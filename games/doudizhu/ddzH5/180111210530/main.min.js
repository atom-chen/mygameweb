function __extends(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),__define=this.__define||function(t,e,i,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:r})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0);var o=i.call(this)||this;return o.x=t,o.y=e,o.width=r,o.height=n,o}return __extends(r,i),r.release=function(t){t&&e.push(t)},r.create=function(){var t=e.pop();return t||(t=new r),t},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,o=Math.max(e,r),a=Math.min(e+this.width,r+t.width);if(a>=o){var s=Math.max(i,n),h=Math.min(i+this.height,n+t.height);if(h>=s)return this.setTo(o,s,a-o,h-s),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y?!0:!1},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&r>=e&&i>this.y&&n>=i},r.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},r.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*this.width+i*this.height},r.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return i*this.width+e*this.height},r}(t.HashObject);t.Rectangle=i,__reflect(i.prototype,"egret.Rectangle"),t.$TempRectangle=new i}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(r,i),r.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,i=t?e[2]:e[1];return i},r.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},r.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},r.prototype.$addListener=function(t,e,i,r,n,o){var a=this.$EventDispatcher,s=r?a[2]:a[1],h=s[t];h?0!==a[3]&&(s[t]=h=h.concat()):h=s[t]=[],this.$insertEventBin(h,t,e,i,r,n,o)},r.prototype.$insertEventBin=function(t,e,i,r,n,o,a){o=0|+o;for(var s=-1,h=t.length,l=0;h>l;l++){var c=t[l];if(c.listener==i&&c.thisObject==r&&c.target==this)return!1;-1==s&&c.priority<o&&(s=l)}var u={type:e,listener:i,thisObject:r,priority:o,target:this,useCapture:n,dispatchOnce:!!a};return-1!==s?t.splice(s,0,u):t.push(u),!0},r.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,o=r?n[2]:n[1],a=o[t];a&&(0!==n[3]&&(o[t]=a=a.concat()),this.$removeEventBin(a,e,i),0==a.length&&(o[t]=null))},r.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;r>n;n++){var o=t[n];if(o.listener==e&&o.thisObject==i&&o.target==this)return t.splice(n,1),!0}return!1},r.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},r.prototype.willTrigger=function(t){return this.hasEventListener(t)},r.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},r.prototype.$notifyListener=function(t,i){var r=this.$EventDispatcher,n=i?r[2]:r[1],o=n[t.$type];if(!o)return!0;var a=o.length;if(0==a)return!0;var s=e;r[3]++;for(var h=0;a>h;h++){var l=o[h];if(l.listener.call(l.thisObject,t),l.dispatchOnce&&s.push(l),t.$isPropagationImmediateStopped)break}for(r[3]--;s.length;){var l=s.pop();l.target.removeEventListener(l.type,l.listener,l.thisObject,l.useCapture)}return!t.$isDefaultPrevented},r.prototype.dispatchEventWith=function(e,i,r,n){if(i||this.hasEventListener(e)){var o=t.Event.create(t.Event,e,i,n);o.data=r;var a=this.dispatchEvent(o);return t.Event.release(o),a}return!0},r}(t.HashObject);t.EventDispatcher=i,__reflect(i.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var i=function(i){function r(){var e=i.call(this)||this;return e.$children=null,e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$visible=!0,e.$displayList=null,e.$alpha=1,e.$touchEnabled=r.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$displayFlags=2032,e.$DisplayObject={0:1,1:1,2:0,3:0,4:0,5:"",6:new t.Matrix,7:new t.Matrix,8:new t.Matrix,9:new t.Rectangle,10:new t.Rectangle,11:!1,12:0,13:0,14:0/0,15:0/0,16:0,17:0,18:0,19:null,20:null},e}return __extends(r,i),r.prototype.$setFlags=function(t){this.$displayFlags|=t},r.prototype.$removeFlags=function(t){this.$displayFlags&=~t},r.prototype.$removeFlagsUp=function(t){if(this.$hasAnyFlags(t)){this.$removeFlags(t);var e=this.$parent;e&&e.$removeFlagsUp(t)}},r.prototype.$hasFlags=function(t){return(this.$displayFlags&t)==t},r.prototype.$propagateFlagsUp=function(t){if(!this.$hasFlags(t)){this.$setFlags(t);var e=this.$parent;e&&e.$propagateFlagsUp(t)}},r.prototype.$propagateFlagsDown=function(t){this.$setFlags(t)},r.prototype.$hasAnyFlags=function(t){return!!(this.$displayFlags&t)},r.prototype.$invalidateMatrix=function(){this.$setFlags(8),this.$invalidatePosition()},r.prototype.$invalidatePosition=function(){var t=this;t.$invalidateTransform(),t.$propagateFlagsDown(48),t.$parent&&t.$parent.$propagateFlagsUp(4)},Object.defineProperty(r.prototype,"name",{get:function(){return this.$DisplayObject[5]},set:function(t){this.$DisplayObject[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),r.prototype.$setParent=function(t){return this.$parent==t?!1:(this.$parent=t,!0)},r.prototype.$onAddToStage=function(e,i){this.$stage=e,this.$nestLevel=i,this.$hasAddToStage=!0,t.DisplayObjectContainer.$EVENT_ADD_TO_STAGE_LIST.push(this)},r.prototype.$onRemoveFromStage=function(){this.$nestLevel=0,t.DisplayObjectContainer.$EVENT_REMOVE_FROM_STAGE_LIST.push(this)},Object.defineProperty(r.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),r.prototype.$getMatrix=function(){var t=this.$DisplayObject;return this.$hasFlags(8)&&(t[6].$updateScaleAndRotation(t[0],t[1],t[2],t[3]),this.$removeFlags(8)),t[6]},r.prototype.$setMatrix=function(t,i){void 0===i&&(i=!0);var r=this,n=r.$DisplayObject,o=n[6];return o.equals(t)?!1:(o.copyFrom(t),i&&(n[0]=o.$getScaleX(),n[1]=o.$getScaleY(),n[2]=o.$getSkewX(),n[3]=o.$getSkewY(),n[16]=e(180*n[2]/Math.PI),n[17]=e(180*n[3]/Math.PI),n[4]=e(180*n[3]/Math.PI)),r.$removeFlags(8),r.$invalidatePosition(),!0)},r.prototype.$getConcatenatedMatrix=function(){var e=this.$DisplayObject[7];if(this.$hasFlags(16)){this.$parent?this.$parent.$getConcatenatedMatrix().$preMultiplyInto(this.$getMatrix(),e):e.copyFrom(this.$getMatrix());var i=this.$DisplayObject,r=i[12],n=i[13],o=this.$scrollRect;o?e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-o.x-r,-o.y-n),e):(0!=r||0!=n)&&e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-r,-n),e),this.$displayList&&(this.$displayList.$renderNode.moved=!0),this.$renderNode&&(this.$renderNode.moved=!0),this.$removeFlags(16)}return e},r.prototype.$getInvertedConcatenatedMatrix=function(){var t=this.$DisplayObject;return this.$hasFlags(32)&&(this.$getConcatenatedMatrix().$invertInto(t[8]),this.$removeFlags(32)),t[8]},Object.defineProperty(r.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),r.prototype.$getX=function(){return this.$DisplayObject[6].tx},r.prototype.$setX=function(t){t=+t||0;var e=this.$DisplayObject[6];return t==e.tx?!1:(e.tx=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),r.prototype.$getY=function(){return this.$DisplayObject[6].ty},r.prototype.$setY=function(t){t=+t||0;var e=this.$DisplayObject[6];return t==e.ty?!1:(e.ty=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleX=function(){return this.$DisplayObject[0]},r.prototype.$setScaleX=function(t){t=+t||0;var e=this.$DisplayObject;return t==e[0]?!1:(e[0]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleY=function(){return this.$DisplayObject[1]},r.prototype.$setScaleY=function(t){return t=+t||0,t==this.$DisplayObject[1]?!1:(this.$DisplayObject[1]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),r.prototype.$getRotation=function(){return this.$DisplayObject[4]},r.prototype.$setRotation=function(t){t=+t||0,t=e(t);var i=this.$DisplayObject;if(t==i[4])return!1;var r=t-i[4],n=r/180*Math.PI;return i[2]+=n,i[3]+=n,i[4]=t,this.$invalidateMatrix(),!0},Object.defineProperty(r.prototype,"skewX",{get:function(){return this.$DisplayObject[16]},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewX=function(t){t=+t||0;var i=this.$DisplayObject;return t==i[16]?!1:(i[16]=t,t=e(t),t=t/180*Math.PI,i[2]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"skewY",{get:function(){return this.$DisplayObject[17]},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewY=function(t){t=+t||0;var i=this.$DisplayObject;return t==i[17]?!1:(i[17]=t,t=e(t),t=t/180*Math.PI,i[3]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),r.prototype.$getWidth=function(){return isNaN(this.$getExplicitWidth())?this.$getOriginalBounds().width:this.$getExplicitWidth()},r.prototype.$getExplicitWidth=function(){return this.$DisplayObject[14]},r.prototype.$setWidth=function(t){return this.$DisplayObject[14]=isNaN(t)?0/0:t,t=+t,0>t?!1:(this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),r.prototype.$getHeight=function(){return isNaN(this.$getExplicitHeight())?this.$getOriginalBounds().height:this.$getExplicitHeight()},r.prototype.$getExplicitHeight=function(){return this.$DisplayObject[15]},r.prototype.$setHeight=function(t){return this.$DisplayObject[15]=isNaN(t)?0/0:t,t=+t,0>t?!1:(this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"anchorOffsetX",{get:function(){return this.$DisplayObject[12]},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),r.prototype.$getAnchorOffsetX=function(){return this.$DisplayObject[12]},r.prototype.$setAnchorOffsetX=function(t){return t=+t||0,t==this.$DisplayObject[12]?!1:(this.$DisplayObject[12]=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"anchorOffsetY",{get:function(){return this.$DisplayObject[13]},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),r.prototype.$getAnchorOffsetY=function(){return this.$DisplayObject[13]},r.prototype.$setAnchorOffsetY=function(t){return t=+t||0,t==this.$DisplayObject[13]?!1:(this.$DisplayObject[13]=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),r.prototype.$setVisible=function(t){return t=!!t,t==this.$visible?!1:(this.$visible=t,this.$propagateFlagsDown(1024),this.$invalidateTransform(),!0)},r.prototype.$getConcatenatedVisible=function(){var t=this.$DisplayObject;if(this.$hasFlags(1024)){if(this.$parent){var e=this.$parent.$getConcatenatedVisible();t[19]=e&&this.$visible}else t[19]=this.$visible;this.$removeFlags(1024)}return t[19]},Object.defineProperty(r.prototype,"cacheAsBitmap",{get:function(){return this.$DisplayObject[11]},set:function(t){t=!!t,this.$DisplayObject[11]=t,this.$setHasDisplayList(t)},enumerable:!0,configurable:!0}),r.prototype.$setHasDisplayList=function(e){var i=!!this.$displayList;if(i!=e)if(e){var r=t.sys.DisplayList.create(this);r&&(this.$displayList=r,this.$parentDisplayList&&this.$parentDisplayList.markDirty(r),this.$cacheAsBitmapChanged())}else this.$displayList=null,this.$cacheAsBitmapChanged()},r.prototype.$cacheAsBitmapChanged=function(){var t=this.$displayList||this.$parentDisplayList;this.$renderNode&&t&&t.markDirty(this),this.$propagateFlagsDown(48)},Object.defineProperty(r.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),r.prototype.$setAlpha=function(t){return t=+t||0,t==this.$alpha?!1:(this.$alpha=t,this.$propagateFlagsDown(64),this.$invalidate(),!0)},r.prototype.$getConcatenatedAlpha=function(){var t=this.$DisplayObject;if(this.$hasFlags(64)){if(this.$parent){var e=this.$parent.$getConcatenatedAlpha();t[18]=e*this.$alpha}else t[18]=this.$alpha;this.$removeFlags(64)}return t[18]},Object.defineProperty(r.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchEnabled=function(){return this.$touchEnabled},r.prototype.$setTouchEnabled=function(t){return this.$touchEnabled==t?!1:(this.$touchEnabled=t,!0)},Object.defineProperty(r.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),r.prototype.$setScrollRect=function(e){return e||this.$scrollRect?(e?(this.$scrollRect||(this.$scrollRect=new t.Rectangle),this.$scrollRect.copyFrom(e)):this.$scrollRect=null,this.$invalidatePosition(),!0):!1},Object.defineProperty(r.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var i=t.sys.blendModeToNumber(e);i!=this.$blendMode&&(this.$blendMode=i,this.$invalidateTransform())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){return this.$mask?this.$mask:this.$maskRect},set:function(t){if(t!==this){if(t)if(t instanceof r){if(t==this.$mask)return;t.$maskedObject&&(t.$maskedObject.mask=null),t.$maskedObject=this,t.$invalidateTransform(),this.$mask=t,this.$maskRect=null}else this.$setMaskRect(t),this.$mask&&(this.$mask.$maskedObject=null,this.$mask.$invalidateTransform()),this.$mask=null;else this.$mask&&(this.$mask.$maskedObject=null,this.$mask.$invalidateTransform()),this.$mask=null,this.$maskRect=null;this.$invalidateTransform()}},enumerable:!0,configurable:!0}),r.prototype.$setMaskRect=function(e){return e||this.$maskRect?(e?(this.$maskRect||(this.$maskRect=new t.Rectangle),this.$maskRect.copyFrom(e)):this.$maskRect=null,this.$invalidatePosition(),!0):!1},Object.defineProperty(r.prototype,"filters",{get:function(){return this.$DisplayObject[20]},set:function(t){var e=this.$DisplayObject[20];if(!e&&!t)return void(this.$DisplayObject[20]=t);if(this.$invalidateContentBounds(),this.$invalidate(!0),e&&e.length)for(var i=e.length,r=0;i>r;r++)e[r].$removeTarget(this);if(this.$DisplayObject[20]=t,t&&t.length)for(var n=t.length,r=0;n>r;r++)t[r].$addTarget(this)},enumerable:!0,configurable:!0}),r.prototype.$getFilters=function(){return this.$DisplayObject[20]},r.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},r.prototype.getBounds=function(t,e){if(void 0===e&&(e=!0),t=this.$getTransformedBounds(this,t),e){var i=this.$DisplayObject;(0!=i[12]||0!=i[13])&&(t.x-=i[12],t.y-=i[13])}return t},r.prototype.$getTransformedBounds=function(e,i){var r=this.$getOriginalBounds();if(i||(i=new t.Rectangle),i.copyFrom(r),e==this)return i;var n;if(e){n=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(this.$getConcatenatedMatrix(),n)}else n=this.$getConcatenatedMatrix();return n.$transformBounds(i),i},r.prototype.globalToLocal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var r=this.$getInvertedConcatenatedMatrix();return r.transformPoint(t,e,i)},r.prototype.localToGlobal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var r=this.$getConcatenatedMatrix();return r.transformPoint(t,e,i)},r.prototype.$invalidateContentBounds=function(){this.$invalidate(),this.$setFlags(2),this.$propagateFlagsUp(4)},r.prototype.$getOriginalBounds=function(){var t=this.$DisplayObject[9];if(this.$hasFlags(4)){t.copyFrom(this.$getContentBounds()),this.$measureChildBounds(t),this.$removeFlags(4),this.$displayList&&(this.$displayList.$renderNode.moved=!0);var e=this.$measureFiltersOffset(!1);e&&(t.x+=e.minX,t.y+=e.minY,t.width+=-e.minX+e.maxX,t.height+=-e.minY+e.maxY)}return t},r.prototype.$measureChildBounds=function(t){},r.prototype.$getContentBounds=function(){var t=this.$DisplayObject[10];return this.$hasFlags(2)&&(this.$measureContentBounds(t),this.$renderNode&&(this.$renderNode.moved=!0),this.$removeFlags(2)),t},r.prototype.$measureContentBounds=function(t){},r.prototype.$invalidate=function(t){if(this.$renderNode&&!this.$hasFlags(384)){this.$setFlags(384);var e=this.$displayList?this.$displayList:this.$parentDisplayList;e&&e.markDirty(this)}},r.prototype.$invalidateTransform=function(){var t=this;if(!t.$hasFlags(512)){t.$setFlags(512);var e=t.$displayList;(e||t.$renderNode)&&t.$parentDisplayList&&t.$parentDisplayList.markDirty(e||t)}},r.prototype.$getRenderNode=function(){var t=this.$renderNode;return t?(128&this.$displayFlags&&(t.cleanBeforeRender(),this.$render(),this.$removeFlags(128),t=this.$renderNode),t):null},r.prototype.$update=function(e,i){var r=this;r.$removeFlagsUp(768);var n=r.$renderNode;n.renderAlpha=r.$getConcatenatedAlpha();var o=r.$getConcatenatedMatrix();if(e==t.DirtyRegionPolicy.OFF){var a=r.$displayList||r.$parentDisplayList;if(!a)return!1;var s=n.renderMatrix;s.copyFrom(o);var h=a.root;h!==r.$stage&&r.$getConcatenatedMatrixAt(h,s)}else{var l=i||r.$getContentBounds();n.renderVisible=r.$getConcatenatedVisible();var a=r.$displayList||r.$parentDisplayList,c=n.renderRegion;if(!a)return c.setTo(0,0,0,0),n.moved=!1,!1;if(!n.moved)return!1;n.moved=!1;var s=n.renderMatrix;s.copyFrom(o);var h=a.root;h!==r.$stage&&r.$getConcatenatedMatrixAt(h,s),c.updateRegion(l,s);var u=r.$measureFiltersOffset(!0);u&&(c.minX+=u.minX,c.minY+=u.minY,c.maxX+=u.maxX,c.maxY+=u.maxY,c.updateArea())}return!0},r.prototype.$measureFiltersOffset=function(e){for(var i=this,r=0,n=0,o=0,a=0;i;){var s=i.$DisplayObject[20];if(s&&s.length)for(var h=s.length,l=0;h>l;l++){var c=s[l];if("blur"==c.type){var u=c.blurX,p=c.blurY;r-=u,n-=p,o+=u,a+=p}else if("glow"==c.type){var u=c.blurX,p=c.blurY;r-=u,n-=p,o+=u,a+=p;var d=c.distance||0,f=c.angle||0,g=0,y=0;0!=d&&(g=d*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),y=d*t.NumberUtils.sin(f),y=y>0?Math.ceil(y):Math.floor(y),r+=g,o+=g,n+=y,a+=y)}else if("custom"==c.type){var v=c.padding;r-=v,n-=v,o+=v,a+=v}}i=e?i.$parent:null}return r=Math.min(r,0),n=Math.min(n,0),o=Math.max(o,0),a=Math.max(a,0),{minX:r,minY:n,maxX:o,maxY:a}},r.prototype.$getConcatenatedMatrixAt=function(e,i){var r=e.$getInvertedConcatenatedMatrix();if(0===r.a||0===r.d){var n=this,o=e.$nestLevel;for(i.identity();n.$nestLevel>o;){var a=n.$scrollRect;a&&i.concat(t.$TempMatrix.setTo(1,0,0,1,-a.x,-a.y)),i.concat(n.$getMatrix()),n=n.$parent}}else r.$preMultiplyInto(i,i)},r.prototype.$getConcatenatedAlphaAt=function(t,e){var i=t.$getConcatenatedAlpha();if(0===i){e=1;for(var r=this,n=t.$nestLevel;r.$nestLevel>n;)e*=r.$alpha,r=r.$parent}else e/=i;return e},r.prototype.$render=function(){},r.prototype.$hitTest=function(t,e){var i=this.$DisplayObject;if(!this.$renderNode||!this.$visible||0==i[0]||0==i[1])return null;var r=this.$getInvertedConcatenatedMatrix();if(0==r.a&&0==r.b&&0==r.c&&0==r.d)return null;var n=this.$getContentBounds(),o=r.a*t+r.c*e+r.tx,a=r.b*t+r.d*e+r.ty;if(n.contains(o,a)){if(!this.$children){var s=this.$scrollRect?this.$scrollRect:this.$maskRect;if(s&&!s.contains(o,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,e))return null}return this}return null},r.prototype.hitTestPoint=function(e,i,r){if(r){var n=this.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=void 0,h=this.$displayList;if(h){var l=h.renderBuffer;try{s=l.getPixels(o-h.offsetX,a-h.offsetY)}catch(c){throw new Error(t.sys.tr(1039))}}else{var l=t.sys.customHitTestBuffer;l.resize(3,3);var u=t.Matrix.create();u.identity(),u.translate(1-o,1-a),t.sys.systemRenderer.render(this,l,u,null,!0),t.Matrix.release(u);try{s=l.getPixels(1,1)}catch(c){throw new Error(t.sys.tr(1039))}}return 0===s[3]?!1:!0}var p=this.$DisplayObject;if(0==p[0]||0==p[1])return!1;var n=this.$getInvertedConcatenatedMatrix(),d=this.getBounds(null,!1),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty;if(d.contains(o,a)){var f=this.$scrollRect?this.$scrollRect:this.$maskRect;return f&&!f.contains(o,a)?!1:!0}return!1},r.prototype.$addListener=function(e,n,o,a,s,h){i.prototype.$addListener.call(this,e,n,o,a,s,h);var l=e==t.Event.ENTER_FRAME;if(l||e==t.Event.RENDER){var c=l?r.$enterFrameCallBackList:r.$renderCallBackList;-1==c.indexOf(this)&&c.push(this)}},r.prototype.removeEventListener=function(e,n,o,a){i.prototype.removeEventListener.call(this,e,n,o,a);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var h=s?r.$enterFrameCallBackList:r.$renderCallBackList,l=h.indexOf(this);-1!==l&&h.splice(l,1)}},r.prototype.dispatchEvent=function(t){if(!t.$bubbles)return i.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),r=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,r),!t.$isDefaultPrevented},r.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),e=i.concat(e)},r.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,o=0;r>o;o++){var a=e[o];if(t.$currentTarget=a,n>o?t.$eventPhase=1:o==i||o==n?t.$eventPhase=2:t.$eventPhase=3,a.$notifyListener(t,i>o),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},r.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},r.defaultTouchEnabled=!1,r.boundsForUpdate=new t.Rectangle,r.$enterFrameCallBackList=[],r.$renderCallBackList=[],r}(t.EventDispatcher);t.DisplayObject=i,__reflect(i.prototype,"egret.DisplayObject",["egret.sys.Renderable"])}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(i,e),i.prototype.$propagateFlagsDown=function(t){if(!this.$hasFlags(t)){this.$setFlags(t);for(var e=this.$children,i=e.length,r=0;i>r;r++)e[r].$propagateFlagsDown(t)}},Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,r,n){void 0===n&&(n=!0);var o=e.$parent;if(o==this)return this.doSetChildIndex(e,r),e;o&&o.removeChild(e),this.$children.splice(r,0,e),e.$setParent(this);var a=this.$stage;if(a&&e.$onAddToStage(a,this.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),a)for(var s=i.$EVENT_ADD_TO_STAGE_LIST;s.length;){var h=s.shift();h.$stage&&n&&h.dispatchEventWith(t.Event.ADDED_TO_STAGE)}var l=this.$displayList||this.$parentDisplayList;return this.assignParentDisplayList(e,l,l),e.$propagateFlagsDown(1648),this.$propagateFlagsUp(4),this.$childAdded(e,r),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;r>n;n++)if(e=i[n],e.name==t)return e;return null},i.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},i.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},i.prototype.$doRemoveChild=function(e,r){void 0===r&&(r=!0),e=0|+e;var n=this.$children,o=n[e];if(this.$childRemoved(o,e),r&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var a=i.$EVENT_REMOVE_FROM_STAGE_LIST;a.length>0;){var s=a.shift();r&&s.$hasAddToStage&&(s.$hasAddToStage=!1,s.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),s.$hasAddToStage=!1,s.$stage=null}}var h=this.$displayList||this.$parentDisplayList;this.assignParentDisplayList(o,h,null),o.$propagateFlagsDown(1648),o.$setParent(null);var l=n.indexOf(o);return-1!=l&&n.splice(l,1),this.$propagateFlagsUp(4),o},i.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(t,e){var i=this.$children.indexOf(t);i!=e&&(this.$childRemoved(t,i),this.$children.splice(i,1),this.$children.splice(e,0,t),this.$childAdded(t,e),t.$invalidateTransform(),this.$propagateFlagsUp(4))},i.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},i.prototype.swapChildren=function(t,e){var i=this.$children.indexOf(t),r=this.$children.indexOf(e);-1==i||-1==r||this.doSwapChildrenAt(i,r)},i.prototype.doSwapChildrenAt=function(t,e){if(t>e){var i=e;e=t,t=i}else if(t==e)return;var r=this.$children,n=r[t],o=r[e];this.$childRemoved(n,t),this.$childRemoved(o,e),r[t]=o,r[e]=n,this.$childAdded(o,t),this.$childAdded(n,e),n.$invalidateTransform(),o.$invalidateTransform(),this.$propagateFlagsUp(4)},i.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},i.prototype.$childAdded=function(t,e){},i.prototype.$childRemoved=function(t,e){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children,n=r.length;i++;for(var o=0;n>o;o++){var a=this.$children[o];a.$onAddToStage(t,i)}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;i>r;r++){var n=t[r];n.$onRemoveFromStage()}},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,o=0,a=0,s=0,h=!1,l=-1;r>l;l++){var c=-1==l?e:i[l].$getTransformedBounds(this,t.$TempRectangle);c.isEmpty()||(h?(n=Math.min(n,c.x),o=Math.max(o,c.x+c.width),a=Math.min(a,c.y),s=Math.max(s,c.y+c.height)):(h=!0,n=c.x,o=n+c.width,a=c.y,s=a+c.height))}e.setTo(n,a,o-n,s-a)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},i.prototype.$invalidate=function(t){if(e.prototype.$invalidate.call(this,t),t){var i=this.$displayList||this.$parentDisplayList,r=this.$children;if(r)for(var n=r.length-1;n>=0;n--)this.markChildDirty(r[n],i)}},i.prototype.$invalidateTransform=function(){this.markChildDirty(this,this.$parentDisplayList)},i.prototype.markChildDirty=function(t,e){if(!t.$hasFlags(512)){t.$setFlags(512);var i=t.$displayList;if((i||t.$renderNode)&&e&&e.markDirty(i||t),!i){var r=t.$children;if(r)for(var n=r.length-1;n>=0;n--)this.markChildDirty(r[n],e)}}},i.prototype.$cacheAsBitmapChanged=function(){e.prototype.$cacheAsBitmapChanged.call(this);for(var t=this.$displayList||this.$parentDisplayList,i=this.$children,r=i.length-1;r>=0;r--)this.assignParentDisplayList(i[r],t,t)},i.prototype.assignParentDisplayList=function(t,e,i){t.$parentDisplayList=i,t.$setFlags(512);var r=t.$displayList;if((t.$renderNode||r)&&e&&e.markDirty(r||t),!r){var n=t.$children;if(n)for(var o=n.length-1;o>=0;o--)this.assignParentDisplayList(n[o],e,i)}},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;
var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,o=r.b*t+r.d*i+r.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var s=this.$children,h=!1,l=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(l=u.$hitTest(t,i))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:e.prototype.$hitTest.call(this,t,i)},i.prototype.$setAlpha=function(t){return t=+t||0,t==this.$alpha?!1:(this.$alpha=t,this.$propagateFlagsDown(64),this.$invalidate(),this.$invalidateAllChildren(),!0)},i.prototype.$invalidateAllChildren=function(){var t=this.$children;if(t)for(var e=t.length-1;e>=0;e--){var i=t[e];i.$invalidate(),i.$children&&i.$invalidateAllChildren()}},i.$EVENT_ADD_TO_STAGE_LIST=[],i.$EVENT_REMOVE_FROM_STAGE_LIST=[],i}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=null,e.$targets=[],e.$uniforms={},e}return __extends(e,t),e.prototype.$addTarget=function(t){for(var e=this.$targets.length,i=0;e>i;i++)if(this.$targets[i].$hashCode==t.$hashCode)return;this.$targets.push(t)},e.prototype.$removeTarget=function(t){for(var e=this.$targets.length,i=0;e>i;i++)if(this.$targets[i].$hashCode==t.$hashCode)return void this.$targets.splice(i,1)},e.prototype.invalidate=function(){for(var t=this.$targets.length,e=0;t>e;e++)this.$targets[e].$invalidateContentBounds()},e.prototype.$toJson=function(){return""},e}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function i(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var o=i.length,a=0;o>a;a++)n=n.replace("{"+a+"}",i[a]);return n}e.tr=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.$eventPhase=2,o.$currentTarget=null,o.$target=null,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.data=n,o}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,i,r,n){void 0===r&&(r=!1);var o=e.create(e,i,r),a=e._getPropertyData(e);void 0!=n&&(a.data=n);var s=t.dispatchEvent(o);return e.release(o),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,i,r){var n=t.eventPool;if(n||(n=t.eventPool=[]),n.length){var o=n.pop();return o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$eventPhase=2,o}return new t(e,i,r)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){var e=[],i=Math.PI/180,r=function(r){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=r.call(this)||this;return i.x=t,i.y=e,i}return __extends(n,r),n.release=function(t){t&&e.push(t)},n.create=function(t,i){var r=e.pop();return r||(r=new n),r.setTo(t,i)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,i){var r=1-i;return new n(t.x*i+e.x*r,t.y*i+e.y*r)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,r){return new n(e*t.NumberUtils.cos(r/i),e*t.NumberUtils.sin(r/i))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=r,__reflect(r.prototype,"egret.Point"),t.$TempPoint=new r}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r._bitmapX=0,r._bitmapY=0,r._textureMap=t.createMap(),r.$texture=i,r._bitmapX=i._bitmapX-i._offsetX,r._bitmapY=i._bitmapY-i._offsetY,r}return __extends(i,e),i.prototype.getTexture=function(t){return this._textureMap[t]},i.prototype.createTexture=function(e,i,r,n,o,a,s,h,l){void 0===a&&(a=0),void 0===s&&(s=0),void 0===h&&(h=a+n),void 0===l&&(l=s+o);var c=new t.Texture;return c._bitmapData=this.$texture._bitmapData,c.$initData(this._bitmapX+i,this._bitmapY+r,n,o,a,s,h,l,this.$texture._sourceWidth,this.$texture._sourceHeight),this._textureMap[e]=c,c},i.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},i}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,o,a,s,h){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===r&&(r=6),void 0===n&&(n=6),void 0===o&&(o=2),void 0===a&&(a=1),void 0===s&&(s=!1),void 0===h&&(h=!1);var l=t.call(this)||this;return l.type="glow",l.$color=e,l.$blue=255&e,l.$green=(65280&e)>>8,l.$red=e>>16,l.$alpha=i,l.$blurX=r,l.$blurY=n,l.$strength=o,l.$quality=a,l.$inner=s,l.$knockout=h,l.$uniforms.color={x:l.$red/255,y:l.$green/255,z:l.$blue/255,w:1},l.$uniforms.alpha=i,l.$uniforms.blurX=r,l.$uniforms.blurY=n,l.$uniforms.strength=o,l.$uniforms.inner=s?1:0,l.$uniforms.knockout=h?0:1,l.$uniforms.dist=0,l.$uniforms.angle=0,l.$uniforms.hideObject=0,l}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.$uniforms.blurX=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.$uniforms.blurY=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,o=r.b*e+r.d*i+r.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var s=this.$children,h=!1,l=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(l=u.$hitTest(e,i))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:(l=t.DisplayObject.prototype.$hitTest.call(this,e,i),l&&(l=this.$graphics.$hitTest(e,i)),l)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function i(){var t=e.call(this)||this;return t._bitmapX=0,t._bitmapY=0,t._bitmapWidth=0,t._bitmapHeight=0,t._offsetX=0,t._offsetY=0,t._textureWidth=0,t._textureHeight=0,t._sourceWidth=0,t._sourceHeight=0,t._bitmapData=null,t.$rotated=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this._textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this._textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this._bitmapWidth*t.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this._bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this._bitmapData},set:function(t){this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(e){this._bitmapData=e;var i=t.$TextureScaleFactor,r=e.width*i,n=e.height*i;this.$initData(0,0,r,n,0,0,r,n,e.width,e.height)},i.prototype.$initData=function(e,i,r,n,o,a,s,h,l,c,u){void 0===u&&(u=!1);var p=t.$TextureScaleFactor;this._bitmapX=e/p,this._bitmapY=i/p,this._bitmapWidth=r/p,this._bitmapHeight=n/p,this._offsetX=o,this._offsetY=a,this._textureWidth=s,this._textureHeight=h,this._sourceWidth=l,this._sourceHeight=c,this.$rotated=u,t.BitmapData.$invalidate(this)},i.prototype.getPixel32=function(t,e){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(t,e,i){throw new Error},i.prototype.saveToFile=function(t,e,i){throw new Error},i.prototype.dispose=function(){this._bitmapData&&(this._bitmapData.$dispose(),this._bitmapData=null)},i}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r){var n=e.call(this)||this;return n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.BitmapNode,n.$Bitmap={0:null,1:null,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:i.defaultSmoothing,11:0/0,12:0/0,13:0/0,14:0/0},n.$setBitmapData(r),r instanceof t.Texture&&(n.$renderNode.rotated=r.$rotated),n}return __extends(i,e),i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=this.$Bitmap[0];n&&t.BitmapData.$addDisplayObject(this,n)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=this.$Bitmap[0];i&&t.BitmapData.$removeDisplayObject(this,i)},Object.defineProperty(i.prototype,"bitmapData",{get:function(){var e=this.$Bitmap[0];return e instanceof t.Texture?null:e},set:function(t){this.$setBitmapData(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){var e=this.$Bitmap[0];return e instanceof t.Texture?e:null},set:function(t){var e=this;e.$setBitmapData(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),i.prototype.$setBitmapData=function(e){var i=this.$Bitmap,r=i[0];if(e==r)return!1;if(i[0]=e,!e)return r&&t.BitmapData.$removeDisplayObject(this,r),this.setImageData(null,0,0,0,0,0,0,0,0,0,0),this.$invalidateContentBounds(),!0;if(this.$refreshImageData(),this.$stage){if(r){var n=void 0;n=r._bitmapData&&r._bitmapData.hashCode?r._bitmapData.hashCode:r.hashCode;var o=void 0;if(o=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,n==o)return this.$invalidateContentBounds(),!0;t.BitmapData.$removeDisplayObject(this,r)}t.BitmapData.$addDisplayObject(this,e)}return this.$invalidateContentBounds(),!0},i.prototype.$refreshImageData=function(){var e=this.$Bitmap,i=e[0];if(i)if(i instanceof t.Texture)this.setImageData(i._bitmapData,i._bitmapX,i._bitmapY,i._bitmapWidth,i._bitmapHeight,i._offsetX,i._offsetY,i.$getTextureWidth(),i.$getTextureHeight(),i._sourceWidth,i._sourceHeight);else{var r=i.width,n=i.height;this.setImageData(i,0,0,r,n,0,0,r,n,r,n)}},i.prototype.setImageData=function(t,e,i,r,n,o,a,s,h,l,c){var u=this.$Bitmap;u[1]=t,u[2]=e,u[3]=i,u[4]=r,u[5]=n,u[6]=o,u[7]=a,u[8]=s,u[9]=h,u[13]=l,u[14]=c},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$scale9Grid=t,this.$invalidateContentBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(t){return t==this.$fillMode?!1:(this.$fillMode=t,!0)},Object.defineProperty(i.prototype,"smoothing",{get:function(){var t=this.$Bitmap;return t[10]},set:function(t){t=!!t;var e=this.$Bitmap;t!=e[10]&&(e[10]=t,this.$invalidate())},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(t){var e=this.$Bitmap;return 0>t||t==e[11]?!1:(e[11]=t,this.$invalidateContentBounds(),!0)},i.prototype.$setHeight=function(t){var e=this.$Bitmap;return 0>t||t==e[12]?!1:(e[12]=t,this.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this.$Bitmap;return isNaN(t[11])?this.$getContentBounds().width:t[11]},i.prototype.$getHeight=function(){var t=this.$Bitmap;return isNaN(t[12])?this.$getContentBounds().height:t[12]},i.prototype.$measureContentBounds=function(t){var e=this.$Bitmap;if(e[1]){var i=this.$Bitmap,r=isNaN(i[11])?i[8]:i[11],n=isNaN(i[12])?i[9]:i[12];t.setTo(0,0,r,n)}else{var r=isNaN(e[11])?0:e[11],n=isNaN(e[12])?0:e[12];t.setTo(0,0,r,n)}},i.prototype.$render=function(){var e=this.$Bitmap;if(e[1]){var i=isNaN(e[11])?e[8]:e[11],r=isNaN(e[12])?e[9]:e[12];t.sys.BitmapNode.$updateTextureData(this.$renderNode,e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],i,r,e[13],e[14],this.scale9Grid||e[0].scale9Grid,this.fillMode,e[10])}},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r&&this._pixelHitTest&&(r=this.hitTestPixel(t,i)),r},i.prototype.hitTestPixel=function(e,i){var r,n=this.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=this.$displayList;if(s){var h=s.renderBuffer;try{r=h.getPixels(o-s.offsetX,a-s.offsetY)}catch(l){throw console.log(this.$Bitmap[0]),new Error(t.sys.tr(1039))}}else{var h=t.sys.customHitTestBuffer;h.resize(3,3);var c=this.$getRenderNode(),u=t.Matrix.create();u.identity(),u.translate(1-o,1-a),t.sys.systemRenderer.drawNodeToBuffer(c,h,u,!0),t.Matrix.release(u);try{r=h.getPixels(1,1)}catch(l){throw console.log(this.$Bitmap[0]),new Error(t.sys.tr(1039))}}return 0===r[3]?null:this},i.$drawImage=function(e,i,r,n,o,a,s,h,l,c,u,p,d,f,g,y,v){console.warn("deprecated method : Bitmap.$drawImage,use egret.sys.BitmapNode.$drawImage instead of it"),t.sys.BitmapNode.$updateTextureData(e,i,r,n,o,a,s,h,l,c,u,p,d,f,g,y,v)},i.defaultSmoothing=!0,i}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function i(){this.type=0,this.needRedraw=!1,this.renderAlpha=1,this.renderVisible=!0,this.renderMatrix=new t.Matrix,this.renderRegion=new e.Region,this.moved=!1,this.drawData=[],this.renderCount=0}return i.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},i.prototype.$getRenderCount=function(){return this.renderCount},i}();e.RenderNode=i,__reflect(i.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,i,r,n,o){this.$commands[this.commandPosition++]=4;var a=this.dataPosition;this.$data[a++]=t,this.$data[a++]=e,this.$data[a++]=i,this.$data[a++]=r,this.$data[a++]=n,this.$data[a++]=o,this.dataPosition=a},t.prototype.drawRect=function(t,e,i,r){var n=t+i,o=e+r;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,o),this.lineTo(t,o),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,i,r,n,o){var a=.5*n|0,s=o?.5*o|0:a;if(!a||!s)return void this.drawRect(t,e,i,r);var h=.5*i,l=.5*r;if(a>h&&(a=h),s>l&&(s=l),h===a&&l===s)return void(a===s?this.drawCircle(t+a,e+s,a):this.drawEllipse(t,e,2*a,2*s));var c=t+i,u=e+r,p=t+a,d=c-a,f=e+s,g=u-s;this.moveTo(c,g),this.curveTo(c,u,d,u),this.lineTo(p,u),this.curveTo(t,u,t,g),this.lineTo(t,f),this.curveTo(t,e,p,e),this.lineTo(d,e),this.curveTo(c,e,c,f),this.lineTo(c,g)},t.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,i,r){var n=.5*i,o=.5*r;t+=n,e+=o,this.arcToBezier(t,e,n,o,0,2*Math.PI)},t.prototype.drawArc=function(t,e,i,r,n,o){o?n>=r&&(n-=2*Math.PI):r>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,o)},t.prototype.arcToBezier=function(t,e,i,r,n,o,a){var s=.5*Math.PI,h=n,l=h;a?(l+=-s-h%s,o>l&&(l=o)):(l+=s-h%s,l>o&&(l=o));var c=t+Math.cos(h)*i,u=e+Math.sin(h)*r;(this.$lastX!=c||this.$lastY!=u)&&this.moveTo(c,u);for(var p=Math.cos(h),d=Math.sin(h),f=0;4>f;f++){var g=l-h,y=4*Math.tan(g/4)/3,v=c-d*y*i,$=u+p*y*r;p=Math.cos(l),d=Math.sin(l),c=t+p*i,u=e+d*r;var m=c+d*y*i,b=u-p*y*r;if(this.cubicCurveTo(v,$,m,b,c,u),l===o)break;h=l,a?(l=h-s,o>l&&(l=o)):(l=h+s,l>o&&(l=o))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){function e(){return""}function i(t){throw new Error("#"+t)}function r(){}function n(){}t.getString=e,t.$error=i,t.$warn=r,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){t.DirtyRegionPolicy={OFF:"off",ON:"on"}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(i,r,n){var o=e.compileFragmentShader(i,n),a=e.compileVertexShader(i,r),s=i.createProgram();return i.attachShader(s,a),i.attachShader(s,o),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,i){return e._compileShader(t,i,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,i){return e._compileShader(t,i,t.VERTEX_SHADER)},e._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(i){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n._status=0,n}return __extends(i,e),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),i.dispatchHTTPStatusEvent=function(e,r){var n=t.Event.create(i,i.HTTP_STATUS);n._status=r;var o=e.dispatchEvent(n);return t.Event.release(n),o},i.HTTP_STATUS="httpStatus",i}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchIOErrorEvent=function(e){var r=t.Event.create(i,i.IO_ERROR),n=e.dispatchEvent(r);return t.Event.release(r),n},i.IO_ERROR="ioError",i}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,o){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===o&&(o=0);var a=e.call(this,t,i,r)||this;return a.bytesLoaded=0,a.bytesTotal=0,a.bytesLoaded=n,a.bytesTotal=o,a}return __extends(i,e),i.dispatchProgressEvent=function(e,r,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var a=t.Event.create(i,r);a.bytesLoaded=n,a.bytesTotal=o;var s=e.dispatchEvent(a);return t.Event.release(a),s},i.PROGRESS="progress",i.SOCKET_DATA="socketData",i}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchStageOrientationEvent=function(e,r){var n=t.Event.create(i,r),o=e.dispatchEvent(n);return t.Event.release(n),o},i.ORIENTATION_CHANGE="orientationChange",i}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="");var o=e.call(this,t,i,r)||this;return o.text=n,o}return __extends(i,e),i.dispatchTextEvent=function(e,r,n){var o=t.Event.create(i,r);o.text=n;var a=e.dispatchEvent(o);return t.Event.release(o),a},i.LINK="link",i}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return e.call(this,t,i,r)||this}return __extends(i,e),i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTimerEvent=function(e,r,n,o){var a=t.Event.create(i,r,n,o),s=e.dispatchEvent(a);return t.Event.release(a),s},i.TIMER="timer",i.TIMER_COMPLETE="timerComplete",i}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.format="image",i.$deleteSource=!0,i.source=t,i.width=t.width,i.height=t.height,i}return __extends(i,e),i.create=function(e,r,n){if(t.Capabilities.runtimeType===t.RuntimeType.WEB){var o="";o="arraybuffer"===e?t.Base64Util.encode(r):r;var a="image/png";"/"===o.charAt(0)?a="image/jpeg":"R"===o.charAt(0)?a="image/gif":"i"===o.charAt(0)&&(a="image/png");var s=new Image;s.src="data:"+a+";base64,"+o,s.crossOrigin="*";var h=new i(s);return s.onload=function(){s.onload=void 0,h.source=s,h.height=s.height,h.width=s.width,n&&n(h)},h}var l=null;l="arraybuffer"===e?r:t.Base64Util.decode(r);var c=egret_native.Texture.createTextureFromArrayBuffer(l),u=new i(c);return n&&n(u),u},i.prototype.$dispose=function(){t.Capabilities.runtimeType==t.RuntimeType.WEB&&"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source=null,i.$dispose(this)},i.$addDisplayObject=function(t,e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode){if(!i._displayList[r])return void(i._displayList[r]=[t]);var n=i._displayList[r];n.indexOf(t)<0&&n.push(t)}},i.$removeDisplayObject=function(t,e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r]){var n=i._displayList[r],o=n.indexOf(t);o>=0&&n.splice(o)}},i.$invalidate=function(e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r])for(var n=i._displayList[r],o=0;o<n.length;o++)n[o]instanceof t.Bitmap&&n[o].$refreshImageData(),n[o].$invalidateContentBounds()},i.$dispose=function(e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r]){for(var n=i._displayList[r],o=0,a=n;o<a.length;o++){var s=a[o];s instanceof t.Bitmap&&(s.$Bitmap[1]=null),s.$invalidateContentBounds()}delete i._displayList[r]}},i._displayList=t.createMap(),i}(t.HashObject);t.BitmapData=e,__reflect(e.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e=new t.Point,i=function(i){function r(t,e,r,n,o,a){var s=i.call(this,t,e,r)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,o,a),s}return __extends(r,i),r.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(r.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),r.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},r.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTouchEvent=function(e,i,n,o,a,s,h,l){if(void 0===l&&(l=!1),!n&&!e.hasEventListener(i))return!0;var c=t.Event.create(r,i,n,o);c.$initTo(a,s,h),c.touchDown=l;var u=e.dispatchEvent(c);return t.Event.release(c),u},r.TOUCH_MOVE="touchMove",r.TOUCH_BEGIN="touchBegin",r.TOUCH_END="touchEnd",r.TOUCH_CANCEL="touchCancel",r.TOUCH_TAP="touchTap",r.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",r}(t.Event);t.TouchEvent=i,__reflect(i.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,n,o){void 0===e&&(e=4),void 0===n&&(n=4),void 0===o&&(o=1);var a=t.call(this)||this;return a.type="blur",a.$blurX=e,a.$blurY=n,a.$quality=o,a.blurXFilter=new i(e),a.blurYFilter=new r(n),a}return __extends(e,t),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.blurXFilter.blurX=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.blurYFilter.blurY=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},e}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var i=function(t){function e(e){void 0===e&&(e=4);var i=t.call(this)||this;return i.type="blurX",i.$uniforms.blur={x:e,y:0},i}return __extends(e,t),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),e}(t.Filter);__reflect(i.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var r=function(t){function e(e){void 0===e&&(e=4);var i=t.call(this)||this;return i.type="blurY",i.$uniforms.blur={x:0,y:e},i}return __extends(e,t),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),e}(t.Filter);__reflect(r.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);
var i=t.call(this)||this;return i.$matrix=[],i.matrix2=[],i.type="colorTransform",i.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.$uniforms.colorAdd={x:0,y:0,z:0,w:0},i.setMatrix(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t),this.invalidate()},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var i=this.$matrix,r=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,o=0;e<i.length;e++)4===e?n.x=i[e]/255:9===e?n.y=i[e]/255:14===e?n.z=i[e]/255:19===e?n.w=i[e]/255:(r[o]=i[e],o++)},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,i={},r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),o=0,a=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=o&&(o=33554432+16777216*Math.random()|0),e=15&o,o>>=4,n[t]=r[19===t?3&e|8:e]);return n.join("")},s=function(t){function e(e,r,n){void 0===n&&(n={});var o=t.call(this)||this;o.padding=0,o.$vertexSrc=e,o.$fragmentSrc=r;var s=e+r;return i[s]||(i[s]=a()),o.$shaderKey=i[s],o.$uniforms=n,o.type="custom",o}return __extends(e,t),Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),e}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,o,a,s,h,l,c,u){void 0===e&&(e=4),void 0===i&&(i=45),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=4),void 0===a&&(a=4),void 0===s&&(s=1),void 0===h&&(h=1),void 0===l&&(l=!1),void 0===c&&(c=!1),void 0===u&&(u=!1);var p=t.call(this,r,n,o,a,s,h,l,c)||this;return p.$distance=e,p.$angle=i,p.$hideObject=u,p.$uniforms.dist=e,p.$uniforms.angle=i/180*Math.PI,p.$uniforms.hideObject=u?1:0,p}return __extends(e,t),Object.defineProperty(e.prototype,"distance",{get:function(){return this.$distance},set:function(t){this.$distance!=t&&(this.$distance=t,this.$uniforms.dist=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.$angle},set:function(t){this.$angle!=t&&(this.$angle=t,this.$uniforms.angle=t/180*Math.PI,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},e}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}var i=function(i){function r(){var e=i.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(r,i),r.prototype.$setTarget=function(t){this.targetDisplay&&(this.targetDisplay.$renderNode=null),t.$renderNode=this.$renderNode,this.targetDisplay=t},r.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},r.prototype.beginFill=function(t,e){void 0===e&&(e=1),t=+t||0,e=+e||0,this.fillPath=this.$renderNode.beginFill(t,e,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},r.prototype.beginGradientFill=function(t,e,i,r,n){void 0===n&&(n=null),this.fillPath=this.$renderNode.beginGradientFill(t,e,i,r,n,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},r.prototype.endFill=function(){this.fillPath=null},r.prototype.lineStyle=function(t,e,i,r,n,o,a,s){void 0===t&&(t=0/0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=!1),void 0===n&&(n="normal"),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=3),t=+t||0,0>=t?(this.strokePath=null,this.setStrokeWidth(0)):(e=+e||0,i=+i||0,s=+s||0,this.setStrokeWidth(t),this.strokePath=this.$renderNode.lineStyle(t,e,i,o,a,s),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},r.prototype.drawRect=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.drawRect(t,e,i,r),o&&o.drawRect(t,e,i,r),this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t,e),this.$renderNode.dirtyRender=!0},r.prototype.drawRoundRect=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0;var a=this.fillPath,s=this.strokePath;a&&a.drawRoundRect(t,e,i,r,n,o),s&&s.drawRoundRect(t,e,i,r,n,o);var h=.5*n|0,l=o?.5*o|0:h,c=t+i,u=e+r,p=u-l;this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(c,u),this.updatePosition(c,p),this.$renderNode.dirtyRender=!0},r.prototype.drawCircle=function(t,e,i){t=+t||0,e=+e||0,i=+i||0;var r=this.fillPath,n=this.strokePath;r&&r.drawCircle(t,e,i),n&&n.drawCircle(t,e,i),this.extendBoundsByPoint(t-i,e-i),this.extendBoundsByPoint(t+i,e+i),this.updatePosition(t+i,e),this.$renderNode.dirtyRender=!0},r.prototype.drawEllipse=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.drawEllipse(t,e,i,r),o&&o.drawEllipse(t,e,i,r),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t+i,e+.5*r),this.$renderNode.dirtyRender=!0},r.prototype.moveTo=function(t,e){t=+t||0,e=+e||0;var i=this.fillPath,r=this.strokePath;i&&i.moveTo(t,e),r&&r.moveTo(t,e),this.includeLastPosition=!1,this.lastX=t,this.lastY=e,this.$renderNode.dirtyRender=!0},r.prototype.lineTo=function(t,e){t=+t||0,e=+e||0;var i=this.fillPath,r=this.strokePath;i&&i.lineTo(t,e),r&&r.lineTo(t,e),this.updatePosition(t,e),this.$renderNode.dirtyRender=!0},r.prototype.curveTo=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.curveTo(t,e,i,r),o&&o.curveTo(t,e,i,r),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.updatePosition(i,r),this.$renderNode.dirtyRender=!0},r.prototype.cubicCurveTo=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0;var a=this.fillPath,s=this.strokePath;a&&a.cubicCurveTo(t,e,i,r,n,o),s&&s.cubicCurveTo(t,e,i,r,n,o),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.extendBoundsByPoint(n,o),this.updatePosition(n,o),this.$renderNode.dirtyRender=!0},r.prototype.drawArc=function(t,i,r,n,o,a){if(!(0>r||n===o)){t=+t||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0,a=!!a,n=e(n),o=e(o);var s=this.fillPath,h=this.strokePath;s&&(s.$lastX=this.lastX,s.$lastY=this.lastY,s.drawArc(t,i,r,n,o,a)),h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(t,i,r,n,o,a)),a?this.arcBounds(t,i,r,o,n):this.arcBounds(t,i,r,n,o);var l=t+Math.cos(o)*r,c=i+Math.sin(o)*r;this.updatePosition(l,c),this.$renderNode.dirtyRender=!0}},r.prototype.arcBounds=function(t,e,i,r,n){var o=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);r>n&&(n+=2*o);for(var a=Math.cos(r)*i,s=Math.cos(n)*i,h=Math.min(a,s),l=Math.max(a,s),c=Math.sin(r)*i,u=Math.sin(n)*i,p=Math.min(c,u),d=Math.max(c,u),f=r/(.5*o),g=n/(.5*o),y=Math.ceil(f);g>=y;y++)switch(y%4){case 0:l=i;break;case 1:d=i;break;case 2:h=-i;break;case 3:p=-i}h=Math.floor(h),p=Math.floor(p),l=Math.ceil(l),d=Math.ceil(d),this.extendBoundsByPoint(h+t,p+e),this.extendBoundsByPoint(l+t,d+e)},r.prototype.clear=function(){this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0)},r.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},r.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},r.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},r.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX-2,t.y=this.minY-2,t.width=Math.ceil(this.maxX-this.minX)+4,t.height=Math.ceil(this.maxY-this.minY)+4},r.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e),this.targetDisplay.$invalidateContentBounds()},r.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},r.prototype.$hitTest=function(e,i){var r=this.targetDisplay,n=r.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var h=this.$renderNode,l=t.Matrix.create();l.identity(),l.translate(1-o,1-a),t.sys.canvasRenderer.drawNodeToBuffer(h,s,l,!0),t.Matrix.release(l);try{var c=s.getPixels(1,1);if(0===c[3])return null}catch(u){throw new Error(t.sys.tr(1039))}return r},r.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean()},r}(t.HashObject);t.Graphics=i,__reflect(i.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=Math.PI,i=2*e,r=e/180,n=[],o=function(o){function a(t,e,i,r,n,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0);var s=o.call(this)||this;return s.a=t,s.b=e,s.c=i,s.d=r,s.tx=n,s.ty=a,s}return __extends(a,o),a.release=function(t){t&&n.push(t)},a.create=function(){var t=n.pop();return t||(t=new a),t},a.prototype.clone=function(){return new a(this.a,this.b,this.c,this.d,this.tx,this.ty)},a.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,o=this.tx*t.a+t.tx,a=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,o+=this.ty*t.c,a+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=o,this.ty=a},a.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},a.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},a.prototype.invert=function(){this.$invertInto(this)},a.prototype.$invertInto=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty;if(0==i&&0==r)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*o,t.ty=-n*a));var s=e*n-i*r;if(0==s)return void t.identity();s=1/s;var h=t.a=n*s;i=t.b=-i*s,r=t.c=-r*s,n=t.d=e*s,t.tx=-(h*o+r*a),t.ty=-(i*o+n*a)},a.prototype.rotate=function(e){if(e=+e,0!==e){e/=r;var i=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),o=this.a,a=this.b,s=this.c,h=this.d,l=this.tx,c=this.ty;this.a=o*i-a*n,this.b=o*n+a*i,this.c=s*i-h*n,this.d=s*n+h*i,this.tx=l*i-c*n,this.ty=l*n+c*i}},a.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},a.prototype.setTo=function(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this},a.prototype.transformPoint=function(e,i,r){var n=this.a*e+this.c*i+this.tx,o=this.b*e+this.d*i+this.ty;return r?(r.setTo(n,o),r):new t.Point(n,o)},a.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},a.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},a.prototype.prepend=function(t,e,i,r,n,o){var a=this.tx;if(1!=t||0!=e||0!=i||1!=r){var s=this.a,h=this.c;this.a=s*t+this.b*i,this.b=s*e+this.b*r,this.c=h*t+this.d*i,this.d=h*e+this.d*r}return this.tx=a*t+this.ty*i+n,this.ty=a*e+this.ty*r+o,this},a.prototype.append=function(t,e,i,r,n,o){var a=this.a,s=this.b,h=this.c,l=this.d;return(1!=t||0!=e||0!=i||1!=r)&&(this.a=t*a+e*h,this.b=t*s+e*l,this.c=i*a+r*h,this.d=i*s+r*l),this.tx=n*a+o*h+this.tx,this.ty=n*s+o*l+this.ty,this},a.prototype.deltaTransformPoint=function(e){var i=this,r=i.a*e.x+i.c*e.y,n=i.b*e.x+i.d*e.y;return new t.Point(r,n)},a.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},a.prototype.createBox=function(e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);var s=this;if(0!==n){n/=r;var h=t.NumberUtils.cos(n),l=t.NumberUtils.sin(n);s.a=h*e,s.b=l*i,s.c=-l*e,s.d=h*i}else s.a=e,s.b=0,s.c=0,s.d=i;s.tx=o,s.ty=a},a.prototype.createGradientBox=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,i,r+t/2,n+e/2)},a.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty,s=t.x,h=t.y,l=s+t.width,c=h+t.height,u=e*s+r*h+o,p=i*s+n*h+a,d=e*l+r*h+o,f=i*l+n*h+a,g=e*l+r*c+o,y=i*l+n*c+a,v=e*s+r*c+o,$=i*s+n*c+a,m=0;u>d&&(m=u,u=d,d=m),g>v&&(m=g,g=v,v=m),t.x=Math.floor(g>u?u:g),t.width=Math.ceil((d>v?d:v)-t.x),p>f&&(m=p,p=f,f=m),y>$&&(m=y,y=$,$=m),t.y=Math.floor(y>p?p:y),t.height=Math.ceil((f>$?f:$)-t.y)},a.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},a.prototype.$getScaleX=function(){var t=this;if(1==t.a&&0==t.b)return 1;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},a.prototype.$getScaleY=function(){var t=this;if(0==t.c&&1==t.d)return 1;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},a.prototype.$getSkewX=function(){return Math.atan2(this.d,this.c)-e/2},a.prototype.$getSkewY=function(){return Math.atan2(this.b,this.a)},a.prototype.$updateScaleAndRotation=function(e,n,o,a){if(!(0!=o&&o!=i||0!=a&&a!=i))return this.a=e,this.b=this.c=0,void(this.d=n);o/=r,a/=r;var s=t.NumberUtils.cos(o),h=t.NumberUtils.sin(o);o==a?(this.a=s*e,this.b=h*e):(this.a=t.NumberUtils.cos(a)*e,this.b=t.NumberUtils.sin(a)*e),this.c=-h*n,this.d=s*n},a.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,o=t.d*this.d,a=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(i+=t.b*this.c,o+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,a+=t.ty*this.c,s+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=o,e.tx=a,e.ty=s},a}(t.HashObject);t.Matrix=o,__reflect(o.prototype,"egret.Matrix"),t.$TempMatrix=new o}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton errorsingleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this,i)||this;return r._verticesDirty=!0,r._bounds=new t.Rectangle,r.$renderNode=new t.sys.MeshNode,r}return __extends(i,e),i.prototype.$render=function(){var e=this.$Bitmap,i=e[1];if(i){var r=(t.$TextureScaleFactor,this.$renderNode);r.smoothing=e[10],r.image=i,r.imageWidth=e[13],r.imageHeight=e[14];var n=isNaN(e[11])?e[8]:e[11],o=isNaN(e[12])?e[9]:e[12],a=n/e[8],s=o/e[9],h=e[4],l=e[5];r.drawMesh(e[2],e[3],h,l,e[6]*a,e[7]*s,a*h,s*l)}},i.prototype.$updateVertices=function(){this._verticesDirty=!0,this.$invalidateContentBounds()},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;n>r;r+=2){var o=i[r],a=i[r+1];this._bounds.x>o&&(this._bounds.x=o),this._bounds.width<o&&(this._bounds.width=o),this._bounds.y>a&&(this._bounds.y=a),this._bounds.height<a&&(this._bounds.height=a)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="Egret: {0}",e[1002]="Egret {0} egret.DisplayObject",e[1003]=" {0}  null",e[1004]="",e[1005]="",e[1006]=" DisplayObject ",e[1007]="",e[1008]=" {0} ",e[1009]=" {0}  {1}",e[1010]=" {0}  {1} ",e[1011]="URL: {0}",e[1012]=" {0}  Class",e[1013]="NaN",e[1014]=" {0}  {1} ",e[1015]="xml not found!",e[1016]="{0}",e[1017]="JSON: {0}\ndata: {1}",e[1018]="9",e[1019]=":{0}",e[1020]="",e[1021]="webgl",e[1022]="{0} ArgumentError",e[1023]="ScrollView!",e[1025]="",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=":{0} ",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="toDataURLbase64",e[1034]='"{0}"mp3',e[1035]="Native ",e[1036]=" Sound.play() ",e[1037]="blob",e[1038]="XML !",e[1039]="!",e[1040]="hitTestPoint ! ",e[1041]="{0} , {1} ",e[1042]="drawToTexture,",e[1043]="{0}  : {1} : {2}",e[1044]=" runtime ,",e[1045]="",e[1046]="BitmapText :{0}",e[1047]="egret.localStorage.setItem,key={0}&value={1}",e[1048]="",e[1049]="",e[1050]="ExternalInterfacejs: {0}",e[3e3]=": {0}",e[3001]=": {0}",e[3002]=':"{0}"',e[3003]="",e[3004]="addChild(){0}addElement()",e[3005]="addChildAt(){0}addElementAt()",e[3006]="removeChild(){0}removeElement()",e[3007]="removeChildAt(){0}removeElementAt()",e[3008]="setChildIndex(){0}setElementIndex()",e[3009]="swapChildren(){0}swapElements()",e[3010]="swapChildrenAt(){0}swapElementsAt()",e[3011]=':"{0}"',e[3012]="Scroller!",e[3013]="UIStageGUI",e[3014]="",e[3100]="WebSocket",e[3101]="WebSocket",e[3102]="type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){r.indexOf(t)<0&&r.push(t)}function i(t){var e=r.indexOf(t);return e>=0?(r.splice(e,1),!0):!1}var r=[];t.$pushSoundChannel=e,t.$popSoundChannel=i}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.onSuccessFunc=null,this.onSuccessThisObject=null,this.onErrorFunc=null,this.onErrorThisObject=null,this.downloadingSizeFunc=null,this.downloadingSizeThisObject=null,this.onResponseHeaderFunc=null,this.onResponseHeaderThisObject=null}return e.create=function(){return e.promiseObjectList.length?e.promiseObjectList.pop():new t.PromiseObject},e.prototype.onSuccess=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onSuccessFunc&&this.onSuccessFunc.apply(this.onSuccessThisObject,t),this.destroy()},e.prototype.onError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onErrorFunc&&this.onErrorFunc.apply(this.onErrorThisObject,t),this.destroy()},e.prototype.downloadingSize=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.downloadingSizeFunc&&this.downloadingSizeFunc.apply(this.downloadingSizeThisObject,t)},e.prototype.onResponseHeader=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onResponseHeaderFunc&&this.onResponseHeaderFunc.apply(this.onResponseHeaderThisObject,t)},e.prototype.destroy=function(){this.onSuccessFunc=void 0,this.onSuccessThisObject=void 0,this.onErrorFunc=void 0,this.onErrorThisObject=void 0,this.downloadingSizeFunc=void 0,this.downloadingSizeThisObject=void 0,this.onResponseHeaderFunc=void 0,this.onResponseHeaderThisObject=void 0,e.promiseObjectList.push(this)},e.promiseObjectList=[],e}();t.PromiseObject=e,__reflect(e.prototype,"egret.PromiseObject")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="GET",t.POST="POST",t}();t.HttpMethod=e,__reflect(e.prototype,"egret.HttpMethod")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){var i=t.minX<e.minX?t.minX:e.minX,r=t.minY<e.minY?t.minY:e.minY,n=t.maxX>e.maxX?t.maxX:e.maxX,o=t.maxY>e.maxY?t.maxY:e.maxY;return(n-i)*(o-r)}var r=function(){function r(e){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1,this.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,this.root=e}return r.prototype.setClipRect=function(t,e){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},r.prototype.addRegion=function(i){var r=i.minX,n=i.minY,o=i.maxX,a=i.maxY;if(this.hasClipRect&&(0>r&&(r=0),0>n&&(n=0),o>this.clipWidth&&(o=this.clipWidth),a>this.clipHeight&&(a=this.clipHeight)),r>=o||n>=a)return!1;if(this.clipRectChanged)return!0;var s=this.dirtyList,h=e.Region.create();return s.push(h.setTo(r,n,o,a)),this.$dirtyRegionPolicy!=t.DirtyRegionPolicy.OFF&&this.mergeDirtyList(s),!0},r.prototype.clear=function(){for(var t=this.dirtyList,i=t.length,r=0;i>r;r++)e.Region.release(t[r]);t.length=0},r.prototype.getDirtyRegions=function(){var i=this.dirtyList;if(this.$dirtyRegionPolicy==t.DirtyRegionPolicy.OFF){this.clipRectChanged=!0,this.clear();var r=e.Region.create();if(this.hasClipRect)i.push(r.setTo(0,0,this.clipWidth,this.clipHeight));else{var n=this.root.$getOriginalBounds();i.push(r.setTo(n.x,n.y,n.width,n.height))}}else if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var r=e.Region.create();i.push(r.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(i););var o=this.dirtyList.length;if(o>0)for(var a=0;o>a;a++)this.dirtyList[a].intValues();return this.dirtyList},r.prototype.mergeDirtyList=function(t){var r=t.length;if(2>r)return!1;for(var n=this.hasClipRect,o=r>3?Number.POSITIVE_INFINITY:0,a=0,s=0,h=0,l=0;r-1>l;l++){var c=t[l];n&&(h+=c.area);for(var u=l+1;r>u;u++){var p=t[u],d=i(c,p)-c.area-p.area;o>d&&(a=l,s=u,o=d)}}if(n&&h/this.clipArea>.95&&(this.clipRectChanged=!0),a!=s){var f=t[s];return t[a].union(f),e.Region.release(f),t.splice(s,1),!0}return!1},r.prototype.setDirtyRegionPolicy=function(t){this.$dirtyRegionPolicy=t},r}();e.DirtyRegion=r,__reflect(r.prototype,"egret.sys.DirtyRegion")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(r){var n=i.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.isDirty=!1,n.needUpdateRegions=!1,n.dirtyNodeList=[],n.dirtyList=null,n.$canvasScaleX=1,n.$canvasScaleY=1,n.sizeChanged=!1,n.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,n.root=r,n.dirtyRegion=new e.DirtyRegion(r),n.isStage=r instanceof t.Stage,n.dirtyNodes=t.createMap(),n}return __extends(r,i),r.create=function(i){var r=new t.sys.DisplayList(i);try{var n=new e.RenderBuffer;r.renderBuffer=n}catch(o){return null}if(r.root=i,"webgl"==t.Capabilities.$renderMode){var a=t.DirtyRegionPolicy.OFF;r.$dirtyRegionPolicy=a,r.dirtyRegion.setDirtyRegionPolicy(a),r.renderBuffer.setDirtyRegionPolicy(a)}return r},r.prototype.$getRenderNode=function(){return this.$renderNode},r.prototype.$update=function(e){var i=this.root;if(null==i)return!1;i.$removeFlagsUp(768);var r=this.$renderNode,n=i.$getConcatenatedMatrix(),o=i.$parentDisplayList;if(e==t.DirtyRegionPolicy.OFF){if(this.needUpdateRegions&&this.updateDirtyRegions(),!o)return!1;var a=r.renderMatrix;a.copyFrom(n);var s=o.root;s!==i.$stage&&i.$getConcatenatedMatrixAt(s,a),r.renderAlpha=i.$getConcatenatedAlpha()}else{var h=i.$getOriginalBounds(),l=r.renderRegion;if(this.needUpdateRegions&&this.updateDirtyRegions(),!o)return l.setTo(0,0,0,0),r.moved=!1,!1;if(!r.moved)return!1;r.moved=!1;var a=r.renderMatrix;a.copyFrom(n);var s=o.root;s!==i.$stage&&i.$getConcatenatedMatrixAt(s,a),l.updateRegion(h,a),r.renderAlpha=i.$getConcatenatedAlpha()}return!0},r.prototype.setClipRect=function(t,e){this.dirtyRegion.setClipRect(t,e),t*=r.$canvasScaleX,e*=r.$canvasScaleY,this.renderBuffer.resize(t,e)},r.prototype.markDirty=function(t){var e=t.$hashCode;if(!this.dirtyNodes[e]&&(this.dirtyNodes[e]=!0,this.dirtyNodeList.push(t),!this.needUpdateRegions)){this.needUpdateRegions=!0,this.isDirty=!0;var i=this.root.$parentDisplayList;i&&i.markDirty(this)}},r.prototype.updateDirtyRegions=function(){var e=this.dirtyNodeList;this.dirtyNodeList=[],this.dirtyNodes=t.createMap(),this.needUpdateRegions=!1;for(var i=this.dirtyRegion,r=e.length,n=0;r>n;n++){var o=e[n],a=o.$getRenderNode();if(a)if(a.needRedraw=!1,this.isStage){a.renderAlpha>0&&a.renderVisible&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0);var s=o.$update(this.$dirtyRegionPolicy);a.renderAlpha>0&&a.renderVisible&&(s||!a.needRedraw)&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0)}else{i.addRegion(a.renderRegion)&&(a.needRedraw=!0);var s=o.$update(this.$dirtyRegionPolicy);(s||!a.needRedraw)&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0)}}return this.dirtyList=i.getDirtyRegions(),this.dirtyList},r.prototype.drawToSurface=function(){var i=0,n=this.dirtyList;if(n&&n.length>0){this.$canvasScaleX=this.offsetMatrix.a=r.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=r.$canvasScaleY,this.isStage||this.changeSurfaceSize();var o=this.renderBuffer;if(o.beginClip(this.dirtyList,this.offsetX,this.offsetY),n=this.$dirtyRegionPolicy==t.DirtyRegionPolicy.OFF?null:this.dirtyList,i=e.systemRenderer.render(this.root,o,this.offsetMatrix,n,!this.isStage),o.endClip(),!this.isStage){var a=o.surface,s=this.$renderNode;s.drawData.length=0;var h=a.width,l=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=h,this.bitmapData.height=l):this.bitmapData=new t.BitmapData(a),s.image=this.bitmapData,s.imageWidth=h,s.imageHeight=l,s.drawImage(0,0,h,l,-this.offsetX,-this.offsetY,h/this.$canvasScaleX,l/this.$canvasScaleY)}}return this.dirtyList=null,this.dirtyRegion.clear(),this.isDirty=!1,i},r.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,i=this.root.$getOriginalBounds(),r=this.$canvasScaleX,n=this.$canvasScaleY;
this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var o=this.renderBuffer,a=Math.max(257,i.width*r),s=Math.max(257,i.height*n);(this.offsetX!=t||this.offsetY!=e||o.surface.width!=a||o.surface.height!=s)&&(this.sizeChanged?o.resizeTo(a,s,this.offsetX-t,this.offsetY-e):(this.sizeChanged=!0,o.resize(a,s)))},r.prototype.setDirtyRegionPolicy=function(t){this.$dirtyRegionPolicy=t,this.dirtyRegion.setDirtyRegionPolicy(t),this.renderBuffer.setDirtyRegionPolicy(t)},r.$setCanvasScale=function(t,e){r.$canvasScaleX=t,r.$canvasScaleY=e},r.$canvasScaleFactor=1,r.$canvasScaleX=1,r.$canvasScaleY=1,r}(t.HashObject);e.DisplayList=i,__reflect(i.prototype,"egret.sys.DisplayList",["egret.sys.Renderable"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(i,r,n,o){if(r&&(t.log=function(){for(var t=arguments.length,i="",r=0;t>r;r++)i+=arguments[r]+" ";e.$logToFPS(i),console.log.apply(console,a(arguments))}),l=o?{}:o,r=!!r,this.showFPS=!!i,this.showLog=r,!this.fps){var s=void 0===o.x?0:o.x,u=void 0===o.y?0:o.y;h=this.fps=new FPS(this.stage,i,r,n,o),h.x=s,h.y=u;for(var p=c.length,d=0;p>d;d++)h.updateInfo(c[d]);c=null}}function r(t){t=!!t,this._showPaintRect!=t&&(this._showPaintRect=t,t?(this.stageDisplayList||(this.stageDisplayList=e.DisplayList.create(this.stage)),this.stage.$displayList=this.stageDisplayList):this.stage.$displayList=this.screenDisplayList)}function n(t){for(var i=t.length,r=[],n=0;i>n;n++){var o=t[n];r[n]=[o.minX,o.minY,o.width,o.height],o.width-=1,o.height-=1}var a=this.paintList;a.push(r),a.length>1&&a.shift();var s=this.screenDisplayList.renderBuffer,h=s.context;h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,s.surface.width,s.surface.height),h.drawImage(this.stageDisplayList.renderBuffer.surface,0,0),i=a.length;for(var n=0;i>n;n++){r=a[n];for(var l=r.length-1;l>=0;l--){var c=r[l];this.drawDirtyRect(c[0],c[1],c[2],c[3],h)}}h.save(),h.beginPath(),i=t.length;for(var n=0;i>n;n++){var o=t[n],u=e.DisplayList.$canvasScaleX,p=e.DisplayList.$canvasScaleY;h.clearRect(o.minX*u,o.minY*p,o.width*u,o.height*p),h.rect(o.minX*u,o.minY*p,o.width*u,o.height*p)}h.clip(),h.drawImage(this.stageDisplayList.renderBuffer.surface,0,0),h.restore()}function o(t,i,r,n,o){o.strokeStyle="rgb(255,0,0)",o.lineWidth=5;var a=e.DisplayList.$canvasScaleX,s=e.DisplayList.$canvasScaleY;o.strokeRect(t*a-.5,i*s-.5,r*a,n*s)}function a(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}var s=function(a){function s(t,e,s){var h=a.call(this)||this;return h.isPlaying=!1,h.entryClassName=s,h.stage=e,h.screenDisplayList=h.createDisplayList(e,t),h.showFPS=!1,h.showLog=!1,h._showPaintRect=!1,h.stageDisplayList=null,h.paintList=[],h.displayFPS=i,h.showPaintRect=r,h.drawPaintRect=n,h.drawDirtyRect=o,h}return __extends(s,a),s.prototype.createDisplayList=function(t,i){var r=new e.DisplayList(t);return r.renderBuffer=i,t.$displayList=r,r},s.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},s.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var i=new e;this.root=i,i instanceof t.DisplayObject&&this.stage.addChild(i)}},s.prototype.stop=function(){this.pause(),this.stage=null},s.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},s.prototype.$render=function(e,i){(this.showFPS||this.showLog)&&this.stage.addChild(this.fps);var r=this.stage,n=t.getTimer(),o=r.$displayList.updateDirtyRegions(),a=t.getTimer();o=o.concat();var s=r.$displayList.drawToSurface();this._showPaintRect&&this.drawPaintRect(o);var h=t.getTimer();if(e&&this.showFPS){var l=0;if(s>0){for(var c=o.length,u=0,p=0;c>p;p++)u+=o[p].area;l=Math.ceil(1e3*u/(r.stageWidth*r.stageHeight))/10}this.fps.update(s,l,a-n,h-a,i)}},s.prototype.updateStageSize=function(e,i){var r=this.stage;r.$stageWidth=e,r.$stageHeight=i,this.screenDisplayList.setClipRect(e,i),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,i),r.dispatchEventWith(t.Event.RESIZE),r.$invalidate(!0)},s}(t.HashObject);e.Player=s,__reflect(s.prototype,"egret.sys.Player");var h,l,c=[];e.$logToFPS=function(t){return h?void h.updateInfo(t):void c.push(t)},FPS=function(e){function i(i,r,n,o,a){e.call(this),this.isFPS=!0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.dirtyRatio=0,this.costDirty=0,this.costRender=0,this.costTicker=0,this._stage=i,this.showFPS=r,this.showLog=n,this.logFilter=o,this.touchChildren=!1,this.touchEnabled=!1,this.styles=a,this.fpsDisplay=new t.FPSDisplay(i,r,n,o,a),this.addChild(this.fpsDisplay);var s;try{s=o?new RegExp(o):null}catch(h){t.log(h)}this.filter=function(t){return s?s.test(t):!o||0==t.indexOf(o)}}return __extends(i,e),i.prototype.update=function(e,i,r,n,o){var a=t.getTimer();if(this.totalTime+=a-this.lastTime,this.lastTime=a,this.totalTick++,this.drawCalls+=e,this.dirtyRatio+=i,this.costDirty+=r,this.costRender+=n,this.costTicker+=o,this.totalTime>=1e3){var s=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),h=Math.round(this.drawCalls/this.totalTick),l=Math.round(this.dirtyRatio/this.totalTick),c=Math.round(this.costDirty/this.totalTick),u=Math.round(this.costRender/this.totalTick),p=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:s,draw:h,dirty:l,costTicker:p,costDirty:c,costRender:u}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.dirtyRatio=0,this.costDirty=0,this.costRender=0,this.costTicker=0}},i.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},i}(t.Sprite),t.warn=function(){console.warn.apply(console,a(arguments))},t.error=function(){console.error.apply(console,a(arguments))},t.assert=function(){console.assert.apply(console,a(arguments))},t.log=function(){console.log.apply(console,a(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=[],i=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0,this.moved=!1}return t.release=function(t){e.push(t)},t.create=function(){var i=e.pop();return i||(i=new t),i},t.prototype.setTo=function(t,e,i,r){return this.minX=t,this.minY=e,this.maxX=i,this.maxY=r,this.updateArea(),this},t.prototype.intValues=function(){this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this.updateArea()},t.prototype.updateArea=function(){this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this.area=this.width*this.height},t.prototype.union=function(t){this.minX>t.minX&&(this.minX=t.minX),this.minY>t.minY&&(this.minY=t.minY),this.maxX<t.maxX&&(this.maxX=t.maxX),this.maxY<t.maxY&&(this.maxY=t.maxY),this.updateArea()},t.prototype.intersect=function(t){return this.minX<t.minX&&(this.minX=t.minX),this.maxX>t.maxX&&(this.maxX=t.maxX),this.minX>=this.maxX?void this.setEmpty():(this.minY<t.minY&&(this.minY=t.minY),this.maxY>t.maxY&&(this.maxY=t.maxY),this.minY>=this.maxY?void this.setEmpty():void this.updateArea())},t.prototype.setEmpty=function(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0},t.prototype.isEmpty=function(){return this.width<=0||this.height<=0},t.prototype.intersects=function(t){if(this.isEmpty())return!1;var e=this.minX>t.minX?this.minX:t.minX,i=this.maxX<t.maxX?this.maxX:t.maxX;return e>i?!1:(e=this.minY>t.minY?this.minY:t.minY,i=this.maxY<t.maxY?this.maxY:t.maxY,i>=e)},t.prototype.updateRegion=function(t,e){if(0==t.width||0==t.height)return void this.setEmpty();var i,r,n,o,a=e,s=a.a,h=a.b,l=a.c,c=a.d,u=a.tx,p=a.ty,d=t.x,f=t.y,g=d+t.width,y=f+t.height;if(1==s&&0==h&&0==l&&1==c)i=d+u-1,r=f+p-1,n=g+u+1,o=y+p+1;else{var v=s*d+l*f+u,$=h*d+c*f+p,m=s*g+l*f+u,b=h*g+c*f+p,x=s*g+l*y+u,T=h*g+c*y+p,_=s*d+l*y+u,w=h*d+c*y+p,O=0;v>m&&(O=v,v=m,m=O),x>_&&(O=x,x=_,_=O),i=(x>v?v:x)-1,n=(m>_?m:_)+1,$>b&&(O=$,$=b,b=O),T>w&&(O=T,T=w,w=O),r=(T>$?$:T)-1,o=(b>w?b:w)+1}this.minX=i,this.minY=r,this.maxX=n,this.maxY=o,this.width=n-i,this.height=o-r,this.area=this.width*this.height},t}();t.Region=i,__reflect(i.prototype,"egret.sys.Region")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.calculateStageSize=function(e,i,r,n,o){var a=i,s=r,h=n,l=o,c=i/h||0,u=r/l||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:h=Math.round(i/u);break;case t.StageScaleMode.FIXED_WIDTH:l=Math.round(r/c);break;case t.StageScaleMode.NO_BORDER:c>u?s=Math.round(l*c):a=Math.round(h*u);break;case t.StageScaleMode.SHOW_ALL:c>u?a=Math.round(h*u):s=Math.round(l*c);break;case t.StageScaleMode.FIXED_NARROW:c>u?h=Math.round(i/u):l=Math.round(r/c);break;case t.StageScaleMode.FIXED_WIDE:c>u?l=Math.round(r/c):h=Math.round(i/u);break;default:h=i,l=r}return h%2!=0&&(h+=1),l%2!=0&&(l+=1),a%2!=0&&(a+=1),s%2!=0&&(s+=1),{stageWidth:h,stageHeight:l,displayWidth:a,displayHeight:s}},i}(t.HashObject);e.DefaultScreenAdapter=i,__reflect(i.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var i=function(){function i(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return i.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},i.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},i.prototype.$startTick=function(t,e){var i=this.getTickIndex(t,e);-1==i&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},i.prototype.$stopTick=function(t,e){var i=this.getTickIndex(t,e);-1!=i&&(this.concatTick(),this.callBackList.splice(i,1),this.thisObjectList.splice(i,1))},i.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;n>=0;n--)if(i[n]==t&&r[n]==e)return n;return-1},i.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},i.prototype.$setFrameRate=function(e){return e=+e||0,0>=e?!1:this.$frameRate==e?!1:(this.$frameRate=e,e>60&&(e=60),t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&(egret_native.setFrameRate(e),e=60),this.frameDeltaTime=1e3/e,this.lastCount=this.frameInterval=Math.round(6e4/e),!0)},i.prototype.pause=function(){this.isPaused=!0},i.prototype.resume=function(){this.isPaused=!1},i.prototype.update=function(){for(var i=t.getTimer(),r=this.callBackList,n=this.thisObjectList,o=r.length,a=e.$requestRenderingFlag,s=t.getTimer(),h=t.lifecycle.contexts,l=0,c=h;l<c.length;l++){var u=c[l];u.onUpdate&&u.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=s);this.callLaterAsyncs();for(var p=0;o>p;p++)r[p].call(n[p],s)&&(a=!0);var d=t.getTimer(),f=s-this.lastTimeStamp;if(this.lastTimeStamp=s,f>=this.frameDeltaTime)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(a&&this.render(!1,this.costEnterFrame+d-i));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+d-i);var g=t.getTimer();this.broadcastEnterFrame();var y=t.getTimer();this.costEnterFrame=y-g},i.prototype.render=function(t,i){var r=this.playerList,n=r.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var o=0;n>o;o++)r[o].$render(t,i);e.$requestRenderingFlag=!1}},i.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.ENTER_FRAME)}},i.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.RENDER)}},i.prototype.callLaters=function(){var e,i,r;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],i=t.$callLaterThisList,t.$callLaterThisList=[],r=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,o=0;n>o;o++){var a=e[o];null!=a&&a.apply(i[o],r[o])}},i.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,i=t.$callAsyncThisList,r=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var o=e[n];null!=o&&o.apply(i[n],r[n])}}},i}();e.SystemTicker=i,__reflect(i.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function i(t){var i=new n;e.contexts.push(i),t(i)}e.contexts=[];var r=!0,n=function(){function i(){}return i.prototype.pause=function(){r&&(r=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},i.prototype.resume=function(){r||(r=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},i}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=i}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.maxTouches=0,i.useTouchesCount=0,i.touchDownTarget={},i.lastTouchX=-1,i.lastTouchY=-1,i.stage=t,i}return __extends(i,e),i.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},i.prototype.onTouchBegin=function(e,i,r){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);null==this.touchDownTarget[r]&&(this.touchDownTarget[r]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,i,r,!0)}},i.prototype.onTouchMove=function(e,i,r){if(null!=this.touchDownTarget[r]&&(this.lastTouchX!=e||this.lastTouchY!=i)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,i,r,!0)}},i.prototype.onTouchEnd=function(e,i,r){if(null!=this.touchDownTarget[r]){var n=this.findTarget(e,i),o=this.touchDownTarget[r];delete this.touchDownTarget[r],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,i,r,!1),o==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,i,r,!1):t.TouchEvent.dispatchTouchEvent(o,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,i,r,!1)}},i.prototype.findTarget=function(t,e){var i=this.stage.$hitTest(t,e);return i||(i=this.stage),i},i}(t.HashObject);e.TouchHandler=i,__reflect(i.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(i,e),i.prototype.drawImage=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},i.$updateTextureData=function(e,r,n,o,a,s,h,l,c,u,p,d,f,g,y,v,$){if(r){var m=t.$TextureScaleFactor;if(e.smoothing=$,e.image=r,e.imageWidth=f,e.imageHeight=g,y)i.$updateTextureDataWithScale9Grid(e,y,n,o,a,s,h,l,c,u,p,d);else if(v==t.BitmapFillMode.SCALE){var b=p/c*m,x=d/u*m;e.drawImage(n,o,a,s,b*h,x*l,b*a,x*s)}else if(v==t.BitmapFillMode.CLIP){var T=Math.min(c,p),_=Math.min(u,d),w=a*m,O=s*m;i.drawClipImage(e,m,n,o,w,O,h,l,T,_)}else for(var w=a*m,O=s*m,E=0;p>E;E+=c)for(var C=0;d>C;C+=u){var T=Math.min(p-E,c),_=Math.min(d-C,u);i.drawClipImage(e,m,n,o,w,O,h,l,T,_,E,C)}}},i.$updateTextureDataWithScale9Grid=function(e,i,r,n,o,a,s,h,l,c,u,p){var d=o,f=a;u-=l-o*t.$TextureScaleFactor,p-=c-a*t.$TextureScaleFactor;var g=i.x-s,y=i.y-h,v=g/t.$TextureScaleFactor,$=y/t.$TextureScaleFactor,m=i.width/t.$TextureScaleFactor,b=i.height/t.$TextureScaleFactor;0==b&&(b=1,$>=f&&$--),0==m&&(m=1,v>=d&&v--);var x=r,T=x+v,_=T+m,w=d-v-m,O=n,E=O+$,C=E+b,F=f-$-b,R=w*t.$TextureScaleFactor,P=F*t.$TextureScaleFactor;if((v+w)*t.$TextureScaleFactor>u||($+F)*t.$TextureScaleFactor>p)return void e.drawImage(r,n,o,a,s,h,u,p);var S=s,D=S+g,M=S+(u-R),A=u-g-R,L=h,B=L+y,N=L+p-P,j=p-y-P;$>0&&(v>0&&e.drawImage(x,O,v,$,S,L,g,y),m>0&&e.drawImage(T,O,m,$,D,L,A,y),w>0&&e.drawImage(_,O,w,$,M,L,R,y)),b>0&&(v>0&&e.drawImage(x,E,v,b,S,B,g,j),m>0&&e.drawImage(T,E,m,b,D,B,A,j),w>0&&e.drawImage(_,E,w,b,M,B,R,j)),F>0&&(v>0&&e.drawImage(x,C,v,F,S,N,g,P),m>0&&e.drawImage(T,C,m,F,D,N,A,P),w>0&&e.drawImage(_,C,w,F,M,N,R,P))},i.drawClipImage=function(t,e,i,r,n,o,a,s,h,l,c,u){void 0===c&&(c=0),void 0===u&&(u=0);var p=a+n-h;p>0&&(n-=p),p=s+o-l,p>0&&(o-=p),t.drawImage(i,r,n/e,o/e,c+a,u+s,n,o)},i}(e.RenderNode);e.BitmapNode=i,__reflect(i.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["none","round","square"],r=["bevel","miter","round"],n=function(n){function o(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(o,n),o.prototype.beginFill=function(t,i,r){void 0===i&&(i=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=i,r){var o=this.drawData.lastIndexOf(r);this.drawData.splice(o,0,n)}else this.drawData.push(n);return n},o.prototype.beginGradientFill=function(i,r,n,o,a,s){var h=new t.Matrix;a?(h.a=819.2*a.a,h.b=819.2*a.b,h.c=819.2*a.c,h.d=819.2*a.d,h.tx=a.tx,h.ty=a.ty):(h.a=100,h.d=100);var l=new e.GradientFillPath;if(l.gradientType=i,l.colors=r,l.alphas=n,l.ratios=o,l.matrix=h,s){var c=this.drawData.lastIndexOf(s);this.drawData.splice(c,0,l)}else this.drawData.push(l);return l},o.prototype.lineStyle=function(n,o,a,s,h,l){void 0===a&&(a=1),void 0===l&&(l=3),-1==i.indexOf(s)&&(s="round"),-1==r.indexOf(h)&&(h="round");var c=new e.StrokePath;return c.lineWidth=n,c.lineColor=o,c.lineAlpha=a,c.caps=s||t.CapsStyle.ROUND,c.joints=h,c.miterLimit=l,this.drawData.push(c),c},o.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0},o.prototype.cleanBeforeRender=function(){},o.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},o}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;i>=0;i--)t+=e[i].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.image=null,i.smoothing=!0,i.bounds=new t.Rectangle,i.blendMode=null,i.alpha=0/0,i.filter=null,i.rotated=!1,i.type=7,i.vertices=[],i.uvs=[],i.indices=[],i}return __extends(i,e),i.prototype.drawMesh=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},i}(e.RenderNode);e.MeshNode=i,__reflect(i.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;i.$renderBuffer=new t.sys.RenderBuffer;var r=new t.BitmapData(i.$renderBuffer.surface);return r.$deleteSource=!1,i._setBitmapData(r),i}return __extends(i,e),i.prototype.drawToTexture=function(e,i,r){if(void 0===r&&(r=1),i&&(0==i.width||0==i.height))return!1;var n=i||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;r/=t.$TextureScaleFactor;var o=(n.x+n.width)*r,a=(n.y+n.height)*r;i&&(o=n.width*r,a=n.height*r);var s=this.$renderBuffer;if(!s)return!1;s.resize(o,a),this._bitmapData.width=o,this._bitmapData.height=a;var h=t.Matrix.create();return h.identity(),i&&h.translate(-i.x,-i.y),h.scale(r,r),t.sys.systemRenderer.render(e,s,h,null,!0),t.Matrix.release(h),this.$initData(0,0,o,a,0,0,o,a,o,a),!0},i.prototype.getPixel32=function(e,i){var r;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),i=Math.round(i/n),r=this.$renderBuffer.getPixels(e,i,1,1)}return r},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},i}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=6,e}return __extends(e,t),e.prototype.setAlpha=function(t){0!=this.drawData.length&&(this.drawData.length=0),this.drawData.push(t),this.renderCount++},e}(t.RenderNode);t.SetAlphaNode=e,__reflect(e.prototype,"egret.sys.SetAlphaNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(i,e),i.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this)},i.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},i}(e.RenderNode);e.TextNode=i,__reflect(i.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var i=null==e.italic?t.italic:e.italic,r=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,o=e.fontFamily||t.fontFamily,a=i?"italic ":"normal ";return a+=r?"bold ":"normal ",a+=n+"px "+o}function i(t,e){var i=t>>16,r=t>>8&255,n=255&t;return"rgba("+i+","+r+","+n+","+e+")"}function r(e,r,n,o,a,s){var h;h=r==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var l=n.length,c=0;l>c;c++)h.addColorStop(a[c]/255,i(n[c],o[c]));return h}function n(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;n>r;r++)t[r+i]=e[r]}function o(t,e,i,r){for(var n=r[0],o=r[1],a=r[2],s=r[3],h=r[4],l=r[5],c=r[6],u=r[7],p=r[8],d=r[9],f=r[10],g=r[11],y=r[12],v=r[13],$=r[14],m=r[15],b=r[16],x=r[17],T=r[18],_=r[19],w=0,O=e*i*4;O>w;w+=4){var E=t[w+0],C=t[w+1],F=t[w+2],R=t[w+3];t[w+0]=n*E+o*C+a*F+s*R+h,t[w+1]=l*E+c*C+u*F+p*R+d,t[w+2]=f*E+g*C+y*F+v*R+$,t[w+3]=m*E+b*C+x*F+T*R+_}}function a(t,e,i,r,n){s(t,e,i,r),h(t,e,i,n)}function s(t,e,i,r){var o;o=_?new Uint8ClampedArray(4*e):new Array(4*e);for(var a=4*e,s=2*r+1,h=0;i>h;h++){for(var l=h*a,c=0,u=0,p=0,d=0,f=0,g=0,y=4*-r,v=4*r+4;v>y;y+=4){var $=l+y;l>$||$>=l+a||(f=t[$+3],c+=t[$+0]*f,u+=t[$+1]*f,p+=t[$+2]*f,d+=f)}for(var y=l,v=l+a,m=0,b=y-4*r,x=y+4*(r+1);v>y;y+=4,m+=4,x+=4,b+=4)0===d?(o[m+0]=0,o[m+1]=0,o[m+2]=0,o[m+3]=0):(o[m+0]=c/d,o[m+1]=u/d,o[m+2]=p/d,o[m+3]=d/s),f=t[x+3],g=t[b+3],f||0==f?g||0==g?(c+=t[x+0]*f-t[b+0]*g,u+=t[x+1]*f-t[b+1]*g,p+=t[x+2]*f-t[b+2]*g,d+=f-g):(c+=t[x+0]*f,u+=t[x+1]*f,p+=t[x+2]*f,d+=f):(g||0==g)&&(c+=-t[b+0]*g,u+=-t[b+1]*g,p+=-t[b+2]*g,d+=-g);_?t.set(o,l):n(t,o,l)}}function h(t,e,i,r){var n;n=_?new Uint8ClampedArray(4*i):new Array(4*i);for(var o=4*e,a=2*r+1,s=0;e>s;s++){for(var h=4*s,l=0,c=0,u=0,p=0,d=0,f=0,g=-r*o,y=r*o+o;y>g;g+=o){var v=h+g;h>v||v>=h+i*o||(d=t[v+3],l+=t[v+0]*d,c+=t[v+1]*d,u+=t[v+2]*d,p+=d)}for(var g=h,y=h+i*o,$=0,m=h-r*o,b=h+(r+1)*o;y>g;g+=o,$+=4,b+=o,m+=o)0===p?(n[$+0]=0,n[$+1]=0,n[$+2]=0,n[$+3]=0):(n[$+0]=l/p,n[$+1]=c/p,n[$+2]=u/p,n[$+3]=p/a),d=t[b+3],f=t[m+3],d||0==d?f||0==f?(l+=t[b+0]*d-t[m+0]*f,c+=t[b+1]*d-t[m+1]*f,u+=t[b+2]*d-t[m+2]*f,p+=d-f):(l+=t[b+0]*d,c+=t[b+1]*d,u+=t[b+2]*d,p+=d):(f||0==f)&&(l+=-t[m+0]*f,c+=-t[m+1]*f,u+=-t[m+2]*f,p+=-f);for(var x=4*s,y=x+i*o,T=0;y>x;x+=o,T+=4)t[x+0]=n[T+0],t[x+1]=n[T+1],t[x+2]=n[T+2],t[x+3]=n[T+3]}}function l(t,e,i,r,o,s,h,l,f){var g=c(t,r);u(g,e,i,h,l),a(g,e,i,o,s),p(g,f),d(g,t),t.set(g),_?t.set(g):n(t,g)}function c(t,e){e||(e=[0,0,0,0]);var i;_?i=new Uint8ClampedArray(t):(i=new Array(t.length),n(i,t));for(var r=e[0],o=e[1],a=e[2],s=e[3],h=0,l=i.length;l>h;h+=4){var c=i[h+3];i[h+0]=r*c,i[h+1]=o*c,i[h+2]=a*c,i[h+3]=s*c}return i}function u(t,e,i,r,o){var a,s,h=Math.sin(r)*o|0,l=Math.cos(r)*o|0;if(_){a=new Int32Array(t.buffer),s=new Int32Array(a.length);for(var c=0;i>c;c++){var u=c+h;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+l;0>d||d>e||(s[u*e+d]=a[c*e+p])}}a.set(s)}else{a=t,s=new Array(a.length);for(var c=0;i>c;c++){var u=c+h;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+l;0>d||d>e||(s[4*(u*e+d)+0]=a[4*(c*e+p)+0],s[4*(u*e+d)+1]=a[4*(c*e+p)+1],s[4*(u*e+d)+2]=a[4*(c*e+p)+2],s[4*(u*e+d)+3]=a[4*(c*e+p)+3])}}n(a,s)}}function p(t,e){for(var i=0,r=t.length;r>i;i+=4)t[i+3]*=e}function d(t,e){for(var i=0,r=t.length;r>i;i+=4){var n=t[i+0],o=t[i+1],a=t[i+2],s=t[i+3]/255,h=e[i+0],l=e[i+1],c=e[i+2],u=e[i+3]/255;t[i+0]=h+n*(1-u),t[i+1]=l+o*(1-u),t[i+2]=c+a*(1-u),t[i+3]=255*(u+s*(1-u))}}function f(t,e,i){return t*(1-i)+e*i}function g(t,e,i,r,o,a,s,h,l,c,u,p){var d;d=_?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,y,v=r[3],$=0,m=0,b=h*Math.cos(s),x=h*Math.sin(s),T=7,w=12,O=3.141592653589793,E=o/T,C=a/T,F=0;e>F;F++)for(var R=0;i>R;R++){for(var P=0,S=R*e*4+4*F,D=0,M=0,A=t[S+0]/255,L=t[S+1]/255,B=t[S+2]/255,N=t[S+3]/255,j=0;2*O>=j;j+=2*O/w){g=Math.cos(j+P),y=Math.sin(j+P);for(var k=0;T>k;k++){$=k*E*g,m=k*C*y;var I=Math.round(F+$-b),X=Math.round(R+m-x),Y=0;if(I>=e||0>I||0>X||X>=i)Y=0;else{var U=X*e*4+4*I;Y=t[U+3]/255}D+=(T-k)*Y,M+=T-k}}N=Math.max(N,1e-4);var H=D/M*l*v*(1-c)*Math.max(Math.min(p,u),1-N),W=(M-D)/M*l*v*c*N;N=Math.max(N*u*(1-p),1e-4);var G=W/(W+N),z=f(A,r[0],G),V=f(L,r[1],G),q=f(B,r[2],G),J=H/(W+N+H),K=f(z,r[0],J),Q=f(V,r[1],J),Z=f(q,r[2],J),te=Math.min(N+H+W,1);d[S+0]=255*K,d[S+1]=255*Q,d[S+2]=255*Z,d[S+3]=255*te}_?t.set(d):n(t,d)}var y=["source-over","lighter","destination-out"],v="source-over",$="#000000",m={none:"butt",square:"square",round:"round"},b=[],x=[],T=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(t,e,i,r,n){this.nestLevel++;var o=e.context,a=n?t:null,s=this.drawDisplayObject(t,o,r,i,null,null,a);if(this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var h=b.length,l=0;h>l;l++)b[l].resize(0,0);x.length>1&&(x.length=1,x[0].resize(0,0))}return s},n.prototype.drawDisplayObject=function(e,i,r,n,o,a,s){var h,l=0;if(o&&!s?((o.isDirty||o.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||o.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(l+=o.drawToSurface()),h=o.$renderNode):h=e.$getRenderNode(),h){if(r){var c=h.renderRegion;if(a&&!a.intersects(c))h.needRedraw=!1;else if(!h.needRedraw)for(var u=r.length,p=0;u>p;p++)if(c.intersects(r[p])){h.needRedraw=!0;break}}else h.needRedraw=!0;if(h.needRedraw){var d=void 0,f=void 0;s?(d=e.$getConcatenatedAlphaAt(s,e.$getConcatenatedAlpha()),f=t.Matrix.create().copyFrom(e.$getConcatenatedMatrix()),e.$getConcatenatedMatrixAt(s,f)):(d=h.renderAlpha,f=t.Matrix.create().copyFrom(h.renderMatrix));var g=f.a*n.a,y=0,v=0,$=f.d*n.d,m=f.tx*n.a+n.tx*n.a,b=f.ty*n.d+n.ty*n.d;(0!==f.b||0!==f.c||0!==n.b||0!==n.c)&&(g+=f.b*n.c,$+=f.c*n.b,y+=f.a*n.b+f.b*n.d,v+=f.c*n.a+f.d*n.c,m+=f.ty*n.c,b+=f.tx*n.b),f.a=g,f.b=y,f.c=v,f.d=$,f.tx=m,f.ty=b,i.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),t.Matrix.release(f),i.globalAlpha=d,l+=this.renderNode(h,i),h.needRedraw=!1}}if(o&&!s)return l;var x=e.$children;if(x)for(var T=x.length,_=0;T>_;_++){var w=x[_];if(!(!w.$visible||w.$alpha<=0||w.$maskedObject)){var O=w.$getFilters();O&&O.length>0?l+=this.drawWithFilter(w,i,r,n,a,s):0!==w.$blendMode||w.$mask&&(w.$mask.$parentDisplayList||s)?l+=this.drawWithClip(w,i,r,n,a,s):w.$scrollRect||w.$maskRect?l+=this.drawWithScrollRect(w,i,r,n,a,s):w.isFPS?this.drawDisplayObject(w,i,r,n,w.$displayList,a,s):l+=this.drawDisplayObject(w,i,r,n,w.$displayList,a,s)}}return l},n.prototype.drawWithFilter=function(e,i,r,n,s,h){if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE){var c,u=0,p=e.$getFilters(),d=0!==e.$blendMode;d&&(c=y[e.$blendMode],c||(c=v));var f=e.$getOriginalBounds();if(f.width<=0||f.height<=0)return u;if(1==p.length&&"colorTransform"==p[0].type&&!e.$children)return d&&(i.globalCompositeOperation=c),i.setGlobalShader(p[0]),u+=e.$mask&&(e.$mask.$parentDisplayList||h)?this.drawWithClip(e,i,r,n,s,h):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,i,r,n,s,h):this.drawDisplayObject(e,i,r,n,e.$displayList,s,h),i.setGlobalShader(null),d&&(i.globalCompositeOperation=v),u;var $=t.Matrix.create();$.copyFrom(e.$getConcatenatedMatrix()),h&&e.$getConcatenatedMatrixAt(h,$);var m;m=t.sys.Region.create(),m.updateRegion(f,$);var T=this.createRenderBuffer(m.width,m.height);T.context.setTransform(n.a,0,0,n.d,-m.minX,-m.minY);var _=t.Matrix.create().setTo(n.a,0,0,n.d,-m.minX,-m.minY);return u+=e.$mask&&(e.$mask.$parentDisplayList||h)?this.drawWithClip(e,T.context,r,_,m,h):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,T.context,r,_,m,h):this.drawDisplayObject(e,T.context,r,_,e.$displayList,m,h),t.Matrix.release(_),u>0&&(d&&(i.globalCompositeOperation=c),u++,i.globalAlpha=1,i.setTransform(1,0,0,1,m.minX+n.tx,m.minY+n.ty),i.setGlobalShader(p[0]),i.drawImage(T.surface,0,0,T.width,T.height,0,0,T.width,T.height),i.setGlobalShader(null),d&&(i.globalCompositeOperation=v)),b.push(T),t.sys.Region.release(m),t.Matrix.release($),u
}var w,O=0,E=e.$getFilters(),C=E.length,F=0!==e.$blendMode;F&&(w=y[e.$blendMode],w||(w=v));var R=e.$getOriginalBounds();if(R.width<=0||R.height<=0)return O;var P=t.Matrix.create();P.copyFrom(e.$getConcatenatedMatrix()),h&&e.$getConcatenatedMatrixAt(h,P);var S;S=t.sys.Region.create(),S.updateRegion(R,P);var D=this.createRenderBuffer(S.width*n.a,S.height*n.d,!0),M=D.context;M.setTransform(n.a,0,0,n.d,-S.minX,-S.minY);var A=t.Matrix.create().setTo(n.a,0,0,n.d,-S.minX,-S.minY);if(O+=e.$mask&&(e.$mask.$parentDisplayList||h)?this.drawWithClip(e,M,r,A,S,h):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,M,r,A,S,h):this.drawDisplayObject(e,M,r,A,e.$displayList,S,h),t.Matrix.release(A),O>0){F&&(i.globalCompositeOperation=w),O++;for(var L=M.getImageData(0,0,D.surface.width,D.surface.height),B=0;C>B;B++){var N=E[B];if("colorTransform"==N.type)o(L.data,D.surface.width,D.surface.height,N.$matrix);else if("blur"==N.type)a(L.data,D.surface.width,D.surface.height,N.$blurX,N.$blurY);else if("glow"==N.type){var j=N.$red,k=N.$green,I=N.$blue,X=N.$alpha;N.$inner||N.$knockout||N.$hideObject?g(L.data,D.surface.width,D.surface.height,[j/255,k/255,I/255,X],N.$blurX,N.$blurY,N.$angle?N.$angle/180*Math.PI:0,N.$distance||0,N.$strength,N.$inner?1:0,N.$knockout?0:1,N.$hideObject?1:0):l(L.data,D.surface.width,D.surface.height,[j/255,k/255,I/255,X],N.$blurX,N.$blurY,N.$angle?N.$angle/180*Math.PI:0,N.$distance||0,N.$strength)}else"custom"==N.type}M.putImageData(L,0,0),i.globalAlpha=1,i.setTransform(1,0,0,1,(S.minX+n.tx)*n.a,(S.minY+n.ty)*n.d),i.drawImage(D.surface,0,0),F&&(i.globalCompositeOperation=v)}return x.push(D),t.sys.Region.release(S),t.Matrix.release(P),O},n.prototype.drawWithClip=function(e,i,r,n,o,a){var s,h=0,l=0!==e.$blendMode;l&&(s=y[e.$blendMode],s||(s=v));var c,u=e.$scrollRect?e.$scrollRect:e.$maskRect,p=e.$mask;if(p&&(c=p.$getRenderNode())){var d=c.renderMatrix;if(0==d.a&&0==d.b||0==d.c&&0==d.d)return h}var f,g=t.Matrix.create();if(g.copyFrom(e.$getConcatenatedMatrix()),a)e.$getConcatenatedMatrixAt(a,g);else if(e.$parentDisplayList){var $=e.$parentDisplayList.root;$!==e.$stage&&e.$getConcatenatedMatrixAt($,g)}var m;if(p){m=p.$getOriginalBounds(),f=t.sys.Region.create();var x=t.Matrix.create();x.copyFrom(p.$getConcatenatedMatrix()),a&&p.$getConcatenatedMatrixAt(a,x),f.updateRegion(m,x),t.Matrix.release(x)}var T;if(u&&(T=t.sys.Region.create(),T.updateRegion(u,g)),T&&f?(T.intersect(f),t.sys.Region.release(f)):!T&&f&&(T=f),T){if(T.isEmpty()||o&&!o.intersects(T))return t.sys.Region.release(T),t.Matrix.release(g),h}else T=t.sys.Region.create(),m=e.$getOriginalBounds(),T.updateRegion(m,g);if(T.width<=0||T.height<=0)return h;var _=!1;if(r){for(var w=r.length,O=0;w>O;O++)if(T.intersects(r[O])){_=!0;break}}else _=!0;if(!_)return t.sys.Region.release(T),t.Matrix.release(g),h;if(!(p||e.$children&&0!=e.$children.length)){if(u){var x=g;i.save(),n.$preMultiplyInto(x,x),i.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),i.beginPath(),i.rect(u.x,u.y,u.width,u.height),i.clip()}return l&&(i.globalCompositeOperation=s),h+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),l&&(i.globalCompositeOperation=v),u&&i.restore(),t.sys.Region.release(T),t.Matrix.release(g),h}if(p&&t.Capabilities.$runtimeType==t.RuntimeType.WEB&&(!p.$children||0==p.$children.length)&&c&&3==c.type&&1==c.drawData.length&&1==c.drawData[0].type&&1==c.drawData[0].fillAlpha){this.renderingMask=!0,i.save();var E=this.drawDisplayObject(p,i,r,n,p.$displayList,o,a);if(this.renderingMask=!1,u){var x=g;n.$preMultiplyInto(x,x),i.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),i.beginPath(),i.rect(u.x,u.y,u.width,u.height),i.clip()}return E+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),i.restore(),t.sys.Region.release(T),t.Matrix.release(g),E}var C=this.createRenderBuffer(T.width*n.a,T.height*n.d),F=C.context;if(!F)return h+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),t.sys.Region.release(T),t.Matrix.release(g),h;F.setTransform(n.a,0,0,n.d,-T.minX,-T.minY);var R=t.Matrix.create().setTo(n.a,0,0,n.d,-T.minX,-T.minY);if(h+=this.drawDisplayObject(e,F,r,R,e.$displayList,T,a),p)if(t.Capabilities.$runtimeType==t.RuntimeType.WEB&&c&&1==c.$getRenderCount()||p.$displayList)F.globalCompositeOperation="destination-in",h+=this.drawDisplayObject(p,F,r,R,p.$displayList,T,a);else{var P=this.createRenderBuffer(T.width*n.a,T.height*n.d),S=P.context;if(!S)return h+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),b.push(C),t.sys.Region.release(T),t.Matrix.release(g),h;S.setTransform(n.a,0,0,n.d,-T.minX,-T.minY),R=t.Matrix.create().setTo(n.a,0,0,n.d,-T.minX,-T.minY),h+=this.drawDisplayObject(p,S,r,R,p.$displayList,T,a),F.globalCompositeOperation="destination-in",F.setTransform(1,0,0,1,0,0),F.globalAlpha=1,F.drawImage(P.surface,0,0),b.push(P)}if(t.Matrix.release(R),h>0){if(h++,l&&(i.globalCompositeOperation=s),u){var x=g;i.save(),n.$preMultiplyInto(x,x),i.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),i.beginPath(),i.rect(u.x,u.y,u.width,u.height),i.clip()}i.globalAlpha=1,i.setTransform(1,0,0,1,(T.minX+n.tx)*n.a,(T.minY+n.ty)*n.d),i.drawImage(C.surface,0,0),u&&i.restore(),l&&(i.globalCompositeOperation=v)}return b.push(C),t.sys.Region.release(T),t.Matrix.release(g),h},n.prototype.drawWithScrollRect=function(e,i,r,n,o,a){var s=0,h=e.$scrollRect?e.$scrollRect:e.$maskRect;if(h.isEmpty())return s;var l=t.Matrix.create();if(l.copyFrom(e.$getConcatenatedMatrix()),a)e.$getConcatenatedMatrixAt(a,l);else if(e.$parentDisplayList){var c=e.$parentDisplayList.root;c!==e.$stage&&e.$getConcatenatedMatrixAt(c,l)}var u=t.sys.Region.create();if(u.updateRegion(h,l),u.isEmpty()||o&&!o.intersects(u))return t.sys.Region.release(u),t.Matrix.release(l),s;var p=!1;if(r){for(var d=r.length,f=0;d>f;f++)if(u.intersects(r[f])){p=!0;break}}else p=!0;return p?(i.save(),n.$preMultiplyInto(l,l),i.setTransform(l.a,l.b,l.c,l.d,l.tx,l.ty),i.beginPath(),i.rect(h.x,h.y,h.width,h.height),i.clip(),s+=this.drawDisplayObject(e,i,r,n,e.$displayList,u,a),i.restore(),t.sys.Region.release(u),t.Matrix.release(l),s):(t.sys.Region.release(u),t.Matrix.release(l),s)},n.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e.context;n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,n,r)},n.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 6:e.globalAlpha=t.drawData[0];break;case 7:r=this.renderMesh(t,e)}return r},n.prototype.renderMesh=function(e,i){if(t.Capabilities.runtimeType!=t.RuntimeType.NATIVE)return 0;var r=e.image,n=e.drawData,o=n.length,a=0,s=e.matrix,h=e.blendMode,l=e.alpha;s&&(i.saveTransform(),i.transform(s.a,s.b,s.c,s.d,s.tx,s.ty)),h&&(i.globalCompositeOperation=y[h]);var c;l==l&&(c=i.globalAlpha,i.globalAlpha*=l);var u=0,p=e.filter;if(p){for(egret_native.Graphics.setGlobalShader(p);o>a;)u++,i.drawMesh(r.source,n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds);egret_native.Graphics.setGlobalShader(null)}else for(;o>a;)u++,i.drawMesh(r.source,n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds);return s&&i.restoreTransform(),h&&(i.globalCompositeOperation=v),l==l&&(i.globalAlpha=c),1},n.prototype.renderBitmap=function(e,i){var r=e.image;if(!r||!r.source)return 0;i.$imageSmoothingEnabled!=e.smoothing&&(i.imageSmoothingEnabled=e.smoothing,i.$imageSmoothingEnabled=e.smoothing);var n=e.drawData,a=n.length,s=0,h=e.matrix,l=e.blendMode,c=e.alpha,u=!1;h&&(i.saveTransform?i.saveTransform():i.save(),u=!0,i.transform(h.a,h.b,h.c,h.d,h.tx,h.ty)),l&&(i.globalCompositeOperation=y[l]);var p;c==c&&(p=i.globalAlpha,i.globalAlpha*=c);var d=0,f=e.filter;if(f&&8==a)if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE){if(egret_native.Graphics.setGlobalShader(f),d++,e.rotated){var g=n[0],$=n[1],m=n[2],x=n[3],T=n[4],_=n[5],w=n[6],O=n[7];i.saveTransform?i.saveTransform():i.save(),i.transform(0,-1,1,0,0,O),i.drawImage(r.source,g,$,x,m,T,_,O,w),i.restoreTransform?i.restoreTransform():i.restore()}else i.drawImage(r.source,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);egret_native.Graphics.setGlobalShader(null)}else{var g=n[0],$=n[1],x=n[2],m=n[3],T=n[4],_=n[5],O=n[6],w=n[7];e.rotated&&(x=n[3],m=n[2],O=n[7],w=n[6]);var E=this.createRenderBuffer(O,w),C=E.context;d++,e.rotated&&i.transform(0,-1,1,0,0,O),C.drawImage(r.source,g,$,x,m,0,0,O,w),d++;var F=C.getImageData(0,0,O,w);o(F.data,O,w,f.$matrix),C.putImageData(F,0,0),i.drawImage(E.surface,0,0,O,w,T,_,O,w),b.push(E)}else for(;a>s;)if(d++,e.rotated){var g=n[s++],$=n[s++],m=n[s++],x=n[s++],T=n[s++],_=n[s++],w=n[s++],O=n[s++];i.saveTransform?i.saveTransform():i.save(),i.transform(0,-1,1,0,0,O),i.drawImage(r.source,g,$,x,m,T,_,O,w),i.restoreTransform?i.restoreTransform():i.restore()}else i.drawImage(r.source,n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++]);return u?i.restoreTransform?(i.restoreTransform(),l&&(i.globalCompositeOperation=v),c==c&&(i.globalAlpha=p)):i.restore():(l&&(i.globalCompositeOperation=v),c==c&&(i.globalAlpha=p)),d},n.prototype.renderText=function(i,r){r.textAlign="left",r.textBaseline="middle",r.lineJoin="round";for(var n=i.drawData,o=n.length,a=0;o>a;){var s=n[a++],h=n[a++],l=n[a++],c=n[a++];r.font=e(i,c);var u=null==c.textColor?i.textColor:c.textColor,p=null==c.strokeColor?i.strokeColor:c.strokeColor,d=null==c.stroke?i.stroke:c.stroke;r.fillStyle=t.toColorString(u),r.strokeStyle=t.toColorString(p),d&&(r.lineWidth=2*d,r.strokeText(l,s,h)),r.fillText(l,s,h)}},n.prototype.renderGraphics=function(t,e,n){var o=t.drawData,a=o.length;n=!!n;for(var s=0;a>s;s++){var h=o[s];switch(h.type){case 1:var l=h;e.fillStyle=n?$:i(l.fillColor,l.fillAlpha),this.renderPath(h,e),this.renderingMask?e.clip():e.fill();break;case 2:var c=h;e.fillStyle=n?$:r(e,c.gradientType,c.colors,c.alphas,c.ratios,c.matrix),e.save();var u=c.matrix;this.renderPath(h,e),e.transform(u.a,u.b,u.c,u.d,u.tx,u.ty),e.fill(),e.restore();break;case 3:var p=h,d=p.lineWidth;e.lineWidth=d,e.strokeStyle=n?$:i(p.lineColor,p.lineAlpha),e.lineCap=m[p.caps],e.lineJoin=p.joints,e.miterLimit=p.miterLimit;var f=1===d||3===d;f&&e.translate(.5,.5),this.renderPath(h,e),e.stroke(),f&&e.translate(-.5,-.5)}}return 0==a?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,o=0,a=0;n>a;a++){var s=r[a];switch(s){case 4:e.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case 3:e.quadraticCurveTo(i[o++],i[o++],i[o++],i[o++]);break;case 2:e.lineTo(i[o++],i[o++]);break;case 1:e.moveTo(i[o++],i[o++])}}},n.prototype.renderGroup=function(t,e){var i=t.matrix,r=!1;i&&(e.saveTransform?e.saveTransform():e.save(),r=!0,e.transform(i.a,i.b,i.c,i.d,i.tx,i.ty));for(var n=0,o=t.drawData,a=o.length,s=0;a>s;s++){var h=o[s];n+=this.renderNode(h,e)}return r&&(e.restoreTransform?e.restoreTransform():e.restore()),n},n.prototype.createRenderBuffer=function(e,i,r){var n=r?x.pop():b.pop();return n?n.resize(e,i,!0):n=new t.sys.CanvasRenderBuffer(e,i),n},n}();t.CanvasRenderer=T,__reflect(T.prototype,"egret.CanvasRenderer",["egret.sys.SystemRenderer"]);var _=!1;try{_=void 0!==typeof Uint8ClampedArray}catch(w){}}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.WEB="web",t.NATIVE="native",t}();t.RuntimeType=e,__reflect(e.prototype,"egret.RuntimeType");var i=function(){function t(){}return Object.defineProperty(t,"language",{get:function(){return t.$language},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMobile",{get:function(){return t.$isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"os",{get:function(){return t.$os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"runtimeType",{get:function(){return t.$runtimeType},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportVersion",{get:function(){return t.$supportVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"engineVersion",{get:function(){return"5.0.13"},enumerable:!0,configurable:!0}),t.$setNativeCapabilities=function(e){var i=e.split("-");if(i.length<=4){var r=i[0];switch(r){case"android":r="Android";break;case"ios":r="iOS"}t.$os=r;var n=i[2].substring(1,i[2].length);t.$supportVersion=n}},Object.defineProperty(t,"renderMode",{get:function(){return t.$renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientWidth",{get:function(){return t.$boundingClientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientHeight",{get:function(){return t.$boundingClientHeight},enumerable:!0,configurable:!0}),t.$language="zh-CN",t.$os="Unknown",t.$runtimeType="Unknown",t.$supportVersion="Unknown",t.$renderMode="Unknown",t.$boundingClientWidth=0,t.$boundingClientHeight=0,t}();t.Capabilities=i,__reflect(i.prototype,"egret.Capabilities")}(egret||(egret={}));var testDeviceType=function(){if(!this.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},testRuntimeType=function(){return this.navigator?!0:!1};egret.Capabilities.$isMobile=testDeviceType(),egret.Capabilities.$runtimeType=testRuntimeType()?egret.RuntimeType.WEB:egret.RuntimeType.NATIVE;var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){function e(t,e){r[t]=e}function i(t){return r[t]}var r={};t.registerImplementation=e,t.getImplementation=i}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i){var r=t.call(this,e)||this;return r.firstCharHeight=0,"string"==typeof i?r.charList=r.parseConfig(i):i&&i.hasOwnProperty("frames")?r.charList=i.frames:r.charList={},r}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(void 0===i){var r=e.h;void 0===r&&(r=0);var n=e.offY;void 0===n&&(n=0),i=r+n}if(0>=i)continue;this.firstCharHeight=i;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;4+i>n;n++){var o=e[n],a=String.fromCharCode(this.getConfigByKey(o,"id")),s={};r[a]=s,s.x=this.getConfigByKey(o,"x"),s.y=this.getConfigByKey(o,"y"),s.w=this.getConfigByKey(o,"width"),s.h=this.getConfigByKey(o,"height"),s.offX=this.getConfigByKey(o,"xoffset"),s.offY=this.getConfigByKey(o,"yoffset"),s.xadvance=this.getConfigByKey(o,"xadvance")}return r},e.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;n>r;r++){var o=i[r];if(e==o.substring(0,e.length)){var a=o.substring(e.length+1);return parseInt(a)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$textOffsetX=0,i.$textOffsetY=0,i.$textStartX=0,i.$textStartY=0,i.textLines=[],i.$lineHeights=[],i.$renderNode=new t.sys.BitmapNode,i.$BitmapText={0:0/0,1:0/0,2:"",3:0,4:0,5:null,6:!1,7:!1,8:!1,9:!1,10:"left",11:"top",12:t.Bitmap.defaultSmoothing},i}return __extends(i,e),Object.defineProperty(i.prototype,"smoothing",{get:function(){var t=this.$BitmapText;return t[12]},set:function(t){t=!!t;var e=this.$BitmapText;t!=e[12]&&(e[12]=t,this.$invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.$BitmapText[2]},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),i.prototype.$setText=function(t){null==t&&(t=""),t=String(t);var e=this.$BitmapText;return t==e[2]?!1:(e[2]=t,this.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this.$BitmapText[0];return isNaN(t)?this.$getContentBounds().width:t},i.prototype.$setWidth=function(t){var e=this.$BitmapText;return 0>t||t==e[0]?!1:(e[0]=t,this.$invalidateContentBounds(),!0)},i.prototype.$invalidateContentBounds=function(){e.prototype.$invalidateContentBounds.call(this),this.$BitmapText[7]=!0},i.prototype.$getHeight=function(){var t=this.$BitmapText[1];return isNaN(t)?this.$getContentBounds().height:t},i.prototype.$setHeight=function(t){var e=this.$BitmapText;return 0>t||t==e[1]?!1:(e[1]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"font",{get:function(){return this.$BitmapText[5]},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),i.prototype.$setFont=function(t){var e=this.$BitmapText;return e[5]==t?!1:(e[5]=t,this.$BitmapText[6]=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this.$BitmapText[3]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLineSpacing=function(t){t=+t||0;var e=this.$BitmapText;return e[3]==t?!1:(e[3]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this.$BitmapText[4]},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLetterSpacing=function(t){t=+t||0;var e=this.$BitmapText;return e[4]==t?!1:(e[4]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"textAlign",{get:function(){return this.$BitmapText[10]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setTextAlign=function(t){var e=this.$BitmapText;return e[10]==t?!1:(e[10]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this.$BitmapText[11]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setVerticalAlign=function(t){var e=this.$BitmapText;return e[11]==t?!1:(e[11]=t,this.$invalidateContentBounds(),!0)},i.prototype.$render=function(){var e=this.$BitmapText,r=this.$getTextLines(),n=r.length;if(0!=n){var o=this.$textLinesWidth,a=e[5],s=this.$renderNode;a.$texture&&(s.image=a.$texture._bitmapData),s.smoothing=e[12];for(var h=a._getFirstCharHeight(),l=Math.ceil(h*i.EMPTY_FACTOR),c=!isNaN(e[1]),u=e[8],p=e[0],d=e[1],f=e[10],g=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,v=0;n>v;v++){var $=y[v];if(c&&v>0&&g+$>d)break;var m=r[v],b=m.length,x=this.$textOffsetX;if(f!=t.HorizontalAlign.LEFT){var T=p>u?p:u;f==t.HorizontalAlign.RIGHT?x+=T-o[v]:f==t.HorizontalAlign.CENTER&&(x+=Math.floor((T-o[v])/2))}for(var _=0;b>_;_++){var w=m.charAt(_),O=a.getTexture(w);if(O){var E=O._bitmapWidth,C=O._bitmapHeight;s.imageWidth=O._sourceWidth,s.imageHeight=O._sourceHeight,s.drawImage(O._bitmapX,O._bitmapY,E,C,x+O._offsetX,g+O._offsetY,O.$getScaleBitmapWidth(),O.$getScaleBitmapHeight()),x+=(a.getConfig(w,"xadvance")||O.$getTextureWidth())+e[4]}else" "==w?x+=l:t.$warn(1046,w)}g+=$+e[3]}}},i.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$BitmapText[8]-this.$textOffsetX,this.$BitmapText[9]-this.$textOffsetY)},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$BitmapText[8]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$BitmapText[9]},enumerable:!0,configurable:!0}),i.prototype.$getTextLines=function(){function e(t){return m&&n.length>0&&f>m?!1:(f+=l+u,s||h||(c-=p),n.push(t),a.push(l),o.push(c),d=Math.max(c,d),!0)}var r=this.$BitmapText;if(!r[7])return this.textLines;var n=[];this.textLines=n;var o=[];this.$textLinesWidth=o,r[7]=!1;var a=[];if(this.$lineHeights=a,!r[2]||!r[5])return n;for(var s,h,l,c,u=r[3],p=r[4],d=0,f=0,g=0,y=0,v=!isNaN(r[0]),$=r[0],m=r[1],b=r[5],x=b._getFirstCharHeight(),T=Math.ceil(x*i.EMPTY_FACTOR),_=r[2],w=_.split(/(?:\r\n|\r|\n)/),O=w.length,E=!0,C=0;O>C;C++){var F=w[C],R=F.length;l=0,c=0,s=!0,h=!1;for(var P=0;R>P;P++){s||(c+=p);var S=F.charAt(P),D=void 0,M=void 0,A=0,L=0,B=b.getTexture(S);if(B)D=B.$getTextureWidth(),M=B.$getTextureHeight(),A=B._offsetX,L=B._offsetY;else{if(" "!=S){t.$warn(1046,S),s&&(s=!1);continue}D=T,M=x}if(s&&(s=!1,g=Math.min(A,g)),E&&(E=!1,y=Math.min(L,y)),v&&P>0&&c+D>$){if(!e(F.substring(0,P)))break;F=F.substring(P),R=F.length,P=0,c=P==R-1?D:b.getConfig(S,"xadvance")||D,l=M}else c+=P==R-1?D:b.getConfig(S,"xadvance")||D,l=Math.max(M,l)}if(m&&C>0&&f>m)break;if(h=!0,!e(F))break}f-=u,r[8]=d,r[9]=f,this.$textOffsetX=g,this.$textOffsetY=y,this.$textStartX=0,this.$textStartY=0;var N;return $>d&&(N=r[10],N==t.HorizontalAlign.RIGHT?this.$textStartX=$-d:N==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor(($-d)/2))),m>f&&(N=r[11],N==t.VerticalAlign.BOTTOM?this.$textStartY=m-f:N==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((m-f)/2))),n},i.EMPTY_FACTOR=.33,i}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var i=0,r=e.length;r>i;){var n=e.indexOf("<",i);if(0>n)this.addToResultArr(e.substring(i)),i=r;else{this.addToResultArr(e.substring(i,n));var o=e.indexOf(">",n);-1==o?(t.$error(1038),o=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,o)),i=o+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},i=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(i=t.match(/^(font|a)\s/)){t=t.substring(i[0].length).trim();for(var r=0,n=void 0;n=t.match(this.getHeadReg());){var o=n[0],a="";t=t.substring(o.length).trim(),'"'==t.charAt(0)?(r=t.indexOf('"',1),a=t.substring(1,r),r+=1):"'"==t.charAt(0)?(r=t.indexOf("'",1),a=t.substring(1,r),r+=1):(a=t.match(/(\S)+/)[0],r=a.length),this.addProperty(e,o.substring(0,o.length-1).trim(),a.trim()),t=t.substring(r).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i=this.stackArray[this.stackArray.length-1];for(var r in i)null==e[r]&&(e[r]=i[r]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(i,e),i.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||(this._text.$isTyping=!0),this._text.$invalidateContentBounds(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$isTyping=!1,this._text.$invalidateContentBounds(),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(t){this.$onFocus()},i.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),this.stageText.$show()))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(e){var i,r,n=this._text.$TextField,o=this.stageText.$getText(),a=!1;null!=n[35]&&(i=new RegExp("["+n[35]+"]","g"),r=o.match(i),o=r?r.join(""):"",a=!0),null!=n[36]&&(i=new RegExp("[^"+n[36]+"]","g"),r=o.match(i),o=r?r.join(""):"",a=!0),a&&this.stageText.$getText()!=o&&this.stageText.$setText(o),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();var t=this._text.$stage;if(null==t);else for(var e=this._text,i=e.$visible;;){if(!i)break;if(e=e.parent,e==t)break;i=e.$visible}this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},i}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i,n){n=n||{};var o=null==n.italic?i[16]:n.italic,a=null==n.bold?i[15]:n.bold,s=null==n.size?i[0]:n.size,h=n.fontFamily||i[8]||r.default_fontFamily;return t.sys.measureText(e,h,s,a,o)}var i=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![)}\\.\\,\\!\\?\\]\\:])"),r=function(r){function n(){var e=r.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var i=new t.sys.TextNode;return i.fontFamily=n.default_fontFamily,e.textNode=i,e.$renderNode=i,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT},e}return __extends(n,r),n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){var e=r.prototype.$setTouchEnabled.call(this,t);return this.isInput()&&(this.$inputEnabled=!0),e},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]==t?!1:(e[8]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(t){t=+t||0;var e=this.$TextField;return e[0]==t?!1:(e[0]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(t){t=!!t;var e=this.$TextField;return t==e[15]?!1:(e[15]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(t){t=!!t;var e=this.$TextField;return t==e[16]?!1:(e[16]=t,this.invalidateFontString(),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(t){var e=this.$TextField;return e[9]==t?!1:(e[9]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]==t?!1:(e[10]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(t){t=+t||0;var e=this.$TextField;return e[1]==t?!1:(e[1]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(t){t=0|+t;var e=this.$TextField;return e[2]==t?!1:(e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidate(),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(t){t=!!t;var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField()))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e?(i[24]=e,e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1
},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(t){null==t&&(t=""),t=t.toString(),this.isFlow=!1;var e=this.$TextField;if(e[13]!=t){this.$invalidateTextField(),e[13]=t;var i="";return i=e[20]?this.changeToPassText(t):t,this.setMiddleStyle([{text:i}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]!=t){e[20]=t,this.$invalidateTextField();var i="";return i=t?this.changeToPassText(e[13]):e[13],this.setMiddleStyle([{text:i}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){t=+t||0,this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var i=this.$TextField;return i[25]!=e?(this.$invalidateTextField(),i[25]=e,i[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(t){return this.$TextField[27]!=t?(this.$invalidateTextField(),this.$TextField[27]=t,!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t?(this.$TextField[21]=t,!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){this.$TextField[28]=Math.max(t,1),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(t){return this.$TextField[30]=t,this.$invalidateTextField(),!0},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&(i=t.indexOf("^",i),0!=i)&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=0/0}else{if(e[3]==t)return!1;e[3]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=0/0}else{if(e[4]==t)return!1;e[4]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(t){this.$TextField[31]=!!t,this.$invalidate()},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(t){this.$TextField[32]=+t||0,this.$invalidate()},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(t){this.$TextField[33]=t,this.$invalidate()},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(t){this.$TextField[34]=t,this.$invalidate()},n.prototype.fillBackground=function(e){var i=this.graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i){i=this.graphicsNode=new t.sys.GraphicsNode;var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var o=void 0,a=void 0;if(r[33]&&(o=i.beginFill(r[34]),o.drawRect(0,0,this.$getWidth(),this.$getHeight())),r[31]&&(a=i.lineStyle(1,r[32]),a.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=r[2],h=-1,l=e.length,c=0;l>c;c+=4){var u=e[c],p=e[c+1],d=e[c+2],f=e[c+3]||s;(0>h||h!=f)&&(h=f,a=i.lineStyle(2,f,1,t.CapsStyle.NONE)),a.moveTo(u,p),a.lineTo(u+d,p)}}if(i){var g=this.$getRenderBounds();i.x=g.x,i.y=g.y,i.width=g.width,i.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&this.textNode.clean()},n.prototype.$onAddToStage=function(e,i){r.prototype.$onAddToStage.call(this,e,i),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){this.$invalidateContentBounds(),this.$TextField[18]=!0},n.prototype.$update=function(e,i){var n=this.$getRenderBounds(),o=r.prototype.$update.call(this,e,n);return t.Rectangle.release(n),o},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4];e.setTo(0,0,i,r)},n.prototype.$render=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if((this.$hasAnyFlags(2032)||this.$hasAnyFlags(1648))&&this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds(),n=this.textNode;n.x=r.x,n.y=r.y,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),t.Rectangle.release(r)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var i=0;i<t.length;i++){var r=t[i];e+=r.text}this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;r>i;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},n.prototype.$getLinesArr=function(){var r=this.$TextField;if(!r[18])return this.linesArr;r[18]=!1;var n=this.textArr;this.linesArr.length=0,r[6]=0,r[5]=0;var o=r[3];if(!isNaN(o)&&0==o)return r[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var a,s=this.linesArr,h=0,l=0,c=0,u=0,p=0,d=n.length;d>p;p++){var f=n[p];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),y=g.split(/(?:\r\n|\r|\n)/),v=0,$=y.length;$>v;v++){null==s[u]&&(a={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[u]=a,h=0,c=0,l=0),c=r[24]==t.TextFieldType.INPUT?r[0]:Math.max(c,f.style.size||r[0]);var m=!0;if(""==y[v])v==$-1&&(m=!1);else{var b=e(y[v],r,f.style);if(isNaN(o))h+=b,l+=y[v].length,a.elements.push({width:b,text:y[v],style:f.style}),v==$-1&&(m=!1);else if(o>=h+b)a.elements.push({width:b,text:y[v],style:f.style}),h+=b,l+=y[v].length,v==$-1&&(m=!1);else{var x=0,T=0,_=y[v],w=void 0;w=r[19]?_.split(i):_.match(/./g);for(var O=w.length,E=0;O>x;x++){var C=w[x].length,F=!1;if(1==C&&O-1>x){var R=w[x].charCodeAt(0),P=w[x+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&P)){var S=w[x]+w[x+1];C=2,F=!0,b=e(S,r,f.style)}else b=e(w[x],r,f.style)}else b=e(w[x],r,f.style);if(0!=h&&h+b>o&&h+x!=0)break;if(T+b>o)for(var D=w[x].match(/./g),M=0,A=D.length;A>M;M++){var C=D[M].length,L=!1;if(1==C&&A-1>M){var R=D[M].charCodeAt(0),P=D[M+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&P)){var S=D[M]+D[M+1];C=2,L=!0,b=e(S,r,f.style)}else b=e(D[M],r,f.style)}else b=e(D[M],r,f.style);if(M>0&&h+b>o)break;E+=C,T+=b,h+=b,l+=E,L&&M++}else E+=C,T+=b,h+=b,l+=E;F&&x++}if(x>0){a.elements.push({width:T,text:_.substring(0,E),style:f.style});var B=_.substring(E),N=void 0,j=B.length;for(N=0;j>N&&" "==B.charAt(N);N++);y[v]=B.substring(N)}""!=y[v]&&(v--,m=!1)}}m&&(l++,a.hasNextLine=!0),v<y.length-1&&(a.width=h,a.height=c,a.charNum=l,r[5]=Math.max(r[5],h),r[6]+=c,u++)}p==n.length-1&&a&&(a.width=h,a.height=c,a.charNum=l,r[5]=Math.max(r[5],h),r[6]+=c)}else a&&(a.width=h,a.height=c,a.charNum=l,r[5]=Math.max(r[5],h),r[6]+=c)}return r[29]=s.length,s},n.prototype.drawText=function(){var e=this.textNode,i=this.$TextField;e.bold=i[15],e.fontFamily=i[8]||n.default_fontFamily,e.italic=i[16],e.size=i[0],e.stroke=i[27],e.strokeColor=i[25],e.textColor=i[2];var r=this.$getLinesArr();if(0==i[5])return[];var o=isNaN(i[3])?i[5]:i[3],a=t.TextFieldUtils.$getTextHeight(this),s=0,h=t.TextFieldUtils.$getStartLine(this),l=i[4];if(!isNaN(l)&&l>a){var c=t.TextFieldUtils.$getValign(this);s+=c*(l-a)}s=Math.round(s);for(var u=t.TextFieldUtils.$getHalign(this),p=0,d=[],f=h,g=i[29];g>f;f++){var y=r[f],v=y.height;if(s+=v/2,f!=h){if(i[24]==t.TextFieldType.INPUT&&!i[30])break;if(!isNaN(l)&&s>l)break}p=Math.round((o-y.width)*u);for(var $=0,m=y.elements.length;m>$;$++){var b=y.elements[$],x=b.style.size||i[0];e.drawText(p,s+(v-x)/2,b.text,b.style),b.style.underline&&d.push(p,s+v/2,b.width,b.style.textColor),p+=b.width}s+=v/2+i[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var i=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=i){var r=i.style;if(r&&r.href)if(r.href.match(/^event:/)){var n=r.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,r.href.substring(n.length))}else open(r.href,r.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=r,__reflect(r.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var i=t.$TextField,r=e.$getTextHeight(t),n=0,o=i[4];return isNaN(o)||(o>r||r>o&&(n=Math.max(i[28]-1,0),n=Math.min(i[29]-1,n)),i[30]||(n=Math.max(i[28]-1,0),i[29]>0&&(n=Math.min(i[29]-1,n)))),n},e.$getHalign=function(e){var i=e.$getLinesArr(),r=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?r=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(r=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&i.length>1&&(r=0),r},e.$getTextHeight=function(e){var i=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return i},e.$getValign=function(i){var r=e.$getTextHeight(i),n=i.$TextField[4];if(!isNaN(n)&&n>r){var o=0;return i.$TextField[10]==t.VerticalAlign.MIDDLE?o=.5:i.$TextField[10]==t.VerticalAlign.BOTTOM&&(o=1),o}return 0},e.$getTextElement=function(t,i,r){var n=e.$getHit(t,i,r),o=t.$getLinesArr();return n&&o[n.lineIndex]&&o[n.lineIndex].elements[n.textElementIndex]?o[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,i,r){var n=t.$getLinesArr();if(0==t.$TextField[3])return null;var o=0,a=e.$getTextHeight(t),s=0,h=t.$TextField[4];if(!isNaN(h)&&h>a){var l=e.$getValign(t);s=l*(h-a),0!=s&&(r-=s)}for(var c=e.$getStartLine(t),u=0,p=c;p<n.length;p++){var d=n[p];if(u+d.height>=r){r>u&&(o=p+1);break}if(u+=d.height,u+t.$TextField[1]>r)return null;u+=t.$TextField[1]}if(0==o)return null;var f=n[o-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var y=e.$getHalign(t);i-=y*(g-f.width);for(var v=0,p=0;p<f.elements.length;p++){var $=f.elements[p];if(v+$.width<=i)v+=$.width;else if(i>v)return{lineIndex:o-1,textElementIndex:p}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var i=t.height,r=t.size,n=t.lineSpacing;e=Math.floor(i/(r+n));var o=i-(r+n)*e;o>r/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),i=e.length,r="",n=0;i>n;n+=3)r+=chars[e[n]>>2],r+=chars[(3&e[n])<<4|e[n+1]>>4],r+=chars[(15&e[n+1])<<2|e[n+2]>>6],r+=chars[63&e[n+2]];return i%3===2?r=r.substring(0,r.length-1)+"=":i%3===1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var e=.75*t.length,i=t.length,r=0,n=0,o=0,a=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var h=new ArrayBuffer(e),l=new Uint8Array(h),c=0;i>c;c+=4)n=lookup[t.charCodeAt(c)],o=lookup[t.charCodeAt(c+1)],a=lookup[t.charCodeAt(c+2)],s=lookup[t.charCodeAt(c+3)],l[r++]=n<<2|o>>4,l[r++]=(15&o)<<4|a>>2,l[r++]=(3&a)<<6|63&s;return h},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var i=function(){function i(t,i){void 0===i&&(i=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>i&&(i=0),this.bufferExtSize=i;var r,n=0;if(t){var o=void 0;if(t instanceof Uint8Array?(o=t,n=t.length):(n=t.byteLength,o=new Uint8Array(t)),0==i)r=new Uint8Array(n);else{var a=(n/i|0)+1;r=new Uint8Array(a*i)}r.set(o)}else r=new Uint8Array(i);this.write_position=n,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(i.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),i.prototype.setArrayBuffer=function(t){},Object.defineProperty(i.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,r=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(i);else{var o=(i/n|0)+1;e=new Uint8Array(o*n)}e.set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),i.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{var r=((t/e>>0)+1)*e;i=new Uint8Array(r)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},i.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},i.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},i.prototype.readBytes=function(e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=0),e){var n=this._position,o=this.write_position-n;if(0>o)return void t.$error(1025);if(0==r)r=o;else if(r>o)return void t.$error(1025);e.validateBuffer(i+r),e._bytes.set(this._bytes.subarray(n,n+r),i),this.position+=r}},i.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},i.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},i.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},i.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},i.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},i.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r;0>e||0>i||(r=0==i?t.length-e:Math.min(t.length-e,i),r>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r))},i.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},i.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},i.prototype.validate=function(e){var i=this._bytes.length;return i>0&&this._position+e<=i?!0:void t.$error(1025)},i.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var o=void 0,a=void 0;for(this.inRange(n,128,2047)?(o=1,a=192):this.inRange(n,2048,65535)?(o=2,a=224):this.inRange(n,65536,1114111)&&(o=3,a=240),r.push(this.div(n,Math.pow(64,o))+a);o>0;){var s=this.div(n,Math.pow(64,o-1));r.push(128+s%64),o-=1}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e,i=!1,r=0,n="",o=0,a=0,s=0,h=0;t.length>r;){var l=t[r++];if(l==this.EOF_byte)e=0!=a?this.decoderError(i):this.EOF_code_point;else if(0==a)this.inRange(l,0,127)?e=l:(this.inRange(l,194,223)?(a=1,h=128,o=l-192):this.inRange(l,224,239)?(a=2,h=2048,o=l-224):this.inRange(l,240,244)?(a=3,h=65536,o=l-240):this.decoderError(i),o*=Math.pow(64,a),e=null);else if(this.inRange(l,128,191))if(s+=1,o+=(l-128)*Math.pow(64,a-s),s!==a)e=null;else{var c=o,u=h;o=0,a=0,s=0,h=0,e=this.inRange(c,u,1114111)&&!this.inRange(c,55296,57343)?c:this.decoderError(i,l)}else o=0,a=0,s=0,h=0,r--,e=this.decoderError(i,l);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},i.prototype.encoderError=function(e){t.$error(1026,e)},i.prototype.decoderError=function(e,i){return e&&t.$error(1027),i||65533},i.prototype.inRange=function(t,e,i){return t>=e&&i>=t},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var o=t.charCodeAt(i+1);if(this.inRange(o,56320,57343)){var a=1023&n,s=1023&o;i+=1,e.push(65536+(a<<10)+s)}else e.push(65533)}else e.push(n);i+=1}return e},i}();t.ByteArray=i,__reflect(i.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function i(t){var e=r[t];return void 0===e?"normal":e}for(var r=["normal","add","erase"],n={},o=r.length,a=0;o>a;a++){var s=r[a];n[s]=a}t.blendModeToNumber=e,t.numberToBlendMode=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(e,i){t.useFontMapping=!0,t.fontMapping[e]=i}t.fontMapping={},t.useFontMapping=!1,t.registerFontMapping=e}(egret||(egret={}));var egret;!function(t){function e(t,e,i){var r=t.prototype;r.__class__=e;var n=[e];i&&(n=n.concat(i));var o=r.__types__;if(r.__types__)for(var a=o.length,s=0;a>s;s++){var h=o[s];-1==n.indexOf(h)&&n.push(h)}r.__types__=n}t.registerClass=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,i.$stage=i,i.$nestLevel=1,i}return __extends(i,e),Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dirtyRegionPolicy",{get:function(){return this.$dirtyRegionPolicy},set:function(t){this.$dirtyRegionPolicy!=t&&(this.$dirtyRegionPolicy=t,this.$displayList.setDirtyRegionPolicy(t))},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var i=Math.floor(e),r=i+1,n=t.sinInt(i);if(i==e)return n;var o=t.sinInt(r);return(e-i)*o+(r-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var i=Math.floor(e),r=i+1,n=t.cosInt(i);if(i==e)return n;var o=t.cosInt(r);return(e-i)*o+(r-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,n.prototype=new r,n});var egret;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=0);var r=e.call(this)||this;return r._delay=0,r._currentCount=0,r._running=!1,r.updateInterval=1e3,r.lastCount=1e3,r.lastTimeStamp=0,r.delay=t,r.repeatCount=0|+i,r}return __extends(i,e),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(e){var i=e-this.lastTimeStamp;if(i>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var r=this.repeatCount>0&&this._currentCount>=this.repeatCount;return t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),r&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},i}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(i),t.$callLaterArgsList.push(r)}function i(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(i),t.$callAsyncArgsList.push(r)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=i}(egret||(egret={}));var egret;!function(t){function e(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];
var o,a=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),o=t.__sets__;var s=o[i];if(s)return s.apply(e,r);var h=Object.getPrototypeOf(a);if(null!=h){for(;!h.hasOwnProperty(i);)if(h=Object.getPrototypeOf(h),null==h)return;s=Object.getOwnPropertyDescriptor(h,i).set,o[i]=s,s.apply(e,r)}}function i(t,e,i){var r,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),r=t.__gets__;var o=r[i];if(o)return o.call(e);var a=Object.getPrototypeOf(n);if(null!=a){for(;!a.hasOwnProperty(i);)if(a=Object.getPrototypeOf(a),null==a)return;return o=Object.getOwnPropertyDescriptor(a,i).get,r[i]=o,o.call(e)}}t.superSetter=e,t.superGetter=i}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=i[t];if(e)return e;var r=t.split("."),n=r.length;e=__global;for(var o=0;n>o;o++){var a=r[o];if(e=e[a],!e)return null}return i[t]=e,e}var i={};t.getDefinitionByName=e}(egret||(egret={}));var __global=this.__global||this,egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype?t.prototype:Object.getPrototypeOf(t);if(i.hasOwnProperty("__class__"))return i.__class__;var r=i.constructor.toString().trim(),n=r.indexOf("("),o=r.substring(9,n);return Object.defineProperty(i,"__class__",{value:o,enumerable:!1,writable:!0}),o}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var i=e.prototype?e.prototype:Object.getPrototypeOf(e),r=Object.getPrototypeOf(i);if(!r)return null;var n=t.getQualifiedClassName(r.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var i=t.getDefinitionByName(e);return i?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var i=Object.getPrototypeOf(t),r=i?i.__types__:null;return r?-1!==r.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$startTick(e,i)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$stopTick(e,i)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),egret;!function(e){var t;!function(t){var r=function(t){function r(r,i,n,a,o){var s=t.call(this)||this;if(s.showPanle=!0,s.fpsHeight=0,s.WIDTH=101,s.HEIGHT=20,s.bgCanvasColor="#18304b",s.fpsFrontColor="#18fefe",s.WIDTH_COST=33,s.cost1Color="#18fefe",s.cost2Color="#ffff00",s.cost3Color="#ff0000",s.arrFps=[],s.arrCost=[],s.arrLog=[],i||n){"canvas"==e.Capabilities.renderMode?s.renderMode="Canvas":s.renderMode="WebGL",s.panelX=void 0===o.x?0:parseInt(o.x),s.panelY=void 0===o.y?0:parseInt(o.y),s.fontColor=void 0===o.textColor?"#ffffff":o.textColor.replace("0x","#"),s.fontSize=void 0===o.size?12:parseInt(o.size),e.Capabilities.isMobile&&(s.fontSize-=2);var l=document.createElement("div");l.style.position="absolute",l.style.background="rgba(0,0,0,"+o.bgAlpha+")",l.style.left=s.panelX+"px",l.style.top=s.panelY+"px",l.style.pointerEvents="none",document.body.appendChild(l);var c=document.createElement("div");c.style.color=s.fontColor,c.style.fontSize=s.fontSize+"px",c.style.lineHeight=s.fontSize+"px",c.style.margin="4px 4px 4px 4px",s.container=c,l.appendChild(c),i&&s.addFps(),n&&s.addLog()}return s}return __extends(r,t),r.prototype.addFps=function(){var e=document.createElement("div");e.style.display="inline-block",this.containerFps=e,this.container.appendChild(e);var t=document.createElement("div");t.style.paddingBottom="2px",this.fps=t,this.containerFps.appendChild(t),t.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var r=document.createElement("canvas");this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,this.canvasFps=r;var i=r.getContext("2d");this.contextFps=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style["float"]="left",a.innerHTML="Draw<br/>Dirty<br/>Cost",n.appendChild(a);var o=document.createElement("div");o.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(o);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>0<br/>",o.appendChild(s);var l=document.createElement("div");this.divCost=l,l.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost2Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',o.appendChild(l),r=document.createElement("canvas"),this.canvasCost=r,this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,i=r.getContext("2d"),this.contextCost=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT),i.fillStyle="#000000",i.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),i.fillRect(2*this.WIDTH_COST+1,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},r.prototype.addLog=function(){var e=document.createElement("div");e.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",e.style.wordWrap="break-word",this.log=e,this.container.appendChild(e)},r.prototype.update=function(e,t){void 0===t&&(t=!1);var r,i,n,a;t?(r=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1],a=this.arrCost[this.arrCost.length-1][2]):(r=e.fps,i=e.costTicker,n=e.costDirty,a=e.costRender,this.lastNumDraw=e.draw,this.lastNumDirty=e.dirty,this.arrFps.push(r),this.arrCost.push([i,n,a]));var o=0,s=this.arrFps.length;s>101&&(s=101,this.arrFps.shift(),this.arrCost.shift());for(var l=this.arrFps[0],c=this.arrFps[0],h=0;s>h;h++){var u=this.arrFps[h];o+=u,l>u?l=u:u>c&&(c=u)}var d=this.WIDTH,p=this.HEIGHT,f=this.contextFps;f.drawImage(this.canvasFps,1,0,d-1,p,0,0,d-1,p),f.fillStyle=this.bgCanvasColor,f.fillRect(d-1,0,1,p);var g=Math.floor(r/60*20);1>g&&(g=1),f.fillStyle=this.fpsFrontColor,f.fillRect(d-1,20-g,1,g);var v=this.WIDTH_COST;f=this.contextCost,f.drawImage(this.canvasCost,1,0,v-1,p,0,0,v-1,p),f.drawImage(this.canvasCost,v+2,0,v-1,p,v+1,0,v-1,p),f.drawImage(this.canvasCost,2*v+3,0,v-1,p,2*v+2,0,v-1,p);var y=Math.floor(i/2);1>y?y=1:y>20&&(y=20);var m=Math.floor(n/2);1>m?m=1:m>20&&(m=20);var x=Math.floor(a/2);1>x?x=1:x>20&&(x=20),f.fillStyle=this.bgCanvasColor,f.fillRect(v-1,0,1,p),f.fillRect(2*v,0,1,p),f.fillRect(3*v+1,0,1,p),f.fillStyle=this.cost1Color,f.fillRect(v-1,20-y,1,y),f.fillStyle=this.cost2Color,f.fillRect(2*v,20-m,1,m),f.fillStyle=this.cost3Color,f.fillRect(3*v+1,20-x,1,x);var b=Math.floor(o/s),w=r+" FPS "+this.renderMode;this.showPanle&&(w+="<br/>min"+l+" max"+c+" avg"+b,this.divDraw.innerHTML=this.lastNumDraw+"<br/>"+this.lastNumDirty+"%<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ffff00">'+n+'<font/> <font  style="color:#ff0000">'+a+"<font/>"),this.fps.innerHTML=w},r.prototype.updateInfo=function(e){for(this.arrLog.push(e),this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},r}(e.DisplayObject);t.WebFps=r,__reflect(r.prototype,"egret.web.WebFps",["egret.FPSDisplay","egret.DisplayObject"]),e.FPSDisplay=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r="egret.BitmapData";e.registerClass(HTMLImageElement,r),e.registerClass(HTMLCanvasElement,r),e.registerClass(HTMLVideoElement,r)}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){function t(t){return t.hashCode=t.$hashCode=e.$hashCount++,t}e.$toBitmapData=t}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r;!function(r){function i(e){return window.localStorage.getItem(e)}function n(t,r){try{return window.localStorage.setItem(t,r),!0}catch(i){return e.$warn(1047,t,r),!1}}function a(e){window.localStorage.removeItem(e)}function o(){window.localStorage.clear()}t.getItem=i,t.setItem=n,t.removeItem=a,t.clear=o}(r=t.web||(t.web={}))}(t=e.localStorage||(e.localStorage={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(){var e=r.call(this)||this;return e.loaded=!1,e}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(t){function r(){a(),l.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),o.loaded=!0,o.dispatchEventWith(e.Event.COMPLETE)}function n(){a(),o.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}function a(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n)}var o=this;this.url=t;var s=new Audio(t);s.addEventListener("canplaythrough",r),s.addEventListener("error",n);var l=navigator.userAgent.toLowerCase();l.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0),s.load(),this.originAudio=s,i.clearAudios[this.url]&&delete i.clearAudios[this.url],i.$recycle(this.url,s)},i.prototype.play=function(r,n){r=+r||0,n=+n||0;var a=i.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var o=new t.HtmlSoundChannel(a);return o.$url=this.url,o.$loops=n,o.$startTime=r,o.$play(),e.sys.$pushSoundChannel(o),o},i.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url)},i.$clear=function(e){i.clearAudios[e]=!0;var t=i.audios[e];t&&(t.length=0)},i.$pop=function(e){var t=i.audios[e];return t&&t.length>0?t.pop():null},i.$recycle=function(e,t){if(!i.clearAudios[e]){var r=i.audios[e];null==i.audios[e]&&(r=i.audios[e]=[]),r.push(t)}},i.MUSIC="music",i.EFFECT="effect",i.audios={},i.clearAudios={},i}(e.EventDispatcher);t.HtmlSound=r,__reflect(r.prototype,"egret.web.HtmlSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(t){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.canPlay=function(){i.audio.removeEventListener("canplay",i.canPlay);try{i.audio.currentTime=i.$startTime}catch(e){}finally{i.audio.play()}},i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(e.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._volume=1,t.addEventListener("ended",i.onPlayEnd),i.audio=t,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void e.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(t){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},i.prototype.stop=function(){if(this.audio){this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.removeEventListener("ended",this.onPlayEnd),r.volume=0,this._volume=0,this.audio=null;var i=this.$url;window.setTimeout(function(){r.pause(),t.HtmlSound.$recycle(i,r)},200)}},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(t){return this.isStopped?void e.$error(1036):(this._volume=t,void(this.audio&&(this.audio.volume=t)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),i}(e.EventDispatcher);t.HtmlSoundChannel=r,__reflect(r.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(){function e(){}return e.decodeAudios=function(){if(!(e.decodeArr.length<=0||e.isDecoding)){e.isDecoding=!0;var t=e.decodeArr.shift();e.ctx.decodeAudioData(t.buffer,function(r){t.self.audioBuffer=r,t.success&&t.success(),e.isDecoding=!1,e.decodeAudios()},function(){t.fail&&t.fail(),e.isDecoding=!1,e.decodeAudios()})}},e.decodeArr=[],e.isDecoding=!1,e}();t.WebAudioDecode=r,__reflect(r.prototype,"egret.web.WebAudioDecode");var i=function(i){function n(){var e=i.call(this)||this;return e.loaded=!1,e}return __extends(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(t){function i(){a.loaded=!0,a.dispatchEventWith(e.Event.COMPLETE)}function n(){a.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}var a=this;this.url=t;var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(4==o.readyState){var t=o.status>=400||0==o.status;t?a.dispatchEventWith(e.IOErrorEvent.IO_ERROR):(r.decodeArr.push({buffer:o.response,success:i,fail:n,self:a,url:a.url}),r.decodeAudios())}},o.send()},n.prototype.play=function(r,i){r=+r||0,i=+i||0;var n=new t.WebAudioSoundChannel;return n.$url=this.url,n.$loops=i,n.$audioBuffer=this.audioBuffer,n.$startTime=r,n.$play(),e.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(e.EventDispatcher);t.WebAudioSound=i,__reflect(i.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(){var i=r.call(this)||this;return i.$startTime=0,i.bufferSource=null,i.context=t.WebAudioDecode.ctx,i.isStopped=!1,i._currentTime=0,i._volume=1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(e.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i.context.createGain?i.gain=i.context.createGain():i.gain=i.context.createGainNode(),i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void e.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var t=this.context,r=this.gain,i=t.createBufferSource();this.bufferSource=i,i.buffer=this.$audioBuffer,i.connect(r),r.connect(t.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},i.prototype.stop=function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.onended=null,t.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(t){return this.isStopped?void e.$error(1036):(this._volume=t,void(this.gain.gain.value=t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),i}(e.EventDispatcher);t.WebAudioSoundChannel=r,__reflect(r.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(r,i){void 0===i&&(i=!0);var n=t.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(t){var r=document.fullscreenEnabled||document.webkitIsFullScreen;r||(n.checkFullScreen(!1),e.Capabilities.isMobile||(n._fullscreen=r))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var t=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),t.width=t.videoWidth,t.height=t.videoHeight,n.$invalidateContentBounds(),window.setTimeout(function(){n.dispatchEventWith(e.Event.COMPLETE)},200)},n.$renderNode=new e.sys.BitmapNode,n.src=r,n.once(e.Event.ADDED_TO_STAGE,n.loadPoster,n),r&&n.load(),n}return __extends(r,t),r.prototype.load=function(t,r){var i=this;if(void 0===r&&(r=!0),t=t||this.src,this.src=t,!this.video||this.video.src!=t){var n;!this.video||e.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=t,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return i.onVideoError()}),n.addEventListener("ended",function(){return i.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){i.waiting=!1,a?i.userPause?i.pause():i.userPlay&&i.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){i.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},r.prototype.play=function(t,r){var i=this;if(void 0===r&&(r=!1),0==this.loaded)return this.load(this.src),void this.once(e.Event.COMPLETE,function(e){return i.play(t,r)},this);this.isPlayed=!0;var n=this.video;void 0!=t&&(n.currentTime=+t||0),n.loop=!!r,e.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=e.Capabilities.os&&"Mac OS"!=e.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},r.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},r.prototype.checkFullScreen=function(t){var r=this.video;if(t)null==r.parentElement&&(r.removeAttribute("webkit-playsinline"),document.body.appendChild(r)),e.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=r.parentElement&&r.parentElement.removeChild(r),r.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),e.startTick(this.markDirty,this),e.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},r.prototype.goFullscreen=function(){var t,r=this.video;return t=e.web.getPrefixStyleName("requestFullscreen",r),r[t]||(t=e.web.getPrefixStyleName("requestFullScreen",r),r[t])?(r.removeAttribute("webkit-playsinline"),r[t](),this.setFullScreenMonitor(!0),!0):!0},r.prototype.setFullScreenMonitor=function(e){var t=this.video;e?(t.addEventListener("mozfullscreenchange",this.screenChanged),t.addEventListener("webkitfullscreenchange",this.screenChanged),t.addEventListener("mozfullscreenerror",this.screenError),t.addEventListener("webkitfullscreenerror",this.screenError)):(t.removeEventListener("mozfullscreenchange",this.screenChanged),t.removeEventListener("webkitfullscreenchange",this.screenChanged),t.removeEventListener("mozfullscreenerror",this.screenError),t.removeEventListener("webkitfullscreenerror",this.screenError))},r.prototype.screenError=function(){e.$error(3014)},r.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},r.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.$invalidateContentBounds(),this.dispatchEventWith(e.Event.ENDED)},r.prototype.onVideoError=function(){this.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},r.prototype.close=function(){var e=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return e.onVideoError()}),this.video.removeEventListener("ended",function(){return e.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},r.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,e.stopTick(this.markDirty,this),void this.$invalidate())},Object.defineProperty(r.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(e){this.video&&(this.video.volume=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(e){this.video&&(this.video.currentTime=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(t){e.Capabilities.isMobile||(this._fullscreen=!!t,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new e.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),r.prototype.loadPoster=function(){var t=this,r=this.poster;if(r){var i=new e.ImageLoader;i.once(e.Event.COMPLETE,function(e){i.data;t.posterData=i.data,t.posterData.width=t.getPlayWidth(),t.posterData.height=t.getPlayHeight(),t.$invalidateContentBounds()},this),i.load(r)}},r.prototype.$measureContentBounds=function(e){var t=this.bitmapData,r=this.posterData;t?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):r?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):e.setEmpty()},r.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},r.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},r.prototype.$render=function(){var t=this.$renderNode,r=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!e.Capabilities.isMobile||!i?this.isPlayed&&r&&(t.image=r,t.imageWidth=r.width,t.imageHeight=r.height,e.WebGLUtils.deleteWebGLTexture(r.webGLTexture),r.webGLTexture=null,t.drawImage(0,0,r.width,r.height,0,0,n,a)):(t.image=i,t.imageWidth=n,t.imageHeight=a,t.drawImage(0,0,i.width,i.height,0,0,n,a))},r.prototype.markDirty=function(){return this.$invalidate(),!0},r.prototype.$setHeight=function(e){return this.heightSet=+e||0,this.$invalidate(),this.$invalidateContentBounds(),t.prototype.$setHeight.call(this,e)},r.prototype.$setWidth=function(e){return this.widthSet=+e||0,this.$invalidate(),this.$invalidateContentBounds(),t.prototype.$setWidth.call(this,e)},Object.defineProperty(r.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),r}(e.DisplayObject);t.WebVideo=r,__reflect(r.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),e.Video=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var e=t.call(this)||this;return e._url="",e._method="",e}return __extends(r,t),Object.defineProperty(r.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var e=window;return e.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(e){this._responseType=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(e){this._withCredentials=e},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(e,t){void 0===t&&(t="GET"),this._url=e,this._method=t,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},r.prototype.send=function(e){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var t in this.headerObj)this._xhr.setRequestHeader(t,this.headerObj[t]);this._xhr.send(e)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var e=this._xhr.getAllResponseHeaders();return e?e:""},r.prototype.setRequestHeader=function(e,t){this.headerObj||(this.headerObj={}),this.headerObj[e]=t},r.prototype.getResponseHeader=function(e){if(!this._xhr)return null;var t=this._xhr.getResponseHeader(e);return t?t:""},r.prototype.onReadyStateChange=function(){var t=this._xhr;if(4==t.readyState){var r=t.status>=400||0==t.status,i=(this._url,this);window.setTimeout(function(){r?i.dispatchEventWith(e.IOErrorEvent.IO_ERROR):i.dispatchEventWith(e.Event.COMPLETE)},0)}},r.prototype.updateProgress=function(t){t.lengthComputable&&e.ProgressEvent.dispatchProgressEvent(this,e.ProgressEvent.PROGRESS,t.loaded,t.total)},r}(e.EventDispatcher);t.WebHttpRequest=r,__reflect(r.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),e.HttpRequest=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=window.URL||window.webkitURL,i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e.data=null,e._crossOrigin=null,e._hasCrossOriginSet=!1,e.currentImage=null,e.request=null,e}return __extends(n,i),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(e){this._hasCrossOriginSet=!0,this._crossOrigin=e},enumerable:!0,configurable:!0}),n.prototype.load=function(r){if(t.Html5Capatibility._canUseBlob&&0!=r.indexOf("wxLocalResource:")&&0!=r.indexOf("data:")&&0!=r.indexOf("http:")&&0!=r.indexOf("https:")){var i=this.request;i||(i=this.request=new e.web.WebHttpRequest,i.addEventListener(e.Event.COMPLETE,this.onBlobLoaded,this),i.addEventListener(e.IOErrorEvent.IO_ERROR,this.onBlobError,this),i.responseType="blob"),i.open(r),i.send()}else this.loadImage(r)},n.prototype.onBlobLoaded=function(e){var t=this.request.response;this.request=void 0,this.loadImage(r.createObjectURL(t))},n.prototype.onBlobError=function(e){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(e){var t=new Image;this.data=null,this.currentImage=t,this._hasCrossOriginSet?this._crossOrigin&&(t.crossOrigin=this._crossOrigin):n.crossOrigin&&(t.crossOrigin=n.crossOrigin),t.onload=this.onImageComplete.bind(this),t.onerror=this.onLoadError.bind(this),t.src=e},n.prototype.onImageComplete=function(t){var r=this.getImage(t);if(r){this.data=new e.BitmapData(r);var i=this;window.setTimeout(function(){i.dispatchEventWith(e.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(e){var t=this.getImage(e);t&&this.dispatchIOError(t.src)},n.prototype.dispatchIOError=function(t){var r=this;window.setTimeout(function(){r.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(t){var i=t.target,n=i.src;if(0==n.indexOf("blob:"))try{r.revokeObjectURL(i.src)}catch(a){e.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},n.crossOrigin=null,n}(e.EventDispatcher);t.WebImageLoader=i,__reflect(i.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),e.ImageLoader=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(){var e=r.call(this)||this;return e._isNeedShow=!1,e.inputElement=null,e.inputDiv=null,e._gscaleX=0,e._gscaleY=0,e.textValue="",e.colorValue=16777215,e._styleInfoes={},e}return __extends(i,r),i.prototype.$setTextField=function(e){return this.$textfield=e,!0},i.prototype.$addToStage=function(){this.htmlInput=e.web.$getTextAdapter(this.$textfield)},i.prototype._initElement=function(){var t=this.$textfield.localToGlobal(0,0),r=t.x,i=t.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=r*n+"px",this.inputDiv.style.top=i*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top="0px");for(var o=this.$textfield,s=1,l=1,c=0;o.parent;)s*=o.scaleX,l*=o.scaleY,c+=o.rotation,o=o.parent;var h=e.web.getPrefixStyleName("transform");this.inputDiv.style[h]="rotate("+c+"deg)",this._gscaleX=n*s,this._gscaleY=a*l},i.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},i.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},i.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},i.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(e){return this.textValue=e,this.resetText(),!0},i.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},i.prototype.$setColor=function(e){return this.colorValue=e,this.resetColor(),!0},i.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",e.toColorString(this.colorValue))},i.prototype.$onBlur=function(){t.Html5Capatibility._System_OS==t.SystemOSType.WPHONE&&e.Event.dispatchEvent(this,"updateText",!1)},i.prototype._onInput=function(){var r=this;if(t.Html5Capatibility._System_OS==t.SystemOSType.WPHONE){var i=this.$textfield.$TextField;null==i[35]&&null==i[36]?(r.textValue=r.inputElement.value,e.Event.dispatchEvent(r,"updateText",!1)):window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart&&r.inputElement.selectionEnd&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,e.Event.dispatchEvent(r,"updateText",!1))},0)}else window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,e.Event.dispatchEvent(r,"updateText",!1))},0)},i.prototype.setAreaHeight=function(){var t=this.$textfield;if(t.multiline){var r=e.TextFieldUtils.$getTextHeight(t);if(t.height<=t.size)this.setElementStyle("height",t.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",t.size*this._gscaleY+"px");else if(t.height<r)this.setElementStyle("height",t.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(t.size+t.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(r+t.lineSpacing)*this._gscaleY+"px");var i=(t.height-r)*this._gscaleY,n=e.TextFieldUtils.$getValign(t),a=i*n,o=i-a;this.setElementStyle("padding",a+"px 0px "+o+"px 0px"),this.setElementStyle("lineHeight",(t.size+t.lineSpacing)*this._gscaleY+"px")}}},i.prototype._onClickHandler=function(t){this._isNeedShow&&(t.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new e.Event("focus")))},i.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new e.Event("blur"))},i.prototype.setElementStyle=function(e,t){this.inputElement&&this._styleInfoes[e]!=t&&(this.inputElement.style[e]=t)},i.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},i.prototype.$resetStageText=function(){if(this.inputElement){var t=this.$textfield;this.setElementStyle("fontFamily",t.fontFamily),this.setElementStyle("fontStyle",t.italic?"italic":"normal"),this.setElementStyle("fontWeight",t.bold?"bold":"normal"),this.setElementStyle("textAlign",t.textAlign),this.setElementStyle("fontSize",t.size*this._gscaleY+"px"),this.setElementStyle("color",e.toColorString(t.textColor));var r=void 0;if(t.stage?(r=t.localToGlobal(0,0).x,r=Math.min(t.width,t.stage.stageWidth-r)):r=t.width,this.setElementStyle("width",r*this._gscaleX+"px"),this.setElementStyle("verticalAlign",t.verticalAlign),t.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",t.size*this._gscaleY+"px"),t.height<t.size){this.setElementStyle("height",t.size*this._gscaleY+"px");var i=t.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+i+"px 0px")}else{this.setElementStyle("height",t.size*this._gscaleY+"px");var n=(t.height-t.size)*this._gscaleY,a=e.TextFieldUtils.$getValign(t),o=n*a,i=n-o;i<t.size/2*this._gscaleY&&(i=t.size/2*this._gscaleY),this.setElementStyle("padding",o+"px 0px "+i+"px 0px")}this.inputDiv.style.clip="rect(0px "+t.width*this._gscaleX+"px "+t.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=t.height*this._gscaleY+"px",this.inputDiv.style.width=r*this._gscaleX+"px"}},i}(e.EventDispatcher);
t.HTML5StageText=r,__reflect(r.prototype,"egret.web.HTML5StageText",["egret.StageText"]),e.StageText=r}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){var r=function(){function t(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return t.prototype.isInputOn=function(){return null!=this._stageText},t.prototype.isCurrentStageText=function(e){return this._stageText==e},t.prototype.initValue=function(e){e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.border="none",e.style.padding="0"},t.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=e.sys.DisplayList.$canvasScaleX,this.$scaleY=e.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var t=e.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[t]=this.canvas.style[t],this.StageDelegateDiv.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},t.prototype._initStageDelegateDiv=function(t,r){this.canvas=r;var i,n=this;i||(i=document.createElement("div"),this.StageDelegateDiv=i,i.id="StageDelegateDiv",t.appendChild(i),n.initValue(i),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(e){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(e),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},t.prototype.initInputElement=function(e){var t,r=this;e?(t=document.createElement("textarea"),t.style.resize="none",r._multiElement=t,t.id="egretTextarea"):(t=document.createElement("input"),r._simpleElement=t,t.id="egretInput"),t.type="text",r._inputDIV.appendChild(t),t.setAttribute("tabindex","-1"),t.style.width="1px",t.style.height="12px",r.initValue(t),t.style.outline="thin",t.style.background="none",t.style.overflow="hidden",t.style.wordBreak="break-all",t.style.opacity=0,t.oninput=function(){r._stageText&&r._stageText._onInput()}},t.prototype.show=function(){var t=this,r=t._inputElement;e.$callAsync(function(){r.style.opacity=1},t)},t.prototype.disconnectStageText=function(e){(null==this._stageText||this._stageText==e)&&(this.clearInputElement(),this._inputElement&&this._inputElement.blur())},t.prototype.clearInputElement=function(){var e=this;if(e._inputElement){e._inputElement.value="",e._inputElement.onblur=null,e._inputElement.style.width="1px",e._inputElement.style.height="12px",e._inputElement.style.left="0px",e._inputElement.style.top="0px",e._inputElement.style.opacity=0;var t=void 0;t=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,t.style.display="block",e._inputDIV.style.left="0px",e._inputDIV.style.top="-100px",e._inputDIV.style.height="0px",e._inputDIV.style.width="0px"}e._stageText&&(e._stageText._onDisconnect(),e._stageText=null,this.canvas.userTyping=!1)},t.prototype.getInputElement=function(e){var t=this;t.clearInputElement(),t._stageText=e,this.canvas.userTyping=!0,t._stageText.$textfield.multiline?t._inputElement=t._multiElement:t._inputElement=t._simpleElement;var r;return r=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,r.style.display="none",t._inputElement},t}();t.HTMLInput=r,__reflect(r.prototype,"egret.web.HTMLInput")}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(e){function t(e){var t=e.stage?e.stage.$hashCode:0,r=i[t],o=n[t],s=a[t];return o&&s&&(delete n[t],delete a[t]),r}function r(e,t,r,o){e._initStageDelegateDiv(r,o),i[t.$hashCode]=e,n[t.$hashCode]=o,a[t.$hashCode]=r}var i={},n={},a={};e.$getTextAdapter=t,e.$cacheTextAdapter=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e,t,r,a,o){n||i();var s="";return o&&(s+="italic "),a&&(s+="bold "),s+=(r||12)+"px ",s+=t||"Arial",n.font=s,n.measureText(e).width}function i(){n=e.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;e.sys.measureText=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e,t){var r=document.createElement("canvas");isNaN(e)||isNaN(t)||(r.width=e,r.height=t);var i=r.getContext("2d");if(void 0===i.imageSmoothingEnabled){for(var n,a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],o=a.length-1;o>=0&&(n=a[o],void 0===i[n]);o--);try{Object.defineProperty(i,"imageSmoothingEnabled",{get:function(){return this[n]},set:function(e){this[n]=e}})}catch(s){i.imageSmoothingEnabled=i[n]}}return r}var i,n=function(){function t(e,t,i){this.surface=r(e,t),this.context=this.surface.getContext("2d")}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(e,t,r){var i=this.surface;if(r){var n=!1;i.width<e&&(i.width=e,n=!0),i.height<t&&(i.height=t,n=!0),n||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else i.width!=e&&(i.width=e),i.height!=t&&(i.height=t);this.clear()},t.prototype.resizeTo=function(e,t,n,a){i||(i=r());var o=(this.context,this.surface),s=i,l=s.getContext("2d");i=o,this.context=l,this.surface=s,s.width=Math.max(e,257),s.height=Math.max(t,257),l.setTransform(1,0,0,1,0,0),l.drawImage(o,n,a),o.height=1,o.width=1},t.prototype.setDirtyRegionPolicy=function(e){},t.prototype.beginClip=function(t,r,i){r=+r||0,i=+i||0;var n=e.sys.DisplayList.$canvasScaleX,a=e.sys.DisplayList.$canvasScaleY,o=this.context;o.save(),o.beginPath(),o.setTransform(n,0,0,a,r*n,i*a);for(var s=t.length,l=0;s>l;l++){var c=t[l];o.clearRect(c.minX,c.minY,c.width,c.height),o.rect(c.minX,c.minY,c.width,c.height)}o.clip()},t.prototype.endClip=function(){this.context.restore()},t.prototype.getPixels=function(e,t,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(e,t,r,i).data},t.prototype.toDataURL=function(e,t){return this.surface.toDataURL(e,t)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=n,__reflect(n.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(r,i){var n=t.call(this)||this;return n.onTouchBegin=function(e){var t=n.getLocation(e);n.touch.onTouchBegin(t.x,t.y,e.identifier)},n.onTouchMove=function(e){var t=n.getLocation(e);n.touch.onTouchMove(t.x,t.y,e.identifier)},n.onTouchEnd=function(e){var t=n.getLocation(e);n.touch.onTouchEnd(t.x,t.y,e.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=i,n.touch=new e.sys.TouchHandler(r),n.addListeners(),n}return __extends(r,t),r.prototype.addListeners=function(){var t=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(e){e.identifier=e.pointerId,t.onTouchBegin(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerMove",function(e){e.identifier=e.pointerId,t.onTouchMove(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerUp",function(e){e.identifier=e.pointerId,t.onTouchEnd(e),t.prevent(e)},!1)):(e.Capabilities.$isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onTouchMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var e=this;this.canvas.addEventListener("touchstart",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchBegin(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchmove",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchMove(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchend",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchEnd(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchcancel",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchEnd(t.changedTouches[i]);e.prevent(t)},!1)},r.prototype.prevent=function(e){e.stopPropagation(),1==e.isScroll||this.canvas.userTyping||e.preventDefault()},r.prototype.getLocation=function(t){t.identifier=+t.identifier||0;var r=document.documentElement,i=this.canvas.getBoundingClientRect(),n=i.left+window.pageXOffset-r.clientLeft,a=i.top+window.pageYOffset-r.clientTop,o=t.pageX-n,s=o,l=t.pageY-a,c=l;return 90==this.rotation?(s=l,c=i.width-o):-90==this.rotation&&(s=i.height-l,c=o),s/=this.scaleX,c/=this.scaleY,e.$TempPoint.setTo(Math.round(s),Math.round(c))},r.prototype.updateScaleMode=function(e,t,r){this.scaleX=e,this.scaleY=t,this.rotation=r},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(e.HashObject);t.WebTouchHandler=r,__reflect(r.prototype,"egret.web.WebTouchHandler")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){e.WebLifeCycleHandler=function(e){var t=function(){document[r]?e.pause():e.resume()};window.addEventListener("focus",e.resume,!1),window.addEventListener("blur",e.pause,!1);var r,i;"undefined"!=typeof document.hidden?(r="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(r="webkitHidden",i="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(r="oHidden",i="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",e.resume,!1),window.addEventListener("pagehide",e.pause,!1)),r&&i&&document.addEventListener(i,t,!1);var n=navigator.userAgent,a=/micromessenger/gi.test(n),o=/mqq/gi.test(n),s=/mobile.*qq/gi.test(n);if((s||a)&&(o=!1),o){var l=window.browser||{};l.execWebFn=l.execWebFn||{},l.execWebFn.postX5GamePlayerMessage=function(t){var r=t.type;"app_enter_background"==r?e.pause():"app_enter_foreground"==r&&e.resume()},window.browser=l}}}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e,t){var r="";if(null!=t)r=i(e,t);else{if(null==s){var n=document.createElement("div").style;s=i("transform",n)}r=s}return""==r?e:r+e.charAt(0).toUpperCase()+e.substring(1,e.length)}function i(e,t){if(e in t)return"";e=e.charAt(0).toUpperCase()+e.substring(1,e.length);for(var r=["webkit","ms","Moz","O"],i=0;i<r.length;i++){var n=r[i]+e;if(n in t)return r[i]}return""}var n=function(){function e(){}return e.WEB_AUDIO=2,e.HTML5_AUDIO=3,e}();t.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var a=function(){function e(){}return e.WPHONE=1,e.IOS=2,e.ADNROID=3,e}();t.SystemOSType=a,__reflect(a.prototype,"egret.web.SystemOSType");var o=function(r){function i(){return r.call(this)||this}return __extends(i,r),i.$init=function(){var r=navigator.userAgent.toLowerCase();i.ua=r,e.Capabilities.$isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i._canUseBlob=!1;var o=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(o)try{t.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(s){o=!1}var l,c=i._audioType;c==n.WEB_AUDIO&&o||c==n.HTML5_AUDIO?(l=!1,i.setAudioType(c)):(l=!0,i.setAudioType(n.HTML5_AUDIO)),r.indexOf("windows phone")>=0?(i._System_OS=a.WPHONE,e.Capabilities.$os="Windows Phone"):r.indexOf("android")>=0?(e.Capabilities.$os="Android",i._System_OS=a.ADNROID,l&&o&&i.setAudioType(n.WEB_AUDIO)):r.indexOf("iphone")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0?(e.Capabilities.$os="iOS",i._System_OS=a.IOS,i.getIOSVersion()>=7&&(i._canUseBlob=!0,l&&o&&i.setAudioType(n.WEB_AUDIO))):-1!=r.indexOf("windows nt")?e.Capabilities.$os="Windows PC":-1!=r.indexOf("mac os")&&(e.Capabilities.$os="Mac OS");var h=window.URL||window.webkitURL;h||(i._canUseBlob=!1),r.indexOf("egretnative")>=0&&(i.setAudioType(n.HTML5_AUDIO),i._canUseBlob=!0),e.Sound=i._AudioClass},i.setAudioType=function(t){switch(i._audioType=t,t){case n.WEB_AUDIO:i._AudioClass=e.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=e.web.HtmlSound}},i.getIOSVersion=function(){var e=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];return parseInt(e.match(/\d+(_\d)*/)[0])||0},i.checkHtml5Support=function(){var t=(navigator.language||navigator.browserLanguage).toLowerCase(),r=t.split("-");r.length>1&&(r[1]=r[1].toUpperCase()),e.Capabilities.$language=r.join("-")},i._canUseBlob=!1,i._audioType=0,i._System_OS=0,i.ua="",i}(e.HashObject);t.Html5Capatibility=o,__reflect(o.prototype,"egret.web.Html5Capatibility");var s=null;t.getPrefixStyleName=r,t.getPrefix=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e){e.onStart(c),l=e}function i(){if(h)for(var e=document.querySelectorAll(".egret-player"),t=e.length,r=0;t>r;r++){var i=e[r],n=i["egret-player"];n.updateScreenSize()}}function n(r){if(!h){if(h=!0,r||(r={}),t.Html5Capatibility._audioType=r.audioType,t.Html5Capatibility.$init(),"webgl"==r.renderMode){var i=r.antialias;t.WebGLRenderContext.antialias=!!i}e.sys.CanvasRenderBuffer=t.CanvasRenderBuffer,a(r.renderMode);var n;if(r.canvasScaleFactor)n=r.canvasScaleFactor;else if(r.calculateCanvasScaleFactor)n=r.calculateCanvasScaleFactor(e.sys.canvasHitTestBuffer.context);else{var l=e.sys.canvasHitTestBuffer.context,c=l.backingStorePixelRatio||l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1;n=(window.devicePixelRatio||1)/c}e.sys.DisplayList.$canvasScaleFactor=n;var d=e.ticker;o(d),r.screenAdapter?e.sys.screenAdapter=r.screenAdapter:e.sys.screenAdapter||(e.sys.screenAdapter=new e.sys.DefaultScreenAdapter);for(var p=document.querySelectorAll(".egret-player"),f=p.length,g=0;f>g;g++){var v=p[g],y=new t.WebPlayer(v,r);v["egret-player"]=y,"webgl"==e.Capabilities.$renderMode&&(y.stage.dirtyRegionPolicy=e.DirtyRegionPolicy.OFF)}"webgl"==e.Capabilities.$renderMode&&(e.sys.DisplayList.prototype.setDirtyRegionPolicy=function(){}),window.addEventListener("resize",function(){isNaN(u)&&(u=window.setTimeout(s,300))})}}function a(r){"webgl"==r&&e.WebGLUtils.checkCanUseWebGL()?(e.sys.RenderBuffer=t.WebGLRenderBuffer,e.sys.systemRenderer=new t.WebGLRenderer,e.sys.canvasRenderer=new e.CanvasRenderer,e.sys.customHitTestBuffer=new t.WebGLRenderBuffer(3,3),e.sys.canvasHitTestBuffer=new t.CanvasRenderBuffer(3,3),e.Capabilities.$renderMode="webgl"):(e.sys.RenderBuffer=t.CanvasRenderBuffer,e.sys.systemRenderer=new e.CanvasRenderer,e.sys.canvasRenderer=e.sys.systemRenderer,e.sys.customHitTestBuffer=new t.CanvasRenderBuffer(3,3),e.sys.canvasHitTestBuffer=e.sys.customHitTestBuffer,e.Capabilities.$renderMode="canvas")}function o(e){function t(){l&&l.onRender(c),e.update(),r(t)}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;r||(r=function(e){return window.setTimeout(e,1e3/60)}),r(t)}function s(){u=0/0,e.updateAllScreens(),l&&l.onResize(c)}var l,c={setAutoClear:function(e){t.WebGLRenderBuffer.autoClear=e},save:function(){},restore:function(){var e=t.WebGLRenderContext.getInstance(0,0),r=e.context;r.bindBuffer(r.ARRAY_BUFFER,e.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer),r.activeTexture(r.TEXTURE0),e.currentProgram=null,e.bindIndices=!1;var i=e.$bufferStack[1];e.activateBuffer(i),r.enable(r.BLEND),e.setBlendMode("source-over")}};e.setRendererContext=r;var h=!1;window.isNaN=function(e){return e=+e,e!==e},e.runEgret=n,e.updateAllScreens=i;var u=0/0}(t=e.web||(e.web={}))}(egret||(egret={}));var language,egret;!function(e){var t;!function(t){var r=function(){function t(){}return t.detect=function(){var r=e.Capabilities,i=navigator.userAgent.toLowerCase();r.$isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),r.$isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?r.$os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?r.$os="Android":-1!=i.indexOf("windows")&&(r.$os="Windows Phone"):-1!=i.indexOf("windows nt")?r.$os="Windows PC":-1!=i.indexOf("mac os")&&(r.$os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),a=n.split("-");a.length>1&&(a[1]=a[1].toUpperCase()),r.$language=a.join("-"),t.injectUIntFixOnIE9()},t.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var e="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(e)}},t}();t.WebCapability=r,__reflect(r.prototype,"egret.web.WebCapability"),r.detect()}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(){function e(){}return e.call=function(e,t){},e.addCallback=function(e,t){},e}();t.WebExternalInterface=r,__reflect(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var i=navigator.userAgent.toLowerCase();i.indexOf("egretnative")<0&&(e.ExternalInterface=r)}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){function r(t){var r=JSON.parse(t),n=r.functionName,a=i[n];if(a){var o=r.value;a.call(null,o)}else e.$warn(1050,n)}var i={},n=function(){function e(){}return e.call=function(e,t){var r={};r.functionName=e,r.value=t,egret_native.sendInfoToPlugin(JSON.stringify(r))},e.addCallback=function(e,t){i[e]=t},e}();t.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);var a=navigator.userAgent.toLowerCase();a.indexOf("egretnative")>=0&&(e.ExternalInterface=n,egret_native.receivedPluginInfo=r)}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){var r={},i=function(){function t(){}return t.call=function(e,t){__global.ExternalInterface.call(e,t)},t.addCallback=function(e,t){r[e]=t},t.invokeCallback=function(t,i){var n=r[t];n?n.call(null,i):e.$warn(1050,t)},t}();t.WebViewExternalInterface=i,__reflect(i.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(e.ExternalInterface=i)}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e){if(window.location){var t=location.search;if(""==t)return"";t=t.slice(1);for(var r=t.split("&"),i=r.length,n=0;i>n;n++){var a=r[n],o=a.split("=");if(o[0]==e)return o[1]}}return""}t.getOption=r,e.getOption=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(e,t){var i=r.call(this)||this;return i.init(e,t),i.initOrientation(),i}return __extends(i,r),i.prototype.init=function(r,i){var n=this.readOption(r,i),a=new e.Stage;a.$screen=this,a.$scaleMode=n.scaleMode,a.$orientation=n.orientation,a.$maxTouches=n.maxTouches,a.frameRate=n.frameRate,a.textureScaleFactor=n.textureScaleFactor;var o=new e.sys.RenderBuffer(void 0,void 0,!0),s=o.surface;this.attachCanvas(r,s);var l=new t.WebTouchHandler(a,s),c=new e.sys.Player(o,a,n.entryClassName);e.lifecycle.stage=a,e.lifecycle.addLifecycleListener(t.WebLifeCycleHandler);var h=new t.HTMLInput;c.showPaintRect(n.showPaintRect),(n.showFPS||n.showLog)&&c.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles),this.playerOption=n,this.container=r,this.canvas=s,this.stage=a,this.player=c,this.webTouchHandler=l,this.webInput=h,e.web.$cacheTextAdapter(h,a,r,s),this.updateScreenSize(),this.updateMaxTouches(),c.start()},i.prototype.initOrientation=function(){var t=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){e.StageOrientationEvent.dispatchStageOrientationEvent(t.stage,e.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},i.prototype.readOption=function(t,r){var i={};i.entryClassName=t.getAttribute("data-entry-class"),i.scaleMode=t.getAttribute("data-scale-mode")||e.StageScaleMode.NO_SCALE,i.frameRate=+t.getAttribute("data-frame-rate")||30,i.contentWidth=+t.getAttribute("data-content-width")||480,i.contentHeight=+t.getAttribute("data-content-height")||800,i.orientation=t.getAttribute("data-orientation")||e.OrientationMode.AUTO,i.maxTouches=+t.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+t.getAttribute("texture-scale-factor")||1,"webgl"==r.renderMode?i.showPaintRect=!1:i.showPaintRect="true"==t.getAttribute("data-show-paint-rect"),i.showFPS="true"==t.getAttribute("data-show-fps");for(var n=t.getAttribute("data-show-fps-style")||"",a=n.split(","),o={},s=0;s<a.length;s++){var l=a[s].split(":");o[l[0]]=l[1]}return i.fpsStyles=o,i.showLog="true"==t.getAttribute("data-show-log"),i.logFilter=t.getAttribute("data-log-filter"),i},i.prototype.attachCanvas=function(e,t){var r=t.style;r.cursor="inherit",r.position="absolute",r.top="0",r.bottom="0",r.left="0",r.right="0",e.appendChild(t),r=e.style,r.overflow="hidden",r.position="absolute"},i.prototype.updateScreenSize=function(){var t=this.canvas;if(!t.userTyping){var r=this.playerOption,i=this.container.getBoundingClientRect(),n=0,a=i.width,o=i.height;i.top<0&&(o+=i.top,n=-i.top);var s=!1,l=this.stage.$orientation;l!=e.OrientationMode.AUTO&&(s=l!=e.OrientationMode.PORTRAIT&&o>a||l==e.OrientationMode.PORTRAIT&&a>o);var c=s?o:a,h=s?a:o;e.Capabilities.$boundingClientWidth=c,e.Capabilities.$boundingClientHeight=h;var u=e.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,c,h,r.contentWidth,r.contentHeight),d=u.stageWidth,p=u.stageHeight,f=u.displayWidth,g=u.displayHeight;t.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",t.width!=d&&(t.width=d),t.height!=p&&(t.height=p);var v=0;s?l==e.OrientationMode.LANDSCAPE?(v=90,t.style.top=n+(o-f)/2+"px",t.style.left=(a+g)/2+"px"):(v=-90,t.style.top=n+(o+f)/2+"px",t.style.left=(a-g)/2+"px"):(t.style.top=n+(o-g)/2+"px",t.style.left=(a-f)/2+"px");var y=f/d,m=g/p,x=y*e.sys.DisplayList.$canvasScaleFactor,b=m*e.sys.DisplayList.$canvasScaleFactor;"canvas"==e.Capabilities.$renderMode&&(x=Math.ceil(x),b=Math.ceil(b));var w=new e.Matrix;w.scale(y/x,m/b),w.rotate(v*Math.PI/180);var E="matrix("+w.a+","+w.b+","+w.c+","+w.d+","+w.tx+","+w.ty+")";t.style[e.web.getPrefixStyleName("transform")]=E,e.sys.DisplayList.$setCanvasScale(x,b),this.webTouchHandler.updateScaleMode(y,m,v),this.webInput.$updateSize(),this.player.updateStageSize(d,p)}},i.prototype.setContentSize=function(e,t){var r=this.playerOption;r.contentWidth=e,r.contentHeight=t,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(e.HashObject);t.WebPlayer=r,__reflect(r.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(t,r){s||(s=document.createElement("canvas"),l=s.getContext("2d"));var i=t.$getTextureWidth(),n=t.$getTextureHeight();null==r&&(r=e.$TempRectangle,r.x=0,r.y=0,r.width=i,r.height=n),r.x=Math.min(r.x,i-1),r.y=Math.min(r.y,n-1),r.width=Math.min(r.width,i-r.x),r.height=Math.min(r.height,n-r.y);var a=r.width,o=r.height,c=s;if(c.style.width=a+"px",c.style.height=o+"px",s.width=a,s.height=o,"webgl"==e.Capabilities.$renderMode){var h=void 0;t.$renderBuffer?h=t:(h=new e.RenderTexture,h.drawToTexture(new e.Bitmap(t)));for(var u=h.$renderBuffer.getPixels(r.x,r.y,a,o),d=new ImageData(a,o),p=0;p<u.length;p++)d.data[p]=u[p];return l.putImageData(d,0,0),t.$renderBuffer||h.dispose(),c}var f=t,g=Math.round(f._offsetX),v=Math.round(f._offsetY),y=f._bitmapWidth,m=f._bitmapHeight;return l.drawImage(f._bitmapData.source,f._bitmapX+r.x/e.$TextureScaleFactor,f._bitmapY+r.y/e.$TextureScaleFactor,y*r.width/i,m*r.height/n,g,v,r.width,r.height),c}function i(t,i,n){try{var a=r(this,i),o=a.toDataURL(t,n);return o}catch(s){e.$error(1033)}return null}function n(e,t,r,n){var a=i.call(this,e,r,n);if(null!=a){var o=a.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=t,s.href=o;var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}function a(t,r){return e.$warn(1041,"getPixel32","getPixels"),this.getPixels(t,r)}function o(t,i,n,a){void 0===n&&(n=1),void 0===a&&(a=1);try{var o=(r(this),l.getImageData(t,i,n,a).data);return o}catch(s){e.$error(1039)}}var s,l;e.Texture.prototype.toDataURL=i,e.Texture.prototype.saveToFile=n,e.Texture.prototype.getPixel32=a,e.Texture.prototype.getPixels=o}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e){for(var t=s.parseFromString(e,"text/xml"),r=t.childNodes.length,n=0;r>n;n++){var a=t.childNodes[n];if(1==a.nodeType)return i(a,null)}return null}function i(e,t){if("parsererror"==e.localName)throw new Error(e.textContent);for(var r=new a(e.localName,t,e.prefix,e.namespaceURI,e.nodeName),n=e.attributes,s=r.attributes,l=n.length,c=0;l>c;c++){var h=n[c],u=h.name;0!=u.indexOf("xmlns:")&&(s[u]=h.value,r["$"+u]=h.value)}var d=e.childNodes;l=d.length;for(var p=r.children,c=0;l>c;c++){var f=d[c],g=f.nodeType,v=null;if(1==g)v=i(f,r);else if(3==g){var y=f.textContent.trim();y&&(v=new o(y,r))}v&&p.push(v)}return r}var n=function(){function e(e,t){this.nodeType=e,this.parent=t}return e}();t.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var a=function(e){function t(t,r,i,n,a){var o=e.call(this,1,r)||this;return o.attributes={},o.children=[],o.localName=t,o.prefix=i,o.namespace=n,o.name=a,o}return __extends(t,e),t}(n);t.XML=a,__reflect(a.prototype,"egret.web.XML");var o=function(e){function t(t,r){var i=e.call(this,3,r)||this;return i.text=t,i}return __extends(t,e),t}(n);t.XMLText=o,__reflect(o.prototype,"egret.web.XMLText");var s=new DOMParser;e.XML={parse:r}}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.onChange=function(t){var i=new e.OrientationEvent(e.Event.CHANGE);i.beta=t.beta,i.gamma=t.gamma,i.alpha=t.alpha,r.dispatchEvent(i)},r}return __extends(r,t),r.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},r}(e.EventDispatcher);t.WebDeviceOrientation=r,__reflect(r.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(t=e.web||(e.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(e){var t;!function(t){var r=function(t){function r(r){var i=t.call(this)||this;return i.onUpdate=function(t){var r=new e.GeolocationEvent(e.Event.CHANGE),n=t.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(t){var r=e.GeolocationEvent.UNAVAILABLE;t.code==t.PERMISSION_DENIED&&(r=e.GeolocationEvent.PERMISSION_DENIED);var n=new e.GeolocationEvent(e.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=t.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(r,t),r.prototype.start=function(){var t=this.geolocation;t?this.watchId=t.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:e.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){var e=this.geolocation;e.clearWatch(this.watchId)},r}(e.EventDispatcher);t.WebGeolocation=r,__reflect(r.prototype,"egret.web.WebGeolocation",["egret.Geolocation"]),e.Geolocation=e.web.WebGeolocation}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.onChange=function(t){var i=new e.MotionEvent(e.Event.CHANGE),n={x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},a={x:t.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z},o={alpha:t.rotationRate.alpha,beta:t.rotationRate.beta,gamma:t.rotationRate.gamma};i.acceleration=n,i.accelerationIncludingGravity=a,i.rotationRate=o,r.dispatchEvent(i)},r}return __extends(r,t),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},r}(e.EventDispatcher);t.WebMotion=r,__reflect(r.prototype,"egret.web.WebMotion",["egret.Motion"]),e.Motion=e.web.WebMotion}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(){this.drawData=[],this.drawDataLen=0}return e.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var e=this.drawData[this.drawDataLen]||{};e.type=1,e.count=0,this.drawData[this.drawDataLen]=e,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},e.prototype.pushDrawTexture=function(e,t,r,i,n){if(void 0===t&&(t=2),r){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=e,a.filter=r,a.count=t,a.textureWidth=i,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||e!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=e,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=t}},e.prototype.pushChangeSmoothing=function(e,t){e.smoothing=t;var r=this.drawData[this.drawDataLen]||{};r.type=10,r.texture=e,r.smoothing=t,this.drawData[this.drawDataLen]=r,this.drawDataLen++},e.prototype.pushPushMask=function(e){void 0===e&&(e=1);var t=this.drawData[this.drawDataLen]||{};t.type=2,t.count=2*e,this.drawData[this.drawDataLen]=t,this.drawDataLen++},e.prototype.pushPopMask=function(e){void 0===e&&(e=1);var t=this.drawData[this.drawDataLen]||{};t.type=3,t.count=2*e,this.drawData[this.drawDataLen]=t,this.drawDataLen++},e.prototype.pushSetBlend=function(e){for(var t=this.drawDataLen,r=!1,i=t-1;i>=0;i--){var n=this.drawData[i];if(n){if((0==n.type||1==n.type)&&(r=!0),!r&&4==n.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==e)return;break}}}var a=this.drawData[this.drawDataLen]||{};a.type=4,a.value=e,this.drawData[this.drawDataLen]=a,this.drawDataLen++},e.prototype.pushResize=function(e,t,r){var i=this.drawData[this.drawDataLen]||{};
i.type=5,i.buffer=e,i.width=t,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},e.prototype.pushClearColor=function(){var e=this.drawData[this.drawDataLen]||{};e.type=6,this.drawData[this.drawDataLen]=e,this.drawDataLen++},e.prototype.pushActivateBuffer=function(e){for(var t=this.drawDataLen,r=!1,i=t-1;i>=0;i--){var n=this.drawData[i];!n||(4!=n.type&&7!=n.type&&(r=!0),r||7!=n.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var a=this.drawData[this.drawDataLen]||{};a.type=7,a.buffer=e,a.width=e.rootRenderTarget.width,a.height=e.rootRenderTarget.height,this.drawData[this.drawDataLen]=a,this.drawDataLen++},e.prototype.pushEnableScissor=function(e,t,r,i){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=e,n.y=t,n.width=r,n.height=i,this.drawData[this.drawDataLen]=n,this.drawDataLen++},e.prototype.pushDisableScissor=function(){var e=this.drawData[this.drawDataLen]||{};e.type=9,this.drawData[this.drawDataLen]=e,this.drawDataLen++},e.prototype.clear=function(){for(var e=0;e<this.drawDataLen;e++){var t=this.drawData[e];t.type=0,t.count=0,t.texture=null,t.filter=null,t.uv=null,t.value="",t.buffer=null,t.width=0,t.height=0}this.drawDataLen=0},e}();e.WebGLDrawCmdManager=t,__reflect(t.prototype,"egret.web.WebGLDrawCmdManager")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var e=this.vertexMaxSize*this.vertSize,t=this.indicesMaxSize;this.vertices=new Float32Array(e),this.indices=new Uint16Array(t),this.indicesForMesh=new Uint16Array(t);for(var r=0,i=0;t>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return e.prototype.reachMaxSize=function(e,t){return void 0===e&&(e=4),void 0===t&&(t=6),this.vertexIndex>this.vertexMaxSize-e||this.indexIndex>this.indicesMaxSize-t},e.prototype.getVertices=function(){var e=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return e},e.prototype.getIndices=function(){return this.indices},e.prototype.getMeshIndices=function(){return this.indicesForMesh},e.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var e=0,t=this.indexIndex;t>e;++e)this.indicesForMesh[e]=this.indices[e];this.hasMesh=!0}},e.prototype.isMesh=function(){return this.hasMesh},e.prototype.cacheArrays=function(e,t,r,i,n,a,o,s,l,c,h,u,d,p,f,g){var v=e,y=v.a,m=v.b,x=v.c,b=v.d,w=v.tx,E=v.ty;p||((0!=o||0!=s)&&v.append(1,0,0,1,o,s),(n/l!=1||a/c!=1)&&v.append(l/n,0,0,c/a,0,0));var T=v.a,_=v.b,S=v.c,C=v.d,L=v.tx,R=v.ty;if(v.a=y,v.b=m,v.c=x,v.d=b,v.tx=w,v.ty=E,p){var A=this.vertices,D=this.vertexIndex*this.vertSize,O=0,I=0,M=0,B=0,$=0,P=0,F=0;for(O=0,M=d.length;M>O;O+=2)I=D+5*O/2,P=p[O],F=p[O+1],B=d[O],$=d[O+1],A[I+0]=T*P+S*F+L,A[I+1]=_*P+C*F+R,g?(A[I+2]=(r+(1-$)*a)/h,A[I+3]=(i+B*n)/u):(A[I+2]=(r+B*n)/h,A[I+3]=(i+$*a)/u),A[I+4]=t;if(this.hasMesh)for(var G=0,W=f.length;W>G;++G)this.indicesForMesh[this.indexIndex+G]=f[G]+this.vertexIndex;this.vertexIndex+=d.length/2,this.indexIndex+=f.length}else{var N=h,H=u,U=n,k=a;r/=N,i/=H;var A=this.vertices,D=this.vertexIndex*this.vertSize;if(g){var V=n;n=a/N,a=V/H,A[D++]=L,A[D++]=R,A[D++]=n+r,A[D++]=i,A[D++]=t,A[D++]=T*U+L,A[D++]=_*U+R,A[D++]=n+r,A[D++]=a+i,A[D++]=t,A[D++]=T*U+S*k+L,A[D++]=C*k+_*U+R,A[D++]=r,A[D++]=a+i,A[D++]=t,A[D++]=S*k+L,A[D++]=C*k+R,A[D++]=r,A[D++]=i,A[D++]=t}else n/=N,a/=H,A[D++]=L,A[D++]=R,A[D++]=r,A[D++]=i,A[D++]=t,A[D++]=T*U+L,A[D++]=_*U+R,A[D++]=n+r,A[D++]=i,A[D++]=t,A[D++]=T*U+S*k+L,A[D++]=C*k+_*U+R,A[D++]=n+r,A[D++]=a+i,A[D++]=t,A[D++]=S*k+L,A[D++]=C*k+R,A[D++]=r,A[D++]=a+i,A[D++]=t;if(this.hasMesh){var z=this.indicesForMesh;z[this.indexIndex+0]=0+this.vertexIndex,z[this.indexIndex+1]=1+this.vertexIndex,z[this.indexIndex+2]=2+this.vertexIndex,z[this.indexIndex+3]=0+this.vertexIndex,z[this.indexIndex+4]=2+this.vertexIndex,z[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},e.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},e}();e.WebGLVertexArrayObject=t,__reflect(t.prototype,"egret.web.WebGLVertexArrayObject")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(e){function t(t,r,i){var n=e.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n.width=r||1,n.height=i||1,n}return __extends(t,e),t.prototype.resize=function(e,t){var r=this.gl;this.width=e,this.height=t,this.frameBuffer&&(r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e,t,0,r.RGBA,r.UNSIGNED_BYTE,null)),this.stencilBuffer&&(r.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},t.prototype.activate=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer())},t.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},t.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var e=this.gl;this.texture=this.createTexture(),this.frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0)}},t.prototype.createTexture=function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t},t.prototype.clear=function(e){var t=this.gl;e&&this.activate(),t.colorMask(!0,!0,!0,!0),t.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),t.clear(t.COLOR_BUFFER_BIT)},t.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencilBuffer)}},t}(e.HashObject);t.WebGLRenderTarget=r,__reflect(r.prototype,"egret.web.WebGLRenderTarget")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e,t){var r=document.createElement("canvas");return isNaN(e)||isNaN(t)||(r.width=e,r.height=t),r}var i=function(){function i(e,i){this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.surface=r(e,i),this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new t.WebGLDrawCmdManager,this.vao=new t.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}return i.getInstance=function(e,t){return this.instance?this.instance:(this.instance=new i(e,t),this.instance)},i.prototype.pushBuffer=function(e){this.$bufferStack.push(e),e!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(e)),this.currentBuffer=e},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var e=this.$bufferStack.pop(),t=this.$bufferStack[this.$bufferStack.length-1];e!=t&&this.drawCmdManager.pushActivateBuffer(t),this.currentBuffer=t}},i.prototype.activateBuffer=function(e){e.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),e.restoreStencil(),e.restoreScissor(),this.onResize(e.width,e.height)},i.prototype.uploadVerticesArray=function(e){var t=this.context;t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(e){var t=this.context;t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(e,t){e=e||this.surface.width,t=t||this.surface.height,this.projectionX=e/2,this.projectionY=-t/2,this.context&&this.context.viewport(0,0,e,t)},i.prototype.resize=function(e,t,r){var i=this.surface;r?(i.width<e&&(i.width=e),i.height<t&&(i.height=t)):(i.width!=e&&(i.width=e),i.height!=t&&(i.height=t)),this.onResize()},i.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var e=this.context;this.$maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){for(var t,r={antialias:i.antialias,stencil:!0},n=["webgl","experimental-webgl"],a=0;a<n.length;a++){try{t=this.surface.getContext(n[a],r)}catch(o){}if(t)break}t||e.$error(1021),this.setContext(t)},i.prototype.setContext=function(e){this.context=e,e.id=i.glContextId++,this.glID=e.id,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.colorMask(!0,!0,!0,!0),e.activeTexture(e.TEXTURE0)},i.prototype.enableStencilTest=function(){var e=this.context;e.enable(e.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var e=this.context;e.disable(e.STENCIL_TEST)},i.prototype.enableScissorTest=function(e){var t=this.context;t.enable(t.SCISSOR_TEST),t.scissor(e.x,e.y,e.width,e.height)},i.prototype.disableScissorTest=function(){var e=this.context;e.disable(e.SCISSOR_TEST)},i.prototype.getPixels=function(e,t,r,i,n){var a=this.context;a.readPixels(e,t,r,i,a.RGBA,a.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(e){var t=this.context,r=t.createTexture();return r?(r.glContext=t,t.bindTexture(t.TEXTURE_2D,r),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r):void(this.contextLost=!0)},i.prototype.createTextureFromCompressedData=function(e,t,r,i,n){return null},i.prototype.updateTexture=function(e,t){var r=this.context;r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)},i.prototype.getWebGLTexture=function(e){return e.webGLTexture||("image"==e.format?e.webGLTexture=this.createTexture(e.source):"pvr"==e.format&&(e.webGLTexture=this.createTextureFromCompressedData(e.source.pvrtcData,e.width,e.height,e.source.mipmapsCount,e.source.format)),e.$deleteSource&&e.webGLTexture&&(e.source=null),e.webGLTexture.smoothing=!0),e.webGLTexture},i.prototype.clearRect=function(e,t,r,i){if(0!=e||0!=t||r!=this.surface.width||i!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(e,t,r,i),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(e=e*a.a+a.tx,t=t*a.d+a.ty,r*=a.a,i*=a.d,this.enableScissor(e,-t-i+n.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(e,t,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(e){this.drawCmdManager.pushSetBlend(e)},i.prototype.drawImage=function(e,t,r,i,n,a,o,s,l,c,h,u,d){var p=this.currentBuffer;if(!this.contextLost&&e&&p){var f;if(e.texture||e.source&&e.source.texture)f=e.texture||e.source.texture,p.saveTransform(),p.transform(1,0,0,-1,0,l+2*o);else{if(!e.source&&!e.webGLTexture)return;f=this.getWebGLTexture(e)}f&&(this.drawTexture(f,t,r,i,n,a,o,s,l,c,h,void 0,void 0,void 0,void 0,u,d),e.source&&e.source.texture&&p.restoreTransform())}},i.prototype.drawMesh=function(e,t,r,i,n,a,o,s,l,c,h,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&e&&y){var m;if(e.texture||e.source&&e.source.texture)m=e.texture||e.source.texture,y.saveTransform(),y.transform(1,0,0,-1,0,l+2*o);else{if(!e.source&&!e.webGLTexture)return;m=this.getWebGLTexture(e)}m&&(this.drawTexture(m,t,r,i,n,a,o,s,l,c,h,u,d,p,f,g,v),(e.texture||e.source&&e.source.texture)&&y.restoreTransform())}},i.prototype.drawTexture=function(e,t,r,i,n,a,o,s,l,c,h,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&e&&y){d&&p?this.vao.reachMaxSize(d.length/2,p.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=v&&e.smoothing!=v&&this.drawCmdManager.pushChangeSmoothing(e,v),u&&this.vao.changeToMeshIndices();var m=y.globalMatrix,x=y.globalAlpha,b=p?p.length/3:2;this.drawCmdManager.pushDrawTexture(e,b,this.$filter),this.vao.cacheArrays(m,x,t,r,i,n,a,o,s,l,c,h,u,d,p,g)}},i.prototype.drawRect=function(e,t,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(n.globalMatrix,n.globalAlpha,0,0,r,i,e,t,r,i,r,i))},i.prototype.pushMask=function(e){var t=this.currentBuffer;if(!this.contextLost&&t){t.$stencilList.push(e),this.vao.reachMaxSize()&&this.$drawWebGL();var r=e.length;if(r){this.drawCmdManager.pushPushMask(r);for(var i=0;r>i;i++){var n=e[i];this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,n.width,n.height,n.minX,n.minY,n.width,n.height,n.width,n.height)}}else this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.popMask=function(){var e=this.currentBuffer;if(!this.contextLost&&e){var t=e.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL();var r=t.length;if(r){this.drawCmdManager.pushPopMask(r);for(var i=0;r>i;i++){var n=t[i];this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,n.width,n.height,n.minX,n.minY,n.width,n.height,n.width,n.height)}}else this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,t.width,t.height,t.x,t.y,t.width,t.height,t.width,t.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(e,t,r,i){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(e,t,r,i),n.$hasScissor=!0},i.prototype.disableScissor=function(){var e=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),e.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var e=this.drawCmdManager.drawDataLen,t=0,r=0;e>r;r++){var i=this.drawCmdManager.drawData[r];t=this.drawData(i,t),7==i.type&&(this.activatedBuffer=i.buffer),(0==i.type||1==i.type||2==i.type||3==i.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(e,r){if(e){var i,n=this.context,a=e.filter;switch(e.type){case 0:a?"custom"===a.type?i=t.EgretWebGLProgram.getProgram(n,a.$vertexSrc,a.$fragmentSrc,a.$shaderKey):"colorTransform"===a.type?i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===a.type?i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.blur_frag,"blur"):"blurY"===a.type?i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.blur_frag,"blur"):"glow"===a.type&&(i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.glow_frag,"glow")):i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.texture_frag,"texture"),this.activeProgram(n,i),this.syncUniforms(i,a,e.textureWidth,e.textureHeight),r+=this.drawTextureElements(e,r);break;case 1:i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,e.textureWidth,e.textureHeight),r+=this.drawRectElements(e,r);break;case 2:i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,e.textureWidth,e.textureHeight),r+=this.drawPushMaskElements(e,r);break;case 3:i=t.EgretWebGLProgram.getProgram(n,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,e.textureWidth,e.textureHeight),r+=this.drawPopMaskElements(e,r);break;case 4:this.setBlendMode(e.value);break;case 5:e.buffer.rootRenderTarget.resize(e.width,e.height),this.onResize(e.width,e.height);break;case 6:if(this.activatedBuffer){var o=this.activatedBuffer.rootRenderTarget;(0!=o.width||0!=o.height)&&o.clear(!0)}break;case 7:this.activateBuffer(e.buffer);break;case 8:var s=this.activatedBuffer;s&&(s.rootRenderTarget&&s.rootRenderTarget.enabledStencil(),s.enableScissor(e.x,e.y,e.width,e.height));break;case 9:s=this.activatedBuffer,s&&s.disableScissor();break;case 10:n.bindTexture(n.TEXTURE_2D,e.texture),e.smoothing?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST))}return r}},i.prototype.activeProgram=function(e,t){if(t!=this.currentProgram){e.useProgram(t.id);var r=t.attributes;for(var i in r)"aVertexPosition"===i?(e.vertexAttribPointer(r.aVertexPosition.location,2,e.FLOAT,!1,20,0),e.enableVertexAttribArray(r.aVertexPosition.location)):"aTextureCoord"===i?(e.vertexAttribPointer(r.aTextureCoord.location,2,e.FLOAT,!1,20,8),e.enableVertexAttribArray(r.aTextureCoord.location)):"aColor"===i&&(e.vertexAttribPointer(r.aColor.location,1,e.FLOAT,!1,20,16),e.enableVertexAttribArray(r.aColor.location));this.currentProgram=t}},i.prototype.syncUniforms=function(e,t,r,i){var n=e.uniforms;t&&"custom"===t.type;for(var a in n)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:r,y:i});else if("uSampler"===a);else{var o=t.$uniforms[a];void 0!==o&&n[a].setValue(o)}},i.prototype.drawTextureElements=function(e,t){var r=this.context;r.bindTexture(r.TEXTURE_2D,e.texture);var i=3*e.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),i},i.prototype.drawRectElements=function(e,t){var r=this.context,i=3*e.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),i},i.prototype.drawPushMaskElements=function(e,t){var r=this.context,i=3*e.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),r.stencilFunc(r.EQUAL,a+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.drawPopMaskElements=function(e,t){var r=this.context,i=3*e.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),r.stencilFunc(r.EQUAL,a,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.setBlendMode=function(e){var t=this.context,r=i.blendModesForGL[e];r&&t.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(e,r){var i,n=r,a=e.length;if(a>1)for(var o=0;a-1>o;o++){var s=e[o],l=r.rootRenderTarget.width,c=r.rootRenderTarget.height;i=t.WebGLRenderBuffer.create(l,c),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this.drawToRenderTarget(s,r,i),r!=n&&t.WebGLRenderBuffer.release(r),r=i}var h=e[a-1];this.drawToRenderTarget(h,r,this.currentBuffer),r!=n&&t.WebGLRenderBuffer.release(r)},i.prototype.drawToRenderTarget=function(e,r,i){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(i);var n,a=r,o=r.rootRenderTarget.width,s=r.rootRenderTarget.height;if("blur"==e.type){var l=e.blurXFilter,c=e.blurYFilter;0!=l.blurX&&0!=c.blurY?(n=t.WebGLRenderBuffer.create(o,s),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(e.blurXFilter,r,n),r!=a&&t.WebGLRenderBuffer.release(r),r=n,e=c):e=0===l.blurX?c:l}i.saveTransform(),i.transform(1,0,0,-1,0,s),this.vao.cacheArrays(i.globalMatrix,i.globalAlpha,0,0,o,s,0,0,o,s,o,s),i.restoreTransform(),this.drawCmdManager.pushDrawTexture(r.rootRenderTarget.texture,2,e,o,s),r!=a&&t.WebGLRenderBuffer.release(r),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();t.WebGLRenderContext=i,__reflect(i.prototype,"egret.web.WebGLRenderContext"),i.initBlendMode()}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function n(i,n,a){var o=r.call(this)||this;if(o.globalAlpha=1,o.stencilState=!1,o.$stencilList=[],o.stencilHandleCount=0,o.$scissorState=!1,o.scissorRect=new e.Rectangle,o.$hasScissor=!1,o.dirtyRegionPolicy=!0,o._dirtyRegionPolicy=!0,o.$drawCalls=0,o.$computeDrawCall=!1,o.globalMatrix=new e.Matrix,o.savedGlobalMatrix=new e.Matrix,o.context=t.WebGLRenderContext.getInstance(i,n),o.rootRenderTarget=new t.WebGLRenderTarget(o.context.context,3,3),i&&n&&o.resize(i,n),o.root=a,o.root)o.context.pushBuffer(o),o.surface=o.context.surface;else{var s=o.context.activatedBuffer;s&&s.rootRenderTarget.activate(),o.rootRenderTarget.initFrameBuffer(),o.surface=o.rootRenderTarget}return o}return __extends(n,r),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(e,t,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(e,t,r,i),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(e,t,r){this.context.pushBuffer(this),e=e||1,t=t||1,(e!=this.rootRenderTarget.width||t!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,e,t),this.rootRenderTarget.width=e,this.rootRenderTarget.height=t),this.root&&this.context.resize(e,t,r),this.context.clear(),this.context.popBuffer()},n.prototype.resizeTo=function(e,t,r,i){this.context.pushBuffer(this);var a=this.rootRenderTarget.width,o=this.rootRenderTarget.height,s=n.create(a,o);this.context.pushBuffer(s),this.context.drawImage(this.rootRenderTarget,0,0,a,o,0,0,a,o,a,o,!1),this.context.popBuffer(),this.resize(e,t),this.setTransform(1,0,0,1,0,0),this.context.drawImage(s.rootRenderTarget,0,0,a,o,r,i,a,o,a,o,!1),n.release(s),this.context.popBuffer()},n.prototype.setDirtyRegionPolicy=function(e){this.dirtyRegionPolicy="on"==e},n.prototype.beginClip=function(e,t,r){this.context.pushBuffer(this),this.root&&(this._dirtyRegionPolicy?(this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate()):(this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),n.autoClear&&this.context.clear())),t=+t||0,r=+r||0,this.setTransform(1,0,0,1,t,r);e.length;this.maskPushed=!1,this.rootRenderTarget.useFrameBuffer&&this.context.clear(),this.context.popBuffer()},n.prototype.endClip=function(){(this.maskPushed||this.scissorEnabled)&&(this.context.pushBuffer(this),this.maskPushed&&(this.setTransform(1,0,0,1,this.offsetX,this.offsetY),this.context.popMask()),this.scissorEnabled&&this.context.disableScissor(),this.context.popBuffer())},n.prototype.getPixels=function(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var n=new Uint8Array(4*r*i),a=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(e,t,r,i,n),this.rootRenderTarget.useFrameBuffer=a,this.rootRenderTarget.activate();for(var o=new Uint8Array(4*r*i),s=0;i>s;s++)for(var l=0;r>l;l++)o[4*(r*(i-s-1)+l)]=n[4*(r*s+l)],o[4*(r*(i-s-1)+l)+1]=n[4*(r*s+l)+1],o[4*(r*(i-s-1)+l)+2]=n[4*(r*s+l)+2],o[4*(r*(i-s-1)+l)+3]=n[4*(r*s+l)+3];return o},n.prototype.toDataURL=function(e,t){return this.context.surface.toDataURL(e,t)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0,this.root&&(!this._dirtyRegionPolicy&&this.dirtyRegionPolicy&&this.drawSurfaceToFrameBuffer(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,!0),this._dirtyRegionPolicy&&this.drawFrameBufferToSurface(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height),this._dirtyRegionPolicy=this.dirtyRegionPolicy)},n.prototype.drawFrameBufferToSurface=function(e,t,r,i,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,e,t,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(e,t,r,i,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.context.surface,e,t,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.clear()},n.prototype.setTransform=function(e,t,r,i,n,a){var o=this.globalMatrix;o.a=e,o.b=t,o.c=r,o.d=i,o.tx=n,o.ty=a},n.prototype.transform=function(e,t,r,i,n,a){var o=this.globalMatrix,s=o.a,l=o.b,c=o.c,h=o.d;(1!=e||0!=t||0!=r||1!=i)&&(o.a=e*s+t*c,o.b=e*l+t*h,o.c=r*s+i*c,o.d=r*l+i*h),o.tx=n*s+a*c+o.tx,o.ty=n*l+a*h+o.ty},n.prototype.translate=function(e,t){var r=this.globalMatrix;r.tx+=e,r.ty+=t},n.prototype.saveTransform=function(){var e=this.globalMatrix,t=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.prototype.restoreTransform=function(){var e=this.globalMatrix,t=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.create=function(e,t){var r=i.pop();if(r){r.resize(e,t);var a=r.globalMatrix;a.a=1,a.b=0,a.c=0,a.d=1,a.tx=0,a.ty=0}else r=new n(e,t),r.$computeDrawCall=!1;return r},n.release=function(e){i.push(e)},n.autoClear=!0,n}(e.HashObject);t.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=["source-over","lighter","destination-out"],i="source-over",n=[],a=function(){function a(){this.nestLevel=0}return a.prototype.render=function(e,t,r,i,a){this.nestLevel++;var o=t,s=o.context,l=a?e:null;s.pushBuffer(o),this.drawDisplayObject(e,o,i,r,null,null,l),s.$drawWebGL();var c=o.$drawCalls;if(o.onRenderFinish(),s.popBuffer(),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var h=n.length,u=0;h>u;u++)n[u].resize(0,0)}return c},a.prototype.drawDisplayObject=function(t,r,i,n,a,o,s){var l,c=0;if(a&&!s?((a.isDirty||a.$canvasScaleX!=e.sys.DisplayList.$canvasScaleX||a.$canvasScaleY!=e.sys.DisplayList.$canvasScaleY)&&(c+=a.drawToSurface()),l=a.$renderNode):l=t.$getRenderNode(),l){if(i){var h=l.renderRegion;if(o&&!o.intersects(h))l.needRedraw=!1;else if(!l.needRedraw)for(var u=i.length,d=0;u>d;d++)if(h.intersects(i[d])){l.needRedraw=!0;break}}else l.needRedraw=!0;if(l.needRedraw){c++;var p=void 0,f=void 0;s?(p=t.$getConcatenatedAlphaAt(s,t.$getConcatenatedAlpha()),f=e.Matrix.create().copyFrom(t.$getConcatenatedMatrix()),t.$getConcatenatedMatrixAt(s,f)):(p=l.renderAlpha,f=e.Matrix.create().copyFrom(l.renderMatrix));var g=f.a*n.a,v=0,y=0,m=f.d*n.d,x=f.tx*n.a+n.tx*n.a,b=f.ty*n.d+n.ty*n.d;(0!==f.b||0!==f.c||0!==n.b||0!==n.c)&&(g+=f.b*n.c,m+=f.c*n.b,v+=f.a*n.b+f.b*n.d,y+=f.c*n.a+f.d*n.c,x+=f.ty*n.c,b+=f.tx*n.b),f.a=g,f.b=v,f.c=y,f.d=m,f.tx=x,f.ty=b,r.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),e.Matrix.release(f),r.globalAlpha=p,this.renderNode(l,r),l.needRedraw=!1}}if(a&&!s)return c;var w=t.$children;if(w)for(var E=w.length,T=0;E>T;T++){var _=w[T];if(!(!_.$visible||_.$alpha<=0||_.$maskedObject)){var S=_.$getFilters();S&&S.length>0?c+=this.drawWithFilter(_,r,i,n,o,s):0!==_.$blendMode||_.$mask&&(_.$mask.$parentDisplayList||s)?c+=this.drawWithClip(_,r,i,n,o,s):_.$scrollRect||_.$maskRect?c+=this.drawWithScrollRect(_,r,i,n,o,s):_.isFPS?(r.context.$drawWebGL(),r.$computeDrawCall=!1,this.drawDisplayObject(_,r,i,n,_.$displayList,o,s),r.context.$drawWebGL(),r.$computeDrawCall=!0):c+=this.drawDisplayObject(_,r,i,n,_.$displayList,o,s)}}return c},a.prototype.drawWithFilter=function(t,a,o,s,l,c){var h=0;if(!t.$children||0!=t.$children.length||t.$renderNode&&0!=t.$renderNode.$getRenderCount()){var u,d=t.$getFilters(),p=0!==t.$blendMode;p&&(u=r[t.$blendMode],u||(u=i));var f=t.$getOriginalBounds();if(f.width<=0||f.height<=0)return h;if(!t.mask&&1==d.length&&("colorTransform"==d[0].type||"custom"===d[0].type&&0===d[0].padding)){var g=this.getRenderCount(t);if(!t.$children||1==g)return p&&a.context.setGlobalCompositeOperation(u),a.context.$filter=d[0],h+=t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,a,o,s,l,c):this.drawDisplayObject(t,a,o,s,t.$displayList,l,c),a.context.$filter=null,p&&a.context.setGlobalCompositeOperation(i),h}var v=e.Matrix.create();v.copyFrom(t.$getConcatenatedMatrix()),c&&t.$getConcatenatedMatrixAt(c,v);var y;y=e.sys.Region.create(),y.updateRegion(f,v);var m=this.createRenderBuffer(y.width*s.a,y.height*s.d);m.context.pushBuffer(m),m.setTransform(s.a,0,0,s.d,-y.minX,-y.minY);var x=e.Matrix.create().setTo(s.a,0,0,s.d,-y.minX,-y.minY);return h+=t.$mask&&(t.$mask.$parentDisplayList||c)?this.drawWithClip(t,m,o,x,y,c):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,m,o,x,y,c):this.drawDisplayObject(t,m,o,x,t.$displayList,y,c),e.Matrix.release(x),m.context.popBuffer(),h>0&&(p&&a.context.setGlobalCompositeOperation(u),h++,a.globalAlpha=1,a.setTransform(1,0,0,1,(y.minX+s.tx)*s.a,(y.minY+s.ty)*s.d),a.context.drawTargetWidthFilters(d,m),p&&a.context.setGlobalCompositeOperation(i)),n.push(m),e.sys.Region.release(y),e.Matrix.release(v),h
}},a.prototype.getRenderCount=function(e){var t=0;if(e.$children)for(var r=0,i=e.$children;r<i.length;r++){var n=i[r],a=n.$getRenderNode();a&&(t+=a.$getRenderCount()),n.$children&&(t+=this.getRenderCount(n))}return t},a.prototype.drawWithClip=function(t,a,o,s,l,c){var h,u=0,d=0!==t.$blendMode;d&&(h=r[t.$blendMode],h||(h=i));var p=t.$scrollRect?t.$scrollRect:t.$maskRect,f=t.$mask;if(f){var g=f.$getRenderNode();if(g){var v=g.renderMatrix;if(0==v.a&&0==v.b||0==v.c&&0==v.d)return u}}var y,m=e.Matrix.create();if(m.copyFrom(t.$getConcatenatedMatrix()),c)t.$getConcatenatedMatrixAt(c,m);else if(t.$parentDisplayList){var x=t.$parentDisplayList.root;x!==t.$stage&&t.$getConcatenatedMatrixAt(x,m)}var b;if(f){b=f.$getOriginalBounds(),y=e.sys.Region.create();var w=e.Matrix.create();w.copyFrom(f.$getConcatenatedMatrix()),c&&f.$getConcatenatedMatrixAt(c,w),y.updateRegion(b,w),e.Matrix.release(w)}var E;if(p&&(E=e.sys.Region.create(),E.updateRegion(p,m)),E&&y?(E.intersect(y),e.sys.Region.release(y)):!E&&y&&(E=y),E){if(E.isEmpty()||l&&!l.intersects(E))return e.sys.Region.release(E),e.Matrix.release(m),u}else E=e.sys.Region.create(),b=t.$getOriginalBounds(),E.updateRegion(b,m);if(E.width<=0||E.height<=0)return u;var T=!1;if(o){for(var _=o.length,S=0;_>S;S++)if(E.intersects(o[S])){T=!0;break}}else T=!0;if(!T)return e.sys.Region.release(E),e.Matrix.release(m),u;if(f||t.$children&&0!=t.$children.length){var C=this.createRenderBuffer(E.width*s.a,E.height*s.d);C.context.pushBuffer(C),C.setTransform(s.a,0,0,s.d,-E.minX,-E.minY);var L=e.Matrix.create().setTo(s.a,0,0,s.d,-E.minX,-E.minY);if(u+=this.drawDisplayObject(t,C,o,L,t.$displayList,E,c),f){var R=this.createRenderBuffer(E.width*s.a,E.height*s.d);R.context.pushBuffer(R),R.setTransform(s.a,0,0,s.d,-E.minX,-E.minY),L=e.Matrix.create().setTo(s.a,0,0,s.d,-E.minX,-E.minY),u+=this.drawDisplayObject(f,R,o,L,f.$displayList,E,c),R.context.popBuffer(),C.context.setGlobalCompositeOperation("destination-in"),C.setTransform(1,0,0,-1,0,R.height),C.globalAlpha=1;var A=R.rootRenderTarget.width,D=R.rootRenderTarget.height;C.context.drawTexture(R.rootRenderTarget.texture,0,0,A,D,0,0,A,D,A,D),C.context.setGlobalCompositeOperation("source-over"),n.push(R)}if(e.Matrix.release(L),C.context.setGlobalCompositeOperation(i),C.context.popBuffer(),u>0){if(u++,d&&a.context.setGlobalCompositeOperation(h),p){var w=m;s.$preMultiplyInto(w,w),C.setTransform(w.a,w.b,w.c,w.d,w.tx,w.ty),C.context.pushMask(p)}a.globalAlpha=1,a.setTransform(1,0,0,-1,(E.minX+s.tx)*s.a,(E.minY+s.ty)*s.d+C.height);var O=C.rootRenderTarget.width,I=C.rootRenderTarget.height;a.context.drawTexture(C.rootRenderTarget.texture,0,0,O,I,0,0,O,I,O,I),p&&C.context.popMask(),d&&a.context.setGlobalCompositeOperation(i)}return n.push(C),e.sys.Region.release(E),e.Matrix.release(m),u}if(p){var w=m;a.setTransform(w.a,w.b,w.c,w.d,w.tx,w.ty),a.context.pushMask(p)}return d&&a.context.setGlobalCompositeOperation(h),u+=this.drawDisplayObject(t,a,o,s,t.$displayList,l,c),d&&a.context.setGlobalCompositeOperation(i),p&&a.context.popMask(),e.sys.Region.release(E),e.Matrix.release(m),u},a.prototype.drawWithScrollRect=function(t,r,i,n,a,o){var s=0,l=t.$scrollRect?t.$scrollRect:t.$maskRect;if(l.isEmpty())return s;var c=e.Matrix.create();if(c.copyFrom(t.$getConcatenatedMatrix()),o)t.$getConcatenatedMatrixAt(o,c);else if(t.$parentDisplayList){var h=t.$parentDisplayList.root;h!==t.$stage&&t.$getConcatenatedMatrixAt(h,c)}var u=e.sys.Region.create();if(u.updateRegion(l,c),u.isEmpty()||a&&!a.intersects(u))return e.sys.Region.release(u),e.Matrix.release(c),s;var d=!1;if(i){for(var p=i.length,f=0;p>f;f++)if(u.intersects(i[f])){d=!0;break}}else d=!0;if(!d)return e.sys.Region.release(u),e.Matrix.release(c),s;n.$preMultiplyInto(c,c),r.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty);var g=r.context,v=!1;if(r.$hasScissor||0!=c.b||0!=c.c)g.pushMask(l);else{var y=c.a,m=c.d,x=c.tx,b=c.ty,w=l.x,E=l.y,T=w+l.width,_=E+l.height,S=void 0,C=void 0,L=void 0,R=void 0;if(1==y&&1==m)S=w+x,C=E+b,L=T+x,R=_+b;else{var A=y*w+x,D=m*E+b,O=y*T+x,I=m*E+b,M=y*T+x,B=m*_+b,$=y*w+x,P=m*_+b,F=0;A>O&&(F=A,A=O,O=F),M>$&&(F=M,M=$,$=F),S=M>A?A:M,L=O>$?O:$,D>I&&(F=D,D=I,I=F),B>P&&(F=B,B=P,P=F),C=B>D?D:B,R=I>P?I:P}g.enableScissor(S,-R+r.height,L-S,R-C),v=!0}return s+=this.drawDisplayObject(t,r,i,n,t.$displayList,u,o),r.setTransform(c.a,c.b,c.c,c.d,c.tx+n.tx,c.ty+n.ty),v?g.disableScissor():g.popMask(),e.sys.Region.release(u),e.Matrix.release(c),s},a.prototype.drawNodeToBuffer=function(e,t,r,i){var n=t;n.context.pushBuffer(n),n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(e,t,i),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},a.prototype.renderNode=function(e,t,r){switch(e.type){case 1:this.renderBitmap(e,t);break;case 2:this.renderText(e,t);break;case 3:this.renderGraphics(e,t,r);break;case 4:this.renderGroup(e,t);break;case 6:t.globalAlpha=e.drawData[0];break;case 7:this.renderMesh(e,t)}},a.prototype.renderBitmap=function(e,t){var n=e.image;if(n){var a=e.drawData,o=a.length,s=0,l=e.matrix,c=e.blendMode,h=e.alpha;l&&(t.saveTransform(),t.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),c&&t.context.setGlobalCompositeOperation(r[c]);var u;if(h==h&&(u=t.globalAlpha,t.globalAlpha*=h),e.filter){for(t.context.$filter=e.filter;o>s;)t.context.drawImage(n,a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);t.context.$filter=null}else for(;o>s;)t.context.drawImage(n,a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);c&&t.context.setGlobalCompositeOperation(i),h==h&&(t.globalAlpha=u),l&&t.restoreTransform()}},a.prototype.renderMesh=function(e,t){var n=e.image,a=e.drawData,o=a.length,s=0,l=e.matrix,c=e.blendMode,h=e.alpha;l&&(t.saveTransform(),t.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),c&&t.context.setGlobalCompositeOperation(r[c]);var u;if(h==h&&(u=t.globalAlpha,t.globalAlpha*=h),e.filter){for(t.context.$filter=e.filter;o>s;)t.context.drawMesh(n,a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);t.context.$filter=null}else for(;o>s;)t.context.drawMesh(n,a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);c&&t.context.setGlobalCompositeOperation(i),h==h&&(t.globalAlpha=u),l&&t.restoreTransform()},a.prototype.renderText=function(r,i){var n=r.width-r.x,a=r.height-r.y,o=e.sys.DisplayList.$canvasScaleX,s=e.sys.DisplayList.$canvasScaleY,l=i.context.$maxTextureSize;n*o>l&&(o*=l/(n*o)),a*s>l&&(s*=l/(a*s)),n*=o,a*=s;var c=r.x*o,h=r.y*s;if(0!=r.drawData.length&&((r.$canvasScaleX!=o||r.$canvasScaleY!=s)&&(r.$canvasScaleX=o,r.$canvasScaleY=s,r.dirtyRender=!0),this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new e.CanvasRenderer,this.canvasRenderBuffer=new t.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context)){if(c||h?(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,-c,-h),i.transform(1,0,0,1,c/o,h/s)):(1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),r.dirtyRender){var u=this.canvasRenderBuffer.surface;this.canvasRenderer.renderText(r,this.canvasRenderBuffer.context);var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d),r.$textureWidth=u.width,r.$textureHeight=u.height}var p=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,p,f,0,0,p/o,f/s,p,f),(c||h)&&(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),i.transform(1,0,0,1,-c/o,-h/s)),r.dirtyRender=!1}},a.prototype.renderGraphics=function(r,i,n){var a=r.width,o=r.height;if(!(0>=a||0>=o)&&a&&o&&0!=r.drawData.length){var s=e.sys.DisplayList.$canvasScaleX,l=e.sys.DisplayList.$canvasScaleY;if((1>a*s||1>o*l)&&(s=l=1),(r.$canvasScaleX!=s||r.$canvasScaleY!=l)&&(r.$canvasScaleX=s,r.$canvasScaleY=l,r.dirtyRender=!0),a*=s,o*=l,this.canvasRenderBuffer&&this.canvasRenderBuffer.context?(r.dirtyRender||n)&&this.canvasRenderBuffer.resize(a,o):(this.canvasRenderer=new e.CanvasRenderer,this.canvasRenderBuffer=new t.CanvasRenderBuffer(a,o)),this.canvasRenderBuffer.context){(1!=s||1!=l)&&this.canvasRenderBuffer.context.setTransform(s,0,0,l,0,0),(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-r.x,-r.y),i.transform(1,0,0,1,r.x,r.y));var c=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context,!0),e.WebGLUtils.deleteWebGLTexture(c);var h=i.context.getWebGLTexture(c);i.context.drawTexture(h,0,0,a,o,0,0,a,o,c.width,c.height)}else{if(r.dirtyRender){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context);var h=r.$texture;h?i.context.updateTexture(h,c):(h=i.context.createTexture(c),r.$texture=h),r.$textureWidth=c.width,r.$textureHeight=c.height}var u=r.$textureWidth,d=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,u,d,0,0,u/s,d/l,u,d)}(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(r.x,r.y),i.transform(1,0,0,1,-r.x,-r.y)),n||(r.dirtyRender=!1)}}},a.prototype.renderGroup=function(e,t){var r=e.matrix;r&&(t.saveTransform(),t.transform(r.a,r.b,r.c,r.d,r.tx,r.ty));for(var i=e.drawData,n=i.length,a=0;n>a;a++){var o=i[a];this.renderNode(o,t)}r&&t.restoreTransform()},a.prototype.createRenderBuffer=function(e,r){var i=n.pop();return i?i.resize(e,r):(i=new t.WebGLRenderBuffer(e,r),i.$computeDrawCall=!1),i},a}();t.WebGLRenderer=a,__reflect(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t;!function(e){e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.FLOAT=5126]="FLOAT",e[e.BYTE=65535]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT"}(t=e.WEBGL_ATTRIBUTE_TYPE||(e.WEBGL_ATTRIBUTE_TYPE={}));var r=function(){function e(e,t,r){this.gl=e,this.name=r.name,this.type=r.type,this.size=r.size,this.location=e.getAttribLocation(t,this.name),this.count=0,this.initCount(e),this.format=e.FLOAT,this.initFormat(e)}return e.prototype.initCount=function(e){var r=this.type;switch(r){case t.FLOAT:case t.BYTE:case t.UNSIGNED_BYTE:case t.UNSIGNED_SHORT:this.count=1;break;case t.FLOAT_VEC2:this.count=2;break;case t.FLOAT_VEC3:this.count=3;break;case t.FLOAT_VEC4:this.count=4}},e.prototype.initFormat=function(e){var r=this.type;switch(r){case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:this.format=e.FLOAT;break;case t.UNSIGNED_BYTE:this.format=e.UNSIGNED_BYTE;break;case t.UNSIGNED_SHORT:this.format=e.UNSIGNED_SHORT;break;case t.BYTE:this.format=e.BYTE}},e}();e.EgretWebGLAttribute=r,__reflect(r.prototype,"egret.web.EgretWebGLAttribute")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){function t(e,t,r){var i=e.createShader(t);e.shaderSource(i,r),e.compileShader(i);var n=e.getShaderParameter(i,e.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(e.getShaderInfoLog(i))),i}function r(e,t,r){var i=e.createProgram();return e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),i}function i(t,r){for(var i={},n=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=0;n>a;a++){var o=t.getActiveAttrib(r,a),s=o.name,l=new e.EgretWebGLAttribute(t,r,o);i[s]=l}return i}function n(t,r){for(var i={},n=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),a=0;n>a;a++){var o=t.getActiveUniform(r,a),s=o.name,l=new e.EgretWebGLUniform(t,r,o);i[s]=l}return i}var a=function(){function e(e,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=t(e,e.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=t(e,e.FRAGMENT_SHADER,this.fshaderSource),this.id=r(e,this.vertexShader,this.fragmentShader),this.uniforms=n(e,this.id),this.attributes=i(e,this.id)}return e.getProgram=function(t,r,i,n){return this.programCache[n]||(this.programCache[n]=new e(t,r,i)),this.programCache[n]},e.deleteProgram=function(e,t,r,i){},e.programCache={},e}();e.EgretWebGLProgram=a,__reflect(a.prototype,"egret.web.EgretWebGLProgram")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t;!function(e){e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.BYTE=65535]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(t=e.WEBGL_UNIFORM_TYPE||(e.WEBGL_UNIFORM_TYPE={}));var r=function(){function e(e,t,r){this.gl=e,this.name=r.name,this.type=r.type,this.size=r.size,this.location=e.getUniformLocation(t,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return e.prototype.setDefaultValue=function(){var e=this.type;switch(e){case t.FLOAT:case t.SAMPLER_2D:case t.SAMPLER_CUBE:case t.BOOL:case t.INT:this.value=0;break;case t.FLOAT_VEC2:case t.BOOL_VEC2:case t.INT_VEC2:this.value=[0,0];break;case t.FLOAT_VEC3:case t.BOOL_VEC3:case t.INT_VEC3:this.value=[0,0,0];break;case t.FLOAT_VEC4:case t.BOOL_VEC4:case t.INT_VEC4:this.value=[0,0,0,0];break;case t.FLOAT_MAT2:this.value=new Float32Array([1,0,0,1]);break;case t.FLOAT_MAT3:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case t.FLOAT_MAT4:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},e.prototype.generateSetValue=function(){var e=this.type;switch(e){case t.FLOAT:case t.SAMPLER_2D:case t.SAMPLER_CUBE:case t.BOOL:case t.INT:this.setValue=function(e){var t=this.value!==e;this.value=e,t&&this.upload()};break;case t.FLOAT_VEC2:case t.BOOL_VEC2:case t.INT_VEC2:this.setValue=function(e){var t=this.value[0]!==e.x||this.value[1]!==e.y;this.value[0]=e.x,this.value[1]=e.y,t&&this.upload()};break;case t.FLOAT_VEC3:case t.BOOL_VEC3:case t.INT_VEC3:this.setValue=function(e){this.value[0]=e.x,this.value[1]=e.y,this.value[2]=e.z,this.upload()};break;case t.FLOAT_VEC4:case t.BOOL_VEC4:case t.INT_VEC4:this.setValue=function(e){this.value[0]=e.x,this.value[1]=e.y,this.value[2]=e.z,this.value[3]=e.w,this.upload()};break;case t.FLOAT_MAT2:case t.FLOAT_MAT3:case t.FLOAT_MAT4:this.setValue=function(e){this.value.set(e),this.upload()}}},e.prototype.generateUpload=function(){var e=this.gl,r=this.type,i=this.location;switch(r){case t.FLOAT:this.upload=function(){var t=this.value;e.uniform1f(i,t)};break;case t.FLOAT_VEC2:this.upload=function(){var t=this.value;e.uniform2f(i,t[0],t[1])};break;case t.FLOAT_VEC3:this.upload=function(){var t=this.value;e.uniform3f(i,t[0],t[1],t[2])};break;case t.FLOAT_VEC4:this.upload=function(){var t=this.value;e.uniform4f(i,t[0],t[1],t[2],t[3])};break;case t.SAMPLER_2D:case t.SAMPLER_CUBE:case t.BOOL:case t.INT:this.upload=function(){var t=this.value;e.uniform1i(i,t)};break;case t.BOOL_VEC2:case t.INT_VEC2:this.upload=function(){var t=this.value;e.uniform2i(i,t[0],t[1])};break;case t.BOOL_VEC3:case t.INT_VEC3:this.upload=function(){var t=this.value;e.uniform3i(i,t[0],t[1],t[2])};break;case t.BOOL_VEC4:case t.INT_VEC4:this.upload=function(){var t=this.value;e.uniform4i(i,t[0],t[1],t[2],t[3])};break;case t.FLOAT_MAT2:this.upload=function(){var t=this.value;e.uniformMatrix2fv(i,!1,t)};break;case t.FLOAT_MAT3:this.upload=function(){var t=this.value;e.uniformMatrix3fv(i,!1,t)};break;case t.FLOAT_MAT4:this.upload=function(){var t=this.value;e.uniformMatrix4fv(i,!1,t)}}},e}();e.EgretWebGLUniform=r,__reflect(r.prototype,"egret.web.EgretWebGLUniform")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(){}return e.blur_frag="precision mediump float;\nuniform vec2 blur;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nuniform vec2 uTextureSize;\nvoid main()\n{\n    const int sampleRadius = 5;\n    const int samples = sampleRadius * 2 + 1;\n    vec2 blurUv = blur / uTextureSize;\n    vec4 color = vec4(0, 0, 0, 0);\n    vec2 uv = vec2(0.0, 0.0);\n    blurUv /= float(sampleRadius);\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\n        color += texture2D(uSampler, uv);\n    }\n    color /= float(samples);\n    gl_FragColor = color;\n}",e.colorTransform_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\n    if(texColor.a > 0.) {\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n    }\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",e.default_vert="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",e.glow_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float dist;\nuniform float angle;\nuniform vec4 color;\nuniform float alpha;\nuniform float blurX;\nuniform float blurY;\nuniform float strength;\nuniform float inner;\nuniform float knockout;\nuniform float hideObject;\nuniform vec2 uTextureSize;\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\nvoid main(void) {\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\n    const float linearSamplingTimes = 7.0;\n    const float circleSamplingTimes = 12.0;\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float totalAlpha = 0.0;\n    float maxTotalAlpha = 0.0;\n    float curDistanceX = 0.0;\n    float curDistanceY = 0.0;\n    float offsetX = dist * cos(angle) * px.x;\n    float offsetY = dist * sin(angle) * px.y;\n    const float PI = 3.14159265358979323846264;\n    float cosAngle;\n    float sinAngle;\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    float stepX = blurX * px.x / linearSamplingTimes;\n    float stepY = blurY * px.y / linearSamplingTimes;\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\n        cosAngle = cos(a + offset);\n        sinAngle = sin(a + offset);\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\n            curDistanceX = i * stepX * cosAngle;\n            curDistanceY = i * stepY * sinAngle;\n            \n            curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\n            totalAlpha += (linearSamplingTimes - i) * curColor.a;\n            maxTotalAlpha += (linearSamplingTimes - i);\n        }\n    }\n    ownColor.a = max(ownColor.a, 0.0001);\n    ownColor.rgb = ownColor.rgb / ownColor.a;\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\n}",e.primitive_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\n    gl_FragColor = vColor;\n}",e.texture_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",e}();e.EgretShaderLib=t,__reflect(t.prototype,"egret.web.EgretShaderLib")}(t=e.web||(e.web={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),eui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.targetLevel=Number.POSITIVE_INFINITY,e.invalidatePropertiesFlag=!1,e.invalidateClientPropertiesFlag=!1,e.invalidatePropertiesQueue=new i,e.invalidateSizeFlag=!1,e.invalidateClientSizeFlag=!1,e.invalidateSizeQueue=new i,e.invalidateDisplayListFlag=!1,e.invalidateDisplayListQueue=new i,e.eventDisplay=new egret.Bitmap,e.listenersAttached=!1,e}return __extends(e,t),e.prototype.invalidateProperties=function(t){this.invalidatePropertiesFlag||(this.invalidatePropertiesFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientPropertiesFlag=!0),this.invalidatePropertiesQueue.insert(t)},e.prototype.validateProperties=function(){for(var t=this.invalidatePropertiesQueue,e=t.shift();e;)e.$stage&&e.validateProperties(),e=t.shift();t.isEmpty()&&(this.invalidatePropertiesFlag=!1)},e.prototype.invalidateSize=function(t){this.invalidateSizeFlag||(this.invalidateSizeFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientSizeFlag=!0),this.invalidateSizeQueue.insert(t)},e.prototype.validateSize=function(){for(var t=this.invalidateSizeQueue,e=t.pop();e;)e.$stage&&e.validateSize(),e=t.pop();t.isEmpty()&&(this.invalidateSizeFlag=!1)},e.prototype.invalidateDisplayList=function(t){this.invalidateDisplayListFlag||(this.invalidateDisplayListFlag=!0,this.listenersAttached||this.attachListeners()),this.invalidateDisplayListQueue.insert(t)},e.prototype.validateDisplayList=function(){for(var t=this.invalidateDisplayListQueue,e=t.shift();e;)e.$stage&&e.validateDisplayList(),e=t.shift();t.isEmpty()&&(this.invalidateDisplayListFlag=!1)},e.prototype.attachListeners=function(){this.eventDisplay.addEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.addEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),egret.sys.$invalidateRenderFlag=!0,this.listenersAttached=!0},e.prototype.doPhasedInstantiationCallBack=function(t){this.eventDisplay.removeEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.removeEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),this.doPhasedInstantiation()},e.prototype.doPhasedInstantiation=function(){this.invalidatePropertiesFlag&&this.validateProperties(),this.invalidateSizeFlag&&this.validateSize(),this.invalidateDisplayListFlag&&this.validateDisplayList(),this.invalidatePropertiesFlag||this.invalidateSizeFlag||this.invalidateDisplayListFlag?this.attachListeners():this.listenersAttached=!1},e.prototype.validateClient=function(t){var e,i=!1,n=this.targetLevel;this.targetLevel===Number.POSITIVE_INFINITY&&(this.targetLevel=t.$nestLevel);for(var r=this.invalidatePropertiesQueue,o=this.invalidateSizeQueue,s=this.invalidateDisplayListQueue;!i;){for(i=!0,e=r.removeSmallestChild(t);e;)e.$stage&&e.validateProperties(),e=r.removeSmallestChild(t);for(r.isEmpty()&&(this.invalidatePropertiesFlag=!1),this.invalidateClientPropertiesFlag=!1,e=o.removeLargestChild(t);e;){if(e.$stage&&e.validateSize(),this.invalidateClientPropertiesFlag&&(e=r.removeSmallestChild(t))){r.insert(e),i=!1;break}e=o.removeLargestChild(t)}for(o.isEmpty()&&(this.invalidateSizeFlag=!1),this.invalidateClientPropertiesFlag=!1,this.invalidateClientSizeFlag=!1,e=s.removeSmallestChild(t);e;){if(e.$stage&&e.validateDisplayList(),this.invalidateClientPropertiesFlag&&(e=r.removeSmallestChild(t))){r.insert(e),i=!1;break}if(this.invalidateClientSizeFlag&&(e=o.removeLargestChild(t))){o.insert(e),i=!1;break}e=s.removeSmallestChild(t)}s.isEmpty()&&(this.invalidateDisplayListFlag=!1)}n===Number.POSITIVE_INFINITY&&(this.targetLevel=Number.POSITIVE_INFINITY)},e}(egret.EventDispatcher);t.Validator=e,__reflect(e.prototype,"eui.sys.Validator");var i=function(){function t(){this.depthBins={},this.minDepth=0,this.maxDepth=-1}return t.prototype.insert=function(t){var e=t.$nestLevel;this.maxDepth<this.minDepth?this.minDepth=this.maxDepth=e:(e<this.minDepth&&(this.minDepth=e),e>this.maxDepth&&(this.maxDepth=e));var i=this.depthBins[e];i||(i=this.depthBins[e]=new n),i.insert(t)},t.prototype.pop=function(){var t,e=this.minDepth;if(e<=this.maxDepth){for(var i=this.depthBins[this.maxDepth];!i||0===i.length;){if(this.maxDepth--,this.maxDepth<e)return null;i=this.depthBins[this.maxDepth]}for(t=i.pop();!(i&&0!=i.length||(this.maxDepth--,this.maxDepth<e));)i=this.depthBins[this.maxDepth]}return t},t.prototype.shift=function(){var t,e=this.maxDepth;if(this.minDepth<=e){for(var i=this.depthBins[this.minDepth];!i||0===i.length;){if(this.minDepth++,this.minDepth>e)return null;i=this.depthBins[this.minDepth]}for(t=i.pop();!(i&&0!=i.length||(this.minDepth++,this.minDepth>e));)i=this.depthBins[this.minDepth]}return t},t.prototype.removeLargestChild=function(t){for(var e=t.$hashCode,i=t.$nestLevel,n=this.maxDepth,r=i;n>=r;){var o=this.depthBins[n];if(o&&o.length>0){if(n===i){if(o.map[e])return o.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var s=o.items,a=o.length,h=0;a>h;h++){var l=s[h];if(t.contains(l))return o.remove(l),l}}n--}else if(n==this.maxDepth&&this.maxDepth--,n--,r>n)break}return null},t.prototype.removeSmallestChild=function(t){for(var e=t.$nestLevel,i=e,n=this.maxDepth,r=t.$hashCode;n>=i;){var o=this.depthBins[i];if(o&&o.length>0){if(i===e){if(o.map[r])return o.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var s=o.items,a=o.length,h=0;a>h;h++){var l=s[h];if(t.contains(l))return o.remove(l),l}}i++}else if(i==this.minDepth&&this.minDepth++,i++,i>n)break}return null},t.prototype.isEmpty=function(){return this.minDepth>this.maxDepth},t}();__reflect(i.prototype,"DepthQueue");var n=function(){function t(){this.map={},this.items=[],this.length=0}return t.prototype.insert=function(t){var e=t.$hashCode;this.map[e]||(this.map[e]=!0,this.length++,this.items.push(t))},t.prototype.pop=function(){var t=this.items.pop();return t&&(this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1),t},t.prototype.remove=function(t){var e=this.items.indexOf(t);e>=0&&(this.items.splice(e,1),this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1)},t}();__reflect(n.prototype,"DepthBin")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){function e(t,e,i,n){var r=t.prototype;r.__meta__=r.__meta__||{},r.__meta__[e]=i,n&&(r.__defaultProperty__=e)}t.registerProperty=e}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=[]);var n=e.call(this)||this;return n.name=t,n.overrides=i,n}return __extends(i,e),i.prototype.initialize=function(e,i){for(var n=this.overrides,r=n.length,o=0;r>o;o++){var s=n[o];if(s instanceof t.AddItems){var a=e[s.target];a&&a instanceof t.Image&&!a.$parent&&(i.addChild(a),i.removeChild(a))}}},i}(egret.HashObject);t.State=e,__reflect(e.prototype,"eui.State")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"states",{get:function(){return this.$stateValues.states},set:function(t){t||(t=[]);var e=this.$stateValues;e.states=t;for(var i={},n=t.length,r=0;n>r;r++){var o=t[r];i[o.name]=o}e.statesMap=i,e.parent&&this.commitCurrentState()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentState",{get:function(){return this.$stateValues.currentState},set:function(t){var e=this.$stateValues;e.explicitState=t,e.currentState=t,this.commitCurrentState()},enumerable:!0,configurable:!0}),t.prototype.commitCurrentState=function(){var t=this.$stateValues;if(t.parent){var e=t.statesMap[t.currentState];if(!e){if(!(t.states.length>0))return;t.currentState=t.states[0].name}if(t.oldState!=t.currentState){var i=t.parent,n=t.statesMap[t.oldState];if(n)for(var r=n.overrides,o=r.length,s=0;o>s;s++)r[s].remove(this,i);if(t.oldState=t.currentState,n=t.statesMap[t.currentState])for(var r=n.overrides,a=r.length,s=0;a>s;s++)r[s].apply(this,i)}}},t.prototype.hasState=function(t){return!!this.$stateValues.statesMap[t]},t.prototype.initializeStates=function(t){this.$stateValues.intialized=!0;for(var e=this.states,i=e.length,n=0;i>n;n++)e[n].initialize(this,t)},t}();t.StateClient=e,__reflect(e.prototype,"eui.sys.StateClient");var i=function(){function t(){this.intialized=!1,this.statesMap={},this.states=[],this.oldState=null,this.explicitState=null,this.currentState=null,this.parent=null,this.stateIsDirty=!1}return t}();t.StateValues=i,__reflect(i.prototype,"eui.sys.StateValues")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){function e(e,i){var n=egret.getImplementation("eui.IAssetAdapter");n||(n=new t.DefaultAssetAdapter),n.getAsset(e,function(t){i(t)},this)}function i(e,i){var n=egret.getImplementation("eui.IThemeAdapter");n||(n=new t.DefaultThemeAdapter),n.getTheme(e,function(t){i(t)},function(t){console.log(t)},this)}t.getAssets=e,t.getTheme=i}(eui||(eui={})),function(t){var e;!function(e){function i(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d}function n(t,e){if("function"!=typeof t[e])return!1;var i=t[e].toString(),n=i.indexOf("{"),r=i.lastIndexOf("}");return i=i.substring(n+1,r),""==i.trim()}function r(t,e){for(var i in e)"prototype"!=i&&e.hasOwnProperty(i)&&(t[i]=e[i]);for(var r=t.prototype,o=e.prototype,s=Object.keys(o),a=s.length,h=0;a>h;h++){var l=s[h];if("__meta__"!=l&&(!r.hasOwnProperty(l)||n(r,l))){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(r,l,u)}}}function o(e,i,n){r(e,h);var o=e.prototype;o.$super=i.prototype,t.registerProperty(e,"left","Percentage"),t.registerProperty(e,"right","Percentage"),t.registerProperty(e,"top","Percentage"),t.registerProperty(e,"bottom","Percentage"),t.registerProperty(e,"horizontalCenter","Percentage"),t.registerProperty(e,"verticalCenter","Percentage"),n&&(o.$childAdded=function(t,e){this.invalidateSize(),this.invalidateDisplayList()},o.$childRemoved=function(t,e){this.invalidateSize(),this.invalidateDisplayList()})}var s="eui.UIComponent",a=new e.Validator,h=function(n){function r(){var t=n.call(this)||this;return t.initializeUIValues(),t}return __extends(r,n),r.prototype.initializeUIValues=function(){this.$UIComponent={0:0/0,1:0/0,2:0/0,3:0/0,4:0/0,5:0/0,6:0/0,7:0/0,8:0/0,9:0/0,10:0,11:0,12:0,13:1e5,14:0,15:1e5,16:0,17:0,18:0/0,19:0/0,20:0,21:0,22:0,23:0,24:!0,25:!0,26:!0,27:!1,28:!1,29:!1},this.$includeInLayout=!0,this.$touchEnabled=!0},r.prototype.createChildren=function(){},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){var e=this.$UIComponent;(e[22]!=e[10]||e[23]!=e[11])&&(this.dispatchEventWith(egret.Event.RESIZE),e[22]=e[10],e[23]=e[11]),(e[20]!=this.$getX()||e[21]!=this.$getY())&&(t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE),e[20]=this.$getX(),e[21]=this.$getY())},r.prototype.measure=function(){},r.prototype.updateDisplayList=function(t,e){},Object.defineProperty(r.prototype,"includeInLayout",{get:function(){return this.$includeInLayout},set:function(t){t=!!t,this.$includeInLayout!==t&&(this.$includeInLayout=!0,this.invalidateParentLayout(),this.$includeInLayout=t)},enumerable:!0,configurable:!0}),r.prototype.$onAddToStage=function(e,i){this.$super.$onAddToStage.call(this,e,i),this.checkInvalidateFlag();var n=this.$UIComponent;n[29]||(n[29]=!0,this.createChildren(),this.childrenCreated(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CREATION_COMPLETE))},r.prototype.checkInvalidateFlag=function(t){var e=this.$UIComponent;e[24]&&a.invalidateProperties(this),e[25]&&a.invalidateSize(this),e[26]&&a.invalidateDisplayList(this)},Object.defineProperty(r.prototype,"left",{get:function(){return this.$UIComponent[0]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[0]!==t&&(e[0]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.$UIComponent[1]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[1]!==t&&(e[1]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.$UIComponent[2]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[2]!==t&&(e[2]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.$UIComponent[3]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[3]!=t&&(e[3]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalCenter",{get:function(){return this.$UIComponent[4]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[4]!==t&&(e[4]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalCenter",{get:function(){return this.$UIComponent[5]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[5]!==t&&(e[5]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"percentWidth",{get:function(){return this.$UIComponent[6]},set:function(t){t=+t;var e=this.$UIComponent;e[6]!==t&&(e[6]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"percentHeight",{get:function(){return this.$UIComponent[7]},set:function(t){t=+t;var e=this.$UIComponent;e[7]!==t&&(e[7]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"explicitWidth",{get:function(){return this.$UIComponent[8]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"explicitHeight",{get:function(){return this.$UIComponent[9]},enumerable:!0,configurable:!0}),r.prototype.$getWidth=function(){return this.validateSizeNow(),this.$UIComponent[10]},r.prototype.$setWidth=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[10]===t&&e[8]===t?!1:(e[8]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},r.prototype.validateSizeNow=function(){this.validateSize(!0),this.updateFinalSize()},r.prototype.$getHeight=function(){return this.validateSizeNow(),this.$UIComponent[11]},r.prototype.$setHeight=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[11]===t&&e[9]===t?!1:(e[9]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},Object.defineProperty(r.prototype,"minWidth",{get:function(){return this.$UIComponent[12]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[12]===t||(e[12]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){return this.$UIComponent[13]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[13]===t||(e[13]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minHeight",{get:function(){return this.$UIComponent[14]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[14]===t||(e[14]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxHeight",{get:function(){return this.$UIComponent[15]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[15]===t||(e[15]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),r.prototype.setMeasuredSize=function(t,e){var i=this.$UIComponent;i[16]=Math.ceil(+t||0),i[17]=Math.ceil(+e||0)},r.prototype.setActualSize=function(t,e){var i=!1,n=this.$UIComponent;n[10]!==t&&(n[10]=t,i=!0),n[11]!==e&&(n[11]=e,i=!0),i&&(this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.RESIZE))},r.prototype.$invalidateMatrix=function(){this.$super.$invalidateMatrix.call(this),this.invalidateParentLayout()},r.prototype.$setMatrix=function(t,e){return void 0===e&&(e=!0),this.$super.$setMatrix.call(this,t,e),this.invalidateParentLayout(),!0},r.prototype.$setAnchorOffsetX=function(t){return this.$super.$setAnchorOffsetX.call(this,t),this.invalidateParentLayout(),!0},r.prototype.$setAnchorOffsetY=function(t){return this.$super.$setAnchorOffsetY.call(this,t),this.invalidateParentLayout(),!0},r.prototype.$setX=function(t){var e=this.$super.$setX.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},r.prototype.$setY=function(t){var e=this.$super.$setY.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},r.prototype.invalidateProperties=function(){var t=this.$UIComponent;t[24]||(t[24]=!0,this.$stage&&a.invalidateProperties(this))},r.prototype.validateProperties=function(){var t=this.$UIComponent;t[24]&&(this.commitProperties(),t[24]=!1)},r.prototype.invalidateSize=function(){var t=this.$UIComponent;t[25]||(t[25]=!0,this.$stage&&a.invalidateSize(this))},r.prototype.validateSize=function(t){if(t){var e=this.$children;if(e)for(var i=e.length,n=0;i>n;n++){var r=e[n];egret.is(r,s)&&r.validateSize(!0)}}var o=this.$UIComponent;if(o[25]){var a=this.measureSizes();a&&(this.invalidateDisplayList(),this.invalidateParentLayout()),o[25]=!1}},r.prototype.measureSizes=function(){var t=!1,e=this.$UIComponent;if(!e[25])return t;(isNaN(e[8])||isNaN(e[9]))&&(this.measure(),e[16]<e[12]&&(e[16]=e[12]),e[16]>e[13]&&(e[16]=e[13]),e[17]<e[14]&&(e[17]=e[14]),e[17]>e[15]&&(e[17]=e[15]));var i=this.getPreferredUWidth(),n=this.getPreferredUHeight();return(i!==e[18]||n!==e[19])&&(e[18]=i,e[19]=n,t=!0),t},r.prototype.invalidateDisplayList=function(){var t=this.$UIComponent;t[26]||(t[26]=!0,this.$stage&&a.invalidateDisplayList(this))},r.prototype.validateDisplayList=function(){var t=this.$UIComponent;t[26]&&(this.updateFinalSize(),this.updateDisplayList(t[10],t[11]),t[26]=!1)},r.prototype.updateFinalSize=function(){var t=0,e=0,i=this.$UIComponent;t=i[27]?i[10]:isNaN(i[8])?i[16]:i[8],e=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.setActualSize(t,e)},r.prototype.validateNow=function(){this.$stage&&a.validateClient(this)},r.prototype.invalidateParentLayout=function(){var t=this.$parent;t&&this.$includeInLayout&&egret.is(t,s)&&(t.invalidateSize(),t.invalidateDisplayList())},r.prototype.setLayoutBoundsSize=function(t,n){if(n=+n,t=+t,!(0>n||0>t)){var r,o,s=this.$UIComponent,a=s[13],h=s[15],l=Math.min(s[12],a),u=Math.min(s[14],h);isNaN(t)?(s[27]=!1,r=this.getPreferredUWidth()):(s[27]=!0,r=Math.max(l,Math.min(a,t))),isNaN(n)?(s[28]=!1,o=this.getPreferredUHeight()):(s[28]=!0,o=Math.max(u,Math.min(h,n)));var p=this.getAnchorMatrix();if(i(p))return void this.setActualSize(r,o);var c=e.MatrixUtil.fitBounds(t,n,p,s[8],s[9],this.getPreferredUWidth(),this.getPreferredUHeight(),l,u,a,h);c||(c=egret.Point.create(l,u)),this.setActualSize(c.x,c.y),egret.Point.release(c)}},r.prototype.setLayoutBoundsPosition=function(e,n){var r=this.$getMatrix();if(!i(r)||0!=this.anchorOffsetX||0!=this.anchorOffsetY){var o=egret.$TempRectangle;this.getLayoutBounds(o),e+=this.$getX()-o.x,n+=this.$getY()-o.y}var s=this.$super.$setX.call(this,e);(this.$super.$setY.call(this,n)||s)&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE)},r.prototype.getLayoutBounds=function(t){var e,i=this.$UIComponent;e=i[27]?i[10]:isNaN(i[8])?i[16]:i[8];var n;n=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.applyMatrix(t,e,n)},r.prototype.getPreferredUWidth=function(){var t=this.$UIComponent;return isNaN(t[8])?t[16]:t[8]},r.prototype.getPreferredUHeight=function(){var t=this.$UIComponent;return isNaN(t[9])?t[17]:t[9]},r.prototype.getPreferredBounds=function(t){var e=this.getPreferredUWidth(),i=this.getPreferredUHeight();this.applyMatrix(t,e,i)},r.prototype.applyMatrix=function(t,e,n){t.setTo(0,0,e,n);var r=this.getAnchorMatrix();i(r)?(t.x+=r.tx,t.y+=r.ty):r.$transformBounds(t)},r.prototype.getAnchorMatrix=function(){var t=this.$getMatrix(),e=this.anchorOffsetX,i=this.anchorOffsetY;if(0!=e||0!=i){var n=egret.$TempMatrix;return t.$preMultiplyInto(n.setTo(1,0,0,1,-e,-i),n),n}return t},r}(egret.DisplayObject);e.UIComponentImpl=h,__reflect(h.prototype,"eui.sys.UIComponentImpl",["eui.UIComponent","egret.DisplayObject"]),e.mixin=r,e.implementUIComponent=o}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$layout=null,i.$stateValues=new t.sys.StateValues,i.initializeUIValues(),i.$Group={0:0,1:0,2:0,3:0,4:!1,5:!1},i.$stateValues.parent=i,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},set:function(t){this.$setLayout(t)},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){return this.$layout==t?!1:(this.$layout&&(this.$layout.target=null),this.$layout=t,t&&(t.target=this),this.invalidateSize(),this.invalidateDisplayList(),!0)},Object.defineProperty(i.prototype,"contentWidth",{get:function(){return this.$Group[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHeight",{get:function(){return this.$Group[1]},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(e,i){e=Math.ceil(+e||0),i=Math.ceil(+i||0);var n=this.$Group,r=n[0]!==e,o=n[1]!==i;(r||o)&&(n[0]=e,n[1]=i,r&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentWidth"),o&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentHeight"))},Object.defineProperty(i.prototype,"scrollEnabled",{get:function(){return this.$Group[4]},set:function(t){t=!!t;var e=this.$Group;t!==e[4]&&(e[4]=t,this.updateScrollRect())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollH",{get:function(){return this.$Group[2]},set:function(e){e=+e||0;var i=this.$Group;e!==i[2]&&(i[2]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollH"))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollV",{get:function(){return this.$Group[3]},set:function(e){e=+e||0;var i=this.$Group;e!=i[3]&&(i[3]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollV"))},enumerable:!0,configurable:!0}),i.prototype.updateScrollRect=function(){var t=this.$Group,e=t[4];if(e){var i=this.$UIComponent;this.scrollRect=egret.$TempRectangle.setTo(t[2],t[3],i[10],i[11])}else this.$scrollRect&&(this.scrollRect=null);return e},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getElementAt=function(t){return this.$children[t]},i.prototype.getVirtualElementAt=function(t){return this.getElementAt(t)},i.prototype.setVirtualElementIndicesInView=function(t,e){},Object.defineProperty(i.prototype,"touchThrough",{get:function(){return this.$Group[5]},set:function(t){this.$Group[5]=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var n=e.prototype.$hitTest.call(this,t,i);if(n||this.$Group[5])return n;if(!this.$visible||!this.touchEnabled)return null;var r=this.globalToLocal(t,i,egret.$TempPoint),o=this.$UIComponent,s=egret.$TempRectangle.setTo(0,0,o[10],o[11]),a=this.$scrollRect;return a&&(s.x=a.x,s.y=a.y),s.contains(r.x,r.y)?this:null},i.prototype.invalidateState=function(){var t=this.$stateValues;t.stateIsDirty||(t.stateIsDirty=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){this.$layout||this.$setLayout(new t.BasicLayout),this.initializeStates(this.$stage)},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$stateValues;e.stateIsDirty&&(e.stateIsDirty=!1,e.explicitState||(e.currentState=this.getCurrentState(),this.commitCurrentState()))},i.prototype.measure=function(){return this.$layout?void this.$layout.measure():void this.setMeasuredSize(0,0)},i.prototype.updateDisplayList=function(t,e){this.$layout&&this.$layout.updateDisplayList(t,e),this.updateScrollRect()},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.DisplayObjectContainer);t.Group=e,__reflect(e.prototype,"eui.Group",["eui.IViewport","eui.UIComponent","egret.DisplayObject"]),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]")}(eui||(eui={}));var eui;!function(t){function e(t,e){if(t.hasOwnProperty(i))t[i].push(e);else{var n=[e];t[i]&&(n=t[i].concat(n)),t[i]=n}}var i="__bindables__";t.registerBindable=e}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initializeUIValues(),t.$Component={0:null,1:null,2:"",3:!0,4:!1,5:!1,6:!0,7:!0,8:null},t.$touchEnabled=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"hostComponentKey",{get:function(){return this.$Component[0]},set:function(t){this.$Component[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skinName",{get:function(){return this.$Component[1]},set:function(t){var e=this.$Component;if(e[5]=!0,e[1]!=t){if(t)e[1]=t;else{var i=egret.getImplementation("eui.Theme");if(i){var n=i.getSkinName(this);n&&(e[1]=n)}}this.$parseSkinName()}},enumerable:!0,configurable:!0}),i.prototype.$parseSkinName=function(){var t,e=this.skinName;if(e)if(e.prototype)t=new e;else if("string"==typeof e){var i=void 0,n=e.trim();if("<"==n.charAt(0))i=EXML.parse(n);else if(i=egret.getDefinitionByName(e),!i&&-1!=n.toLowerCase().indexOf(".exml"))return void EXML.load(e,this.onExmlLoaded,this,!0);i&&(t=new i)}else t=e;this.setSkin(t)},i.prototype.onExmlLoaded=function(t,e){if(this.skinName==e){var i=new t;this.setSkin(i)}},Object.defineProperty(i.prototype,"skin",{get:function(){return this.$Component[8]},enumerable:!0,configurable:!0}),i.prototype.setSkin=function(e){!e||e instanceof t.Skin||(e=null);var i=this.$Component,n=i[8];if(n){for(var r=n.skinParts,o=r.length,s=0;o>s;s++){var a=r[s];this[a]&&this.setSkinPart(a,null)}var h=n.$elementsContent;if(h){o=h.length;for(var s=0;o>s;s++){var l=h[s];l.$parent==this&&this.removeChild(l)}}n.hostComponent=null}if(i[8]=e,e){for(var r=e.skinParts,u=r.length,s=0;u>s;s++){var a=r[s],p=e[a];p&&this.setSkinPart(a,p)}var h=e.$elementsContent;if(h)for(var s=h.length-1;s>=0;s--)this.addChildAt(h[s],0);e.hostComponent=this}this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.setSkinPart=function(t,e){var i=this[t];i&&this.partRemoved(t,i),this[t]=e,e&&this.partAdded(t,e)},i.prototype.partAdded=function(t,e){},i.prototype.partRemoved=function(t,e){},i.prototype.$setTouchChildren=function(t){t=!!t;var i=this.$Component;return i[6]=t,i[3]?(i[6]=t,e.prototype.$setTouchChildren.call(this,t)):!0},i.prototype.$setTouchEnabled=function(t){t=!!t;var i=this.$Component;return i[7]=t,i[3]?e.prototype.$setTouchEnabled.call(this,t):!0},Object.defineProperty(i.prototype,"enabled",{get:function(){return this.$Component[3]},set:function(t){t=!!t,this.$setEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$setEnabled=function(t){var e=this.$Component;return t===e[3]?!1:(e[3]=t,t?(this.$touchEnabled=e[7],this.$touchChildren=e[6]):(this.$touchEnabled=!1,this.$touchChildren=!1),this.invalidateState(),!0)},Object.defineProperty(i.prototype,"currentState",{get:function(){var t=this.$Component;return t[2]?t[2]:this.getCurrentState()},set:function(t){var e=this.$Component;t!=e[2]&&(e[2]=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.invalidateState=function(){var t=this.$Component;t[4]||(t[4]=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){var t=this.$Component;if(!t[1]){var e=egret.getImplementation("eui.Theme");if(e){var i=e.getSkinName(this);i&&(t[1]=i,this.$parseSkinName())}}},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$Component;e[4]&&(e[4]=!1,e[8]&&(e[8].currentState=this.currentState))},i.prototype.measure=function(){t.sys.measure(this);var e=this.$Component[8];if(e){var i=this.$UIComponent;isNaN(e.width)?(i[16]<e.minWidth&&(i[16]=e.minWidth),i[16]>e.maxWidth&&(i[16]=e.maxWidth)):i[16]=e.width,isNaN(e.height)?(i[17]<e.minHeight&&(i[17]=e.minHeight),i[17]>e.maxHeight&&(i[17]=e.maxHeight)):i[17]=e.height}},i.prototype.updateDisplayList=function(e,i){t.sys.updateDisplayList(this,e,i)},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.DisplayObjectContainer);t.Component=e,__reflect(e.prototype,"eui.Component",["eui.UIComponent","egret.DisplayObject"]),t.registerProperty(e,"skinName","Class"),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$dataProviderChanged=!1,t.$dataProvider=null,t.$indexToRenderer=[],t.$DataGroup={0:!0,1:!1,2:{},3:{},4:!1,5:!1,6:null,7:null,8:!1,9:null,10:!1,11:!1,12:null,13:null,14:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"useVirtualLayout",{get:function(){return this.$layout?this.$layout.$useVirtualLayout:this.$DataGroup[0]},set:function(t){t=!!t;var e=this.$DataGroup;t!==e[0]&&(e[0]=t,this.$layout&&(this.$layout.useVirtualLayout=t))},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){if(t==this.$layout)return!1;this.$layout&&(this.$layout.setTypicalSize(0,0),this.$layout.removeEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)),this.$layout&&t&&this.$layout.$useVirtualLayout!=t.$useVirtualLayout&&this.onUseVirtualLayoutChanged();var i=e.prototype.$setLayout.call(this,t);if(t){var n=this.$DataGroup[9];n&&t.setTypicalSize(n.width,n.height),t.useVirtualLayout=this.$DataGroup[0],t.addEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)}return i},i.prototype.onUseVirtualLayoutChanged=function(t){var e=this.$DataGroup;e[1]=!0,e[10]=!0,this.removeDataProviderListener(),this.invalidateProperties()},i.prototype.setVirtualElementIndicesInView=function(t,e){if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,n=Object.keys(i),r=n.length,o=0;r>o;o++){var s=+n[o];
(t>s||s>e)&&this.freeRendererByIndex(s)}},i.prototype.getElementAt=function(t){return this.$indexToRenderer[t]},i.prototype.getVirtualElementAt=function(t){if(t=0|+t,0>t||t>=this.$dataProvider.length)return null;var e=this.$indexToRenderer[t];if(!e){var i=this.$dataProvider.getItemAt(t);e=this.createVirtualRenderer(i),this.$indexToRenderer[t]=e,this.updateRenderer(e,t,i);var n=this.$DataGroup;n[4]&&(e.validateNow(),n[4]=!1,this.rendererAdded(e,t,i))}return e},i.prototype.freeRendererByIndex=function(t){var e=this.$indexToRenderer[t];e&&(delete this.$indexToRenderer[t],this.doFreeRenderer(e))},i.prototype.doFreeRenderer=function(t){var e=this.$DataGroup,i=e[2][t.$hashCode],n=i.$hashCode;e[3][n]||(e[3][n]=[]),e[3][n].push(t),t.visible=!1},i.prototype.invalidateSize=function(){this.$DataGroup[4]||e.prototype.invalidateSize.call(this)},i.prototype.createVirtualRenderer=function(t){var e,i=this.itemToRendererClass(t),n=i.$hashCode,r=this.$DataGroup,o=r[3];return o[n]&&o[n].length>0?(e=o[n].pop(),e.visible=!0,this.invalidateDisplayList(),e):(r[4]=!0,this.createOneRenderer(i))},i.prototype.createOneRenderer=function(t){var e=new t,i=this.$DataGroup;return i[2][e.$hashCode]=t,egret.is(e,"eui.IItemRenderer")?(i[13]&&this.setItemRenderSkinName(e,i[13]),this.addChild(e),e):null},i.prototype.setItemRenderSkinName=function(e,i){if(e&&e instanceof t.Component){var n=e;n.$Component[5]||(n.skinName=i,n.$Component[5]=!1)}},Object.defineProperty(i.prototype,"dataProvider",{get:function(){return this.$dataProvider},set:function(t){this.$setDataProvider(t)},enumerable:!0,configurable:!0}),i.prototype.$setDataProvider=function(t){return this.$dataProvider==t||t&&!t.getItemAt?!1:(this.removeDataProviderListener(),this.$dataProvider=t,this.$dataProviderChanged=!0,this.$DataGroup[10]=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),!0)},i.prototype.removeDataProviderListener=function(){this.$dataProvider&&this.$dataProvider.removeEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this)},i.prototype.onCollectionChange=function(e){switch(e.kind){case t.CollectionEventKind.ADD:this.itemAddedHandler(e.items,e.location);break;case t.CollectionEventKind.REMOVE:this.itemRemovedHandler(e.items,e.location);break;case t.CollectionEventKind.UPDATE:case t.CollectionEventKind.REPLACE:this.itemUpdatedHandler(e.items[0],e.location);break;case t.CollectionEventKind.RESET:case t.CollectionEventKind.REFRESH:if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,n=Object.keys(i),r=n.length,o=r-1;o>=0;o--){var s=+n[o];this.freeRendererByIndex(s)}this.$dataProviderChanged=!0,this.invalidateProperties()}this.invalidateSize(),this.invalidateDisplayList()},i.prototype.itemAddedHandler=function(t,e){for(var i=t.length,n=0;i>n;n++)this.itemAdded(t[n],e+n);this.resetRenderersIndices()},i.prototype.itemRemovedHandler=function(t,e){for(var i=t.length,n=i-1;n>=0;n--)this.itemRemoved(t[n],e+n);this.resetRenderersIndices()},i.prototype.itemAdded=function(t,e){if(this.$layout&&this.$layout.elementAdded(e),this.$layout&&this.$layout.$useVirtualLayout)return void this.$indexToRenderer.splice(e,0,null);var i=this.createVirtualRenderer(t);if(this.$indexToRenderer.splice(e,0,i),i){this.updateRenderer(i,e,t);var n=this.$DataGroup;n[4]&&(n[4]=!1,this.rendererAdded(i,e,t))}},i.prototype.itemRemoved=function(t,e){this.$layout&&this.$layout.elementRemoved(e);var i=this.$indexToRenderer[e];this.$indexToRenderer.length>e&&this.$indexToRenderer.splice(e,1),i&&(this.$layout&&this.$layout.$useVirtualLayout?this.doFreeRenderer(i):(this.rendererRemoved(i,e,t),this.removeChild(i)))},i.prototype.resetRenderersIndices=function(){var t=this.$indexToRenderer;if(0!=t.length)if(this.$layout&&this.$layout.$useVirtualLayout)for(var e=Object.keys(t),i=e.length,n=0;i>n;n++){var r=+e[n];this.resetRendererItemIndex(r)}else for(var o=t.length,r=0;o>r;r++)this.resetRendererItemIndex(r)},i.prototype.itemUpdatedHandler=function(t,e){if(!this.$DataGroup[11]){var i=this.$indexToRenderer[e];i&&this.updateRenderer(i,e,t)}},i.prototype.resetRendererItemIndex=function(t){var e=this.$indexToRenderer[t];e&&(e.itemIndex=t)},Object.defineProperty(i.prototype,"itemRenderer",{get:function(){return this.$DataGroup[6]},set:function(t){var e=this.$DataGroup;e[6]!=t&&(e[6]=t,e[5]=!0,e[8]=!0,e[10]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererSkinName",{get:function(){return this.$DataGroup[13]},set:function(t){var e=this.$DataGroup;e[13]!=t&&(e[13]=t,this.$UIComponent[29]&&(e[14]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererFunction",{get:function(){return this.$DataGroup[7]},set:function(t){var e=this.$DataGroup;e[7]!=t&&(e[7]=t,e[5]=!0,e[8]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.itemToRendererClass=function(e){var i,n=this.$DataGroup;return n[7]&&(i=n[7](e)),i||(i=n[6]),i||(i=t.ItemRenderer),i.$hashCode||(i.$hashCode=egret.$hashCount++),i},i.prototype.createChildren=function(){if(!this.$layout){var i=new t.VerticalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.commitProperties=function(){var i=this.$DataGroup;if((i[5]||this.$dataProviderChanged||i[1])&&(this.removeAllRenderers(),this.$layout&&this.$layout.clearVirtualLayoutCache(),this.setTypicalLayoutRect(null),i[1]=!1,i[5]=!1,this.$dataProvider&&this.$dataProvider.addEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this),this.$layout&&this.$layout.$useVirtualLayout?(this.invalidateSize(),this.invalidateDisplayList()):this.createRenderers(),this.$dataProviderChanged&&(this.$dataProviderChanged=!1,this.scrollV=this.scrollH=0)),e.prototype.commitProperties.call(this),i[8]&&(i[8]=!1,this.$dataProvider&&this.$dataProvider.length>0&&(i[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())),i[14]){i[14]=!1;for(var n=i[13],r=this.$indexToRenderer,o=Object.keys(r),s=o.length,a=0;s>a;a++){var h=o[a];this.setItemRenderSkinName(r[h],n)}var l=i[3];o=Object.keys(l),s=o.length;for(var a=0;s>a;a++)for(var u=o[a],p=l[u],c=p.length,d=0;c>d;d++)this.setItemRenderSkinName(p[d],n)}},i.prototype.measure=function(){this.$layout&&this.$layout.$useVirtualLayout&&this.ensureTypicalLayoutElement(),e.prototype.measure.call(this)},i.prototype.updateDisplayList=function(t,i){var n=this.$layout&&this.$layout.$useVirtualLayout;n&&this.ensureTypicalLayoutElement(),e.prototype.updateDisplayList.call(this,t,i);var r=this.$DataGroup;if(n){var o=r[9];if(o){var s=this.$indexToRenderer[0];if(s){var a=egret.$TempRectangle;s.getPreferredBounds(a),(a.width!=o.width||a.height!=o.height)&&(r[9]=null)}}}},i.prototype.ensureTypicalLayoutElement=function(){this.$DataGroup[9]||this.$dataProvider&&this.$dataProvider.length>0&&(this.$DataGroup[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())},i.prototype.measureRendererSize=function(){var t=this.$DataGroup;if(!t[12])return void this.setTypicalLayoutRect(null);var e=this.createVirtualRenderer(t[12]);if(!e)return void this.setTypicalLayoutRect(null);this.updateRenderer(e,0,t[12]),e.validateNow();var i=egret.$TempRectangle;e.getPreferredBounds(i);var n=new egret.Rectangle(0,0,i.width,i.height);this.$layout&&this.$layout.$useVirtualLayout?(t[4]&&this.rendererAdded(e,0,t[12]),this.doFreeRenderer(e)):this.removeChild(e),this.setTypicalLayoutRect(n),t[4]=!1},i.prototype.setTypicalLayoutRect=function(t){this.$DataGroup[9]=t,this.$layout&&(t?this.$layout.setTypicalSize(t.width,t.height):this.$layout.setTypicalSize(0,0))},i.prototype.removeAllRenderers=function(){for(var t=this.$indexToRenderer,e=Object.keys(t),i=e.length,n=0;i>n;n++){var r=e[n],o=t[r];o&&(this.rendererRemoved(o,o.itemIndex,o.data),this.removeChild(o))}this.$indexToRenderer=[];var s=this.$DataGroup;if(s[10]){for(var a=s[3],h=Object.keys(a),l=h.length,n=0;l>n;n++)for(var u=h[n],p=a[u],c=p.length,d=0;c>d;d++){var o=p[d];this.rendererRemoved(o,o.itemIndex,o.data),this.removeChild(o)}s[3]={},s[2]={},s[10]=!1}},i.prototype.createRenderers=function(){if(this.$dataProvider)for(var t=0,e=this.$dataProvider.length,i=0;e>i;i++){var n=this.$dataProvider.getItemAt(i),r=this.itemToRendererClass(n),o=this.createOneRenderer(r);o&&(this.$indexToRenderer[t]=o,this.updateRenderer(o,t,n),this.rendererAdded(o,t,n),t++)}},i.prototype.updateRenderer=function(t,e,i){var n=this.$DataGroup;return n[11]=!0,t.itemIndex=e,t.parent==this&&this.setChildIndex(t,e),t.data=i,n[11]=!1,t},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$dataProvider?this.$dataProvider.length:0},enumerable:!0,configurable:!0}),i.prototype.rendererAdded=function(t,e,i){},i.prototype.rendererRemoved=function(t,e,i){},i}(t.Group);t.DataGroup=e,__reflect(e.prototype,"eui.DataGroup"),t.registerProperty(e,"itemRenderer","Class"),t.registerProperty(e,"itemRendererSkinName","Class"),t.registerProperty(e,"dataProvider","eui.ICollection",!0)}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.labelDisplay=null,e._label="",e.iconDisplay=null,e._icon=null,e.touchCaptured=!1,e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.labelDisplay&&(this.labelDisplay.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=t)},enumerable:!0,configurable:!0}),e.prototype.onTouchCancle=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){return this.enabled?this.touchCaptured?"down":"up":"disabled"},e.prototype.partAdded=function(t,e){e===this.labelDisplay?this.labelDisplay.text=this._label:e==this.iconDisplay&&(this.iconDisplay.source=this._icon)},e.prototype.buttonReleased=function(){},e}(t.Component);t.Button=e,__reflect(e.prototype,"eui.Button")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$Range={0:100,1:!1,2:0,3:!1,4:0,5:0,6:!1,7:1,8:!1,9:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"maximum",{get:function(){return this.$Range[0]},set:function(t){t=+t||0;var e=this.$Range;t!==e[0]&&(e[0]=t,e[1]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minimum",{get:function(){return this.$Range[2]},set:function(t){t=+t||0;var e=this.$Range;t!==e[2]&&(e[2]=t,e[3]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){var t=this.$Range;return t[6]?t[5]:t[4]},set:function(t){t=+t||0,this.$setValue(t)},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(t===this.value)return!1;var e=this.$Range;return e[5]=t,e[6]=!0,this.invalidateProperties(),!0},Object.defineProperty(i.prototype,"snapInterval",{get:function(){return this.$Range[7]},set:function(t){var e=this.$Range;e[9]=!0,t=+t||0,t!==e[7]&&(isNaN(t)?(e[7]=1,e[9]=!1):e[7]=t,e[8]=!0,this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this);var t=this.$Range;if(t[2]>t[0]&&(t[1]?t[0]=t[2]:t[2]=t[0]),t[6]||t[1]||t[3]||t[8]){var i=t[6]?t[5]:t[4];t[6]=!1,t[1]=!1,t[3]=!1,t[8]=!1,this.setValue(this.nearestValidValue(i,t[7]))}},i.prototype.nearestValidSize=function(t){var e=this.snapInterval;if(0==e)return t;var i=Math.round(t/e)*e;return Math.abs(i)<e?e:i},i.prototype.nearestValidValue=function(t,e){var i=this.$Range;if(0==e)return Math.max(i[2],Math.min(i[0],t));var n=i[0]-i[2],r=1;if(t-=i[2],e!=Math.round(e)){var o=(1+e).toString().split(".");r=Math.pow(10,o[1].length),n*=r,t=Math.round(t*r),e=Math.round(e*r)}var s=Math.max(0,Math.floor(t/e)*e),a=Math.min(n,Math.floor((t+e)/e)*e),h=t-s>=(a-s)/2?a:s;return h/r+i[2]},i.prototype.setValue=function(e){var i=this.$Range;i[4]!==e&&(i[0]>i[2]?i[4]=Math.min(i[0],Math.max(i[2],e)):i[4]=e,i[6]=!1,this.invalidateDisplayList(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"value"))},i.prototype.updateDisplayList=function(t,i){e.prototype.updateDisplayList.call(this,t,i),this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){},i}(t.Component);t.Range=e,__reflect(e.prototype,"eui.Range"),t.registerBindable(e.prototype,"value")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.$target=null,e.$useVirtualLayout=!1,e.$typicalWidth=71,e.$typicalHeight=22,e}return __extends(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},set:function(t){this.$target!==t&&(this.$target=t,this.clearVirtualLayoutCache())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useVirtualLayout",{get:function(){return this.$useVirtualLayout},set:function(t){t=!!t,this.$useVirtualLayout!=t&&(this.$useVirtualLayout=t,this.dispatchEventWith("useVirtualLayoutChanged"),this.$useVirtualLayout&&!t&&this.clearVirtualLayoutCache(),this.target&&this.target.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.setTypicalSize=function(t,e){t=+t||71,e=+e||22,(t!==this.$typicalWidth||e!==this.$typicalHeight)&&(this.$typicalWidth=t,this.$typicalHeight=e,this.$target&&this.$target.invalidateSize())},e.prototype.scrollPositionChanged=function(){},e.prototype.clearVirtualLayoutCache=function(){},e.prototype.elementAdded=function(t){},e.prototype.elementRemoved=function(t){},e.prototype.getElementIndicesInView=function(){return null},e.prototype.measure=function(){},e.prototype.updateDisplayList=function(t,e){},e}(egret.EventDispatcher);t.LayoutBase=e,__reflect(e.prototype,"eui.LayoutBase")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$ListBase={0:!1,1:!1,2:-2,3:-1,4:!1,5:void 0,6:!1,7:null,8:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"requireSelection",{get:function(){return this.$ListBase[0]},set:function(t){t=!!t;var e=this.$ListBase;t!==e[0]&&(e[0]=t,t&&(e[1]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.$getSelectedIndex()},set:function(t){t=0|+t,this.setSelectedIndex(t,!1)},enumerable:!0,configurable:!0}),i.prototype.$getSelectedIndex=function(){var t=this.$ListBase;return t[2]!=i.NO_PROPOSED_SELECTION?t[2]:t[3]},i.prototype.setSelectedIndex=function(t,e){if(t!=this.selectedIndex){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[2]=t,this.invalidateProperties()}},Object.defineProperty(i.prototype,"selectedItem",{get:function(){var t=this.$ListBase;if(void 0!==t[5])return t[5];var e=this.$getSelectedIndex();if(e!=i.NO_SELECTION&&null!=this.$dataProvider)return this.$dataProvider.length>e?this.$dataProvider.getItemAt(e):void 0},set:function(t){this.setSelectedItem(t,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedItem=function(t,e){if(void 0===e&&(e=!1),this.selectedItem!==t){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[5]=t,this.invalidateProperties()}},i.prototype.commitProperties=function(){var n=this.$dataProviderChanged;e.prototype.commitProperties.call(this);var r=this.$ListBase,o=this.$getSelectedIndex(),s=this.$dataProvider;n&&(o>=0&&s&&o<s.length?this.itemSelected(o,!0):this.requireSelection?r[2]=0:this.setSelectedIndex(-1,!1)),r[1]&&(r[1]=!1,r[0]&&o==i.NO_SELECTION&&s&&s.length>0&&(r[2]=0)),void 0!==r[5]&&(s?r[2]=s.getItemIndex(r[5]):r[2]=i.NO_SELECTION,r[5]=void 0);var a=!1;r[2]!=i.NO_PROPOSED_SELECTION&&(a=this.commitSelection()),r[6]&&(r[6]=!1,a||t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.updateRenderer=function(t,i,n){return this.itemSelected(i,this.$isItemIndexSelected(i)),e.prototype.updateRenderer.call(this,t,i,n)},i.prototype.itemSelected=function(t,e){var i=this.$indexToRenderer[t];i&&(i.selected=e)},i.prototype.$isItemIndexSelected=function(t){return t==this.selectedIndex},i.prototype.commitSelection=function(e){void 0===e&&(e=!0);var n=this.$dataProvider,r=this.$ListBase,o=n?n.length-1:-1,s=r[3],a=r[2];if(a<i.NO_SELECTION&&(a=i.NO_SELECTION),a>o&&(a=o),r[0]&&a==i.NO_SELECTION&&n&&n.length>0)return r[2]=i.NO_PROPOSED_SELECTION,r[4]=!1,!1;if(r[4]){var h=this.dispatchEventWith(egret.Event.CHANGING,!1,!0,!0);if(!h)return this.itemSelected(r[2],!1),r[2]=i.NO_PROPOSED_SELECTION,r[4]=!1,!1}return r[3]=a,r[2]=i.NO_PROPOSED_SELECTION,s!=i.NO_SELECTION&&this.itemSelected(s,!1),r[3]!=i.NO_SELECTION&&this.itemSelected(r[3],!0),e&&(r[4]&&(this.dispatchEventWith(egret.Event.CHANGE),r[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),!0},i.prototype.adjustSelection=function(t,e){void 0===e&&(e=!1);var n=this.$ListBase;n[2]!=i.NO_PROPOSED_SELECTION?n[2]=t:n[3]=t,n[6]=!0,this.invalidateProperties()},i.prototype.itemAdded=function(t,n){e.prototype.itemAdded.call(this,t,n);var r=this.$getSelectedIndex();r==i.NO_SELECTION?this.$ListBase[0]&&this.adjustSelection(n,!0):r>=n&&this.adjustSelection(r+1,!0)},i.prototype.itemRemoved=function(t,n){if(e.prototype.itemRemoved.call(this,t,n),this.selectedIndex!=i.NO_SELECTION){var r=this.$getSelectedIndex();n==r?this.requireSelection&&this.$dataProvider&&this.$dataProvider.length>0?0==n?(this.$ListBase[2]=0,this.invalidateProperties()):this.setSelectedIndex(0,!1):this.adjustSelection(-1,!1):r>n&&this.adjustSelection(r-1,!1)}},i.prototype.onCollectionChange=function(n){e.prototype.onCollectionChange.call(this,n),n.kind==t.CollectionEventKind.RESET?0==this.$dataProvider.length&&this.setSelectedIndex(i.NO_SELECTION,!1):n.kind==t.CollectionEventKind.REFRESH&&this.dataProviderRefreshed()},i.prototype.dataProviderRefreshed=function(){this.setSelectedIndex(i.NO_SELECTION,!1)},i.prototype.rendererAdded=function(t,e,i){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.rendererRemoved=function(t,e,i){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.onRendererTouchBegin=function(t){var e=this.$ListBase;t.$isDefaultPrevented||(e[8]=!1,e[7]=t.$currentTarget,this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this))},i.prototype.onRendererTouchCancle=function(t){var e=this.$ListBase;e[7]=null,e[8]=!0,this.$stage&&this.$stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this)},i.prototype.onRendererTouchEnd=function(e){var i=this.$ListBase,n=e.$currentTarget,r=i[7];n==r&&(i[8]||(this.setSelectedIndex(n.itemIndex,!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,n)),i[8]=!1)},i.prototype.stage_touchEndHandler=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this),this.$ListBase[7]=null},i.NO_SELECTION=-1,i.NO_PROPOSED_SELECTION=-2,i}(t.DataGroup);t.ListBase=e,__reflect(e.prototype,"eui.ListBase"),t.registerBindable(e.prototype,"selectedIndex"),t.registerBindable(e.prototype,"selectedItem")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.thumb=null,t.$viewport=null,t.autoVisibility=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"viewport",{get:function(){return this.$viewport},set:function(e){if(e!=this.$viewport){var i=this.$viewport;i&&(i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),i.removeEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.$viewport=e,e&&(e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),e.addEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.invalidateDisplayList()}},enumerable:!0,configurable:!0}),i.prototype.onViewportResize=function(t){this.invalidateDisplayList()},i.prototype.onPropertyChanged=function(t){},i}(t.Component);t.ScrollBarBase=e,__reflect(e.prototype,"eui.ScrollBarBase")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.trackHighlight=null,t.thumb=null,t.track=null,t.$SliderBase={0:0,1:0,2:0,3:0,4:null,5:null,6:300,7:0,8:0,9:!0},t.maximum=10,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this.$SliderBase[6]},set:function(t){this.$SliderBase[6]=+t||0},enumerable:!0,configurable:!0}),i.prototype.pointToValue=function(t,e){return this.minimum},Object.defineProperty(i.prototype,"liveDragging",{get:function(){return this.$SliderBase[9]},set:function(t){this.$SliderBase[9]=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pendingValue",{get:function(){return this.$SliderBase[7]},set:function(t){t=+t||0;var e=this.$SliderBase;t!==e[7]&&(e[7]=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.setValue=function(t){this.$SliderBase[7]=t,e.prototype.setValue.call(this,t)},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.thumb?(this.thumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track?(this.track.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i===this.trackHighlight&&(this.trackHighlight.touchEnabled=!1,egret.is(this.trackHighlight,"egret.DisplayObjectContainer")&&(this.trackHighlight.touchChildren=!1))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.thumb?(this.thumb.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track&&(this.track.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this))},i.prototype.onTrackOrThumbResize=function(t){this.updateSkinDisplayList()},i.prototype.onThumbTouchBegin=function(e){var i=this.$SliderBase;i[5]&&i[5].isPlaying&&this.stopAnimation();var n=this.$stage;n.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),n.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this);var r=this.thumb.globalToLocal(e.stageX,e.stageY,egret.$TempPoint);i[0]=r.x,i[1]=r.y,t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START)},i.prototype.onStageTouchMove=function(t){var e=this.$SliderBase;e[2]=t.$stageX,e[3]=t.$stageY;var i=this.track;if(i){var n=i.globalToLocal(e[2],e[3],egret.$TempPoint),r=this.pointToValue(n.x-e[0],n.y-e[1]);r=this.nearestValidValue(r,this.snapInterval),this.updateWhenTouchMove(r),t.updateAfterEvent()}},i.prototype.updateWhenTouchMove=function(t){t!=this.$SliderBase[7]&&(this.liveDragging?(this.setValue(t),this.dispatchEventWith(egret.Event.CHANGE)):this.pendingValue=t)},i.prototype.onStageTouchEnd=function(e){var i=e.$currentTarget;i.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),i.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END);var n=this.$SliderBase;this.liveDragging||this.value==n[7]||(this.setValue(n[7]),this.dispatchEventWith(egret.Event.CHANGE))},i.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),this.$SliderBase[4]=t.$target},i.prototype.stageTouchEndHandler=function(t){var e=t.$target,i=this.$SliderBase;t.$currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),i[4]!=e&&this.contains(e)&&egret.TouchEvent.dispatchTouchEvent(this,egret.TouchEvent.TOUCH_TAP,!0,!0,t.$stageX,t.$stageY,t.touchPointID),i[4]=null},i.prototype.$animationUpdateHandler=function(t){this.pendingValue=t.currentValue},i.prototype.animationEndHandler=function(e){this.setValue(this.$SliderBase[8]),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.stopAnimation=function(){this.$SliderBase[5].stop(),this.setValue(this.nearestValidValue(this.pendingValue,this.snapInterval)),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.onTrackTouchBegin=function(e){var i=this.thumb?this.thumb.width:0,n=this.thumb?this.thumb.height:0,r=e.$stageX-i/2,o=e.$stageY-n/2,s=this.track.globalToLocal(r,o,egret.$TempPoint),a=this.$Range,h=this.pointToValue(s.x,s.y);h=this.nearestValidValue(h,a[7]);var l=this.$SliderBase;if(h!=l[7])if(0!=l[6]){l[5]||(l[5]=new t.sys.Animation(this.$animationUpdateHandler,this),l[5].endFunction=this.animationEndHandler);var u=l[5];u.isPlaying&&this.stopAnimation(),l[8]=h,u.duration=l[6]*(Math.abs(l[7]-l[8])/(a[0]-a[2])),u.from=l[7],u.to=l[8],t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),u.play()}else this.setValue(h),this.dispatchEventWith(egret.Event.CHANGE)},i}(t.Range);t.SliderBase=e,__reflect(e.prototype,"eui.SliderBase")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){if(!t)return"";for(var e="  at <"+t.name,i=t.attributes,n=Object.keys(i),r=n.length,o=0;r>o;o++){var s=n[o],a=i[s];("id"!=s||"__"!=a.substring(0,2))&&(e+=" "+s+'="'+a+'"')}return e+=0==t.children.length?"/>":">"}function i(t){var i=e(t.parent),n=e(t).substring(5);return i+"\n      	"+n}var n=[],r=1,o="hostComponent",s="eui.Skin",a="Declarations",h="egret.Rectangle",l="Class",u="Array",p="Percentage",c="State[]",d="skinName",f=[u,"boolean","string","number"],y=["id","locked","includeIn","excludeFrom"],g=[["<","&lt;"],[">","&gt;"],["&","&amp;"],['"',"&quot;"],["'","&apos;"]],v=["null","NaN","undefined","true","false"],m=function(){function e(){this.delayAssignmentDic={}}return e.prototype.$parseCode=function(t,e){var i=e?e:"$exmlClass"+r++,n=eval,o=n(t),s=!0;if(s&&o){egret.registerClass(o,i);for(var a=i.split("."),h=a.length,l=__global,u=0;h-1>u;u++){var p=a[u];l=l[p]||(l[p]={})}l[a[h-1]]||(l[a[h-1]]=o)}return o},e.prototype.parse=function(t){var e=null;e=egret.XML.parse(t);var i=!1,n="";e.attributes["class"]?(n=e.attributes["class"],delete e.attributes["class"],i=!!n):n="$exmlClass"+r++;var o=this.parseClass(e,n),s=o.toCode(),a=null,h=eval;if(a=h(s),i&&a){egret.registerClass(a,n);for(var l=n.split("."),u=l.length,p=__global,c=0;u-1>c;c++){var d=l[c];p=p[d]||(p[d]={})}p[l[u-1]]||(p[l[u-1]]=a)}return a},e.prototype.parseClass=function(e,i){t.exmlConfig||(t.exmlConfig=new t.EXMLConfig),this.currentXML=e,this.currentClassName=i,this.delayAssignmentDic={},this.idDic={},this.stateCode=[],this.stateNames=[],this.skinParts=[],this.bindings=[],this.declarations=null,this.currentClass=new t.EXClass,this.stateIds=[];var n=i.lastIndexOf(".");-1!=n?this.currentClass.className=i.substring(n+1):this.currentClass.className=i,this.startCompile();var r=this.currentClass;return this.currentClass=null,r},e.prototype.startCompile=function(){var e=this.getClassNameOfNode(this.currentXML);this.isSkinClass=e==s,this.currentClass.superClass=e,this.getStateNames();var i=this.currentXML.children;if(i)for(var n=i.length,r=0;n>r;r++){var o=i[r];if(1===o.nodeType&&o.namespace==t.NS_W&&o.localName==a){this.declarations=o;break}}this.currentXML.namespace&&(this.addIds(this.currentXML.children),this.createConstructFunc())},e.prototype.addIds=function(e){if(e)for(var i=e.length,n=0;i>n;n++){var r=e[n];if(1==r.nodeType&&r.namespace&&!this.isInnerClass(r))if(this.addIds(r.children),r.namespace!=t.NS_W&&r.localName){if(this.isProperty(r)){var o=r.localName,s=o.indexOf("."),a=r.children;if(-1==s||!a||0==a.length)continue;var h=a[0];this.stateIds.push(h.attributes.id)}else if(1===r.nodeType){var l=r.attributes.id;if(l){var u=new RegExp("^[a-zA-Z_$]{1}[a-z0-9A-Z_$]*");null==l.match(u)&&egret.$warn(2022,l),null!=l.match(new RegExp(/ /g))&&egret.$warn(2022,l),-1==this.skinParts.indexOf(l)&&this.skinParts.push(l),this.createVarForNode(r),this.isStateNode(r)&&this.stateIds.push(l)}else this.createIdForNode(r),this.isStateNode(r)&&this.stateIds.push(r.attributes.id)}}else;}},e.prototype.isInnerClass=function(e){if(e.hasOwnProperty("isInnerClass"))return e.isInnerClass;var i="Skin"==e.localName&&e.namespace==t.NS_S;if(!i)if(this.isProperty(e))i=!1;else{var n=void 0,r=e.parent;if(this.isProperty(r)){n=r.localName;var o=n.indexOf(".");if(-1!=o){n.substring(o+1);n=n.substring(0,o)}r=r.parent}else n=t.exmlConfig.getDefaultPropById(r.localName,r.namespace);var s=t.exmlConfig.getClassNameById(r.localName,r.namespace);i=t.exmlConfig.getPropertyType(n,s)==l}return e.isInnerClass=i,i},e.prototype.containsState=function(t){var e=t.attributes;if(e.includeIn||e.excludeFrom)return!0;for(var i=Object.keys(e),n=i.length,r=0;n>r;r++){var o=i[r];if(-1!=o.indexOf("."))return!0}return!1},e.prototype.createIdForNode=function(t){var e=this.getNodeId(t);this.idDic[e]?this.idDic[e]++:this.idDic[e]=1,e+=this.idDic[e],t.attributes.id=e},e.prototype.getNodeId=function(t){return t.attributes.id?t.attributes.id:"_"+t.localName},e.prototype.createVarForNode=function(e){var i=this.getClassNameOfNode(e);""!=i&&(this.currentClass.getVariableByName(e.attributes.id)||this.currentClass.addVariable(new t.EXVariable(e.attributes.id)))},e.prototype.createFuncForNode=function(e){var i=e.localName,n=this.isBasicTypeData(i);if(n)return this.createBasicTypeForNode(e);var r=this.getClassNameOfNode(e),o=new t.EXFunction,s="_i",a=e.attributes.id;o.name=a+s,this.currentClass.addFunction(o);var h=new t.EXCodeBlock;o.codeBlock=h;var l="t";"Object"==i?h.addVar(l,"{}"):h.addVar(l,"new "+r+"()");var u=!!this.currentClass.getVariableByName(a);u&&h.addAssignment("this."+a,l),this.addAttributesToCodeBlock(h,l,e),this.initlizeChildNode(e,h,l);var p=this.delayAssignmentDic[a];if(p)for(var c=p.length,d=0;c>d;d++){var f=p[d];h.concat(f)}return h.addReturn(l),"this."+o.name+"()"},e.prototype.isBasicTypeData=function(t){return-1!=f.indexOf(t)},e.prototype.createBasicTypeForNode=function(t){var e=t.localName,i="",n=this.currentClass.getVariableByName(t.attributes.id),r=t.children,o="";if(r&&r.length>0){var s=r[0];3==s.nodeType&&(o=s.text.trim())}switch(e){case u:var a=[];if(r)for(var h=r.length,l=0;h>l;l++){var p=r[l];1==p.nodeType&&a.push(this.createFuncForNode(p))}i="["+a.join(",")+"]";break;case"boolean":i="false"!=o&&o?"true":"false";break;case"number":i=o,-1!=i.indexOf("%")&&(i=i.substring(0,i.length-1));
break;case"string":i=this.formatString(o)}return n&&(n.defaultValue=i),i},e.prototype.addAttributesToCodeBlock=function(e,i,n){var r,o,s=n.attributes,a=Object.keys(s);a.sort();for(var h=a.length,l=0;h>l;l++)if(r=a[l],this.isNormalKey(r)&&(o=s[r],r=this.formatKey(r,o),o=this.formatValue(r,o,n))){if(this.currentClass.getVariableByName(o)){var u="this.",p=s.id,c=u+p+" = t;";this.currentClass.getVariableByName(p)||this.createVarForNode(n),e.containsCodeLine(c)||e.addCodeLineAt(c,1);var d=new t.EXCodeBlock;"this"==i?d.addAssignment(i,u+o,r):(d.startIf(u+p),d.addAssignment(u+p,u+o,r),d.endBlock()),this.delayAssignmentDic[o]||(this.delayAssignmentDic[o]=[]),this.delayAssignmentDic[o].push(d),o=u+o}e.addAssignment(i,o,r)}},e.prototype.initlizeChildNode=function(e,n,r){var o=e.children;if(o&&0!=o.length){for(var s,a=t.exmlConfig.getClassNameById(e.localName,e.namespace),h=[],l=o.length,u=[],p=0;l>p;p++){var c=o[p];if(1==c.nodeType&&c.namespace!=t.NS_W)if(this.isInnerClass(c)){if("Skin"==c.localName){var f=this.parseInnerClass(c),y=t.exmlConfig.getPropertyType(d,a);y?n.addAssignment(r,f,d):egret.$error(2005,this.currentClassName,d,i(c))}}else{var g=c.localName;if(this.isProperty(c)){if(!this.isNormalKey(g))continue;var y=t.exmlConfig.getPropertyType(c.localName,a);if(!y)continue;if(!c.children||0==c.children.length)continue;this.addChildrenToProp(c.children,y,g,n,r,s,u,e)}else h.push(c)}}if(0!=h.length){var v=t.exmlConfig.getDefaultPropById(e.localName,e.namespace),m=t.exmlConfig.getPropertyType(v,a);v&&m&&this.addChildrenToProp(h,m,v,n,r,s,u,e)}}},e.prototype.parseInnerClass=function(t){var i=n.pop();i||(i=new e);var o=this.currentClass.className+"$"+t.localName+r++,s=i.parseClass(t,o);return this.currentClass.addInnerClass(s),n.push(i),o},e.prototype.addChildrenToProp=function(t,e,i,n,r,o,s,a){var h="",p=t.length;if(p>1){if(e!=u)return;for(var c=[],d=0;p>d;d++){var f=t[d];if(1==f.nodeType){h=this.createFuncForNode(f);this.getClassNameOfNode(f);this.isStateNode(f)||c.push(h)}}h="["+c.join(",")+"]"}else{var y=t[0];if(e==u)if(y.localName==u){var c=[];if(y.children)for(var g=y.children.length,v=0;g>v;v++){var f=y.children[v];if(1==f.nodeType){h=this.createFuncForNode(f);this.getClassNameOfNode(f);this.isStateNode(f)||c.push(h)}}h="["+c.join(",")+"]"}else{h=this.createFuncForNode(y);this.getClassNameOfNode(y);h=this.isStateNode(y)?"[]":"["+h+"]"}else if(1==y.nodeType)if(e==l){if(p>1)return;h=this.parseInnerClass(t[0])}else{this.getClassNameOfNode(y);h=this.createFuncForNode(y)}else h=this.formatValue(i,y.text,a)}""!=h&&(-1==h.indexOf("()")&&(i=this.formatKey(i,h)),-1==s.indexOf(i)&&s.push(i),n.addAssignment(r,h,i))},e.prototype.isProperty=function(e){if(e.hasOwnProperty("isProperty"))return e.isProperty;var i,n=e.localName;if(n&&1===e.nodeType&&e.parent&&!this.isBasicTypeData(n)){var r=e.parent,o=n.indexOf(".");-1!=o&&(n=n.substr(0,o));var s=t.exmlConfig.getClassNameById(r.localName,r.namespace);i=!!t.exmlConfig.getPropertyType(n,s)}else i=!1;return e.isProperty=i,i},e.prototype.isNormalKey=function(t){return t&&-1==t.indexOf(".")&&-1==t.indexOf(":")&&-1==y.indexOf(t)?!0:!1},e.prototype.formatKey=function(t,e){return-1!=e.indexOf("%")&&("height"==t?t="percentHeight":"width"==t&&(t="percentWidth")),t},e.prototype.formatValue=function(e,i,n){i||(i="");var r=i;i=i.trim();var o=this.getClassNameOfNode(n),s=t.exmlConfig.getPropertyType(e,o),a=this.formatBinding(e,i,n);if(a){this.checkIdForState(n);var u="this";n!==this.currentXML&&(u+="."+n.attributes.id),this.bindings.push(new t.EXBinding(u,e,a.templates,a.chainIndex)),i=""}else if(s==h){i="new "+h+"("+i+")"}else if(s==p)-1!=i.indexOf("%")&&(i=this.formatString(i));else{switch(s){case l:e==d&&(i=this.formatString(r));break;case"number":0==i.indexOf("#")?i="0x"+i.substring(1):-1!=i.indexOf("%")&&(i=parseFloat(i.substr(0,i.length-1)).toString());break;case"boolean":i="false"!=i&&i?"true":"false";break;case"string":case"any":i=this.formatString(r)}}return i},e.prototype.formatString=function(t){return t=this.unescapeHTMLEntity(t),t=t.split("\n").join("\\n"),t=t.split("\r").join("\\n"),t=t.split('"').join('\\"'),t='"'+t+'"'},e.prototype.formatBinding=function(t,e,i){if(!e)return null;if(e=e.trim(),"{"!=e.charAt(0)||"}"!=e.charAt(e.length-1))return null;e=e.substring(1,e.length-1).trim();for(var n=-1==e.indexOf("+")?[e]:this.parseTemplates(e),r=[],s=n.length,a=0;s>a;a++){var h=n[a].trim();if(h){var l=h.charAt(0);if(!("'"==l||'"'==l||l>="0"&&"9">=l||"-"==l||-1==h.indexOf(".")&&-1!=v.indexOf(h))){0==h.indexOf("this.")&&(h=h.substring(5));var u=h.split(".")[0];u!=o&&-1==this.skinParts.indexOf(u)&&(h=o+"."+h),n[a]='"'+h+'"',r.push(a)}}else n.splice(a,1),a--,s--}return{templates:n,chainIndex:r}},e.prototype.parseTemplates=function(t){if(-1==t.indexOf("'"))return t.split("+");var e=!1,i="";for(t=t.split("\\'").join("0");t.length>0;){var n=t.indexOf("'");if(-1==n){i+=t;break}i+=t.substring(0,n+1),t=t.substring(n+1),n=t.indexOf("'"),-1==n&&(n=t.length-1,e=!0);var r=t.substring(0,n+1);i+=r.split("+").join("1"),t=t.substring(n+1)}t=i.split("0").join("\\'"),e&&(t+="'");for(var o=t.split("+"),s=o.length,a=0;s>a;a++)o[a]=o[a].split("1").join("+");return o},e.prototype.unescapeHTMLEntity=function(t){if(!t)return"";for(var e=g.length,i=0;e>i;i++){var n=g[i],r=n[0],o=n[1];t=t.split(o).join(r)}return t},e.prototype.createConstructFunc=function(){var e=new t.EXCodeBlock;e.addEmptyLine();var i="this";if(this.addAttributesToCodeBlock(e,i,this.currentXML),this.declarations){var n=this.declarations.children;if(n&&n.length>0)for(var r=n.length,o=0;r>o;o++){var s=n[o];if(1==s.nodeType){var a=this.createFuncForNode(s);a&&e.addCodeLine(a+";")}}}this.initlizeChildNode(this.currentXML,e,i);var h,l,u=this.stateIds;if(u.length>0){l=u.length;for(var o=0;l>o;o++)h=u[o],e.addCodeLine("this."+h+"_i();");e.addEmptyLine()}var p=this.skinParts,c="[]";if(l=p.length,l>0){for(var o=0;l>o;o++)p[o]='"'+p[o]+'"';c="["+p.join(",")+"]"}var d=new t.EXFunction;d.name="skinParts",d.isGet=!0;var f=new t.EXCodeBlock;f.addReturn(c),d.codeBlock=f,this.currentClass.addFunction(d),this.currentXML.attributes.id="",this.createStates(this.currentXML);for(var y,g=this.currentXML,v=(this.getClassNameOfNode(g),g.attributes),m=Object.keys(v),$=m.length,E=0;$>E;E++){var C=m[E],_=v[C],b=C.indexOf(".");if(-1!=b){var S=C.substring(0,b);S=this.formatKey(S,_);var T=this.formatValue(S,_,g);if(!T)continue;var x=C.substr(b+1);y=this.getStateByName(x,g);var I=y.length;if(I>0)for(var o=0;I>o;o++){var P=y[o];P.addOverride(new t.EXSetProperty("",S,T))}}}var L=this.stateCode;if(l=L.length,l>0){var N="	";e.addCodeLine("this.states = [");for(var O=!0,o=0;l>o;o++){var P=L[o];O?O=!1:e.addCodeLine(N+",");for(var B=P.toCode().split("\n"),A=0;A<B.length;){var D=B[A];D&&e.addCodeLine(N+D),A++}}e.addCodeLine("];")}var R=this.bindings;if(l=R.length,l>0){e.addEmptyLine();for(var o=0;l>o;o++){var M=R[o];e.addCodeLine(M.toCode())}}this.currentClass.constructCode=e},e.prototype.isStateNode=function(t){var e=t.attributes;return e.hasOwnProperty("includeIn")||e.hasOwnProperty("excludeFrom")},e.prototype.getStateNames=function(){var e=this.currentXML,i=t.exmlConfig.getClassNameById(e.localName,e.namespace),n=t.exmlConfig.getPropertyType("states",i);if(n==c){var r=e.attributes.states;r&&delete e.attributes.states;var o,s,a=this.stateNames,h=e.children;if(h)for(var l=h.length,u=0;l>u;u++)if(s=h[u],1==s.nodeType&&"states"==s.localName){s.namespace=t.NS_W,o=s.children;break}if(o||r)if(r)for(var p=r.split(","),d=p.length,u=0;d>u;u++){var f=p[u].trim();f&&(-1==a.indexOf(f)&&a.push(f),this.stateCode.push(new t.EXState(f)))}else for(var y=o.length,u=0;y>u;u++){var g=o[u];if(1==g.nodeType){var v=[],m=g.attributes;if(m.stateGroups)for(var $=m.stateGroups.split(","),E=$.length,C=0;E>C;C++){var _=$[C].trim();_&&(-1==a.indexOf(_)&&a.push(_),v.push(_))}var f=m.name;-1==a.indexOf(f)&&a.push(f),this.stateCode.push(new t.EXState(f,v))}}}},e.prototype.createStates=function(e){var i=e.children;if(i)for(var n=i.length,r=0;n>r;r++){var o=i[r];if(1==o.nodeType&&!this.isInnerClass(o)&&(this.createStates(o),o.namespace!=t.NS_W&&o.localName))if(this.isProperty(o)){var s=o.localName,a=s.indexOf("."),h=o.children;if(-1==a||!h||0==h.length)continue;var l=s.substring(a+1);s=s.substring(0,a);var p=this.getClassNameOfNode(e),c=(t.exmlConfig.getPropertyType(s,p),h[0]),d=void 0;1==c.nodeType?(this.createFuncForNode(c),this.checkIdForState(c),d="this."+c.attributes.id):d=this.formatValue(s,c.text,e);var f=this.getStateByName(l,o),y=f.length;if(y>0)for(var g=0;y>g;g++){var v=f[g];v.addOverride(new t.EXSetProperty(e.attributes.id,s,d))}}else if(this.containsState(o)){var m=o.attributes,$=m.id;this.getClassNameOfNode(o);this.checkIdForState(o);var l=void 0,f=void 0,v=void 0;if(this.isStateNode(o)){var E="",C=o.parent;C.localName==u&&(C=C.parent),C&&C.parent&&this.isProperty(C)&&(C=C.parent),C&&C!=this.currentXML&&(E=C.attributes.id,this.checkIdForState(C));var _=this.findNearNodeId(o),b=[];if(m.includeIn)b=m.includeIn.split(",");else{for(var S=m.excludeFrom.split(","),T=S.length,g=0;T>g;g++){var x=S[g];this.getStateByName(x,o)}T=this.stateCode.length;for(var g=0;T>g;g++)v=this.stateCode[g],-1==S.indexOf(v.name)&&b.push(v.name)}for(var I=b.length,P=0;I>P;P++)if(l=b[P],f=this.getStateByName(l,o),f.length>0)for(var y=f.length,g=0;y>g;g++)v=f[g],v.addOverride(new t.EXAddItems($,E,_.position,_.relativeTo))}for(var L=Object.keys(m),N=L.length,O=0;N>O;O++){var B=L[O],d=m[B],a=B.indexOf(".");if(-1!=a){var A=B.substring(0,a);A=this.formatKey(A,d);var D=this.formatBinding(A,d,o);if(!D&&(d=this.formatValue(A,d,o),!d))continue;l=B.substr(a+1),f=this.getStateByName(l,o);var y=f.length;if(y>0)for(var g=0;y>g;g++)v=f[g],D?v.addOverride(new t.EXSetStateProperty($,A,D.templates,D.chainIndex)):v.addOverride(new t.EXSetProperty($,A,d))}}}}},e.prototype.checkIdForState=function(t){if(t&&!this.currentClass.getVariableByName(t.attributes.id)){this.createVarForNode(t);var e=t.attributes.id,i=e+"_i",n=this.currentClass.getFuncByName(i);if(n){var r="this."+e+" = t;",o=n.codeBlock;o&&(o.containsCodeLine(r)||o.addCodeLineAt(r,1))}}},e.prototype.getStateByName=function(t,e){for(var i=[],n=this.stateCode,r=n.length,o=0;r>o;o++){var s=n[o];if(s.name==t)-1==i.indexOf(s)&&i.push(s);else if(s.stateGroups.length>0){for(var a=!1,h=s.stateGroups.length,l=0;h>l;l++){var u=s.stateGroups[l];if(u==t){a=!0;break}}a&&-1==i.indexOf(s)&&i.push(s)}}return i},e.prototype.findNearNodeId=function(t){for(var e,i,n,r=t.parent,o="",s=-1,a=!1,h=r.children,l=h.length,u=0;l>u;u++){var p=h[u];this.isProperty(p)||(p==t?(a=!0,s=u):!a||n||this.isStateNode(p)||(n=p),a||this.isStateNode(p)||(i=p))}return 0==s?(e=0,{position:e,relativeTo:o}):s==l-1?(e=1,{position:e,relativeTo:o}):n&&(e=2,o=n.attributes.id)?(this.checkIdForState(n),{position:e,relativeTo:o}):{position:1,relativeTo:o}},e.prototype.getClassNameOfNode=function(e){var i=t.exmlConfig.getClassNameById(e.localName,e.namespace);return i},e}();t.EXMLParser=m,__reflect(m.prototype,"eui.sys.EXMLParser")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.$selected=!1,t.$autoSelected=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"selected",{get:function(){return this.$selected},set:function(t){this.$setSelected(t)},enumerable:!0,configurable:!0}),i.prototype.$setSelected=function(e){return e=!!e,e===this.$selected?!1:(this.$selected=e,this.invalidateState(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selected"),!0)},i.prototype.getCurrentState=function(){var t=e.prototype.getCurrentState.call(this);if(this.$selected){var i=t+"AndSelected",n=this.skin;return n&&n.hasState(i)?i:"disabled"==t?"disabled":"down"}return t},i.prototype.buttonReleased=function(){this.$autoSelected&&(this.selected=!this.$selected,this.dispatchEventWith(egret.Event.CHANGE))},i}(t.Button);t.ToggleButton=e,__reflect(e.prototype,"eui.ToggleButton"),t.registerBindable(e.prototype,"selected")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$horizontalAlign="left",e.$verticalAlign="top",e.$gap=6,e.$paddingLeft=0,e.$paddingRight=0,e.$paddingTop=0,e.$paddingBottom=0,e.elementSizeTable=[],e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e.maxElementSize=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this.$horizontalAlign},set:function(t){this.$horizontalAlign!=t&&(this.$horizontalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this.$gap},set:function(t){t=+t||0,this.$gap!==t&&(this.$gap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.$paddingLeft},set:function(t){t=+t||0,this.$paddingLeft!==t&&(this.$paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.$paddingRight},set:function(t){t=+t||0,this.$paddingRight!==t&&(this.$paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.$paddingTop},set:function(t){t=+t||0,this.$paddingTop!==t&&(this.$paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.$paddingBottom},set:function(t){t=+t||0,this.$paddingBottom!==t&&(this.$paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),e.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},e.prototype.measure=function(){this.$target&&(this.$useVirtualLayout?this.measureVirtual():this.measureReal())},e.prototype.measureReal=function(){},e.prototype.measureVirtual=function(){},e.prototype.updateDisplayList=function(t,e){var i=this.$target;if(i)return 0==i.numElements?void i.setContentSize(Math.ceil(this.$paddingLeft+this.$paddingRight),Math.ceil(this.$paddingTop+this.$paddingBottom)):void(this.$useVirtualLayout?this.updateDisplayListVirtual(t,e):this.updateDisplayListReal(t,e))},e.prototype.getStartPosition=function(t){return 0},e.prototype.getElementSize=function(t){return 0},e.prototype.getElementTotalSize=function(){return 0},e.prototype.elementRemoved=function(e){this.$useVirtualLayout&&(t.prototype.elementRemoved.call(this,e),this.elementSizeTable.splice(e,1))},e.prototype.clearVirtualLayoutCache=function(){this.$useVirtualLayout&&(this.elementSizeTable=[],this.maxElementSize=0)},e.prototype.findIndexAt=function(t,e,i){var n=.5*(e+i)|0,r=this.getStartPosition(n),o=this.getElementSize(n);return t>=r&&t<r+o+this.$gap?n:e==i?-1:r>t?this.findIndexAt(t,e,Math.max(e,n-1)):this.findIndexAt(t,Math.min(n+1,i),i)},e.prototype.scrollPositionChanged=function(){if(t.prototype.scrollPositionChanged.call(this),this.$useVirtualLayout){var e=this.getIndexInView();e&&(this.indexInViewCalculated=!0,this.target.invalidateDisplayList())}},e.prototype.getIndexInView=function(){return!1},e.prototype.updateDisplayListVirtual=function(t,e){},e.prototype.updateDisplayListReal=function(t,e){},e.prototype.flexChildrenProportionally=function(t,e,i,n){var r,o=n.length;do{r=!0;var s=e-t*i/100;s>0?e-=s:s=0;for(var a=e/i,h=0;o>h;h++){var l=n[h],u=l.percent*a;if(u<l.min){var p=l.min;l.size=p,n[h]=n[--o],n[o]=l,i-=l.percent,s>=p?s-=p:(e-=p-s,s=0),r=!1;break}if(u>l.max){var c=l.max;l.size=c,n[h]=n[--o],n[o]=l,i-=l.percent,s>=c?s-=c:(e-=c-s,s=0),r=!1;break}l.size=u}}while(!r)},e}(t.LayoutBase);t.LinearLayoutBase=e,__reflect(e.prototype,"eui.LinearLayoutBase")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){this.layoutElement=null,this.size=0,this.percent=0/0,this.min=0/0,this.max=0/0}return t}();t.ChildInfo=e,__reflect(e.prototype,"eui.sys.ChildInfo")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t,e){if(!this.thumb||!this.track)return 0;var i=this.$Range,n=i[0]-i[2],r=this.getThumbRange();return i[2]+(0!=r?t/r*n:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.width;return this.thumb.getLayoutBounds(t),e-t.width},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],n=i>0?(this.pendingValue-t[2])/i*e:0,r=this.track.localToGlobal(n,0,egret.$TempPoint),o=r.x,s=r.y,a=this.thumb.$parent.globalToLocal(o,s,egret.$TempPoint).x,h=egret.$TempRectangle;if(this.thumb.getLayoutBounds(h),this.thumb.setLayoutBoundsPosition(Math.round(a),h.y),this.trackHighlight&&this.trackHighlight.$parent){var l=this.trackHighlight.$parent.globalToLocal(o,s,egret.$TempPoint).x-n;this.trackHighlight.x=Math.round(l),this.trackHighlight.width=Math.round(n)}}},e}(t.SliderBase);t.HSlider=e,__reflect(e.prototype,"eui.HSlider")}(eui||(eui={}));var eui;!function(t){var e=[],i={},n={},r=function(){function t(){}return t.prototype.getAsset=function(t,r,o){var s=i[t];if(s)return void s.push([r,o]);var a=e.pop();a||(a=new egret.ImageLoader),i[t]=[[r,o]],n[a.$hashCode]=t,a.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),a.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),a.load(t)},t.prototype.onLoadFinish=function(t){var r=t.currentTarget;r.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),r.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this);var o;t.$type==egret.Event.COMPLETE&&(o=new egret.Texture,o._setBitmapData(r.data),r.data=null),e.push(r);var s=n[r.$hashCode];delete n[r.$hashCode];var a=i[s];delete i[s];for(var h=a.length,l=0;h>l;l++){var u=a[l];u[0].call(u[1],o,s)}},t}();t.DefaultAssetAdapter=r,__reflect(r.prototype,"eui.DefaultAssetAdapter",["eui.IAssetAdapter"])}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.sourceChanged=!1,i._source=null,i.initializeUIValues(),t&&(i.source=t),i}return __extends(i,e),Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$scale9Grid=t,this.$invalidateContentBounds(),this.invalidateDisplayList()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){t!=this.$fillMode&&(this.$fillMode=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(t){var i=e.prototype.$setFillMode.call(this,t);return this.invalidateDisplayList(),i},Object.defineProperty(i.prototype,"source",{get:function(){return this._source},set:function(t){t!=this._source&&(this._source=t,this.$stage?this.parseSource():(this.sourceChanged=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),i.prototype.$setBitmapData=function(t){if(t==this.$Bitmap[0])return!1;var i=e.prototype.$setBitmapData.call(this,t);return this.sourceChanged=!1,this.invalidateSize(),this.invalidateDisplayList(),i},i.prototype.parseSource=function(){var e=this;this.sourceChanged=!1;var i=this._source;i&&"string"==typeof i?t.getAssets(this._source,function(t){i===e._source&&egret.is(t,"egret.Texture")&&(e.$setBitmapData(t),t&&e.dispatchEventWith(egret.Event.COMPLETE))}):this.$setBitmapData(i)},i.prototype.$measureContentBounds=function(t){var e=(this.$Bitmap,this.$Bitmap[0]);if(e){var i=this.$UIComponent,n=i[10],r=i[11];if(isNaN(n)||isNaN(r))return void t.setEmpty();"clip"==this.$fillMode&&(n>e.$getTextureWidth()&&(n=e.$getTextureWidth()),r>e.$getTextureHeight()&&(r=e.$getTextureHeight())),t.setTo(0,0,n,r)}else t.setEmpty()},i.prototype.$render=function(){var t=this.$Bitmap[0];if(t){var e=this.$UIComponent,i=e[10],n=e[11];if(0!==i&&0!==n){var r=this.$Bitmap;egret.sys.BitmapNode.$updateTextureData(this.$renderNode,r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],i,n,r[13],r[14],this.scale9Grid||r[0].scale9Grid,this.$fillMode,r[10])}}},i.prototype.createChildren=function(){this.sourceChanged&&this.parseSource()},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this),this.sourceChanged&&this.parseSource()},i.prototype.measure=function(){var t=this.$Bitmap[0];t?this.setMeasuredSize(t.$getTextureWidth(),t.$getTextureHeight()):this.setMeasuredSize(0,0)},i.prototype.updateDisplayList=function(t,e){this.$invalidateContentBounds()},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.Bitmap);t.Image=e,__reflect(e.prototype,"eui.Image",["eui.UIComponent","egret.DisplayObject"]),t.sys.implementUIComponent(e,egret.Bitmap),t.registerProperty(e,"scale9Grid","egret.Rectangle")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._data=null,t._selected=!1,t.itemIndex=-1,t.touchCaptured=!1,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),i.prototype.dataChanged=function(){},Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.onTouchCancle=function(t){this.touchCaptured=!1;var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.invalidateState()},i.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},i.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},i.prototype.getCurrentState=function(){var t="up";if(this.enabled||(t="disabled"),this.touchCaptured&&(t="down"),this._selected){var e=t+"AndSelected",i=this.skin;return i&&i.hasState(e)?e:"disabled"==t?"disabled":"down"}return t},i}(t.Component);t.ItemRenderer=e,__reflect(e.prototype,"eui.ItemRenderer",["eui.IItemRenderer"]),t.registerBindable(e.prototype,"data")}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function n(t){var e=i.call(this)||this;return e.$styleSetMap={fontFamily:!0,size:!0,bold:!0,italic:!0,textAlign:!0,verticalAlign:!0,lineSpacing:!0,textColor:!0,wordWrap:!0,displayAsPassword:!0,strokeColor:!0,stroke:!0,maxChars:!0,multiline:!0,border:!0,borderColor:!0,background:!0,backgroundColor:!0},e.$revertStyle={},e.$style=null,e.$changeFromStyle=!1,e._widthConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(n,i),Object.defineProperty(n.prototype,"style",{get:function(){return this.$style},set:function(t){this.$setStyle(t)},enumerable:!0,configurable:!0}),n.prototype.$setStyle=function(t){if(this.$style!=t){this.$style=t;var e=egret.getImplementation("eui.Theme");if(e){this.$changeFromStyle=!0;for(var i in this.$revertStyle)this[i]=this.$revertStyle[i];if(this.$revertStyle={},null==t)return void(this.$changeFromStyle=!1);for(var n=t.split(","),r=0;r<n.length;r++){var o=e.$getStyleConfig(n[r]);if(o)for(var i in o)if(this.$styleSetMap[i]){var s=this[i];this[i]=o[i],this.$revertStyle[i]=s}}this.$changeFromStyle=!1}}},n.prototype.$setFontFamily=function(t){return this.$changeFromStyle||(delete this.$revertStyle.fontFanily,this.$styleSetMap.fontFanily=!1),i.prototype.$setFontFamily.call(this,t)},n.prototype.$setSize=function(t){return this.$changeFromStyle||(delete this.$revertStyle.size,this.$styleSetMap.size=!1),i.prototype.$setSize.call(this,t)},n.prototype.$setBold=function(t){return this.$changeFromStyle||(delete this.$revertStyle.bold,this.$styleSetMap.bold=!1),i.prototype.$setBold.call(this,t)},n.prototype.$setItalic=function(t){return this.$changeFromStyle||(delete this.$revertStyle.italic,this.$styleSetMap.italic=!1),i.prototype.$setItalic.call(this,t)},n.prototype.$setTextAlign=function(t){return this.$changeFromStyle||(delete this.$revertStyle.textAlign,this.$styleSetMap.textAlign=!1),i.prototype.$setTextAlign.call(this,t)},n.prototype.$setVerticalAlign=function(t){return this.$changeFromStyle||(delete this.$revertStyle.verticalAlign,this.$styleSetMap.verticalAlign=!1),i.prototype.$setVerticalAlign.call(this,t)},n.prototype.$setLineSpacing=function(t){return this.$changeFromStyle||(delete this.$revertStyle.lineSpacing,this.$styleSetMap.lineSpacing=!1),i.prototype.$setLineSpacing.call(this,t)},n.prototype.$setTextColor=function(t){return this.$changeFromStyle||(delete this.$revertStyle.textColor,this.$styleSetMap.textColor=!1),i.prototype.$setTextColor.call(this,t)},n.prototype.$setWordWrap=function(t){this.$changeFromStyle||(delete this.$revertStyle.wordWrap,this.$styleSetMap.wordWrap=!1),i.prototype.$setWordWrap.call(this,t)},n.prototype.$setDisplayAsPassword=function(t){return this.$changeFromStyle||(delete this.$revertStyle.displayAsPassword,this.$styleSetMap.displayAsPassword=!1),i.prototype.$setDisplayAsPassword.call(this,t)},n.prototype.$setStrokeColor=function(t){return this.$changeFromStyle||(delete this.$revertStyle.strokeColor,this.$styleSetMap.strokeColor=!1),i.prototype.$setStrokeColor.call(this,t)},n.prototype.$setStroke=function(t){return this.$changeFromStyle||(delete this.$revertStyle.stroke,this.$styleSetMap.stroke=!1),i.prototype.$setStroke.call(this,t)},n.prototype.$setMaxChars=function(t){return this.$changeFromStyle||(delete this.$revertStyle.maxChars,this.$styleSetMap.maxChars=!1),i.prototype.$setMaxChars.call(this,t)},n.prototype.$setMultiline=function(t){return this.$changeFromStyle||(delete this.$revertStyle.multiline,this.$styleSetMap.multiline=!1),i.prototype.$setMultiline.call(this,t)},n.prototype.$setBorder=function(t){this.$changeFromStyle||(delete this.$revertStyle.border,this.$styleSetMap.border=!1),i.prototype.$setBorder.call(this,t)},n.prototype.$setBorderColor=function(t){this.$changeFromStyle||(delete this.$revertStyle.borderColor,this.$styleSetMap.borderColor=!1),i.prototype.$setBorderColor.call(this,t)},n.prototype.$setBackground=function(t){this.$changeFromStyle||(delete this.$revertStyle.background,this.$styleSetMap.background=!1),i.prototype.$setBackground.call(this,t)},n.prototype.$setBackgroundColor=function(t){this.$changeFromStyle||(delete this.$revertStyle.backgroundColor,this.$styleSetMap.backgroundColor=!1),i.prototype.$setBackgroundColor.call(this,t)},n.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},n.prototype.$setWidth=function(t){var n=i.prototype.$setWidth.call(this,t),r=e.prototype.$setWidth.call(this,t);return n&&r},n.prototype.$setHeight=function(t){var n=i.prototype.$setHeight.call(this,t),r=e.prototype.$setHeight.call(this,t);return n&&r},n.prototype.$setText=function(e){var n=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),n},n.prototype.createChildren=function(){},n.prototype.childrenCreated=function(){},n.prototype.commitProperties=function(){},n.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,n=e[3],r=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(r=t[13]):r=t[8]:(r=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,r),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,n)},n.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},n.prototype.invalidateParentLayout=function(){},n.prototype.setMeasuredSize=function(t,e){},n.prototype.invalidateProperties=function(){},n.prototype.validateProperties=function(){},n.prototype.invalidateSize=function(){},n.prototype.validateSize=function(t){},n.prototype.invalidateDisplayList=function(){},n.prototype.validateDisplayList=function(){},n.prototype.validateNow=function(){},n.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),isNaN(t)||t===this._widthConstraint||0==t)return void(this._widthConstraint=t);this._widthConstraint=t;var n=this.$UIComponent;isNaN(n[9])&&t!=n[16]&&this.invalidateSize()},n.prototype.setLayoutBoundsPosition=function(t,e){},n.prototype.getLayoutBounds=function(t){},n.prototype.getPreferredBounds=function(t){},n}(egret.TextField);t.Label=i,__reflect(i.prototype,"eui.Label",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowMultipleSelection=!1,t._selectedIndices=[],t.isValidIndex=function(e,i,n){return t.$dataProvider&&e>=0&&e<t.$dataProvider.length&&e%1==0},t}return __extends(i,e),Object.defineProperty(i.prototype,"selectedIndices",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices:this._selectedIndices},set:function(t){this.setSelectedIndices(t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices.length>0?this._proposedSelectedIndices[0]:-1:this.$getSelectedIndex()},set:function(t){this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedItems",{get:function(){var t=[],e=this.selectedIndices;if(e)for(var i=e.length,n=0;i>n;n++)t[n]=this.$dataProvider.getItemAt(e[n]);return t},set:function(t){var e=[];if(t)for(var i=t.length,n=0;i>n;n++){var r=this.$dataProvider.getItemIndex(t[n]);if(-1!=r&&e.splice(0,0,r),-1==r){e=[];break}}this.setSelectedIndices(e,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndices=function(t,e){var i=this.$ListBase;e&&(i[4]=i[4]||e),t?this._proposedSelectedIndices=t:this._proposedSelectedIndices=[],this.invalidateProperties()},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this._proposedSelectedIndices&&this.commitSelection()},i.prototype.commitSelection=function(i){void 0===i&&(i=!0);var n=this.$ListBase,r=n[3];if(this._proposedSelectedIndices){if(this._proposedSelectedIndices=this._proposedSelectedIndices.filter(this.isValidIndex),!this.allowMultipleSelection&&this._proposedSelectedIndices.length>0){var o=[];o.push(this._proposedSelectedIndices[0]),this._proposedSelectedIndices=o}this._proposedSelectedIndices.length>0?n[2]=this._proposedSelectedIndices[0]:n[2]=-1}var s=e.prototype.commitSelection.call(this,!1);
if(!s)return this._proposedSelectedIndices=null,!1;var a=this.$getSelectedIndex();return a>t.ListBase.NO_SELECTION&&(this._proposedSelectedIndices?-1==this._proposedSelectedIndices.indexOf(a)&&this._proposedSelectedIndices.push(a):this._proposedSelectedIndices=[a]),this._proposedSelectedIndices&&(-1!=this._proposedSelectedIndices.indexOf(r)&&this.itemSelected(r,!0),this.commitMultipleSelection()),i&&s&&(n[4]&&(this.dispatchEventWith(egret.Event.CHANGE),n[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),s},i.prototype.commitMultipleSelection=function(){var t,e,i=[],n=[],r=this._selectedIndices,o=this._proposedSelectedIndices;if(r.length>0&&o.length>0){for(e=o.length,t=0;e>t;t++)-1==r.indexOf(o[t])&&n.push(o[t]);for(e=r.length,t=0;e>t;t++)-1==o.indexOf(r[t])&&i.push(r[t])}else r.length>0?i=r:o.length>0&&(n=o);if(this._selectedIndices=o,i.length>0)for(e=i.length,t=0;e>t;t++)this.itemSelected(i[t],!1);if(n.length>0)for(e=n.length,t=0;e>t;t++)this.itemSelected(n[t],!0);this._proposedSelectedIndices=null},i.prototype.$isItemIndexSelected=function(t){return this.allowMultipleSelection?-1!=this._selectedIndices.indexOf(t):e.prototype.$isItemIndexSelected.call(this,t)},i.prototype.dataProviderRefreshed=function(){this.allowMultipleSelection||e.prototype.dataProviderRefreshed.call(this)},i.prototype.calculateSelectedIndices=function(t){var e=[],i=this._selectedIndices,n=i.length;if(n>0){if(1==n&&i[0]==t)return this.$ListBase[0]?(e.splice(0,0,i[0]),e):e;for(var r=!1,o=0;n>o;o++)i[o]==t?r=!0:i[o]!=t&&e.splice(0,0,i[o]);return r||e.splice(0,0,t),e}return e.splice(0,0,t),e},i.prototype.onRendererTouchEnd=function(i){if(this.allowMultipleSelection){var n=i.currentTarget,r=this.$ListBase[7];if(n!=r)return;this.setSelectedIndices(this.calculateSelectedIndices(n.itemIndex),!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,n)}else e.prototype.onRendererTouchEnd.call(this,i)},i}(t.ListBase);t.List=e,__reflect(e.prototype,"eui.List")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.closeButton=null,t.moveArea=null,t.titleDisplay=null,t._title="",t.offsetPointX=0,t.offsetPointY=0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onWindowTouchBegin,t,!1,100),t}return __extends(i,e),i.prototype.onWindowTouchBegin=function(t){this.$parent.addChild(this)},Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this.titleDisplay&&(this.titleDisplay.text=this.title)},enumerable:!0,configurable:!0}),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.titleDisplay?this.titleDisplay.text=this._title:i==this.moveArea?this.moveArea.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.moveArea?this.moveArea.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.onCloseButtonClick=function(e){t.UIEvent.dispatchUIEvent(this,t.UIEvent.CLOSING,!0,!0)&&this.close()},i.prototype.close=function(){this.$parent&&this.$parent.removeChild(this)},i.prototype.onTouchBegin=function(t){this.$includeInLayout=!1,this.offsetPointX=this.x-t.$stageX,this.offsetPointY=this.y-t.$stageY,this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.prototype.onTouchMove=function(t){this.x=t.$stageX+this.offsetPointX,this.y=t.$stageY+this.offsetPointY},i.prototype.onTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i}(t.Component);t.Panel=e,__reflect(e.prototype,"eui.Panel"),t.registerProperty(e,"elementsContent","Array",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.thumb=null,i.labelDisplay=null,i._labelFunction=null,i._slideDuration=500,i._direction=t.Direction.LTR,i.slideToValue=0,i.animationValue=0,i.thumbInitX=0,i.thumbInitY=0,i.animation=new t.sys.Animation(i.animationUpdateHandler,i),i}return __extends(i,e),Object.defineProperty(i.prototype,"labelFunction",{get:function(){return this._labelFunction},set:function(t){this._labelFunction!=t&&(this._labelFunction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.valueToLabel=function(t,e){return null!=this.labelFunction?this._labelFunction(t,e):t+" / "+e},Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this._slideDuration},set:function(t){t=0|+t,this._slideDuration!==t&&(this._slideDuration=t,this.animation.isPlaying&&(this.animation.stop(),this.setValue(this.slideToValue)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!=t&&(this.thumb&&(this.thumb.x=this.thumbInitX),this.thumb&&(this.thumb.y=this.thumbInitY),this._direction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(this.value===t)return!1;var i=this.$Range,n=e.prototype.$setValue.call(this,t);if(this._slideDuration>0&&this.$stage){this.validateProperties();var r=this.animation;if(r.isPlaying&&(this.animationValue=this.slideToValue,this.invalidateDisplayList(),r.stop()),this.slideToValue=this.nearestValidValue(t,i[7]),this.slideToValue===this.animationValue)return n;var o=this._slideDuration*(Math.abs(this.animationValue-this.slideToValue)/(i[0]-i[2]));r.duration=o===1/0?0:o,r.from=this.animationValue,r.to=this.slideToValue,r.play()}else this.animationValue=this.value;return n},i.prototype.animationUpdateHandler=function(t){var e=this.$Range,i=this.nearestValidValue(t.currentValue,e[7]);this.animationValue=Math.min(e[0],Math.max(e[2],i)),this.invalidateDisplayList()},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i===this.thumb&&(this.thumb.x&&(this.thumbInitX=this.thumb.x),this.thumb.y&&(this.thumbInitY=this.thumb.y),this.thumb.addEventListener(egret.Event.RESIZE,this.onThumbResize,this))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i===this.thumb&&this.thumb.removeEventListener(egret.Event.RESIZE,this.onThumbResize,this)},i.prototype.onThumbResize=function(t){this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){var e=this.animation.isPlaying?this.animationValue:this.value,i=this.maximum,n=this.thumb;if(n){var r=n.width,o=n.height,s=Math.round(e/i*r);(0>s||s===1/0)&&(s=0);var a=Math.round(e/i*o);(0>a||a===1/0)&&(a=0);var h=n.$scrollRect;h||(h=egret.$TempRectangle),h.setTo(0,0,r,o);var l=n.x-h.x,u=n.y-h.y;switch(this._direction){case t.Direction.LTR:h.width=s,n.x=l;break;case t.Direction.RTL:h.width=s,h.x=r-s,n.x=h.x;break;case t.Direction.TTB:h.height=a,n.y=u;break;case t.Direction.BTT:h.height=a,h.y=o-a,n.y=h.y}n.scrollRect=h}this.labelDisplay&&(this.labelDisplay.text=this.valueToLabel(e,i))},i}(t.Range);t.ProgressBar=e,__reflect(e.prototype,"eui.ProgressBar")}(eui||(eui={}));var eui;!function(t){var e={},i=function(i){function n(){var t=i.call(this)||this;return t.$indexNumber=0,t.$radioButtonGroup=null,t._group=null,t.groupChanged=!1,t._groupName="radioGroup",t._value=null,t.groupName="radioGroup",t}return __extends(n,i),Object.defineProperty(n.prototype,"enabled",{get:function(){return this.$Component[3]?!this.$radioButtonGroup||this.$radioButtonGroup.$enabled:!1},set:function(t){this.$setEnabled(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"group",{get:function(){if(!this._group&&this._groupName){var i=e[this._groupName];i||(i=new t.RadioButtonGroup,i.$name=this._groupName,e[this._groupName]=i),this._group=i}return this._group},set:function(t){this._group!=t&&(this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=t,this._groupName=t?this.group.$name:"radioGroup",this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"groupName",{get:function(){return this._groupName},set:function(t){t&&""!=t&&(this._groupName=t,this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=null,this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),n.prototype.$setSelected=function(t){var e=i.prototype.$setSelected.call(this,t);return this.invalidateDisplayList(),e},Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,this.$selected&&this.group&&t.PropertyEvent.dispatchPropertyEvent(this.group,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"))},enumerable:!0,configurable:!0}),n.prototype.commitProperties=function(){this.groupChanged&&(this.addToGroup(),this.groupChanged=!1),i.prototype.commitProperties.call(this)},n.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e),this.group&&(this.$selected?this._group.$setSelection(this,!1):this.group.selection==this&&this._group.$setSelection(null,!1))},n.prototype.buttonReleased=function(){this.enabled&&!this.selected&&(this.$radioButtonGroup||this.addToGroup(),i.prototype.buttonReleased.call(this),this.group.$setSelection(this,!0))},n.prototype.addToGroup=function(){var t=this.group;return t&&t.$addInstance(this),t},n}(t.ToggleButton);t.RadioButton=i,__reflect(i.prototype,"eui.RadioButton")}(eui||(eui={}));var eui;!function(t){function e(t,i){var n=t.parent,r=i.parent;if(!n||!r)return 0;var o=t.$nestLevel,s=i.$nestLevel,a=0,h=0;return n==r&&(a=n.getChildIndex(t),h=r.getChildIndex(i)),o>s||a>h?1:s>o||h>a?-1:t==i?0:e(n,r)}var i=0,n=function(n){function r(){var t=n.call(this)||this;return t.$name=null,t.radioButtons=[],t.$enabled=!0,t._selectedValue=null,t._selection=null,t.$name="_radioButtonGroup"+i++,t}return __extends(r,n),r.prototype.getRadioButtonAt=function(t){return this.radioButtons[t]},Object.defineProperty(r.prototype,"enabled",{get:function(){return this.$enabled},set:function(t){if(t=!!t,this.$enabled!==t){this.$enabled=t;for(var e=this.radioButtons,i=e.length,n=0;i>n;n++)e[n].invalidateState()}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"numRadioButtons",{get:function(){return this.radioButtons.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selectedValue",{get:function(){return this.selection?null!=this.selection.value?this.selection.value:this.selection.label:null},set:function(e){if(this._selectedValue=e,null==e)return void this.$setSelection(null,!1);for(var i=this.numRadioButtons,n=0;i>n;n++){var r=this.radioButtons[n];if(r.value==e||r.label==e){this.changeSelection(n,!1),this._selectedValue=null,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue");break}}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selection",{get:function(){return this._selection},set:function(t){this._selection!=t&&this.$setSelection(t,!1)},enumerable:!0,configurable:!0}),r.prototype.$addInstance=function(t){t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedHandler,this);var i=this.radioButtons;i.push(t),i.sort(e);for(var n=i.length,r=0;n>r;r++)i[r].$indexNumber=r;this._selectedValue&&(this.selectedValue=this._selectedValue),1==t.selected&&(this.selection=t),t.$radioButtonGroup=this,t.invalidateState()},r.prototype.$removeInstance=function(t,e){if(t)for(var i=!1,n=this.radioButtons,r=n.length,o=0;r>o;o++){var s=n[o];i?s.$indexNumber=s.$indexNumber-1:s==t&&(e&&t.addEventListener(egret.Event.ADDED_TO_STAGE,this.addedHandler,this),t==this._selection&&(this._selection=null),t.$radioButtonGroup=null,t.invalidateState(),this.radioButtons.splice(o,1),i=!0,o--,r--)}},r.prototype.$setSelection=function(e,i){if(this._selection==e)return!1;if(e){for(var n=this.numRadioButtons,r=0;n>r;r++)if(e==this.getRadioButtonAt(r)){this.changeSelection(r,i);break}}else this._selection&&(this._selection.selected=!1,this._selection=null,i&&this.dispatchEventWith(egret.Event.CHANGE));return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"),!0},r.prototype.changeSelection=function(t,e){var i=this.getRadioButtonAt(t);i&&i!=this._selection&&(this._selection&&(this._selection.selected=!1),this._selection=i,this._selection.selected=!0,e&&this.dispatchEventWith(egret.Event.CHANGE))},r.prototype.addedHandler=function(t){var e=t.target;e==t.currentTarget&&(e.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addedHandler,this),this.$addInstance(e))},r.prototype.removedHandler=function(t){var e=t.target;e==t.currentTarget&&(e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedHandler,this),this.$removeInstance(e,!0))},r}(egret.EventDispatcher);t.RadioButtonGroup=n,__reflect(n.prototype,"eui.RadioButtonGroup"),t.registerBindable(n.prototype,"selectedValue")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,n){var r=t.call(this)||this;return r.$fillColor=0,r.$fillAlpha=1,r.$strokeColor=4473924,r.$strokeAlpha=1,r.$strokeWeight=0,r.$ellipseWidth=0,r.$ellipseHeight=0,r.touchChildren=!1,r.$graphics=new egret.Graphics,r.$graphics.$setTarget(r),r.width=e,r.height=i,r.fillColor=n,r}return __extends(e,t),Object.defineProperty(e.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),e.prototype.$measureContentBounds=function(t){this.$graphics&&t.setTo(0,0,this.width,this.height)},Object.defineProperty(e.prototype,"fillColor",{get:function(){return this.$fillColor},set:function(t){void 0!=t&&this.$fillColor!=t&&(this.$fillColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillAlpha",{get:function(){return this.$fillAlpha},set:function(t){this.$fillAlpha!=t&&(this.$fillAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this.$strokeColor},set:function(t){this.$strokeColor!=t&&(this.$strokeColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeAlpha",{get:function(){return this.$strokeAlpha},set:function(t){this.$strokeAlpha!=t&&(this.$strokeAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWeight",{get:function(){return this.$strokeWeight},set:function(t){this.$strokeWeight!=t&&(this.$strokeWeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseWidth",{get:function(){return this.$ellipseWidth},set:function(t){this.$ellipseWidth!=t&&(this.$ellipseWidth=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseHeight",{get:function(){return this.$ellipseHeight},set:function(t){this.$ellipseHeight!=t&&(this.$ellipseHeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.updateDisplayList=function(t,e){var i=this.graphics;i.clear(),this.$strokeWeight>0&&(i.beginFill(this.$fillColor,0),i.lineStyle(this.$strokeWeight,this.$strokeColor,this.$strokeAlpha,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight):i.drawRoundRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill()),i.beginFill(this.$fillColor,this.$fillAlpha),i.lineStyle(this.$strokeWeight,this.$strokeColor,0,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight):i.drawRoundRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill(),this.$invalidateContentBounds()},e}(t.Component);t.Rect=e,__reflect(e.prototype,"eui.Rect")}(eui||(eui={}));var eui;!function(t){var e,i=function(i){function n(){var e=i.call(this)||this;e.$bounces=!0,e.horizontalScrollBar=null,e.verticalScrollBar=null;var n=new t.sys.TouchScroll(e.horizontalUpdateHandler,e.horizontalEndHandler,e),r=new t.sys.TouchScroll(e.verticalUpdateHandler,e.verticalEndHanlder,e);return e.$Scroller={0:"auto",1:"auto",2:null,3:0,4:0,5:!1,6:!1,7:!1,8:n,9:r,10:null,11:!1,12:!1},e}return __extends(n,i),Object.defineProperty(n.prototype,"bounces",{get:function(){return this.$bounces},set:function(t){this.$bounces=!!t;var e=this.$Scroller[8];e&&(e.$bounces=this.$bounces);var i=this.$Scroller[9];i&&(i.$bounces=this.$bounces)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"throwSpeed",{get:function(){return this.$Scroller[8].$scrollFactor},set:function(t){t=+t,0>t&&(t=0),this.$Scroller[8].$scrollFactor=t,this.$Scroller[9].$scrollFactor=t},enumerable:!0,configurable:!0}),n.prototype.$getThrowInfo=function(i,n){return e?(e.currentPos=i,e.toPos=n):e=new t.ScrollerThrowEvent(t.ScrollerThrowEvent.THROW,!1,!1,i,n),e},Object.defineProperty(n.prototype,"scrollPolicyV",{get:function(){return this.$Scroller[0]},set:function(t){var e=this.$Scroller;e[0]!=t&&(e[0]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollPolicyH",{get:function(){return this.$Scroller[1]},set:function(t){var e=this.$Scroller;e[1]!=t&&(e[1]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),n.prototype.stopAnimation=function(){var e=this.$Scroller,i=e[9],n=e[8];i.animation.isPlaying?t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END):n.animation.isPlaying&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END),i.stop(),n.stop();var r=this.verticalScrollBar,o=this.horizontalScrollBar;r&&r.autoVisibility&&(r.visible=!1),o&&o.autoVisibility&&(o.visible=!1)},Object.defineProperty(n.prototype,"viewport",{get:function(){return this.$Scroller[10]},set:function(t){var e=this.$Scroller;t!=e[10]&&(this.uninstallViewport(),e[10]=t,e[11]=!1,this.installViewport())},enumerable:!0,configurable:!0}),n.prototype.installViewport=function(){var t=this.viewport;t&&(this.addChildAt(t,0),t.scrollEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.addEventListener(egret.Event.REMOVED,this.onViewPortRemove,this)),this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=t),this.verticalScrollBar&&(this.verticalScrollBar.viewport=t)},n.prototype.uninstallViewport=function(){this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=null),this.verticalScrollBar&&(this.verticalScrollBar.viewport=null);var t=this.viewport;t&&(t.scrollEnabled=!1,t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.removeEventListener(egret.Event.REMOVED,this.onViewPortRemove,this),0==this.$Scroller[11]&&this.removeChild(t))},n.prototype.onViewPortRemove=function(t){t.target==this.viewport&&(this.$Scroller[11]=!0,this.viewport=null)},n.prototype.setSkin=function(t){i.prototype.setSkin.call(this,t);var e=this.viewport;e&&this.addChildAt(e,0)},n.prototype.onTouchBeginCapture=function(t){this.$Scroller[12]=!1;var e=this.checkScrollPolicy();e&&this.onTouchBegin(t)},n.prototype.onTouchEndCapture=function(t){this.$Scroller[12]&&(t.$bubbles=!1,this.dispatchBubbleEvent(t),t.$bubbles=!0,t.stopPropagation(),this.onTouchEnd(t))},n.prototype.onTouchTapCapture=function(t){this.$Scroller[12]&&(t.$bubbles=!1,this.dispatchBubbleEvent(t),t.$bubbles=!0,t.stopPropagation())},n.prototype.checkScrollPolicy=function(){var t=this.$Scroller,e=t[10];if(!e)return!1;var i,n=e.$UIComponent;switch(t[1]){case"auto":i=e.contentWidth>n[10]||0!==e.scrollH?!0:!1;break;case"on":i=!0;break;case"off":i=!1}t[6]=i;var r;switch(t[0]){case"auto":r=e.contentHeight>n[11]||0!==e.scrollV?!0:!1;break;case"on":r=!0;break;case"off":r=!1}return t[7]=r,i||r},n.prototype.onTouchBegin=function(t){if(!t.isDefaultPrevented()&&this.checkScrollPolicy()){this.downTarget=t.target;var e=this.$Scroller;this.stopAnimation(),e[3]=t.$stageX,e[4]=t.$stageY,e[6]&&e[8].start(t.$stageX),e[7]&&e[9].start(t.$stageY);var i=this.$stage;this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this),this.tempStage=i}},n.prototype.onTouchMove=function(e){if(!e.isDefaultPrevented()){var i=this.$Scroller;if(!i[5]){var r=void 0;r=Math.abs(i[3]-e.$stageX)<n.scrollThreshold?!1:!0;var o=void 0;if(o=Math.abs(i[4]-e.$stageY)<n.scrollThreshold?!1:!0,!r&&!o)return;if(!o&&r&&"off"==i[1])return;if(!r&&o&&"off"==i[0])return;i[12]=!0,i[5]=!0,this.dispatchCancelEvent(e);var s=this.horizontalScrollBar,a=this.verticalScrollBar;s&&s.autoVisibility&&i[6]&&(s.visible=!0),a&&a.autoVisibility&&i[7]&&(a.visible=!0),i[2]&&i[2].reset(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)}e.preventDefault();var h=i[10],l=h.$UIComponent;i[6]&&i[8].update(e.$stageX,h.contentWidth-l[10],h.scrollH),i[7]&&i[9].update(e.$stageY,h.contentHeight-l[11],h.scrollV)}},n.prototype.onTouchCancel=function(t){this.$Scroller[5]||this.onRemoveListeners()},n.prototype.dispatchBubbleEvent=function(t){var e=this.$Scroller[10];if(e){var i=egret.Event.create(egret.TouchEvent,t.type,t.bubbles,t.cancelable);i.$initTo(t.$stageX,t.$stageY,t.touchPointID);var n=this.downTarget;i.$setTarget(n);for(var r=this.$getPropagationList(n),o=r.length,s=.5*r.length,a=-1,h=0;o>h;h++)if(r[h]===e){a=h;break}r.splice(0,r.length-a+1),s=0,this.$dispatchPropagationEvent(i,r,s),egret.Event.release(i)}},n.prototype.dispatchCancelEvent=function(t){var e=this.$Scroller[10];if(e){var i=egret.Event.create(egret.TouchEvent,egret.TouchEvent.TOUCH_CANCEL,t.bubbles,t.cancelable);i.$initTo(t.$stageX,t.$stageY,t.touchPointID);var n=this.downTarget;i.$setTarget(n);for(var r=this.$getPropagationList(n),o=r.length,s=.5*r.length,a=-1,h=0;o>h;h++)if(r[h]===e){a=h;break}r.splice(0,a+1-2),r.splice(r.length-1-a+2,a+1-2),s-=a+1,this.$dispatchPropagationEvent(i,r,s),egret.Event.release(i)}},n.prototype.onTouchEnd=function(t){var e=this.$Scroller;e[5]=!1,this.onRemoveListeners();var i=e[10],n=i.$UIComponent;e[8].isStarted()&&e[8].finish(i.scrollH,i.contentWidth-n[10]),e[9].isStarted()&&e[9].finish(i.scrollV,i.contentHeight-n[11])},n.prototype.onRemoveListeners=function(){var t=this.tempStage||this.$stage;this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this)},n.prototype.horizontalUpdateHandler=function(t){this.$Scroller[10].scrollH=t,this.dispatchEventWith(egret.Event.CHANGE)},n.prototype.verticalUpdateHandler=function(t){this.$Scroller[10].scrollV=t,this.dispatchEventWith(egret.Event.CHANGE)},n.prototype.horizontalEndHandler=function(){this.$Scroller[9].isPlaying()||this.onChangeEnd()},n.prototype.verticalEndHanlder=function(){this.$Scroller[8].isPlaying()||this.onChangeEnd()},n.prototype.onChangeEnd=function(){var e=this.$Scroller,i=this.horizontalScrollBar,n=this.verticalScrollBar;(i&&i.visible||n&&n.visible)&&(e[2]||(e[2]=new egret.Timer(200,1),e[2].addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onAutoHideTimer,this)),e[2].reset(),e[2].start()),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},n.prototype.onAutoHideTimer=function(t){var e=this.horizontalScrollBar,i=this.verticalScrollBar;e&&e.autoVisibility&&(e.visible=!1),i&&i.autoVisibility&&(i.visible=!1)},n.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e);var n=this.viewport;n&&(n.setLayoutBoundsSize(t,e),n.setLayoutBoundsPosition(0,0))},n.prototype.partAdded=function(t,e){i.prototype.partAdded.call(this,t,e),e==this.horizontalScrollBar?(this.horizontalScrollBar.touchChildren=!1,this.horizontalScrollBar.touchEnabled=!1,this.horizontalScrollBar.viewport=this.viewport,this.horizontalScrollBar.autoVisibility&&(this.horizontalScrollBar.visible=!1)):e==this.verticalScrollBar&&(this.verticalScrollBar.touchChildren=!1,this.verticalScrollBar.touchEnabled=!1,this.verticalScrollBar.viewport=this.viewport,this.verticalScrollBar.autoVisibility&&(this.verticalScrollBar.visible=!1))},n.scrollThreshold=5,n}(t.Component);t.Scroller=i,__reflect(i.prototype,"eui.Scroller"),t.registerProperty(i,"viewport","eui.IViewport",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.maxWidth=1e5,i.minWidth=0,i.maxHeight=1e5,i.minHeight=0,i.width=0/0,i.height=0/0,i.$elementsContent=[],i._hostComponent=null,i.$stateValues=new t.sys.StateValues,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){this.$elementsContent=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hostComponent",{get:function(){return this._hostComponent},set:function(e){if(this._hostComponent!=e){this._hostComponent&&this._hostComponent.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this._hostComponent=e;var i=this.$stateValues;i.parent=e,e&&(this.commitCurrentState(),this.$stateValues.intialized||(e.$stage?this.initializeStates(e.$stage):e.once(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this))),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"hostComponent")}},enumerable:!0,configurable:!0}),i.prototype.onAddedToStage=function(t){this.initializeStates(this._hostComponent.$stage)},i}(egret.EventDispatcher);t.Skin=e,__reflect(e.prototype,"eui.Skin"),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]"),t.registerBindable(e.prototype,"hostComponent")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.indexBeingUpdated=!1,t.requireSelection=!0,t.useVirtualLayout=!1,t}return __extends(i,e),i.prototype.createChildren=function(){if(!this.$layout){var i=new t.HorizontalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.JUSTIFY,i.verticalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.$setDataProvider=function(i){var n=this.$dataProvider;return n&&n instanceof t.ViewStack&&(n.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.removeEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),i&&i instanceof t.ViewStack&&(i.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.addEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),e.prototype.$setDataProvider.call(this,i)},i.prototype.onIndexChanged=function(t){this.indexBeingUpdated=!0,this.$dataProvider.selectedIndex=this.selectedIndex,this.indexBeingUpdated=!1},i.prototype.onViewStackIndexChange=function(t){"selectedIndex"!=t.property||this.indexBeingUpdated||this.setSelectedIndex(this.$dataProvider.selectedIndex,!1)},i}(t.ListBase);t.TabBar=e,__reflect(e.prototype,"eui.TabBar")}(eui||(eui={}));var eui;!function(t){var e=egret.FocusEvent,i=function(i){function n(){var t=i.call(this)||this;return t.isFocus=!1,t.$TextInput={0:null,1:null,2:null,3:null,4:null,5:null,6:"",7:null,8:egret.TextFieldInputType.TEXT},t}return __extends(n,i),Object.defineProperty(n.prototype,"prompt",{get:function(){return this.promptDisplay?this.promptDisplay.text:this.$TextInput[0]},set:function(t){this.$TextInput[0]=t,this.promptDisplay&&(this.promptDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){if(this.textDisplay)return this.textDisplay.displayAsPassword;var t=this.$TextInput[1];return t?t:!1},set:function(t){this.$TextInput[1]=t,this.textDisplay&&(this.textDisplay.displayAsPassword=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputType",{get:function(){return this.textDisplay?this.textDisplay.inputType:this.$TextInput[8]},set:function(t){this.$TextInput[8]=t,this.textDisplay&&(this.textDisplay.inputType=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textColor",{get:function(){return this.textDisplay?this.textDisplay.textColor:this.$TextInput[2]},set:function(t){this.$TextInput[2]=t,this.textDisplay&&(this.textDisplay.textColor=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxChars",{get:function(){if(this.textDisplay)return this.textDisplay.maxChars;var t=this.$TextInput[3];return t?t:0},set:function(t){this.$TextInput[3]=t,this.textDisplay&&(this.textDisplay.maxChars=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){if(this.textDisplay)return this.textDisplay.maxWidth;var t=this.$TextInput[4];return t?t:1e5},set:function(t){this.$TextInput[4]=t,this.textDisplay&&(this.textDisplay.maxWidth=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxHeight",{get:function(){this.textDisplay;var t=this.$TextInput[5];return t?t:1e5},set:function(t){this.$TextInput[5]=t,this.textDisplay&&(this.textDisplay.maxHeight=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.textDisplay?this.textDisplay.text:this.$TextInput[6]},set:function(t){this.$TextInput[6]=t,this.textDisplay&&(this.textDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restrict",{get:function(){return this.textDisplay?this.textDisplay.restrict:this.$TextInput[7]},set:function(t){this.$TextInput[7]=t,this.textDisplay&&(this.textDisplay.restrict=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),n.prototype.focusInHandler=function(t){this.isFocus=!0,this.invalidateState()},n.prototype.focusOutHandler=function(t){this.isFocus=!1,this.invalidateState()},n.prototype.getCurrentState=function(){var t=this.skin;return!this.prompt||this.isFocus||this.text?this.enabled?"normal":"disabled":this.enabled&&t.hasState("normalWithPrompt")?"normalWithPrompt":!this.enabled&&t.hasState("disabledWithPrompt")?"disabledWithPrompt":void 0},n.prototype.partAdded=function(n,r){i.prototype.partAdded.call(this,n,r);var o=this.$TextInput;r==this.textDisplay?(this.textDisplayAdded(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.addEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.addEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):r==this.promptDisplay&&o[0]&&(this.promptDisplay.text=o[0])
},n.prototype.partRemoved=function(n,r){i.prototype.partRemoved.call(this,n,r),r==this.textDisplay?(this.textDisplayRemoved(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.removeEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.removeEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):r==this.promptDisplay&&(this.$TextInput[0]=this.promptDisplay.text)},n.prototype.textDisplayAdded=function(){var t=this.$TextInput;t[1]&&(this.textDisplay.displayAsPassword=t[1]),t[2]&&(this.textDisplay.textColor=t[2]),t[3]&&(this.textDisplay.maxChars=t[3]),t[4]&&(this.textDisplay.maxWidth=t[4]),t[5]&&(this.textDisplay.maxHeight=t[5]),t[6]&&(this.textDisplay.text=t[6]),t[7]&&(this.textDisplay.restrict=t[7]),t[8]&&(this.textDisplay.inputType=t[8])},n.prototype.textDisplayRemoved=function(){var t=this.$TextInput;t[1]=this.textDisplay.displayAsPassword,t[2]=this.textDisplay.textColor,t[3]=this.textDisplay.maxChars,t[4]=this.textDisplay.maxWidth,t[5]=this.textDisplay.maxHeight,t[6]=this.textDisplay.text,t[7]=this.textDisplay.restrict,t[8]=this.textDisplay.inputType},n}(t.Component);t.TextInput=i,__reflect(i.prototype,"eui.TextInput")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.CheckBox=e,__reflect(e.prototype,"eui.CheckBox")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.ToggleSwitch=e,__reflect(e.prototype,"eui.ToggleSwitch")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoveFromStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.$stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize()},e.prototype.onRemoveFromStage=function(t){this.$stage.removeEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.onResize=function(t){var e=this.$stage;this.$setWidth(e.$stageWidth),this.$setHeight(e.$stageHeight)},e}(t.Group);t.UILayer=e,__reflect(e.prototype,"eui.UILayer")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var n=this.thumb,r=this.$viewport;if(n&&r){var o=egret.$TempRectangle;n.getPreferredBounds(o);var s=o.height,a=o.x,h=r.scrollV,l=r.contentHeight,u=r.height;if(0>=h){var p=s*(1- -h/(.5*u));p=Math.max(5,Math.round(p)),n.setLayoutBoundsSize(0/0,p),n.setLayoutBoundsPosition(a,0)}else if(h>=l-u){var p=s*(1-(h-l+u)/(.5*u));p=Math.max(5,Math.round(p)),n.setLayoutBoundsSize(0/0,p),n.setLayoutBoundsPosition(a,i-p)}else{var c=(i-s)*h/(l-u);n.setLayoutBoundsSize(0/0,0/0),n.setLayoutBoundsPosition(a,c)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollV":case"contentHeight":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.VScrollBar=e,__reflect(e.prototype,"eui.VScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t,e){if(!this.thumb||!this.track)return 0;var i=this.$Range,n=i[0]-i[2],r=this.getThumbRange();return i[2]+(0!=r?(r-e)/r*n:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.height;return this.thumb.getLayoutBounds(t),e-t.height},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],n=i>0?e-(this.pendingValue-t[2])/i*e:0,r=this.track.localToGlobal(0,n,egret.$TempPoint),o=r.x,s=r.y,a=this.thumb.$parent.globalToLocal(o,s,egret.$TempPoint).y,h=egret.$TempRectangle,l=h.height;if(this.thumb.getLayoutBounds(h),this.thumb.setLayoutBoundsPosition(h.x,Math.round(a)),this.trackHighlight){var u=this.trackHighlight.$parent.globalToLocal(o,s,egret.$TempPoint).y;this.trackHighlight.y=Math.round(u+l),this.trackHighlight.height=Math.round(e-u)}}},e}(t.SliderBase);t.VSlider=e,__reflect(e.prototype,"eui.VSlider")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._selectedChild=null,i.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION,i._selectedIndex=-1,i}return __extends(i,e),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedChild",{get:function(){var t=this.selectedIndex;return t>=0&&t<this.numChildren?this.getChildAt(t):null},set:function(t){var e=this.getChildIndex(t);e>=0&&e<this.numChildren&&this.setSelectedIndex(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION?this.proposedSelectedIndex:this._selectedIndex},set:function(t){t=0|+t,this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndex=function(e){e!=this.selectedIndex&&(this.proposedSelectedIndex=e,this.invalidateProperties(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.$childAdded=function(i,n){e.prototype.$childAdded.call(this,i,n),this.showOrHide(i,!1);var r=this.selectedIndex;-1==r?this.setSelectedIndex(n):n<=this.selectedIndex&&this.$stage&&this.setSelectedIndex(r+1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.ADD,n,-1,[i.name])},i.prototype.$childRemoved=function(i,n){e.prototype.$childRemoved.call(this,i,n),this.showOrHide(i,!0);var r=this.selectedIndex;n==r?this.numChildren>0?0==n?(this.proposedSelectedIndex=0,this.invalidateProperties()):this.setSelectedIndex(0):this.setSelectedIndex(-1):r>n&&this.setSelectedIndex(r-1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.REMOVE,n,-1,[i.name])},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION&&(this.commitSelection(this.proposedSelectedIndex),this.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION)},i.prototype.commitSelection=function(t){t>=0&&t<this.numChildren?(this._selectedIndex=t,this._selectedChild&&this.showOrHide(this._selectedChild,!1),this._selectedChild=this.getElementAt(this._selectedIndex),this.showOrHide(this._selectedChild,!0)):(this._selectedChild=null,this._selectedIndex=-1),this.invalidateSize(),this.invalidateDisplayList()},i.prototype.showOrHide=function(t,e){egret.is(t,"eui.UIComponent")&&(t.includeInLayout=e),t.visible=e},Object.defineProperty(i.prototype,"length",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getItemAt=function(t){var e=this.$children[t];return e?e.name:""},i.prototype.getItemIndex=function(t){for(var e=this.$children,i=e.length,n=0;i>n;n++)if(e[n].name==t)return n;return-1},i}(t.Group);t.ViewStack=e,__reflect(e.prototype,"eui.ViewStack",["eui.ICollection","egret.IEventDispatcher"]),t.registerBindable(e.prototype,"selectedIndex")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){return-.5*(Math.cos(Math.PI*t)-1)}var i=function(){function t(t,i){this.easerFunction=e,this.isPlaying=!1,this.duration=500,this.currentValue=0,this.from=0,this.to=0,this.startTime=0,this.endFunction=null,this.updateFunction=t,this.thisObject=i}return t.prototype.play=function(){this.stop(),this.start()},t.prototype.start=function(){this.isPlaying=!1,this.currentValue=0,this.startTime=egret.getTimer(),this.doInterval(this.startTime),egret.startTick(this.doInterval,this)},t.prototype.stop=function(){this.isPlaying=!1,this.startTime=0,egret.stopTick(this.doInterval,this)},t.prototype.doInterval=function(t){var e=t-this.startTime;this.isPlaying||(this.isPlaying=!0);var i=this.duration,n=0==i?1:Math.min(e,i)/i;this.easerFunction&&(n=this.easerFunction(n)),this.currentValue=this.from+(this.to-this.from)*n,this.updateFunction&&this.updateFunction.call(this.thisObject,this);var r=e>=i;return r&&this.stop(),r&&this.endFunction&&this.endFunction.call(this.thisObject,this),!1},t}();t.Animation=i,__reflect(i.prototype,"eui.sys.Animation")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){var i=t.target;e.call(n,i.response)}function o(t){i.call(n)}var s=new egret.HttpRequest;s.addEventListener(egret.Event.COMPLETE,r,n),s.addEventListener(egret.IOErrorEvent.IO_ERROR,o,n),s.responseType=egret.HttpResponseType.TEXT,s.open(t),s.send()},t}();t.DefaultThemeAdapter=e,__reflect(e.prototype,"eui.DefaultThemeAdapter",["eui.IThemeAdapter"])}(eui||(eui={}));var eui;!function(t){function e(t,i){var n=Object.getOwnPropertyDescriptor(t,i);if(n)return n;var r=Object.getPrototypeOf(t);return r?e(r,i):null}function i(t,e){for(var i=t[n],r=i.length,o=0;r>o;o+=2){var s=i[o],a=i[o+1];s.call(a,e)}}var n="__listeners__",r="__bindables__",o=0,s=function(){function s(t,e,i,n){this.isExecuting=!1,this.property=t,this.handler=e,this.next=n,this.thisObject=i}return s.watch=function(t,e,i,n){if(e.length>0){var r=e.shift(),o=s.watch(null,e,i,n),a=new s(r,i,n,o);return a.reset(t),a}return null},s.checkBindable=function(s,a){var h=s[r];if(h&&-1!=h.indexOf(a))return!0;var l=egret.is(s,"egret.IEventDispatcher");l||s[n]||(s[n]=[]);var u=e(s,a);if(u&&u.set&&u.get){var p=u.set;u.set=function(e){this[a]!=e&&(p.call(this,e),l?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,a):i(this,a))}}else{if(u&&(u.get||u.set))return!1;o++;var c="_"+o+a;s[c]=u?u.value:null,u={enumerable:!0,configurable:!0},u.get=function(){return this[c]},u.set=function(e){this[c]!=e&&(this[c]=e,l?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,a):i(this,a))}}Object.defineProperty(s,a,u),t.registerBindable(s,a)},s.prototype.unwatch=function(){this.reset(null),this.handler=null,this.next&&(this.next.handler=null)},s.prototype.getValue=function(){return this.next?this.next.getValue():this.getHostPropertyValue()},s.prototype.setHandler=function(t,e){this.handler=t,this.thisObject=e,this.next&&this.next.setHandler(t,e)},s.prototype.reset=function(e){var i=this.host;if(i)if(egret.is(i,"egret.IEventDispatcher"))i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this);else{var r=i[n],o=r.indexOf(this);r.splice(o-1,2)}if(this.host=e,e)if(s.checkBindable(e,this.property),egret.is(e,"egret.IEventDispatcher"))e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this,!1,100);else{var r=e[n];r.push(this.onPropertyChange),r.push(this)}this.next&&this.next.reset(this.getHostPropertyValue())},s.prototype.getHostPropertyValue=function(){return this.host?this.host[this.property]:null},s.prototype.wrapHandler=function(t){this.onPropertyChange(t.property)},s.prototype.onPropertyChange=function(t){if(t==this.property&&!this.isExecuting)try{this.isExecuting=!0,this.next&&this.next.reset(this.getHostPropertyValue()),this.handler.call(this.thisObject,this.getValue())}finally{this.isExecuting=!1}},s}();t.Watcher=s,__reflect(s.prototype,"eui.Watcher")}(eui||(eui={}));var eui;!function(t){function e(e){for(var i=e[0],n=i instanceof t.Watcher?i.getValue():i,r=e.length,o=1;r>o;o++){var s=e[o];s instanceof t.Watcher&&(s=s.getValue()),n+=s}return n}var i=function(){function i(){}return i.bindProperty=function(e,i,n,r){var o=t.Watcher.watch(e,i,null,null);if(o){var s=function(t){n[r]=t};o.setHandler(s,null),s(o.getValue())}return o},i.bindHandler=function(e,i,n,r){var o=t.Watcher.watch(e,i,n,r);return o&&n.call(r,o.getValue()),o},i.$bindProperties=function(n,r,o,s,a){if(1==r.length&&1==o.length)return i.bindProperty(n,r[0].split("."),s,a);for(var h,l=function(){s[a]=e(r)},u=o.length,p=0;u>p;p++){var c=o[p],d=r[c].split(".");h=t.Watcher.watch(n,d,null,null),h&&(r[c]=h,h.setHandler(l,null))}return l(),h},i}();t.Binding=i,__reflect(i.prototype,"eui.Binding")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return t?i._source=t:i._source=[],i}return __extends(i,e),Object.defineProperty(i.prototype,"source",{get:function(){return this._source},set:function(e){e||(e=[]),this._source=e,this.dispatchCoEvent(t.CollectionEventKind.RESET)},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){this.dispatchCoEvent(t.CollectionEventKind.REFRESH)},Object.defineProperty(i.prototype,"length",{get:function(){return this._source.length},enumerable:!0,configurable:!0}),i.prototype.addItem=function(e){this._source.push(e),this.dispatchCoEvent(t.CollectionEventKind.ADD,this._source.length-1,-1,[e])},i.prototype.addItemAt=function(e,i){0>i||i>this._source.length,this._source.splice(i,0,e),this.dispatchCoEvent(t.CollectionEventKind.ADD,i,-1,[e])},i.prototype.getItemAt=function(t){return this._source[t]},i.prototype.getItemIndex=function(t){for(var e=this._source.length,i=0;e>i;i++)if(this._source[i]===t)return i;return-1},i.prototype.itemUpdated=function(e){var i=this.getItemIndex(e);-1!=i&&this.dispatchCoEvent(t.CollectionEventKind.UPDATE,i,-1,[e])},i.prototype.removeAll=function(){var e=this._source.concat();this._source=[],this.dispatchCoEvent(t.CollectionEventKind.REMOVE,0,-1,e)},i.prototype.removeItemAt=function(e){if(!(0>e||e>=this._source.length)){var i=this._source.splice(e,1)[0];return this.dispatchCoEvent(t.CollectionEventKind.REMOVE,e,-1,[i]),i}},i.prototype.replaceItemAt=function(e,i){if(!(0>i||i>=this._source.length)){var n=this._source.splice(i,1,e)[0];return this.dispatchCoEvent(t.CollectionEventKind.REPLACE,i,-1,[e],[n]),n}},i.prototype.replaceAll=function(t){t||(t=[]);for(var e=t.length,i=this._source.length,n=e;i>n;n++)this.removeItemAt(e);for(var n=0;e>n;n++)n>=i?this.addItemAt(t[n],n):this.replaceItemAt(t[n],n);this._source=t},i.prototype.dispatchCoEvent=function(e,i,n,r,o){t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,e,i,n,r,o)},i}(egret.EventDispatcher);t.ArrayCollection=e,__reflect(e.prototype,"eui.ArrayCollection",["eui.ICollection","egret.IEventDispatcher"]),t.registerProperty(e,"source","Array",!0)}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function n(){var t=i.call(this)||this;return t._widthConstraint=0/0,t.$isShowPrompt=!1,t.$promptColor=6710886,t.$isFocusIn=!1,t.initializeUIValues(),t.type=egret.TextFieldType.INPUT,t.$EditableText={0:null,1:16777215,2:!1},t}return __extends(n,i),n.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},n.prototype.$setWidth=function(t){var n=i.prototype.$setWidth.call(this,t),r=e.prototype.$setWidth.call(this,t);return n&&r},n.prototype.$setHeight=function(t){var n=i.prototype.$setHeight.call(this,t),r=e.prototype.$setHeight.call(this,t);return n&&r},n.prototype.$getText=function(){var t=i.prototype.$getText.call(this);return t==this.$EditableText[0]&&(t=""),t},n.prototype.$setText=function(e){var n=this.$EditableText[0];(n!=e||null==n)&&(this.$isShowPrompt=!1,this.textColor=this.$EditableText[1],this.displayAsPassword=this.$EditableText[2]),this.$isFocusIn||(""==e||null==e)&&(e=n,this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1));var r=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),r},n.prototype.$onAddToStage=function(e,i){t.sys.UIComponentImpl.prototype.$onAddToStage.call(this,e,i),this.addEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this)},n.prototype.$onRemoveFromStage=function(){t.sys.UIComponentImpl.prototype.$onRemoveFromStage.call(this),this.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this)},Object.defineProperty(n.prototype,"prompt",{get:function(){return this.$EditableText[0]},set:function(t){var e=this.$EditableText,i=e[0];if(i!=t){e[0]=t;var n=this.text;n&&n!=i||this.showPromptText()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promptColor",{get:function(){return this.$promptColor},set:function(t){if(t=0|+t,this.$promptColor!=t){this.$promptColor=t;var e=this.text;e&&e!=this.$EditableText[0]||this.showPromptText()}},enumerable:!0,configurable:!0}),n.prototype.onfocusOut=function(){this.$isFocusIn=!1,this.text||this.showPromptText()},n.prototype.onfocusIn=function(){this.$isFocusIn=!0,this.$isShowPrompt=!1,this.displayAsPassword=this.$EditableText[2];var t=this.$EditableText,e=this.text;e&&e!=t[0]||(this.textColor=t[1],this.text="")},n.prototype.showPromptText=function(){var t=this.$EditableText;this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1),this.text=t[0]},n.prototype.$setTextColor=function(t){return t=0|+t,this.$EditableText[1]=t,this.$isShowPrompt||i.prototype.$setTextColor.call(this,t),!0},n.prototype.$setDisplayAsPassword=function(t){return this.$EditableText[2]=t,this.$isShowPrompt||i.prototype.$setDisplayAsPassword.call(this,t),!0},n.prototype.createChildren=function(){this.onfocusOut()},n.prototype.childrenCreated=function(){},n.prototype.commitProperties=function(){},n.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,n=e[3],r=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(r=t[13]):r=t[8]:(r=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,r),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,n)},n.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},n.prototype.invalidateParentLayout=function(){},n.prototype.setMeasuredSize=function(t,e){},n.prototype.invalidateProperties=function(){},n.prototype.validateProperties=function(){},n.prototype.invalidateSize=function(){},n.prototype.validateSize=function(t){},n.prototype.invalidateDisplayList=function(){},n.prototype.validateDisplayList=function(){},n.prototype.validateNow=function(){},n.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var n=this.$UIComponent;isNaN(n[9])&&t!=n[16]&&(this._widthConstraint=t,this.invalidateSize())}},n.prototype.setLayoutBoundsPosition=function(t,e){},n.prototype.getLayoutBounds=function(t){},n.prototype.getPreferredBounds=function(t){},n}(egret.TextField);t.EditableText=i,__reflect(i.prototype,"eui.EditableText",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){var e=t-1;return e*e*e+1}var i=4,n=[1,1.33,1.66,2],r=2.33,o=.02,s=.998,a=.95,h=Math.log(s),l=function(){function l(i,n,r){this.$scrollFactor=1,this.previousTime=0,this.velocity=0,this.previousVelocity=[],this.currentPosition=0,this.previousPosition=0,this.currentScrollPos=0,this.maxScrollPos=0,this.offsetPoint=0,this.$bounces=!0,this.started=!0,this.updateFunction=i,this.endFunction=n,this.target=r,this.animation=new t.Animation(this.onScrollingUpdate,this),this.animation.endFunction=this.finishScrolling,this.animation.easerFunction=e}return l.prototype.isPlaying=function(){return this.animation.isPlaying},l.prototype.stop=function(){this.animation.stop(),egret.stopTick(this.onTick,this),this.started=!1},l.prototype.isStarted=function(){return this.started},l.prototype.start=function(t){this.started=!0,this.velocity=0,this.previousVelocity.length=0,this.previousTime=egret.getTimer(),this.previousPosition=this.currentPosition=t,this.offsetPoint=t,egret.startTick(this.onTick,this)},l.prototype.update=function(t,e,i){e=Math.max(e,0),this.currentPosition=t,this.maxScrollPos=e;var n=this.offsetPoint-t,r=n+i;this.offsetPoint=t,0>r&&(this.$bounces?r-=.5*n:r=0),r>e&&(this.$bounces?r-=.5*n:r=e),this.currentScrollPos=r,this.updateFunction.call(this.target,r)},l.prototype.finish=function(t,e){egret.stopTick(this.onTick,this),this.started=!1;for(var i=this.velocity*r,l=this.previousVelocity,u=l.length,p=r,c=0;u>c;c++){var d=n[c];i+=l[0]*d,p+=d}var f=i/p,y=Math.abs(f),g=0,v=0;if(y>o)if(v=t+(f-o)/h*2*this.$scrollFactor,0>v||v>e)for(v=t;Math.abs(f)>o;)v-=f,f*=0>v||v>e?s*a:s,g++;else g=Math.log(o/y)/h;else v=t;if(this.target.$getThrowInfo){var m=this.target.$getThrowInfo(t,v);v=m.toPos}g>0?(this.$bounces||(0>v?v=0:v>e&&(v=e)),this.throwTo(v,g)):this.finishScrolling()},l.prototype.onTick=function(t){var e=t-this.previousTime;if(e>10){var n=this.previousVelocity;n.length>=i&&n.shift(),this.velocity=(this.currentPosition-this.previousPosition)/e,n.push(this.velocity),this.previousTime=t,this.previousPosition=this.currentPosition}return!0},l.prototype.finishScrolling=function(t){var e=this.currentScrollPos,i=this.maxScrollPos,n=e;0>e&&(n=0),e>i&&(n=i),this.throwTo(n,300)},l.prototype.throwTo=function(t,e){void 0===e&&(e=500);var i=this.currentScrollPos;if(i==t)return void this.endFunction.call(this.target);var n=this.animation;n.duration=e,n.from=i,n.to=t,n.play()},l.prototype.onScrollingUpdate=function(t){this.currentScrollPos=t.currentValue,this.updateFunction.call(this.target,t.currentValue)},l}();t.TouchScroll=l,__reflect(l.prototype,"eui.sys.TouchScroll")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.LTR="ltr",t.RTL="rtl",t.TTB="ttb",t.BTT="btt",t}();t.Direction=e,__reflect(e.prototype,"eui.Direction")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.AUTO="auto",t.OFF="off",t.ON="on",t}();t.ScrollPolicy=e,__reflect(e.prototype,"eui.ScrollPolicy")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){var n=e.call(this)||this;return n.delayList=[],n.skinMap={},n.$styles={},n.initialized=!t,i&&egret.registerImplementation("eui.Theme",n),n.$configURL=t,n.load(t),n}return __extends(i,e),i.prototype.load=function(e){var i=this;t.getTheme(e,function(t){return i.onConfigLoaded(t)})},i.prototype.onConfigLoaded=function(t){var e;if("string"==typeof t)try{e=JSON.parse(t)}catch(i){egret.$error(3e3)}else e=t;if(e&&e.skins)for(var n=this.skinMap,r=e.skins,o=Object.keys(r),s=o.length,a=0;s>a;a++){var h=o[a];n[h]||this.mapSkin(h,r[h])}e.styles&&(this.$styles=e.styles),e.exmls&&0!=e.exmls.length?e.exmls[0].gjs?(e.exmls.forEach(function(t){return EXML.$parseURLContentAsJs(t.path,t.gjs,t.className)}),this.onLoaded()):e.exmls[0].content?(e.exmls.forEach(function(t){return EXML.$parseURLContent(t.path,t.content)}),this.onLoaded()):EXML.$loadAll(e.exmls,this.onLoaded,this,!0):this.onLoaded()},i.prototype.onLoaded=function(t,e){this.initialized=!0,this.handleDelayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.handleDelayList=function(){for(var t=this.delayList,e=t.length,i=0;e>i;i++){var n=t[i];if(!n.$Component[5]){var r=this.getSkinName(n);r&&(n.$Component[1]=r,n.$parseSkinName())}}t.length=0},i.prototype.getSkinName=function(t){if(!this.initialized)return-1==this.delayList.indexOf(t)&&this.delayList.push(t),"";var e=this.skinMap,i=e[t.hostComponentKey];return i||(i=this.findSkinName(t)),i},i.prototype.findSkinName=function(t){if(!t)return"";var e=t.__class__;if(void 0===e)return"";var i=this.skinMap[e];return i||"eui.Component"==e?i:this.findSkinName(Object.getPrototypeOf(t))},i.prototype.mapSkin=function(t,e){this.skinMap[t]=e},i.prototype.$getStyleConfig=function(t){return this.$styles[t]},i}(egret.EventDispatcher);t.Theme=e,__reflect(e.prototype,"eui.Theme")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,n,r,o,s,a,h){var l=t.call(this,e,i,n)||this;return l.$initTo(r,o,s,a,h),l}return __extends(e,t),e.prototype.$initTo=function(t,e,i,n,r){this.kind=t,this.location=0|+e,this.oldLocation=0|+i,this.items=n||[],this.oldItems=r||[]},e.prototype.clean=function(){t.prototype.clean.call(this),this.items=this.oldItems=null},e.dispatchCollectionEvent=function(t,i,n,r,o,s,a){if(!t.hasEventListener(i))return!0;var h=egret.Event.create(e,i);h.$initTo(n,r,o,s,a);var l=t.dispatchEvent(h);return egret.Event.release(h),l},e.COLLECTION_CHANGE="collectionChange",e}(egret.Event);t.CollectionEvent=e,__reflect(e.prototype,"eui.CollectionEvent")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.ADD="add",t.REFRESH="refresh",t.REMOVE="remove",t.REPLACE="replace",t.RESET="reset",t.UPDATE="update",t}();t.CollectionEventKind=e,__reflect(e.prototype,"eui.CollectionEventKind")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e.itemRenderer=null,e.itemIndex=-1,e}return __extends(e,t),e.prototype.clean=function(){t.prototype.clean.call(this),this.item=this.itemRenderer=null},e.dispatchItemTapEvent=function(t,i,n){if(!t.hasEventListener(i))return!0;var r=egret.Event.create(e,i);r.item=n.data,r.itemIndex=n.itemIndex,r.itemRenderer=n;var o=t.dispatchEvent(r);return egret.Event.release(r),o},e.ITEM_TAP="itemTap",e}(egret.Event);t.ItemTapEvent=e,__reflect(e.prototype,"eui.ItemTapEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n)||this;return o.property=r,o}return __extends(e,t),e.dispatchPropertyEvent=function(t,i,n){if(!t.hasEventListener(i))return!0;var r=egret.Event.create(e,i);r.property=n;var o=t.dispatchEvent(r);return egret.Event.release(r),o},e.PROPERTY_CHANGE="propertyChange",e}(egret.Event);t.PropertyEvent=e,__reflect(e.prototype,"eui.PropertyEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,n)||this;return r=+r,o=+o,s.currentPos=r,s.toPos=o,s}return __extends(e,t),e.THROW="throw",e}(egret.Event);t.ScrollerThrowEvent=e,__reflect(e.prototype,"eui.ScrollerThrowEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return __extends(e,t),e.dispatchUIEvent=function(t,i,n,r){if(!t.hasEventListener(i))return!0;var o=egret.Event.create(e,i,n,r),s=t.dispatchEvent(o);return egret.Event.release(o),s},e.CREATION_COMPLETE="creationComplete",e.CHANGE_END="changeEnd",e.CHANGE_START="changeStart",e.CLOSING="closing",e.MOVE="move",e}(egret.Event);t.UIEvent=e,__reflect(e.prototype,"eui.UIEvent")}(eui||(eui={}));var eui;!function(t){var e;!function(t){var e="eui.State",i="eui.AddItems",n="eui.SetProperty",r="eui.SetStateProperty",o="eui.Binding.$bindProperties",s=function(){function t(){this.indent=0}return t.prototype.toCode=function(){return""},t.prototype.getIndent=function(t){void 0===t&&(t=this.indent);for(var e="",i=0;t>i;i++)e+="	";return e},t}();t.CodeBase=s,__reflect(s.prototype,"eui.sys.CodeBase");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className="",e.superClass="",e.innerClassBlock=[],e.variableBlock=[],e.functionBlock=[],e}return __extends(e,t),e.prototype.addInnerClass=function(t){-1==this.innerClassBlock.indexOf(t)&&this.innerClassBlock.push(t)},e.prototype.addVariable=function(t){-1==this.variableBlock.indexOf(t)&&this.variableBlock.push(t)},e.prototype.getVariableByName=function(t){for(var e=this.variableBlock,i=e.length,n=0;i>n;n++){var r=e[n];if(r.name==t)return r}return null},e.prototype.addFunction=function(t){-1==this.functionBlock.indexOf(t)&&this.functionBlock.push(t)},e.prototype.getFuncByName=function(t){for(var e=this.functionBlock,i=e.length,n=0;i>n;n++){var r=e[n];if(r.name==t)return r}return null},e.prototype.toCode=function(){var t=this.indent,e=this.getIndent(t),i=this.getIndent(t+1),n=this.getIndent(t+2),r=e+"(function (";r+=this.superClass?"_super) {\n"+i+"__extends("+this.className+", _super);\n":") {\n";for(var o=this.innerClassBlock,s=o.length,a=0;s>a;a++){var h=o[a];h.indent=t+1,r+=i+"var "+h.className+" = "+h.toCode()+"\n\n"}r+=i+"function "+this.className+"() {\n",this.superClass&&(r+=n+"_super.call(this);\n");var l=this.variableBlock;s=l.length;for(var a=0;s>a;a++){var u=l[a];u.defaultValue&&(r+=n+u.toCode()+"\n")}if(this.constructCode){var p=this.constructCode.toCode().split("\n");s=p.length;for(var a=0;s>a;a++){var c=p[a];r+=n+c+"\n"}}r+=i+"}\n",r+=i+"var _proto = "+this.className+".prototype;\n\n";var d=this.functionBlock;s=d.length;for(var a=0;s>a;a++){var f=d[a];f.indent=t+1,r+=f.toCode()+"\n"}return r+=i+"return "+this.className+";\n"+e,r+=this.superClass?"})("+this.superClass+");":"})();"},e}(s);t.EXClass=a,__reflect(a.prototype,"eui.sys.EXClass");var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lines=[],e}return __extends(e,t),e.prototype.addVar=function(t,e){var i=e?" = "+e:"";this.addCodeLine("var "+t+i+";")},e.prototype.addAssignment=function(t,e,i){var n=i?"."+i:"";this.addCodeLine(t+n+" = "+e+";")},e.prototype.addReturn=function(t){this.addCodeLine("return "+t+";")},e.prototype.addEmptyLine=function(){this.addCodeLine("")},e.prototype.startIf=function(t){this.addCodeLine("if("+t+")"),this.startBlock()},e.prototype.startElse=function(){this.addCodeLine("else"),this.startBlock()},e.prototype.startElseIf=function(t){this.addCodeLine("else if("+t+")"),this.startBlock()},e.prototype.startBlock=function(){this.addCodeLine("{"),this.indent++},e.prototype.endBlock=function(){this.indent--,this.addCodeLine("}")},e.prototype.doFunction=function(t,e){var i=e.join(",");this.addCodeLine(t+"("+i+")")},e.prototype.addCodeLine=function(t){this.lines.push(this.getIndent()+t)},e.prototype.addCodeLineAt=function(t,e){this.lines.splice(e,0,this.getIndent()+t)},e.prototype.containsCodeLine=function(t){return-1!=this.lines.indexOf(t)},e.prototype.concat=function(t){this.lines=this.lines.concat(t.lines)},e.prototype.toCode=function(){return this.lines.join("\n")},e}(s);t.EXCodeBlock=h,__reflect(h.prototype,"eui.sys.EXCodeBlock");var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.codeBlock=null,e.isGet=!1,e.name="",e}return __extends(e,t),e.prototype.toCode=function(){var t,e=this.getIndent(),i=this.getIndent(this.indent+1),n=e;if(this.isGet?(t=this.getIndent(this.indent+2),n+='Object.defineProperty(_proto, "skinParts", {\n',n+=i+"get: function () {\n"):(t=i,n+="_proto."+this.name+" = function () {\n"),this.codeBlock)for(var r=this.codeBlock.toCode().split("\n"),o=r.length,s=0;o>s;s++){var a=r[s];n+=t+a+"\n"}return n+=this.isGet?i+"},\n"+i+"enumerable: true,\n"+i+"configurable: true\n"+e+"});":e+"};"},e}(s);t.EXFunction=l,__reflect(l.prototype,"eui.sys.EXFunction");var u=function(t){function e(e,i){var n=t.call(this)||this;return n.indent=2,n.name=e,n.defaultValue=i,n}return __extends(e,t),e.prototype.toCode=function(){return this.defaultValue?"this."+this.name+" = "+this.defaultValue+";":""},e}(s);t.EXVariable=u,__reflect(u.prototype,"eui.sys.EXVariable");var p=function(t){function i(e,i){var n=t.call(this)||this;return n.name="",n.stateGroups=[],n.addItems=[],n.setProperty=[],n.name=e,i&&(n.stateGroups=i),n}return __extends(i,t),i.prototype.addOverride=function(t){t instanceof c?this.addItems.push(t):this.setProperty.push(t)},i.prototype.toCode=function(){for(var t=this.getIndent(1),i="new "+e+' ("'+this.name+'",\n'+t+"[\n",n=0,r=!0,o=this.addItems.concat(this.setProperty);n<o.length;){r?r=!1:i+=",\n";for(var s=o[n],a=s.toCode().split("\n"),h=a.length,l=0;h>l;l++){var u=a[l];a[l]=t+t+u}i+=a.join("\n"),n++}return i+="\n"+t+"])"},i}(s);t.EXState=p,__reflect(p.prototype,"eui.sys.EXState");var c=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.target=e,o.property=i,o.position=n,o.relativeTo=r,o}return __extends(e,t),e.prototype.toCode=function(){var t="new "+i+'("'+this.target+'","'+this.property+'",'+this.position+',"'+this.relativeTo+'")';
return t},e}(s);t.EXAddItems=c,__reflect(c.prototype,"eui.sys.EXAddItems");var d=function(t){function e(e,i,n){var r=t.call(this)||this;return r.target=e,r.name=i,r.value=n,r}return __extends(e,t),e.prototype.toCode=function(){return"new "+n+'("'+this.target+'","'+this.name+'",'+this.value+")"},e}(s);t.EXSetProperty=d,__reflect(d.prototype,"eui.sys.EXSetProperty");var f=function(t){function e(e,i,n,r){var o=t.call(this)||this;return e=e?"this."+e:"this",o.target=e,o.property=i,o.templates=n,o.chainIndex=r,o}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return"new "+r+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(s);t.EXSetStateProperty=f,__reflect(f.prototype,"eui.sys.EXSetStateProperty");var y=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.target=e,o.property=i,o.templates=n,o.chainIndex=r,o}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return o+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(s);t.EXBinding=y,__reflect(y.prototype,"eui.sys.EXBinding")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function n(t){var e=i.call(this)||this;return e.$createChildrenCalled=!1,e.$fontChanged=!1,e._widthConstraint=0/0,e._heightConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(n,i),n.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},n.prototype.$setWidth=function(t){var n=i.prototype.$setWidth.call(this,t),r=e.prototype.$setWidth.call(this,t);return n&&r},n.prototype.$setHeight=function(t){var n=i.prototype.$setHeight.call(this,t),r=e.prototype.$setHeight.call(this,t);return n&&r},n.prototype.$setText=function(e){var n=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),n},n.prototype.$setFont=function(t){this.$BitmapText;return this.$font==t?!1:(this.$font=t,this.$createChildrenCalled?this.$parseFont():this.$fontChanged=!0,this.$BitmapText[6]=!0,!0)},n.prototype.$parseFont=function(){var e=this;this.$fontChanged=!1;var i=this.$font;"string"==typeof i?t.getAssets(i,function(t){e.$setFontData(t)}):this.$setFontData(i)},n.prototype.$setFontData=function(t){return t==this.$BitmapText[5]?!1:(this.$BitmapText[5]=t,this.$invalidateContentBounds(),!0)},n.prototype.createChildren=function(){this.$fontChanged&&this.$parseFont(),this.$createChildrenCalled=!0},n.prototype.childrenCreated=function(){},n.prototype.commitProperties=function(){},n.prototype.measure=function(){var t=this.$UIComponent,e=this.$BitmapText,n=e[0],r=e[1],o=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(o=t[13]):o=t[8]:(o=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,o);var s=0/0;isNaN(this._heightConstraint)?isNaN(t[9])?1e5!=t[15]&&(s=t[15]):s=t[9]:(s=this._heightConstraint,this._heightConstraint=0/0),i.prototype.$setHeight.call(this,s),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,n),i.prototype.$setHeight.call(this,r)},n.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},n.prototype.invalidateParentLayout=function(){},n.prototype.setMeasuredSize=function(t,e){},n.prototype.invalidateProperties=function(){},n.prototype.validateProperties=function(){},n.prototype.invalidateSize=function(){},n.prototype.validateSize=function(t){},n.prototype.invalidateDisplayList=function(){},n.prototype.validateDisplayList=function(){},n.prototype.validateNow=function(){},n.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var n=this.$UIComponent;isNaN(n[9])&&t!=n[16]&&(this._widthConstraint=t,this._heightConstraint=i,this.invalidateSize())}},n.prototype.setLayoutBoundsPosition=function(t,e){},n.prototype.getLayoutBounds=function(t){},n.prototype.getPreferredBounds=function(t){},n}(egret.BitmapText);t.BitmapLabel=i,__reflect(i.prototype,"eui.BitmapLabel",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.BitmapText),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var EXML;!function(t){function e(t){return h.parse(t)}function i(t,e,i,n){if(void 0===n&&(n=!1),n&&t in u)return void(e&&e.call(i,u[t],t));var r=l[t];return r?void r.push([e,i]):(l[t]=[[e,i]],void a(t,s))}function n(t,e,i,n){if(void 0===n&&(n=!1),!t||0==t.length)return void(e&&e.call(i,[],t));var o=[];t.forEach(function(s){var h=function(n,s){o[n]=s,o.push(n),o.length==t.length&&r(t,o,e,i)};return n&&s in u?void h(s,""):void a(s,h)})}function r(t,e,i,n){var r=[];t.forEach(function(t,i){if(t in u&&!e[t])return void(r[i]=u[t]);var n=e[t],o=s(t,n);r[i]=o}),i&&i.call(n,r,t)}function o(t,e,i){var n=null;if(e&&(n=h.$parseCode(e,i)),t){u[t]=n;var r=l[t];delete l[t];for(var o=r?r.length:0,s=0;o>s;s++){var a=r[s];a[0]&&a[1]&&a[0].call(a[1],n,t)}}return n}function s(t,i){var n=null;if(i)try{n=e(i)}catch(r){console.error(t+"\n"+r.message)}if(t){n&&(u[t]=n);var o=l[t];delete l[t];for(var s=o?o.length:0,a=0;s>a;a++){var h=o[a];h[0]&&h[1]&&h[0].call(h[1],n,t)}}return n}function a(t,e){var i=t;-1==t.indexOf("://")&&(i=p+t);var n=function(i){i||(i=""),e(t,i)};eui.getTheme(i,n)}var h=new eui.sys.EXMLParser,l={},u={},p="";Object.defineProperty(t,"prefixURL",{get:function(){return p},set:function(t){p=t},enumerable:!0,configurable:!0}),t.parse=e,t.load=i,t.$loadAll=n,t.$parseURLContentAsJs=o,t.$parseURLContent=s}(EXML||(EXML={}));var eui;!function(t){var e;!function(t){function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){var e=egret.getDefinitionByName(t);return e?e.prototype:null}function n(t){if(!t)return null;var e;return e=new t}t.NS_S="http://ns.egret.com/eui",t.NS_W="http://ns.egret.com/wing";var r=["Point","Matrix","Rectangle"],o=["Array","boolean","string","number"],s="eui.",a=0,h={},l=function(){function l(){}return l.prototype.$describe=function(t){if(!t)return null;var i=Object.getPrototypeOf(t);if(!i)return null;var r;if(i.hasOwnProperty("__hashCode__")&&(r=h[i.__hashCode__]))return r;var s=Object.getPrototypeOf(i);if(!s)return null;var l=n(s.constructor),u=this.$describe(l);if(u){var p=function(){};p.prototype=u,r=new p}else r={};for(var c=Object.keys(i).concat(Object.keys(t)),d=c.length,f=t.__meta__,y=0;d>y;y++){var g=c[y];if("constructor"!=g&&"_"!=g.charAt(0)&&"$"!=g.charAt(0)){var v=void 0;if(f&&f[g])v=f[g];else if(e(t[g]))v="Array";else{if(v=typeof t[g],"function"==v)continue;-1==o.indexOf(v)&&(v="any")}r[g]=v}}return Object.getPrototypeOf(s)&&(i.__hashCode__=a++,h[i.__hashCode__]=r),r},l.prototype.getClassNameById=function(e,n){if(n==t.NS_S){if("Object"==e)return e;if(-1!=r.indexOf(e))return"egret."+e}var a="";return-1!=o.indexOf(e)?e:(n==t.NS_W||(a=n&&n!=t.NS_S?n.substring(0,n.length-1)+e:s+e),i(a)||(a=""),a)},l.prototype.getDefaultPropById=function(t,e){var n,r=this.getClassNameById(t,e),o=i(r);return o&&(n=o.__defaultProperty__),n?n:""},l.prototype.getPropertyType=function(t,e){if("Object"==e)return"any";var r="",o=i(e);if(o){if(!o.hasOwnProperty("__hashCode__")){var s=egret.getDefinitionByName(e),a=n(s);if(!a)return r;this.$describe(a)}var l=h[o.__hashCode__];l&&(r=l[t])}return r},l}();t.EXMLConfig=l,__reflect(l.prototype,"eui.sys.EXMLConfig")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.en_US=egret.$locale_strings.en_US||{};var e=egret.$locale_strings.en_US;e[2001]="EXML parsing error {0}: EXML file can't be found ",e[2002]="EXML parsing error : invalid XML file:\n{0}",e[2003]="EXML parsing error {0}: the class definitions corresponding to nodes can't be found  \n {1}",e[2004]="EXML parsing error {0}: nodes cannot contain id property with the same name \n {1}",e[2005]="EXML parsing error {0}: property with the name of '{1}' does not exist on the node, or the property does not have a default value: \n {2}",e[2006]="EXML parsing error {0}: undefined view state name: '{1}' \n {2}",e[2007]="EXML parsing error {0}: only UIComponent objects within the container can use the includeIn and excludeFrom properties\n {1}",e[2008]="EXML parsing error {0}: fail to assign values of '{1}' class to property: '{2}' \n {3}",e[2009]="EXML parsing error {0}: only one ID can be referenced in the node property value '{}' label; and complex expression is not allowed to use \n {1}",e[2010]="EXML parsing error {0}: ID referenced by property: '{1}':  '{2}' does not exist \n {3}",e[2011]="EXML parsing error {0}: fail to assign more than one child nodes to the same property: '{1}' \n {2}",e[2012]="EXML parsing error {0}: no default property exists on the node; and you must explicitly declare the property name that the child node  is assigned to \n {1}",e[2013]="EXML parsing error {0}: view state grammar is not allowed to use on property nodes of Array class \n {1} ",e[2014]="EXML parsing error {0}: assigning the skin class itself to the node property is not allowed \n {1}",e[2015]="EXML parsing error {0}: class definition referenced by node: {1} does not exist \n {2}",e[2016]="EXML parsing error {0}: format error of 'scale9Grid' property value on the node: {1}",e[2017]="EXML parsing error {0}: namespace prefix missing on the node: {1}",e[2018]="EXML parsing error {0}: format error of 'skinName' property value on the node: {1}",e[2019]="EXML parsing error {0}: the containers child item must be visible nodes: {1}",e[2020]="EXML parsing error {0}: for child nodes in w: Declarations, the includeIn and excludeFrom properties are not allowed to use \n {1}",e[2021]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[2022]="EXML parsing error: there contains illegal characters in the id `{0}`",e[2101]="EXML parsing warnning : fail to register the class property : {0},there is already a class with the same name in the global,please try to rename the class name for the exml. \n {1}",e[2102]="EXML parsing warnning {0}: no child node can be found on the property code \n {1}",e[2103]="EXML parsing warnning {0}: the same property '{1}' on the node is assigned multiple times \n {2}",e[2104]="EXML parsing warnning, Instantiate class {0} errorthe parameters of its constructor method must be empty.",e[2201]="BasicLayout doesn't support virtualization.",e[2202]="parse skinName errorthe parsing result of skinName must be a instance of eui.Skin.",e[2203]="Could not find the skin class '{0}'",e[2301]="parse source failedcould not find asset from URL{0} ."}(eui||(eui={}));var eui;!function(t){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.zh_CN=egret.$locale_strings.zh_CN||{};var e=egret.$locale_strings.zh_CN;e[2001]="EXML {0}: EXML",e[2002]="EXML: XML:\n{0}",e[2003]="EXML {0}: \n{1}",e[2004]="EXML {0}: id\n{1}",e[2005]="EXML {0}: '{1}':\n{2}",e[2006]="EXML {0}: :'{1}'\n{2}",e[2007]="EXML {0}:  UIComponent includeInexcludeFrom\n{1}",e[2008]="EXML {0}: '{1}':'{2}'\n{3}",e[2009]="EXML {0}: {}ID\n{1}",e[2010]="EXML {0}: :'{1}'ID: '{2}'\n{3}",e[2011]="EXML {0}: :'{1}'\n{2}",e[2012]="EXML {0}: \n{1}",e[2013]="EXML {0}: Array\n{1}",e[2014]="EXML {0}: \n{1}",e[2015]="EXML {0}: :{1}\n{2}",e[2016]="EXML {0}: 'scale9Grid':{1}",e[2017]="EXML {0}: :{1}",e[2018]="EXML {0}: 'skinName':{1}",e[2019]="EXML {0}: :{1}",e[2020]="EXML {0}: w:DeclarationsincludeInexcludeFrom\n{1}",e[2021]="{0}  : {1} : {2}",e[2022]="EXML: id `{0}` ",e[2101]="EXML: EXML class : {0} \n{1}",e[2102]="EXML {0}: \n{1}",e[2103]="EXML {0}: '{1}'\n{2}",e[2104]="EXML{0} EXMLEXML",e[2201]="BasicLayout ",e[2202]=" skinName  eui.Skin ",e[2203]=" '{0}'",e[2301]="URL{0} "}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.measure=function(){e.prototype.measure.call(this),t.sys.measure(this.$target)},i.prototype.updateDisplayList=function(i,n){e.prototype.updateDisplayList.call(this,i,n);var r=this.$target,o=t.sys.updateDisplayList(r,i,n);r.setContentSize(Math.ceil(o.x),Math.ceil(o.y))},i}(t.LayoutBase);t.BasicLayout=e,__reflect(e.prototype,"eui.BasicLayout")}(eui||(eui={})),function(t){var e;!function(t){function e(t,e){if(!t||"number"==typeof t)return t;var i=t,n=i.indexOf("%");if(-1==n)return+i;var r=+i.substring(0,n);return.01*r*e}function i(t){if(t){for(var e=0,i=0,n=egret.$TempRectangle,o=t.numChildren,s=0;o>s;s++){var a=t.getChildAt(s);if(egret.is(a,r)&&a.$includeInLayout){var h=a.$UIComponent,l=+h[4],u=+h[5],p=+h[0],c=+h[1],d=+h[2],f=+h[3],y=void 0,g=void 0;a.getPreferredBounds(n),isNaN(p)||isNaN(c)?isNaN(l)?isNaN(p)&&isNaN(c)?y=n.x:(y=isNaN(p)?0:p,y+=isNaN(c)?0:c):y=2*Math.abs(l):y=p+c,isNaN(d)||isNaN(f)?isNaN(u)?isNaN(d)&&isNaN(f)?g=n.y:(g=isNaN(d)?0:d,g+=isNaN(f)?0:f):g=2*Math.abs(u):g=d+f;var v=n.width,m=n.height;e=Math.ceil(Math.max(e,y+v)),i=Math.ceil(Math.max(i,g+m))}}t.setMeasuredSize(e,i)}}function n(t,i,n){if(t){for(var o=t.numChildren,s=0,a=0,h=egret.$TempRectangle,l=0;o>l;l++){var u=t.getChildAt(l);if(egret.is(u,r)&&u.$includeInLayout){var p=u.$UIComponent,c=e(p[4],.5*i),d=e(p[5],.5*n),f=e(p[0],i),y=e(p[1],i),g=e(p[2],n),v=e(p[3],n),m=p[6],$=p[7],E=0/0,C=0/0;isNaN(f)||isNaN(y)?isNaN(m)||(E=Math.round(i*Math.min(.01*m,1))):E=i-y-f,isNaN(g)||isNaN(v)?isNaN($)||(C=Math.round(n*Math.min(.01*$,1))):C=n-v-g,u.setLayoutBoundsSize(E,C),u.getLayoutBounds(h);var _=h.width,b=h.height,S=0/0,T=0/0;S=isNaN(c)?isNaN(f)?isNaN(y)?h.x:i-_-y:f:Math.round((i-_)/2+c),T=isNaN(d)?isNaN(g)?isNaN(v)?h.y:n-b-v:g:Math.round((n-b)/2+d),u.setLayoutBoundsPosition(S,T),s=Math.max(s,S+_),a=Math.max(a,T+b)}}return egret.$TempPoint.setTo(s,a)}}var r="eui.UIComponent";t.measure=i,t.updateDisplayList=n}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.LEFT="left",t.JUSTIFY_USING_GAP="justifyUsingGap",t.JUSTIFY_USING_WIDTH="justifyUsingWidth",t}();t.ColumnAlign=e,__reflect(e.prototype,"eui.ColumnAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return __extends(n,i),n.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,n=i,r=0,o=0,s=egret.$TempRectangle,a=0;i>a;a++){var h=t.getElementAt(a);egret.is(h,e)&&h.$includeInLayout?(h.getPreferredBounds(s),r+=s.width,o=Math.max(o,s.height)):n--}r+=(n-1)*this.$gap;var l=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(r+l,o+u)},n.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalWidth,n=this.getElementTotalSize(),r=Math.max(this.maxElementSize,this.$typicalHeight),o=egret.$TempRectangle,s=this.endIndex,a=this.elementSizeTable,h=this.startIndex;s>h;h++){var l=t.getElementAt(h);egret.is(l,e)&&l.$includeInLayout&&(l.getPreferredBounds(o),n+=o.width,n-=isNaN(a[h])?i:a[h],r=Math.max(r,o.height))}var u=this.$paddingLeft+this.$paddingRight,p=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+u,r+p)},n.prototype.updateDisplayListReal=function(i,n){var r=this.$target,o=this.$paddingLeft,s=this.$paddingRight,a=this.$paddingTop,h=this.$paddingBottom,l=this.$gap,u=Math.max(0,i-o-s),p=Math.max(0,n-a-h),c=this.$horizontalAlign==t.JustifyAlign.JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var y,g,v,m=r.numElements,$=m,E=o,C=a,_=0,b=0,S=[],T=u,x=this.maxElementSize,I=egret.$TempRectangle;for(y=0;m>y;y++){var P=r.getElementAt(y);if(egret.is(P,e)&&P.$includeInLayout)if(P.getPreferredBounds(I),x=Math.max(x,I.height),c)_+=I.width;else{var L=P.$UIComponent;isNaN(L[6])?T-=I.width:(b+=L[6],v=new t.sys.ChildInfo,v.layoutElement=P,v.percent=L[6],v.min=L[12],v.max=L[13],S.push(v))}else $--}T-=l*($-1),T=T>0?T:0;var N,O=u-_-l*($-1),B=$,A={};if(c){if(0>O){for(N=T/$,y=0;m>y;y++)g=r.getElementAt(y),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(I),I.width<=N&&(T-=I.width,B--));T=T>0?T:0}}else if(b>0){this.flexChildrenProportionally(u,T,b,S);var D=0,R=S.length;for(y=0;R>y;y++){v=S[y];var M=Math.round(v.size+D);D+=v.size-M,A[v.layoutElement.$hashCode]=M,T-=M}T=T>0?T:0}this.$horizontalAlign==egret.HorizontalAlign.CENTER?E=o+.5*T:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(E=o+T);var w=o,V=a,H=0,z=0,U=Math.ceil(p);this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(p,x)));var k,F,G=0;for(y=0;m>y;y++){var j=0;if(g=r.getElementAt(y),egret.is(g,e)&&g.$includeInLayout){if(g.getPreferredBounds(I),k=0/0,c?(F=0/0,O>0?F=T*I.width/_:0>O&&I.width>N&&(F=T/B),isNaN(F)||(k=Math.round(F+G),G+=F-k)):k=A[g.$hashCode],d)C=a,g.setLayoutBoundsSize(k,U),g.getLayoutBounds(I);else{var W=0/0,L=g.$UIComponent;if(!isNaN(g.percentHeight)){var X=Math.min(100,L[7]);W=Math.round(p*X*.01)}g.setLayoutBoundsSize(k,W),g.getLayoutBounds(I),j=(p-I.height)*f,j=j>0?j:0,C=a+j}g.setLayoutBoundsPosition(Math.round(E),Math.round(C)),H=Math.ceil(I.width),z=Math.ceil(I.height),w=Math.max(w,E+H),V=Math.max(V,C+z),E+=H+l}}this.maxElementSize=x,r.setContentSize(w+s,V+h)},n.prototype.updateDisplayListVirtual=function(i,n){var r=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var o,s=this.$paddingRight,a=this.$paddingTop,h=this.$paddingBottom,l=this.$gap,u=r.numElements;if(-1==this.startIndex||-1==this.endIndex)return o=this.getStartPosition(u)-l+s,void r.setContentSize(o,r.contentHeight);var p=this.endIndex;r.setVirtualElementIndicesInView(this.startIndex,p);var c=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;c||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var y,g=egret.$TempRectangle,v=Math.max(0,n-a-h),m=Math.ceil(v),$=this.$typicalHeight,E=this.$typicalWidth,C=this.maxElementSize,_=Math.max($,this.maxElementSize);if(d){for(var b=this.startIndex;p>=b;b++)y=r.getVirtualElementAt(b),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(g),C=Math.max(C,g.height));m=Math.ceil(Math.max(v,C))}for(var S,T=0,x=0,I=0,P=!1,L=this.elementSizeTable,N=this.startIndex;p>=N;N++){var O=0;y=r.getVirtualElementAt(N),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(g),d||(C=Math.max(C,g.height)),c?(x=a,y.setLayoutBoundsSize(0/0,m),y.getLayoutBounds(g)):(y.getLayoutBounds(g),O=(v-g.height)*f,O=O>0?O:0,x=a+O),I=Math.max(I,g.height),P||(S=isNaN(L[N])?E:L[N],S!=g.width&&(P=!0)),L[N]=g.width,T=this.getStartPosition(N),y.setLayoutBoundsPosition(Math.round(T),Math.round(x)))}I+=a+h,o=this.getStartPosition(u)-l+s,this.maxElementSize=C,r.setContentSize(o,I),(P||_<this.maxElementSize)&&r.invalidateSize()},n.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.x}for(var i=this.$typicalWidth,n=this.$paddingLeft,r=this.$gap,o=this.elementSizeTable,s=0;t>s;s++){var a=o[s];isNaN(a)&&(a=i),n+=a+r}return n},n.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalWidth),e}return this.$target?this.$target.getElementAt(t).width:0},n.prototype.getElementTotalSize=function(){for(var t=this.$typicalWidth,e=this.$gap,i=0,n=this.$target.numElements,r=this.elementSizeTable,o=0;n>o;o++){var s=r[o];isNaN(s)&&(s=t),i+=s+e}return i-=e},n.prototype.elementAdded=function(t){this.useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalWidth))},n.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(e[10]<=0||e[11]<=0)return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,n=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingRight,r=t.scrollH;if(r>n-this.$paddingRight)return this.startIndex=-1,this.endIndex=-1,!1;var o=t.scrollH+e[10];if(o<this.$paddingLeft)return this.startIndex=-1,this.endIndex=-1,!1;var s=this.startIndex,a=this.endIndex;return this.startIndex=this.findIndexAt(r,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(o,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),s!=this.startIndex||a!=this.endIndex},n}(t.LinearLayoutBase);t.HorizontalLayout=i,__reflect(i.prototype,"eui.HorizontalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.JustifyAlign=e,__reflect(e.prototype,"eui.JustifyAlign")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.TOP="top",t.JUSTIFY_USING_GAP="justifyUsingGap",t.JUSTIFY_USING_HEIGHT="justifyUsingHeight",t}();t.RowAlign=e,__reflect(e.prototype,"eui.RowAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function n(){var e=i.call(this)||this;return e.explicitHorizontalGap=0/0,e._horizontalGap=6,e.explicitVerticalGap=0/0,e._verticalGap=6,e._columnCount=-1,e._requestedColumnCount=0,e._rowCount=-1,e._requestedRowCount=0,e.explicitColumnWidth=0/0,e._columnWidth=0/0,e.explicitRowHeight=0/0,e._rowHeight=0/0,e._paddingLeft=0,e._paddingRight=0,e._paddingTop=0,e._paddingBottom=0,e._horizontalAlign=t.JustifyAlign.JUSTIFY,e._verticalAlign=t.JustifyAlign.JUSTIFY,e._columnAlign=t.ColumnAlign.LEFT,e._rowAlign=t.RowAlign.TOP,e._orientation=t.TileOrientation.ROWS,e.maxElementWidth=0,e.maxElementHeight=0,e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e}return __extends(n,i),Object.defineProperty(n.prototype,"horizontalGap",{get:function(){return this._horizontalGap},set:function(t){t=+t,t!==this._horizontalGap&&(this.explicitHorizontalGap=t,this._horizontalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalGap",{get:function(){return this._verticalGap},set:function(t){t=+t,t!==this._verticalGap&&(this.explicitVerticalGap=t,this._verticalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnCount",{get:function(){return this._columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"requestedColumnCount",{get:function(){return this._requestedColumnCount},set:function(t){t=+t||0,this._requestedColumnCount!==t&&(this._requestedColumnCount=t,this._columnCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rowCount",{get:function(){return this._rowCount},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"requestedRowCount",{get:function(){return this._requestedRowCount},set:function(t){t=+t||0,this._requestedRowCount!=t&&(this._requestedRowCount=t,this._rowCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnWidth",{get:function(){return this._columnWidth},set:function(t){t=+t,t!==this._columnWidth&&(this.explicitColumnWidth=t,this._columnWidth=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rowHeight",{get:function(){return this._rowHeight},set:function(t){t=+t,t!==this._rowHeight&&(this.explicitRowHeight=t,this._rowHeight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(t){t=+t||0,this._paddingLeft!=t&&(this._paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(t){t=+t||0,this._paddingTop!=t&&(this._paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalAlign",{get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnAlign",{get:function(){return this._columnAlign},set:function(t){this._columnAlign!=t&&(this._columnAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rowAlign",{get:function(){return this._rowAlign},set:function(t){this._rowAlign!=t&&(this._rowAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation!=t&&(this._orientation=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),n.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},n.prototype.measure=function(){var t=this.$target;if(t){var e=this._columnCount,i=this._rowCount,n=this._columnWidth,r=this._rowHeight,o=0,s=0,a=t.$UIComponent;this.calculateRowAndColumn(a[8],a[9]);var h=this._requestedColumnCount>0?this._requestedColumnCount:this._columnCount,l=this._requestedRowCount>0?this._requestedRowCount:this._rowCount,u=isNaN(this._horizontalGap)?0:this._horizontalGap,p=isNaN(this._verticalGap)?0:this._verticalGap;h>0&&(o=h*(this._columnWidth+u)-u),l>0&&(s=l*(this._rowHeight+p)-p);var c=this._paddingLeft+this._paddingRight,d=this._paddingTop+this._paddingBottom;t.setMeasuredSize(o+c,s+d),this._columnCount=e,this._rowCount=i,this._columnWidth=n,this._rowHeight=r}},n.prototype.calculateRowAndColumn=function(i,n){var r=this.$target,o=isNaN(this._horizontalGap)?0:this._horizontalGap,s=isNaN(this._verticalGap)?0:this._verticalGap;this._rowCount=this._columnCount=-1;for(var a=r.numElements,h=a,l=0;h>l;l++){var u=r.getElementAt(l);!u||egret.is(u,e)&&u.$includeInLayout||a--}if(0==a)return void(this._rowCount=this._columnCount=0);(isNaN(this.explicitColumnWidth)||isNaN(this.explicitRowHeight))&&this.updateMaxElementSize(),isNaN(this.explicitColumnWidth)?this._columnWidth=this.maxElementWidth:this._columnWidth=this.explicitColumnWidth,isNaN(this.explicitRowHeight)?this._rowHeight=this.maxElementHeight:this._rowHeight=this.explicitRowHeight;var p=this._columnWidth+o;0>=p&&(p=1);var c=this._rowHeight+s;0>=c&&(c=1);var d=this._orientation==t.TileOrientation.COLUMNS,f=!isNaN(i),y=!isNaN(n),g=this._paddingLeft,v=this._paddingRight,m=this._paddingTop,$=this._paddingBottom;if(this._requestedColumnCount>0||this._requestedRowCount>0)this._requestedRowCount>0&&(this._rowCount=Math.min(this._requestedRowCount,a)),this._requestedColumnCount>0&&(this._columnCount=Math.min(this._requestedColumnCount,a));else if(f||y)if(!f||y&&d){var E=Math.max(0,n-m-$);this._rowCount=Math.floor((E+s)/c),this._rowCount=Math.max(1,Math.min(this._rowCount,a))}else{var C=Math.max(0,i-g-v);this._columnCount=Math.floor((C+o)/p),this._columnCount=Math.max(1,Math.min(this._columnCount,a))}else{var _=Math.sqrt(a*p*c);d?this._rowCount=Math.max(1,Math.round(_/c)):this._columnCount=Math.max(1,Math.round(_/p))}-1==this._rowCount&&(this._rowCount=Math.max(1,Math.ceil(a/this._columnCount))),-1==this._columnCount&&(this._columnCount=Math.max(1,Math.ceil(a/this._rowCount))),this._requestedColumnCount>0&&this._requestedRowCount>0&&(this._orientation==t.TileOrientation.ROWS?this._rowCount=Math.max(1,Math.ceil(a/this._requestedColumnCount)):this._columnCount=Math.max(1,Math.ceil(a/this._requestedRowCount)))},n.prototype.updateMaxElementSize=function(){this.$target&&(this.$useVirtualLayout?(this.maxElementWidth=Math.max(this.maxElementWidth,this.$typicalWidth),this.maxElementHeight=Math.max(this.maxElementHeight,this.$typicalHeight),this.doUpdateMaxElementSize(this.startIndex,this.endIndex)):this.doUpdateMaxElementSize(0,this.$target.numElements-1))},n.prototype.doUpdateMaxElementSize=function(t,i){var n=this.maxElementWidth,r=this.maxElementHeight,o=egret.$TempRectangle,s=this.$target;if(-1!=t&&-1!=i)for(var a=t;i>=a;a++){var h=s.getVirtualElementAt(a);egret.is(h,e)&&h.$includeInLayout&&(h.getPreferredBounds(o),n=Math.max(n,o.width),r=Math.max(r,o.height))}this.maxElementWidth=n,this.maxElementHeight=r},n.prototype.clearVirtualLayoutCache=function(){i.prototype.clearVirtualLayoutCache.call(this),this.maxElementWidth=0,this.maxElementHeight=0},n.prototype.scrollPositionChanged=function(){if(this.$useVirtualLayout){var t=this.getIndexInView();t&&(this.indexInViewCalculated=!0,this.$target.invalidateDisplayList())}},n.prototype.getIndexInView=function(){if(!this.$target||0==this.$target.numElements)return this.startIndex=this.endIndex=-1,!1;var e=this.$target,i=e.numElements;if(!this.$useVirtualLayout)return this.startIndex=0,this.endIndex=i-1,!1;var n=e.$UIComponent;if(0==n[10]||0==n[11])return this.startIndex=this.endIndex=-1,!1;var r=this.startIndex,o=this.endIndex,s=this._paddingLeft,a=this._paddingTop,h=isNaN(this._horizontalGap)?0:this._horizontalGap,l=isNaN(this._verticalGap)?0:this._verticalGap;if(this._orientation==t.TileOrientation.COLUMNS){var u=this._columnWidth+h;if(0>=u)return this.startIndex=0,this.endIndex=i-1,!1;var p=e.scrollH,c=p+n[10],d=Math.floor((p-s)/u);0>d&&(d=0);var f=Math.ceil((c-s)/u);0>f&&(f=0),this.startIndex=Math.min(i-1,Math.max(0,d*this._rowCount)),this.endIndex=Math.min(i-1,Math.max(0,f*this._rowCount-1))}else{var y=this._rowHeight+l;if(0>=y)return this.startIndex=0,this.endIndex=i-1,!1;var g=e.scrollV,v=g+n[11],m=Math.floor((g-a)/y);0>m&&(m=0);var $=Math.ceil((v-a)/y);0>$&&($=0),this.startIndex=Math.min(i-1,Math.max(0,m*this._columnCount)),this.endIndex=Math.min(i-1,Math.max(0,$*this._columnCount-1))}return this.startIndex!=r||this.endIndex!=o},n.prototype.updateDisplayList=function(n,r){if(i.prototype.updateDisplayList.call(this,n,r),this.$target){var o=this.$target,s=this._paddingLeft,a=this._paddingRight,h=this._paddingTop,l=this._paddingBottom;if(this.indexInViewCalculated)this.indexInViewCalculated=!1;else{if(this.calculateRowAndColumn(n,r),0==this._rowCount||0==this._columnCount)return void o.setContentSize(s+a,h+l);this.adjustForJustify(n,r),this.getIndexInView()}if(this.$useVirtualLayout&&(this.calculateRowAndColumn(n,r),this.adjustForJustify(n,r)),-1==this.startIndex||-1==this.endIndex)return void o.setContentSize(0,0);var u=this.endIndex;o.setVirtualElementIndicesInView(this.startIndex,u);for(var p,c,d,f,y,g=this._orientation==t.TileOrientation.COLUMNS,v=this.startIndex,m=isNaN(this._horizontalGap)?0:this._horizontalGap,$=isNaN(this._verticalGap)?0:this._verticalGap,E=this._rowCount,C=this._columnCount,_=this._columnWidth,b=this._rowHeight,S=this.startIndex;u>=S;S++)if(p=this.$useVirtualLayout?this.target.getVirtualElementAt(S):this.target.getElementAt(S),egret.is(p,e)&&p.$includeInLayout){switch(g?(f=Math.ceil((v+1)/E)-1,y=Math.ceil((v+1)%E)-1,-1==y&&(y=E-1)):(f=Math.ceil((v+1)%C)-1,-1==f&&(f=C-1),y=Math.ceil((v+1)/C)-1),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:c=n-(f+1)*(_+m)+m-a;
break;case egret.HorizontalAlign.LEFT:c=f*(_+m)+s;break;default:c=f*(_+m)+s}switch(this._verticalAlign){case egret.VerticalAlign.TOP:d=y*(b+$)+h;break;case egret.VerticalAlign.BOTTOM:d=r-(y+1)*(b+$)+$-l;break;default:d=y*(b+$)+h}this.sizeAndPositionElement(p,c,d,_,b),v++}var T=s+a,x=h+l,I=(_+m)*C-m,P=(b+$)*E-$;o.setContentSize(I+T,P+x)}},n.prototype.sizeAndPositionElement=function(e,i,n,r,o){var s=0/0,a=0/0,h=e.$UIComponent;this._horizontalAlign==t.JustifyAlign.JUSTIFY?s=r:isNaN(h[6])||(s=r*h[6]*.01),this._verticalAlign==t.JustifyAlign.JUSTIFY?a=o:isNaN(h[7])||(a=o*h[7]*.01),e.setLayoutBoundsSize(Math.round(s),Math.round(a));var l=i,u=egret.$TempRectangle;switch(e.getLayoutBounds(u),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:l+=r-u.width;break;case egret.HorizontalAlign.CENTER:l=i+(r-u.width)/2}var p=n;switch(this._verticalAlign){case egret.VerticalAlign.BOTTOM:p+=o-u.height;break;case egret.VerticalAlign.MIDDLE:p+=(o-u.height)/2}e.setLayoutBoundsPosition(Math.round(l),Math.round(p))},n.prototype.adjustForJustify=function(e,i){var n=this._paddingLeft,r=this._paddingRight,o=this._paddingTop,s=this._paddingBottom,a=Math.max(0,e-n-r),h=Math.max(0,i-o-s);isNaN(this.explicitVerticalGap)||(this._verticalGap=this.explicitVerticalGap),isNaN(this.explicitHorizontalGap)||(this._horizontalGap=this.explicitHorizontalGap),this._verticalGap=isNaN(this._verticalGap)?0:this._verticalGap,this._horizontalGap=isNaN(this._horizontalGap)?0:this._horizontalGap;var l,u=h-this._rowHeight*this._rowCount,p=a-this._columnWidth*this._columnCount;u>0&&(this._rowAlign==t.RowAlign.JUSTIFY_USING_GAP?(l=Math.max(1,this._rowCount-1),this._verticalGap=u/l):this._rowAlign==t.RowAlign.JUSTIFY_USING_HEIGHT&&this._rowCount>0&&(this._rowHeight+=(u-(this._rowCount-1)*this._verticalGap)/this._rowCount)),p>0&&(this._columnAlign==t.ColumnAlign.JUSTIFY_USING_GAP?(l=Math.max(1,this._columnCount-1),this._horizontalGap=p/l):this._columnAlign==t.ColumnAlign.JUSTIFY_USING_WIDTH&&this._columnCount>0&&(this._columnWidth+=(p-(this._columnCount-1)*this._horizontalGap)/this._columnCount))},n}(t.LayoutBase);t.TileLayout=i,__reflect(i.prototype,"eui.TileLayout")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.ROWS="rows",t.COLUMNS="columns",t}();t.TileOrientation=e,__reflect(e.prototype,"eui.TileOrientation")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return __extends(n,i),n.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,n=i,r=0,o=0,s=egret.$TempRectangle,a=0;i>a;a++){var h=t.getElementAt(a);egret.is(h,e)&&h.$includeInLayout?(h.getPreferredBounds(s),o+=s.height,r=Math.max(r,s.width)):n--}o+=(n-1)*this.$gap;var l=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(r+l,o+u)},n.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalHeight,n=this.getElementTotalSize(),r=Math.max(this.maxElementSize,this.$typicalWidth),o=egret.$TempRectangle,s=this.endIndex,a=this.elementSizeTable,h=this.startIndex;s>h;h++){var l=t.getElementAt(h);egret.is(l,e)&&l.$includeInLayout&&(l.getPreferredBounds(o),n+=o.height,n-=isNaN(a[h])?i:a[h],r=Math.max(r,o.width))}var u=this.$paddingLeft+this.$paddingRight,p=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(r+u,n+p)},n.prototype.updateDisplayListReal=function(i,n){var r=this.$target,o=this.$paddingLeft,s=this.$paddingRight,a=this.$paddingTop,h=this.$paddingBottom,l=this.$gap,u=Math.max(0,i-o-s),p=Math.max(0,n-a-h),c=this.$verticalAlign==t.JustifyAlign.JUSTIFY,d=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?f=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(f=1));var y,g,v,m=r.numElements,$=m,E=o,C=a,_=0,b=0,S=[],T=p,x=this.maxElementSize,I=egret.$TempRectangle;for(y=0;m>y;y++){var P=r.getElementAt(y);if(egret.is(P,e)&&P.$includeInLayout)if(P.getPreferredBounds(I),x=Math.max(x,I.width),c)_+=I.height;else{var L=P.$UIComponent;isNaN(L[7])?T-=I.height:(b+=L[7],v=new t.sys.ChildInfo,v.layoutElement=P,v.percent=L[7],v.min=L[14],v.max=L[15],S.push(v))}else $--}T-=l*($-1),T=T>0?T:0;var N,O=p-_-l*($-1),B=$,A={};if(c){if(0>O){for(N=T/$,y=0;m>y;y++)g=r.getElementAt(y),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(I),I.height<=N&&(T-=I.height,B--));T=T>0?T:0}}else if(b>0){this.flexChildrenProportionally(p,T,b,S);var D=0,R=S.length;for(y=0;R>y;y++){v=S[y];var M=Math.round(v.size+D);D+=v.size-M,A[v.layoutElement.$hashCode]=M,T-=M}T=T>0?T:0}this.$verticalAlign==egret.VerticalAlign.MIDDLE?C=a+.5*T:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(C=a+T);var w=o,V=a,H=0,z=0,U=Math.ceil(u);this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(u,x)));var k,F,G=0;for(y=0;m>y;y++){var j=0;if(g=r.getElementAt(y),egret.is(g,e)&&g.$includeInLayout){if(g.getPreferredBounds(I),k=0/0,c?(F=0/0,O>0?F=T*I.height/_:0>O&&I.height>N&&(F=T/B),isNaN(F)||(k=Math.round(F+G),G+=F-k)):k=A[g.$hashCode],d)E=o,g.setLayoutBoundsSize(U,k),g.getLayoutBounds(I);else{var W=0/0,L=g.$UIComponent;if(!isNaN(L[6])){var X=Math.min(100,L[6]);W=Math.round(u*X*.01)}g.setLayoutBoundsSize(W,k),g.getLayoutBounds(I),j=(u-I.width)*f,j=j>0?j:0,E=o+j}g.setLayoutBoundsPosition(Math.round(E),Math.round(C)),H=Math.ceil(I.width),z=Math.ceil(I.height),w=Math.max(w,E+H),V=Math.max(V,C+z),C+=z+l}}this.maxElementSize=x,r.setContentSize(w+s,V+h)},n.prototype.updateDisplayListVirtual=function(i,n){var r=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var o,s=this.$paddingBottom,a=this.$paddingLeft,h=this.$paddingRight,l=this.$gap,u=r.numElements;if(-1==this.startIndex||-1==this.endIndex)return o=this.getStartPosition(u)-l+s,void r.setContentSize(r.contentWidth,o);var p=this.endIndex;r.setVirtualElementIndicesInView(this.startIndex,p);var c=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;c||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?f=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(f=1));var y,g=egret.$TempRectangle,v=Math.max(0,i-a-h),m=Math.ceil(v),$=this.$typicalHeight,E=this.$typicalWidth,C=this.maxElementSize,_=Math.max(E,this.maxElementSize);if(d){for(var b=this.startIndex;p>=b;b++)y=r.getVirtualElementAt(b),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(g),C=Math.max(C,g.width));m=Math.ceil(Math.max(v,C))}for(var S,T=0,x=0,I=0,P=!1,L=this.elementSizeTable,N=this.startIndex;p>=N;N++){var O=0;y=r.getVirtualElementAt(N),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(g),d||(C=Math.max(C,g.width)),c?(T=a,y.setLayoutBoundsSize(m,0/0),y.getLayoutBounds(g)):(y.getLayoutBounds(g),O=(v-g.width)*f,O=O>0?O:0,T=a+O),I=Math.max(I,g.width),P||(S=isNaN(L[N])?$:L[N],S!=g.height&&(P=!0)),L[N]=g.height,x=this.getStartPosition(N),y.setLayoutBoundsPosition(Math.round(T),Math.round(x)))}I+=a+h,o=this.getStartPosition(u)-l+s,this.maxElementSize=C,r.setContentSize(I,o),(P||_<this.maxElementSize)&&r.invalidateSize()},n.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.y}for(var i=this.$typicalHeight,n=this.$paddingTop,r=this.$gap,o=this.elementSizeTable,s=0;t>s;s++){var a=o[s];isNaN(a)&&(a=i),n+=a+r}return n},n.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalHeight),e}return this.$target?this.$target.getElementAt(t).height:0},n.prototype.getElementTotalSize=function(){for(var t=this.$typicalHeight,e=this.$gap,i=0,n=this.$target.numElements,r=this.elementSizeTable,o=0;n>o;o++){var s=r[o];isNaN(s)&&(s=t),i+=s+e}return i-=e},n.prototype.elementAdded=function(t){this.$useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalHeight))},n.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(0==e[10]||0==e[11])return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,n=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingBottom,r=t.scrollV;if(r>n-this.$paddingBottom)return this.startIndex=-1,this.endIndex=-1,!1;var o=t.scrollV+e[11];if(o<this.$paddingTop)return this.startIndex=-1,this.endIndex=-1,!1;var s=this.startIndex,a=this.endIndex;return this.startIndex=this.findIndexAt(r,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(o,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),s!=this.startIndex||a!=this.endIndex},n}(t.LinearLayoutBase);t.VerticalLayout=i,__reflect(i.prototype,"eui.VerticalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var n=this.thumb,r=this.$viewport;if(n&&r){var o=egret.$TempRectangle;n.getPreferredBounds(o);var s=o.width,a=o.y,h=r.scrollH,l=r.contentWidth,u=r.width;if(0>=h){var p=s*(1- -h/(.5*u));p=Math.max(5,Math.round(p)),n.setLayoutBoundsSize(p,0/0),n.setLayoutBoundsPosition(0,a)}else if(h>=l-u){var p=s*(1-(h-l+u)/(.5*u));p=Math.max(5,Math.round(p)),n.setLayoutBoundsSize(p,0/0),n.setLayoutBoundsPosition(e-p,a)}else{var c=(e-s)*h/(l-u);n.setLayoutBoundsSize(0/0,0/0),n.setLayoutBoundsPosition(c,a)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollH":case"contentWidth":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.HScrollBar=e,__reflect(e.prototype,"eui.HScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i,n){this.target=t,this.propertyName=e,this.position=i,this.relativeTo=n}return t.prototype.apply=function(t,e){var i,n=t[this.relativeTo],r=t[this.target],o=this.propertyName?t[this.propertyName]:e;if(r&&o){switch(this.position){case 0:i=0;break;case 1:i=-1;break;case 2:i=o.getChildIndex(n);break;case 3:i=o.getChildIndex(n)+1}-1==i&&(i=o.numChildren),egret.is(o,"eui.Component")&&o.$Component[8].$elementsContent.push(r),o.addChildAt(r,i)}},t.prototype.remove=function(t,e){var i=this.propertyName?t[this.propertyName]:e,n=t[this.target];if(n&&i&&(n.$parent===i&&i.removeChild(n),egret.is(i,"eui.Component"))){var r=i.$Component[8].$elementsContent,o=r.indexOf(n);o>-1&&r.splice(o,1)}},t}();t.AddItems=e,__reflect(e.prototype,"eui.AddItems",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i){this.target=t,this.name=e,this.value=i}return t.prototype.apply=function(t,e){var i=this.target?t[this.target]:t;i&&(this.oldValue=i[this.name],this.setPropertyValue(i,this.name,this.value,this.oldValue))},t.prototype.remove=function(t,e){var i=this.target?t[this.target]:t;i&&(this.setPropertyValue(i,this.name,this.oldValue,this.oldValue),this.oldValue=null)},t.prototype.setPropertyValue=function(t,e,i,n){void 0===i||null===i?t[e]=i:"number"==typeof n?t[e]=+i:"boolean"==typeof n?t[e]=this.toBoolean(i):t[e]=i},t.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},t}();t.SetProperty=e,__reflect(e.prototype,"eui.SetProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function e(t,e,i,n,r){this.host=t,this.templates=e,this.chainIndex=i,this.target=n,this.prop=r}return e.prototype.apply=function(e,i){if(this.target){var n=this.target[this.prop];this.oldValue&&this.setPropertyValue(this.target,this.prop,this.oldValue,this.oldValue),n&&(this.oldValue=n),t.Binding.$bindProperties(this.host,this.templates.concat(),this.chainIndex.concat(),this.target,this.prop)}},e.prototype.remove=function(t,e){if(this.target){var i=this.oldValue;this.target[this.prop]&&(this.oldValue=this.target[this.prop]),i&&this.setPropertyValue(this.target,this.prop,i,i)}},e.prototype.setPropertyValue=function(t,e,i,n){void 0===i||null===i?t[e]=i:"number"==typeof n?t[e]=+i:"boolean"==typeof n?t[e]=this.toBoolean(i):t[e]=i},e.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},e}();t.SetStateProperty=e,__reflect(e.prototype,"eui.SetStateProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t,e,i,n,o,s,a,h,l,u){var p;if(!isNaN(i)&&isNaN(n)){if(p=r(t,e,i,s,i,h,i,u))return p}else if(isNaN(i)&&!isNaN(n)&&(p=r(t,e,o,n,a,n,l,n)))return p;return p=r(t,e,o,s,a,h,l,u)}function i(t,e,i,r,o,s,a,h,l,u){var p;if(!isNaN(i)&&isNaN(r)){if(p=n(t,e,i,s,i,h,i,u))return p}else if(isNaN(i)&&!isNaN(r)&&(p=n(t,e,o,r,a,r,l,r)))return p;return p=n(t,e,o,s,a,h,l,u)}function n(t,e,i,n,r,s,h,l){var u=e.b,p=e.d;if(u>-1e-9&&1e-9>u&&(u=0),p>-1e-9&&1e-9>p&&(p=0),0==u&&0==p)return null;if(0==u&&0==p)return null;if(0==u)return egret.Point.create(i,t/Math.abs(p));if(0==p)return egret.Point.create(t/Math.abs(u),n);var c,d,f,y=u*p>=0?p:-p;if(0!=y&&i>0){var g=1/y;i=Math.max(r,Math.min(h,i)),d=i,f=(t-u*d)*g,f>=s&&l>=f&&u*d+y*f>=0&&(c=egret.Point.create(d,f)),f=(-t-u*d)*g,f>=s&&l>=f&&0>u*d+y*f&&(!c||a(c.x,c.y,e).width>a(d,f,e).width)&&(egret.Point.release(c),c=egret.Point.create(d,f))}if(0!=u&&n>0){var v=1/u;n=Math.max(s,Math.min(l,n)),f=n,d=(t-y*f)*v,d>=r&&h>=d&&u*d+y*f>=0&&(!c||a(c.x,c.y,e).width>a(d,f,e).width)&&(c=egret.Point.create(d,f)),d=(-t-y*f)*v,d>=r&&h>=d&&0>u*d+y*f&&(!c||a(c.x,c.y,e).width>a(d,f,e).width)&&(egret.Point.release(c),c=egret.Point.create(d,f))}if(c)return c;var m=e.a,$=e.c,E=m*$>=0?$:-$;return o(u,y,t,r,s,h,l,m,E)}function r(t,e,i,n,r,s,h,l){var u=e.a,p=e.c;if(u>-1e-9&&1e-9>u&&(u=0),p>-1e-9&&1e-9>p&&(p=0),0==u&&0==p)return null;if(0==u)return egret.Point.create(i,t/Math.abs(p));if(0==p)return egret.Point.create(t/Math.abs(u),n);var c,d,f,y=u*p>=0?p:-p;if(0!=y&&i>0){var g=1/y;i=Math.max(r,Math.min(h,i)),d=i,f=(t-u*d)*g,f>=s&&l>=f&&u*d+y*f>=0&&(c=egret.Point.create(d,f)),f=(-t-u*d)*g,f>=s&&l>=f&&0>u*d+y*f&&(!c||a(c.x,c.y,e).height>a(d,f,e).height)&&(egret.Point.release(c),c=egret.Point.create(d,f))}if(0!=u&&n>0){var v=1/u;n=Math.max(s,Math.min(l,n)),f=n,d=(t-y*f)*v,d>=r&&h>=d&&u*d+y*f>=0&&(!c||a(c.x,c.y,e).height>a(d,f,e).height)&&(egret.Point.release(c),c=egret.Point.create(d,f)),d=(-t-y*f)*v,d>=r&&h>=d&&0>u*d+y*f&&(!c||a(c.x,c.y,e).height>a(d,f,e).height)&&(egret.Point.release(c),c=egret.Point.create(d,f))}if(c)return c;var m=e.b,$=e.d,E=m*$>=0?$:-$;return o(u,y,t,r,s,h,l,m,E)}function o(t,e,i,n,r,o,s,a,h){if(0==t||0==e)return null;var l,u,p=(i-n*t)/e,c=(i-o*t)/e,d=Math.max(r,Math.min(p,c)),f=Math.min(s,Math.max(p,c)),y=a*e-t*h;return f>=d?(u=Math.abs(y)<1e-9?i/(t+e):a*i/y,u=Math.max(d,Math.min(u,f)),l=(i-e*u)/t,egret.Point.create(l,u)):(p=-(n*t+i)/e,c=-(o*t+i)/e,d=Math.max(r,Math.min(p,c)),f=Math.min(s,Math.max(p,c)),f>=d?(u=Math.abs(y)<1e-9?-i/(t+e):-a*i/y,u=Math.max(d,Math.min(u,f)),l=(-i-e*u)/t,egret.Point.create(l,u)):null)}function s(t,e,i,n,r,s,a){var l=i.a,u=i.b,p=i.c,c=i.d;if(l>-1e-9&&1e-9>l&&(l=0),u>-1e-9&&1e-9>u&&(u=0),p>-1e-9&&1e-9>p&&(p=0),c>-1e-9&&1e-9>c&&(c=0),0==u&&0==p)return 0==l||0==c?null:egret.Point.create(t/Math.abs(l),e/Math.abs(c));if(0==l&&0==c)return 0==u||0==p?null:egret.Point.create(e/Math.abs(u),t/Math.abs(p));var d=l*p>=0?p:-p,f=u*c>=0?c:-c,y=l*f-u*d;if(Math.abs(y)<1e-9)return 0==d||0==l||l==-d?null:Math.abs(l*e-u*t)>1e-9?null:o(l,d,t,n,n,s,a,u,f);var g=1/y;t*=g,e*=g;var v;return v=h(l,d,u,f,t,e),v&&n<=v.x&&v.x<=s&&r<=v.y&&v.y<=a&&l*v.x+d*v.x>=0&&u*v.x+f*v.y>=0?v:(v=h(l,d,u,f,t,-e),v&&n<=v.x&&v.x<=s&&r<=v.y&&v.y<=a&&l*v.x+d*v.x>=0&&u*v.x+f*v.y<0?v:(v=h(l,d,u,f,-t,e),v&&n<=v.x&&v.x<=s&&r<=v.y&&v.y<=a&&l*v.x+d*v.x<0&&u*v.x+f*v.y>=0?v:(v=h(l,d,u,f,-t,-e),v&&n<=v.x&&v.x<=s&&r<=v.y&&v.y<=a&&l*v.x+d*v.x<0&&u*v.x+f*v.y<0?v:(egret.Point.release(v),null))))}function a(t,e,i){var n=egret.$TempRectangle.setTo(0,0,t,e);return i.$transformBounds(n),n}function h(t,e,i,n,r,o){return egret.Point.create(n*r-e*o,t*o-i*r)}var l=.1,u=.1,p=function(){function t(){}return t.fitBounds=function(t,n,r,o,h,p,c,d,f,y,g){if(isNaN(t)&&isNaN(n))return egret.Point.create(p,c);var v,m=u>d?0:d-u,$=u>f?0:f-u,E=y+u,C=g+u;if(isNaN(t)||isNaN(n))return isNaN(t)?i(n,r,o,h,p,c,m,$,E,C):e(t,r,o,h,p,c,m,$,E,C);if(v=s(t,n,r,m,$,E,C),!v){var _=void 0;if(_=e(t,r,o,h,p,c,m,$,E,C)){var b=a(_.x,_.y,r).height;b-l>n&&(egret.Point.release(_),_=null)}var S=void 0;if(S=i(n,r,o,h,p,c,m,$,E,C)){var T=a(S.x,S.y,r).width;T-l>t&&(egret.Point.release(S),S=null)}v=_&&S?_.x*_.y>S.x*S.y?_:S:_?_:S,egret.Point.release(_),egret.Point.release(S)}return v},t}();t.MatrixUtil=p,__reflect(p.prototype,"eui.sys.MatrixUtil")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),RES;!function(e){var t=function(t){function r(){var r=t.call(this)||this;return r.resourceConfig=null,r.resourceConfig=e.configInstance,r}return __extends(r,t),r.prototype.addSubkey=function(e,t){this.resourceConfig.addSubkey(e,t)},r.prototype.loadFile=function(e,t,r){},r.prototype.getRes=function(e){},r.prototype.destroyRes=function(e){return!1},r.getStringPrefix=function(e){if(!e)return"";var t=e.indexOf(".");return-1!=t?e.substring(0,t):""},r.getStringTail=function(e){if(!e)return"";var t=e.indexOf(".");return-1!=t?e.substring(t+1):""},r}(egret.HashObject);e.AnalyzerBase=t,__reflect(t.prototype,"RES.AnalyzerBase")}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.fileDic={},e.resItemDic=[],e._dataFormat=egret.HttpResponseType.ARRAY_BUFFER,e.recycler=[],e}return __extends(r,t),r.prototype.loadFile=function(t,r,i){if(this.fileDic[t.name])return void r.call(i,t);var n=this.getRequest();this.resItemDic[n.hashCode]={item:t,func:r,thisObject:i},n.open(e.$getVirtualUrl(t.url)),n.send()},r.prototype.getRequest=function(){var e=this.recycler.pop();return e||(e=new egret.HttpRequest,e.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),e.responseType=this._dataFormat,e},r.prototype.onLoadFinish=function(e){var t=e.target,r=this.resItemDic[t.hashCode];delete this.resItemDic[t.hashCode];var i=r.item,n=r.func;i.loaded=e.type==egret.Event.COMPLETE,i.loaded&&this.analyzeData(i,t.response),this.recycler.push(t),n.call(r.thisObject,i)},r.prototype.analyzeData=function(e,t){var r=e.name;this.fileDic[r]||""!=t&&!t||(this.fileDic[r]=t)},r.prototype.getRes=function(e){return this.fileDic[e]},r.prototype.hasRes=function(e){var t=this.getRes(e);return null!=t},r.prototype.destroyRes=function(e){return this.fileDic[e]?(this.onResourceDestroy(this.fileDic[e]),delete this.fileDic[e],!0):!1},r.prototype.onResourceDestroy=function(e){},r}(e.AnalyzerBase);e.BinAnalyzer=t,__reflect(t.prototype,"RES.BinAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(){function e(e,t,r){this.groupName="",this.data=null,this._loaded=!1,this.name=e,this.url=t,this.type=r}return Object.defineProperty(e.prototype,"loaded",{get:function(){return this.data?this.data.loaded:this._loaded},set:function(e){this.data&&(this.data.loaded=e),this._loaded=e},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return'[ResourceItem name="'+this.name+'" url="'+this.url+'" type="'+this.type+'"]'},e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e}();e.ResourceItem=t,__reflect(t.prototype,"RES.ResourceItem")}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.sheetMap={},e.textureMap={},e.recyclerIamge=[],e._dataFormat=egret.HttpResponseType.TEXT,e}return __extends(r,t),r.prototype.getRes=function(t){var r=this.fileDic[t];if(r||(r=this.textureMap[t]),!r){var i=e.AnalyzerBase.getStringPrefix(t);if(r=this.fileDic[i]){var n=e.AnalyzerBase.getStringTail(t);r=r.getTexture(n)}}return r},r.prototype.onLoadFinish=function(e){var t=e.target,r=this.resItemDic[t.$hashCode];delete this.resItemDic[t.hashCode];var i=r.item,n=r.func;if(i.loaded=e.type==egret.Event.COMPLETE,i.loaded)if(t instanceof egret.HttpRequest){i.loaded=!1;var o=this.analyzeConfig(i,t.response);if(o)return this.loadImage(o,r),void this.recycler.push(t)}else{var s=new egret.Texture;s._setBitmapData(t.data),this.analyzeBitmap(i,s)}t instanceof egret.HttpRequest?this.recycler.push(t):this.recyclerIamge.push(t),n.call(r.thisObject,i)},r.prototype.analyzeConfig=function(e,t){var r,i=e.name,n="";try{var o=t;r=JSON.parse(o)}catch(s){egret.$warn(1017,e.url,t)}return r&&(this.sheetMap[i]=r,n=this.getRelativePath(e.url,r.file)),n},r.prototype.analyzeBitmap=function(e,t){var r=e.name;if(!this.fileDic[r]&&t){var i=this.sheetMap[r];delete this.sheetMap[r];var n=e.data&&e.data.subkeys?"":r,o=this.parseSpriteSheet(t,i,n);this.fileDic[r]=o}},r.prototype.getRelativePath=function(e,t){e=e.split("\\").join("/");var r=e.match(/#.*|\?.*/),i="";r&&(i=r[0]);var n=e.lastIndexOf("/");return e=-1!=n?e.substring(0,n+1)+t:t,e+i},r.prototype.parseSpriteSheet=function(e,t,r){var i=t.frames;if(!i)return null;var n=new egret.SpriteSheet(e),o=this.textureMap;for(var s in i){var a=i[s],u=n.createTexture(s,a.x,a.y,a.w,a.h,a.offX,a.offY,a.sourceW,a.sourceH);if(a.scale9grid){var c=a.scale9grid,l=c.split(",");u.scale9Grid=new egret.Rectangle(parseInt(l[0]),parseInt(l[1]),parseInt(l[2]),parseInt(l[3]))}null==o[s]&&(o[s]=u,r&&this.addSubkey(s,r))}return n},r.prototype.destroyRes=function(e){var t=this.fileDic[e];if(t){delete this.fileDic[e];var r=void 0;for(var i in t._textureMap)null==r&&(r=t._textureMap[i],this.onResourceDestroy(r),r=null),delete this.textureMap[i];return t.dispose&&t.dispose(),!0}return!1},r.prototype.loadImage=function(t,r){var i=this.getImageLoader();this.resItemDic[i.hashCode]=r,i.load(e.$getVirtualUrl(t))},r.prototype.getImageLoader=function(){var e=this.recyclerIamge.pop();return e||(e=new egret.ImageLoader,e.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),e},r.prototype.onResourceDestroy=function(e){e&&e.dispose()},r}(e.BinAnalyzer);e.SheetAnalyzer=t,__reflect(t.prototype,"RES.SheetAnalyzer")}(RES||(RES={}));var RES;!function(e){}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.fileDic={},e.resItemDic=[],e.recycler=[],e}return __extends(r,t),r.prototype.loadFile=function(t,r,i){if(this.fileDic[t.name])return void r.call(i,t);var n=this.getLoader();this.resItemDic[n.$hashCode]={item:t,func:r,thisObject:i},n.load(e.$getVirtualUrl(t.url))},r.prototype.getLoader=function(){var e=this.recycler.pop();return e||(e=new egret.ImageLoader,e.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),e},r.prototype.onLoadFinish=function(e){var t=e.$target,r=this.resItemDic[t.$hashCode];delete this.resItemDic[t.$hashCode];var i=r.item,n=r.func;if(i.loaded=e.$type==egret.Event.COMPLETE,i.loaded){var o=new egret.Texture;o._setBitmapData(t.data),this.analyzeData(i,o)}this.recycler.push(t),n.call(r.thisObject,i)},r.prototype.analyzeData=function(e,t){var r=e.name;if(!this.fileDic[r]&&t){this.fileDic[r]=t;var i=e.data;if(i&&i.scale9grid){var n=i.scale9grid,o=n.split(",");t.scale9Grid=new egret.Rectangle(parseInt(o[0]),parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}}},r.prototype.getRes=function(e){return this.fileDic[e]},r.prototype.hasRes=function(e){var t=this.getRes(e);return null!=t},r.prototype.destroyRes=function(e){return this.fileDic[e]?(this.onResourceDestroy(this.fileDic[e]),delete this.fileDic[e],!0):!1},r.prototype.onResourceDestroy=function(e){e.dispose()},r}(e.AnalyzerBase);e.ImageAnalyzer=t,__reflect(t.prototype,"RES.ImageAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._dataFormat=egret.HttpResponseType.TEXT,t}return __extends(t,e),t}(e.BinAnalyzer);e.TextAnalyzer=t,__reflect(t.prototype,"RES.TextAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._dataFormat=egret.HttpResponseType.TEXT,t}return __extends(t,e),t.prototype.analyzeData=function(e,t){var r=e.name;if(!this.fileDic[r]&&t)try{var i=t;this.fileDic[r]=JSON.parse(i)}catch(n){egret.$warn(1017,e.url,t)}},t}(e.BinAnalyzer);e.JsonAnalyzer=t,__reflect(t.prototype,"RES.JsonAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.thread=2,e.loadingCount=0,e.callBack=null,e.resInstance=null,e.groupTotalDic={},e.numLoadedDic={},e.itemListDic={},e.groupErrorDic={},e.retryTimesDic={},e.maxRetryTimes=3,e.failedList=new Array,e.priorityQueue={},e.lazyLoadList=new Array,e.analyzerDic={},e.queueIndex=0,e}return __extends(r,t),r.prototype.isGroupInLoading=function(e){return void 0!==this.itemListDic[e]},r.prototype.loadGroup=function(t,r,i){if(void 0===i&&(i=0),!this.itemListDic[r]&&r){if(!t||0==t.length){egret.$warn(3201,r);var n=new e.ResourceEvent(e.ResourceEvent.GROUP_LOAD_ERROR);return n.groupName=r,void this.dispatchEvent(n)}this.priorityQueue[i]?this.priorityQueue[i].push(r):this.priorityQueue[i]=[r],this.itemListDic[r]=t;for(var o=t.length,s=0;o>s;s++){var a=t[s];a.groupName=r}this.groupTotalDic[r]=t.length,this.numLoadedDic[r]=0,this.next()}},r.prototype.loadItem=function(e){this.lazyLoadList.push(e),e.groupName="",this.next()},r.prototype.next=function(){for(;this.loadingCount<this.thread;){var e=this.getOneResourceItem();if(!e)break;if(this.loadingCount++,e.loaded)this.onItemComplete(e);else{var t=this.resInstance.$getAnalyzerByType(e.type);t.loadFile(e,this.onItemComplete,this)}}},r.prototype.getOneResourceItem=function(){if(this.failedList.length>0)return this.failedList.shift();var e=Number.NEGATIVE_INFINITY;for(var t in this.priorityQueue)e=Math.max(e,t);var r=this.priorityQueue[e];if(!r||0==r.length)return 0==this.lazyLoadList.length?null:this.lazyLoadList.pop();for(var i,n=r.length,o=0;n>o&&(this.queueIndex>=n&&(this.queueIndex=0),i=this.itemListDic[r[this.queueIndex]],!(i.length>0));o++)this.queueIndex++;return 0==i.length?null:i.shift()},r.prototype.onItemComplete=function(t){this.loadingCount--;var r=t.groupName;if(!t.loaded){var i=this.retryTimesDic[t.name]||1;if(!(i>this.maxRetryTimes))return this.retryTimesDic[t.name]=i+1,this.failedList.push(t),void this.next();delete this.retryTimesDic[t.name],e.ResourceEvent.dispatchResourceEvent(this.resInstance,e.ResourceEvent.ITEM_LOAD_ERROR,r,t)}if(r){this.numLoadedDic[r]++;var n=this.numLoadedDic[r],o=this.groupTotalDic[r];if(t.loaded||(this.groupErrorDic[r]=!0),e.ResourceEvent.dispatchResourceEvent(this.resInstance,e.ResourceEvent.GROUP_PROGRESS,r,t,n,o),n==o){var s=this.groupErrorDic[r];this.removeGroupName(r),delete this.groupTotalDic[r],delete this.numLoadedDic[r],delete this.itemListDic[r],delete this.groupErrorDic[r],s?e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.GROUP_LOAD_ERROR,r):e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.GROUP_COMPLETE,r)}}else this.callBack.call(this.resInstance,t);this.next()},r.prototype.removeGroupName=function(e){for(var t in this.priorityQueue){for(var r=this.priorityQueue[t],i=0,n=!1,o=r.length,s=0;o>s;s++){var a=r[s];if(a==e){r.splice(i,1),n=!0;break}i++}if(n){0==r.length&&delete this.priorityQueue[t];break}}},r}(egret.EventDispatcher);e.ResourceLoader=t,__reflect(t.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.analyzeConfig=function(e,t){var r,i=e.name,n="";try{var o=t;r=JSON.parse(o)}catch(s){}return r?n=this.getRelativePath(e.url,r.file):(r=t,n=this.getTexturePath(e.url,r)),this.sheetMap[i]=r,n},t.prototype.analyzeBitmap=function(e,t){var r=e.name;if(!this.fileDic[r]&&t){var i=this.sheetMap[r];delete this.sheetMap[r];var n=new egret.BitmapFont(t,i);this.fileDic[r]=n}},t.prototype.getTexturePath=function(e,t){var r="",i=t.split("\n"),n=i[2],o=n.indexOf('file="');return-1!=o&&(n=n.substring(o+6),o=n.indexOf('"'),r=n.substring(0,o)),e=e.split("\\").join("/"),o=e.lastIndexOf("/"),e=-1!=o?e.substring(0,o+1)+r:r},t.prototype.onResourceDestroy=function(e){e&&e.dispose()},t}(e.SheetAnalyzer);e.FontAnalyzer=t,__reflect(t.prototype,"RES.FontAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(){function t(){this.keyMap={},this.groupDic={},e.configInstance=this}return t.prototype.getGroupByName=function(e){var t=new Array;if(!this.groupDic[e])return t;for(var r=this.groupDic[e],i=r.length,n=0;i>n;n++){var o=r[n];t.push(this.parseResourceItem(o))}return t},t.prototype.getRawGroupByName=function(e){return this.groupDic[e]?this.groupDic[e]:[]},t.prototype.createGroup=function(e,t,r){if(void 0===r&&(r=!1),!r&&this.groupDic[e]||!t||0==t.length)return!1;for(var i=this.groupDic,n=[],o=t.length,s=0;o>s;s++){var a=t[s],u=i[a];if(u)for(var c=u.length,l=0;c>l;l++){var p=u[l];-1==n.indexOf(p)&&n.push(p)}else{var p=this.keyMap[a];p?-1==n.indexOf(p)&&n.push(p):egret.$warn(3200,a)}}return 0==n.length?!1:(this.groupDic[e]=n,!0)},t.prototype.parseConfig=function(e,t){if(e){var r=e.resources;if(r)for(var i=r.length,n=0;i>n;n++){var o=r[n],s=o.url;s&&-1==s.indexOf("://")&&(o.url=t+s),this.addItemToKeyMap(o)}var a=e.groups;if(a)for(var u=a.length,n=0;u>n;n++){for(var c=a[n],l=[],p=c.keys.split(","),h=p.length,f=0;h>f;f++){var d=p[f].trim(),o=this.keyMap[d];o&&-1==l.indexOf(o)&&l.push(o)}this.groupDic[c.name]=l}}},t.prototype.addSubkey=function(e,t){var r=this.keyMap[t];r&&!this.keyMap[e]&&(this.keyMap[e]=r)},t.prototype.addItemToKeyMap=function(e){if(this.keyMap[e.name]||(this.keyMap[e.name]=e),e.hasOwnProperty("subkeys")){var t=e.subkeys.split(",");e.subkeys=t;for(var r=t.length,i=0;r>i;i++){var n=t[i];null==this.keyMap[n]&&(this.keyMap[n]=e)}}},t.prototype.getName=function(e){var t=this.keyMap[e];return t?t.name:""},t.prototype.getType=function(e){var t=this.keyMap[e];return t?t.type:""},t.prototype.getRawResourceItem=function(e){return this.keyMap[e]},t.prototype.getResourceItem=function(e){var t=this.keyMap[e];return t?this.parseResourceItem(t):null},t.prototype.parseResourceItem=function(t){var r=new e.ResourceItem(t.name,t.url,t.type);return r.data=t,r},t}();e.ResourceConfig=t,__reflect(t.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._dataFormat=egret.HttpResponseType.TEXT,t}return __extends(t,e),t.prototype.analyzeData=function(e,t){var r=e.name;if(!this.fileDic[r]&&t)try{var i=t,n=egret.XML.parse(i);this.fileDic[r]=n}catch(o){}},t}(e.BinAnalyzer);e.XMLAnalyzer=t,__reflect(t.prototype,"RES.XMLAnalyzer")}(RES||(RES={}));var RES;!function(e){var t=function(e){function t(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n.resItem=null,n}return __extends(t,e),t.dispatchResourceEvent=function(e,r,i,n,o,s){void 0===i&&(i=""),void 0===n&&(n=null),void 0===o&&(o=0),void 0===s&&(s=0);var a=egret.Event.create(t,r);a.groupName=i,a.resItem=n,a.itemsLoaded=o,a.itemsTotal=s;var u=e.dispatchEvent(a);return egret.Event.release(a),u},t.ITEM_LOAD_ERROR="itemLoadError",t.CONFIG_COMPLETE="configComplete",t.CONFIG_LOAD_ERROR="configLoadError",t.GROUP_PROGRESS="groupProgress",t.GROUP_COMPLETE="groupComplete",t.GROUP_LOAD_ERROR="groupLoadError",t}(egret.Event);e.ResourceEvent=t,__reflect(t.prototype,"RES.ResourceEvent")}(RES||(RES={}));var RES;!function(e){var t;!function(t){var r=function(e){function t(){var t=e.call(this)||this;return t._versionInfo={},t}return __extends(t,e),t.prototype.fetchVersion=function(e){e.onSuccess(null)},t.prototype.getChangeList=function(){return[]},t.prototype.getVirtualUrl=function(e){return e},t}(egret.EventDispatcher);t.Html5VersionController=r,__reflect(r.prototype,"RES.web.Html5VersionController",["RES.VersionController","RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(e.VersionController=r)}(t=e.web||(e.web={}))}(RES||(RES={}));var RES;!function(e){var t;!function(t){var r=function(){function e(){this._versionInfo={},this._versionPath="",this._localFileArr=[]}return e.prototype.fetchVersion=function(e){var t=this;if(t._versionPath="all.manifest",t._versionInfo=t.getLocalData(t._versionPath),null==t._versionInfo)return void egret.callLater(function(){e.onFail(1,null)},t);var r=0,i=function(i){if(i)for(var n=0;n<i.length;n++)i[n]&&""!=i[n]&&t._localFileArr.push("resource/"+i[n]);r++,2==r&&e.onSuccess(null)};t.getList(i,"assets","resource"),t.getList(i,"update","resource")},e.prototype.getList=function(e,t,r){void 0===r&&(r="");var i=egret.PromiseObject.create();i.onSuccessFunc=function(t){e(t)},i.onErrorFunc=function(){console.error("list files error")},"assets"==t?egret_native.Game.listResource(r,i):egret_native.Game.listUpdate(r,i)},e.prototype.getChangeList=function(){var e=[],t=this._localFileArr;for(var r in this._versionInfo)t.indexOf(this.getVirtualUrl(r))<0&&e.push({url:this.getVirtualUrl(r),size:this._versionInfo[r].s});return e},e.prototype.getVirtualUrl=function(e){return this._versionInfo&&this._versionInfo[e]?"resource/"+this._versionInfo[e].v.substring(0,2)+"/"+this._versionInfo[e].v+"_"+this._versionInfo[e].s+"."+e.substring(e.lastIndexOf(".")+1):e},e.prototype.getLocalData=function(e){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var t=egret_native.readUpdateFileSync(e);if(null!=t)return JSON.parse(t);if(t=egret_native.readResourceFileSync(e),null!=t)return JSON.parse(t)}return null},e}();t.NativeVersionController=r,__reflect(r.prototype,"RES.native.NativeVersionController",["RES.VersionController","RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(e.VersionController=r)}(t=e["native"]||(e["native"]={}))}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.soundDic={},e.resItemDic=[],e}return __extends(r,t),r.prototype.loadFile=function(t,r,i){if(this.soundDic[t.name])return void r.call(i,t);var n=new egret.Sound;n.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),this.resItemDic[n.$hashCode]={item:t,func:r,thisObject:i},n.load(e.$getVirtualUrl(t.url)),t.data&&(n.type=t.data.soundType)},r.prototype.onLoadFinish=function(e){var t=e.$target;t.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this);var r=this.resItemDic[t.$hashCode];delete this.resItemDic[t.$hashCode];var i=r.item,n=r.func;i.loaded=e.$type==egret.Event.COMPLETE,i.loaded&&this.analyzeData(i,t),n.call(r.thisObject,i)},r.prototype.analyzeData=function(e,t){var r=e.name;!this.soundDic[r]&&t&&(this.soundDic[r]=t)},r.prototype.getRes=function(e){return this.soundDic[e]},r.prototype.hasRes=function(e){return!!this.getRes(e)},r.prototype.destroyRes=function(e){return this.soundDic[e]?(delete this.soundDic[e],!0):!1},r}(e.AnalyzerBase);e.SoundAnalyzer=t,__reflect(t.prototype,"RES.SoundAnalyzer")}(RES||(RES={}));var RES;!function(e){function t(e,t){I.registerAnalyzer(e,t)}function r(e){return I.$getAnalyzerByType(e)}function i(e){I.$registerVersionController(e)}function n(){return I.vcs}function o(e,t,r){void 0===t&&(t=""),void 0===r&&(r="json"),I.loadConfig(e,t,r)}function s(e,t){void 0===t&&(t=0),I.loadGroup(e,t)}function a(e){return I.isGroupLoaded(e)}function u(e){return I.getGroupByName(e)}function c(e,t,r){return void 0===r&&(r=!1),I.createGroup(e,t,r)}function l(e){return I.hasRes(e)}function p(e,t){void 0===t&&(t=""),I.parseConfig(e,t)}function h(e){return I.getRes(e)}function f(e,t,r){I.getResAsync(e,t,r)}function d(e,t,r,i){void 0===i&&(i=""),I.getResByUrl(e,t,r,i)}function y(e,t){return I.destroyRes(e,t)}function g(e){I.setMaxLoadingThread(e)}function v(e){I.setMaxRetryTimes(e)}function R(e,t,r,i,n){void 0===i&&(i=!1),void 0===n&&(n=0),I.addEventListener(e,t,r,i,n)}function E(e,t,r,i){void 0===i&&(i=!1),I.removeEventListener(e,t,r,i)}function m(e){return I.vcs?I.vcs.getVirtualUrl(e):e}e.registerAnalyzer=t,e.getAnalyzer=r,e.registerVersionController=i,e.getVersionController=n,e.loadConfig=o,e.loadGroup=s,e.isGroupLoaded=a,e.getGroupByName=u,e.createGroup=c,e.hasRes=l,e.parseConfig=p,e.getRes=h,e.getResAsync=f,e.getResByUrl=d,e.destroyRes=y,e.setMaxLoadingThread=g,e.setMaxRetryTimes=v,e.addEventListener=R,e.removeEventListener=E,e.$getVirtualUrl=m;var _=function(t){function r(){var e=t.call(this)||this;return e.analyzerDic={},e.analyzerClassMap={},e.configItemList=[],e.callLaterFlag=!1,e.configComplete=!1,e.loadedGroups=[],e.groupNameList=[],e.asyncDic={},e._loadedUrlTypes={},e.init(),e}return __extends(r,t),r.prototype.$getAnalyzerByType=function(e){var t=this.analyzerDic[e];if(!t){var r=this.analyzerClassMap[e];if(!r)return null;t=this.analyzerDic[e]=new r}return t},r.prototype.registerAnalyzer=function(e,t){this.analyzerClassMap[e]=t},r.prototype.$registerVersionController=function(e){this.vcs=e},r.prototype.init=function(){this.vcs=new e.VersionController;var t=this.analyzerClassMap;t[e.ResourceItem.TYPE_BIN]=e.BinAnalyzer,t[e.ResourceItem.TYPE_IMAGE]=e.ImageAnalyzer,t[e.ResourceItem.TYPE_TEXT]=e.TextAnalyzer,t[e.ResourceItem.TYPE_JSON]=e.JsonAnalyzer,t[e.ResourceItem.TYPE_SHEET]=e.SheetAnalyzer,t[e.ResourceItem.TYPE_FONT]=e.FontAnalyzer,t[e.ResourceItem.TYPE_SOUND]=e.SoundAnalyzer,t[e.ResourceItem.TYPE_XML]=e.XMLAnalyzer,this.resConfig=new e.ResourceConfig,this.resLoader=new e.ResourceLoader,this.resLoader.callBack=this.onResourceItemComp,this.resLoader.resInstance=this,this.resLoader.addEventListener(e.ResourceEvent.GROUP_COMPLETE,this.onGroupComp,this),this.resLoader.addEventListener(e.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupError,this)},r.prototype.loadConfig=function(e,t,r){void 0===r&&(r="json");var i={url:e,resourceRoot:t,type:r};this.configItemList.push(i),this.callLaterFlag||(egret.callLater(this.startLoadConfig,this),this.callLaterFlag=!0)},r.prototype.startLoadConfig=function(){var t=this;this.callLaterFlag=!1;var i=this.configItemList;this.configItemList=[],this.loadingConfigList=i;for(var n=i.length,o=[],s=0;n>s;s++){var a=i[s],u=new e.ResourceItem(a.url,a.url,a.type);o.push(u)}var c={onSuccess:function(e){t.resLoader.loadGroup(o,r.GROUP_CONFIG,Number.MAX_VALUE)},onFail:function(r,i){e.ResourceEvent.dispatchResourceEvent(t,e.ResourceEvent.CONFIG_LOAD_ERROR)}};this.vcs?this.vcs.fetchVersion(c):this.resLoader.loadGroup(o,r.GROUP_CONFIG,Number.MAX_VALUE)},r.prototype.isGroupLoaded=function(e){return-1!=this.loadedGroups.indexOf(e)},r.prototype.getGroupByName=function(e){return this.resConfig.getGroupByName(e)},r.prototype.loadGroup=function(t,r){if(void 0===r&&(r=0),-1!=this.loadedGroups.indexOf(t))return void e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.GROUP_COMPLETE,t);if(!this.resLoader.isGroupInLoading(t))if(this.configComplete){var i=this.resConfig.getGroupByName(t);this.resLoader.loadGroup(i,t,r)}else this.groupNameList.push({name:t,priority:r})},r.prototype.createGroup=function(e,t,r){if(void 0===r&&(r=!1),r){var i=this.loadedGroups.indexOf(e);-1!=i&&this.loadedGroups.splice(i,1)}return this.resConfig.createGroup(e,t,r)},r.prototype.onGroupComp=function(t){if(t.groupName==r.GROUP_CONFIG){for(var i=this.loadingConfigList.length,n=0;i>n;n++){var o=this.loadingConfigList[n],s=this.$getAnalyzerByType(o.type),a=s.getRes(o.url);s.destroyRes(o.url),this.resConfig.parseConfig(a,o.resourceRoot)}this.configComplete=!0,this.loadingConfigList=null,e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.CONFIG_COMPLETE),this.loadDelayGroups()}else this.loadedGroups.push(t.groupName),this.dispatchEvent(t)},r.prototype.loadDelayGroups=function(){var e=this.groupNameList;this.groupNameList=[];for(var t=e.length,r=0;t>r;r++){var i=e[r];this.loadGroup(i.name,i.priority)}},r.prototype.onGroupError=function(t){t.groupName==r.GROUP_CONFIG?(this.loadingConfigList=null,e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.CONFIG_LOAD_ERROR)):this.dispatchEvent(t)},r.prototype.hasRes=function(t){var r=this.resConfig.getType(t);if(""==r){var i=e.AnalyzerBase.getStringTail(t);if(r=this.resConfig.getType(i),""==r)return!1}return!0},r.prototype.parseConfig=function(e,t){this.resConfig.parseConfig(e,t),this.configComplete||this.loadingConfigList||(this.configComplete=!0,this.loadDelayGroups())},r.prototype.getRes=function(t){var r=this.resConfig.getType(t);if(""==r){var i=e.AnalyzerBase.getStringPrefix(t);if(r=this.resConfig.getType(i),""==r)return null}var n=this.$getAnalyzerByType(r);return n.getRes(t)},r.prototype.getResAsync=function(t,r,i){var n=this.resConfig.getType(t),o=this.resConfig.getName(t);if(""==n&&(o=e.AnalyzerBase.getStringPrefix(t),n=this.resConfig.getType(o),""==n))return void egret.$callAsync(r,i);var s=this.$getAnalyzerByType(n),a=s.getRes(t);if(a)return void egret.$callAsync(r,i,a,t);var u={key:t,compFunc:r,thisObject:i};if(this.asyncDic[o])this.asyncDic[o].push(u);else{this.asyncDic[o]=[u];var c=this.resConfig.getResourceItem(o);this.resLoader.loadItem(c)}},r.prototype.getResByUrl=function(t,r,i,n){if(void 0===n&&(n=""),!t)return void egret.$callAsync(r,i);n||(n=this.getTypeByUrl(t)),null!=this._loadedUrlTypes[t]&&this._loadedUrlTypes[t]!=n&&egret.$warn(3202),this._loadedUrlTypes[t]=n;var o=this.$getAnalyzerByType(n),s=t,a=o.getRes(s);if(a)return void egret.$callAsync(r,i,a,t);var u={key:s,compFunc:r,thisObject:i};if(this.asyncDic[s])this.asyncDic[s].push(u);else{this.asyncDic[s]=[u];var c=new e.ResourceItem(s,t,n);this.resLoader.loadItem(c)}},r.prototype.getTypeByUrl=function(t){var r=t.substr(t.lastIndexOf(".")+1);r&&(r=r.toLowerCase());var i;switch(r){case e.ResourceItem.TYPE_XML:case e.ResourceItem.TYPE_JSON:case e.ResourceItem.TYPE_SHEET:i=r;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":i=e.ResourceItem.TYPE_IMAGE;break;case"fnt":i=e.ResourceItem.TYPE_FONT;break;case"txt":i=e.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":i=e.ResourceItem.TYPE_SOUND;break;default:i=e.ResourceItem.TYPE_BIN}return i},r.prototype.onResourceItemComp=function(e){var t=this.asyncDic[e.name];delete this.asyncDic[e.name];for(var r=this.$getAnalyzerByType(e.type),i=t.length,n=0;i>n;n++){var o=t[n],s=r.getRes(o.key);o.compFunc.call(o.thisObject,s,o.key)}},r.prototype.destroyRes=function(e,t){void 0===t&&(t=!0);var r=this.resConfig.getRawGroupByName(e);if(r&&r.length>0){var i=this.loadedGroups.indexOf(e);-1!=i&&this.loadedGroups.splice(i,1);for(var n=r.length,o=0;n>o;o++){var s=r[o];if(!t&&this.isResInLoadedGroup(s.name));else{s.loaded=!1;var a=this.$getAnalyzerByType(s.type);a.destroyRes(s.name),this.removeLoadedGroupsByItemName(s.name)}}return!0}var u=this.resConfig.getType(e);if(""==u){if(u=this._loadedUrlTypes[e],null==u||""==u)return!1;delete this._loadedUrlTypes[e];var c=this.$getAnalyzerByType(u);return c.destroyRes(e),!0}var s=this.resConfig.getRawResourceItem(e);s.loaded=!1;var a=this.$getAnalyzerByType(u),l=a.destroyRes(e);return this.removeLoadedGroupsByItemName(s.name),l},r.prototype.removeLoadedGroupsByItemName=function(e){for(var t=this.loadedGroups,r=t.length,i=0;r>i;i++)for(var n=this.resConfig.getRawGroupByName(t[i]),o=n.length,s=0;o>s;s++){var a=n[s];if(a.name==e){t.splice(i,1),i--,r=t.length;break}}},r.prototype.isResInLoadedGroup=function(e){for(var t=this.loadedGroups,r=t.length,i=0;r>i;i++)for(var n=this.resConfig.getRawGroupByName(t[i]),o=n.length,s=0;o>s;s++){var a=n[s];if(a.name==e)return!0}return!1},r.prototype.setMaxLoadingThread=function(e){1>e&&(e=1),this.resLoader.thread=e},r.prototype.setMaxRetryTimes=function(e){e=Math.max(e,0),this.resLoader.maxRetryTimes=e},r.GROUP_CONFIG="RES__CONFIG",r}(egret.EventDispatcher);__reflect(_.prototype,"Resource");var I=new _}(RES||(RES={}));var RES;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.sheetMap={},e.recyclerIamge=[],e._dataFormat=egret.HttpResponseType.TEXT,e}return __extends(r,t),r.prototype.onLoadFinish=function(e){var t=e.target,r=this.resItemDic[t.$hashCode];delete this.resItemDic[t.hashCode];var i=r.item,n=r.func;if(i.loaded=e.type==egret.Event.COMPLETE,i.loaded)if(t instanceof egret.HttpRequest){i.loaded=!1;var o=this.analyzeConfig(i,t.response);if(o)return this.loadImage(o,r),void this.recycler.push(t)}else this.analyzeBitmap(i,t.data);t instanceof egret.HttpRequest?this.recycler.push(t):this.recyclerIamge.push(t),n.call(r.thisObject,i)},r.prototype.analyzeConfig=function(e,t){var r,i=e.name,n="";try{var o=t;r=JSON.parse(o)}catch(s){egret.$warn(1017,e.url,t)}if(r)if(this.sheetMap[i]=r,r.file)n=this.getRelativePath(e.url,r.file);else{var a=e.url.split("?"),u=a[0].split("/");u[u.length-1]=u[u.length-1].split(".")[0]+".png",n="";for(var c=0;c<u.length;c++)n+=u[c]+(c<u.length-1?"/":"");2==a.length&&(n+=a[2])}return n},r.prototype.analyzeBitmap=function(e,t){var r=e.name;if(!this.fileDic[r]&&t){var i=this.sheetMap[r];delete this.sheetMap[r];var n=e.data&&e.data.subkeys?"":r,o=this.parseAnimation(t,i,n);this.fileDic[r]=o}},r.prototype.getRelativePath=function(e,t){e=e.split("\\").join("/");var r=e.lastIndexOf("/");return e=-1!=r?e.substring(0,r+1)+t:t},r.prototype.parseAnimation=function(e,t,r){for(var i,n=Object.keys(t.mc),o=t.mc[n[0]].frames,s=o.length,a=[],u=0;s>u;u++){i=t.res[o[u].res];var c=new egret.Texture;c._bitmapData=e,c.$initData(i.x,i.y,i.w,i.h,o[u].x,o[u].y,o[u].sourceW,o[u].sourceH,e.width,e.height)}return a},r.prototype.destroyRes=function(e){var t=this.fileDic[e];return t?(delete this.fileDic[e],!0):!1},r.prototype.loadImage=function(t,r){var i=this.getImageLoader();this.resItemDic[i.hashCode]=r,i.load(e.$getVirtualUrl(t))},r.prototype.getImageLoader=function(){var e=this.recyclerIamge.pop();return e||(e=new egret.ImageLoader,e.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),e},r}(e.BinAnalyzer);e.AnimationAnalyzer=t,__reflect(t.prototype,"RES.AnimationAnalyzer")}(RES||(RES={}));var egret;!function(e){e.$locale_strings=e.$locale_strings||{},e.$locale_strings.en_US=e.$locale_strings.en_US||{};var t=e.$locale_strings.en_US;t[3200]="RES.createGroup() passed in non-existed key value in configuration: {0}",t[3201]='RES loaded non-existed or empty resource group:"{0}"',t[3202]="Do not use the different types of ways to load the same material!",t[3203]="Can't find the analyzer of the specified file type:{0} Please register the specified analyzer in the initialization of the project first,then start the resource loading process"}(egret||(egret={}));var egret;!function(e){e.$locale_strings=e.$locale_strings||{},e.$locale_strings.zh_CN=e.$locale_strings.zh_CN||{};var t=e.$locale_strings.zh_CN;t[3200]="RES.createGroup(): {0}",t[3201]='RES:"{0}"',t[3202]="",t[3203]=":{0} "}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var r=e/n*Math.asin(1/t);return-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n/e))}},e.getElasticOut=function(t,e){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var r=e/n*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*n/e)+1}},e.getElasticInOut=function(t,e){var n=2*Math.PI;return function(i){var r=e/n*Math.asin(1/t);return(i*=2)<1?-.5*(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n/e)):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*n/e)*.5+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,i){var r=e.call(this)||this;return r._target=null,r._useTicks=!1,r.ignoreGlobalPause=!1,r.loop=!1,r.pluginData=null,r._steps=null,r.paused=!1,r.duration=0,r._prevPos=-1,r.position=null,r._prevPosition=0,r._stepPosition=0,r.passive=!1,r.initialize(t,n,i),r}return __extends(n,e),n.get=function(t,e,i,r){return void 0===i&&(i=null),void 0===r&&(r=!1),r&&n.removeTweens(t),new n(t,e,i)},n.removeTweens=function(t){if(t.tween_count){for(var e=n._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},n.pauseTweens=function(e){if(e.tween_count)for(var n=t.Tween._tweens,i=n.length-1;i>=0;i--)n[i]._target==e&&(n[i].paused=!0)},n.resumeTweens=function(e){if(e.tween_count)for(var n=t.Tween._tweens,i=n.length-1;i>=0;i--)n[i]._target==e&&(n[i].paused=!1)},n.tick=function(t,e){void 0===e&&(e=!1);var i=t-n._lastTime;n._lastTime=t;for(var r=n._tweens.concat(),s=r.length-1;s>=0;s--){var o=r[s];e&&!o.ignoreGlobalPause||o.paused||o.$tick(o._useTicks?1:i)}return!1},n._register=function(e,i){var r=e._target,s=n._tweens;if(i)r&&(r.tween_count=r.tween_count>0?r.tween_count+1:1),s.push(e),n._inited||(n._lastTime=t.getTimer(),t.ticker.$startTick(n.tick,null),n._inited=!0);else{r&&r.tween_count--;for(var o=s.length;o--;)if(s[o]==e)return void s.splice(o,1)}},n.removeAllTweens=function(){for(var t=n._tweens,e=0,i=t.length;i>e;e++){var r=t[e];r.paused=!0,r._target.tween_count=0}t.length=0},n.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&n.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:n._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,n.NONE)},n.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var n=t,i=!1;if(n>=this.duration)if(this.loop){var r=n%this.duration;n=n>0&&0===r?this.duration:r}else n=this.duration,i=!0;if(n==this._prevPos)return i;i&&this.setPaused(!0);var s=this._prevPos;if(this.position=this._prevPos=n,this._prevPosition=t,this._target&&this._steps.length>0){for(var o=this._steps.length,u=-1,a=0;o>a&&!("step"==this._steps[a].type&&(u=a,this._steps[a].t<=n&&this._steps[a].t+this._steps[a].d>=n));a++);for(var a=0;o>a;a++)if("action"==this._steps[a].type)0!=e&&(this._useTicks?this._runAction(this._steps[a],n,n):1==e&&s>n?(s!=this.duration&&this._runAction(this._steps[a],s,this.duration),this._runAction(this._steps[a],0,n,!0)):this._runAction(this._steps[a],s,n));else if("step"==this._steps[a].type&&u==a){var p=this._steps[u];this._updateTargetProps(p,Math.min((this._stepPosition=n-p.t)/p.d,1))}}return this.dispatchEventWith("change"),i},n.prototype._runAction=function(t,e,n,i){void 0===i&&(i=!1);var r=e,s=n;e>n&&(r=n,s=e);var o=t.t;(o==s||o>r&&s>o||i&&o==e)&&t.f.apply(t.o,t.p)},n.prototype._updateTargetProps=function(t,e){var i,r,s,o,u,a;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,r=t.p1}else this.passive=!1,i=r=this._curQueueProps;for(var p in this._initQueueProps){null==(o=i[p])&&(i[p]=o=this._initQueueProps[p]),null==(u=r[p])&&(r[p]=u=o),s=o==u||0==e||1==e||"number"!=typeof o?1==e?u:o:o+(u-o)*e;var h=!1;if(a=n._plugins[p])for(var c=0,_=a.length;_>c;c++){var f=a[c].tween(this,p,s,i,r,e,!!t&&i==r,!t);f==n.IGNORE?h=!0:s=f}h||(this._target[p]=s)}},n.prototype.setPaused=function(t){return this.paused==t?this:(this.paused=t,n._register(this,!t),this)},n.prototype._cloneProps=function(t){var e={};for(var n in t)e[n]=t[n];return e},n.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},n.prototype._appendQueueProps=function(t){var e,i,r,s,o;for(var u in t)if(void 0===this._initQueueProps[u]){if(i=this._target[u],e=n._plugins[u])for(r=0,s=e.length;s>r;r++)i=e[r].init(this,u,i);this._initQueueProps[u]=this._curQueueProps[u]=void 0===i?null:i}else i=this._curQueueProps[u];for(var u in t){if(i=this._curQueueProps[u],e=n._plugins[u])for(o=o||{},r=0,s=e.length;s>r;r++)e[r].step&&e[r].step(this,u,i,t[u],o);this._curQueueProps[u]=t[u]}return o&&this._appendQueueProps(o),this._curQueueProps},n.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},n.prototype._set=function(t,e){for(var n in t)e[n]=t[n]},n.prototype.wait=function(t,e){if(null==t||0>=t)return this;var n=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:n,p1:n,v:e})},n.prototype.to=function(t,e,n){return void 0===n&&(n=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:n,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},n.prototype.call=function(t,e,n){return void 0===e&&(e=void 0),void 0===n&&(n=void 0),this._addAction({f:t,p:n?n:[],o:e?e:this._target})},n.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},n.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},n.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},n.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},n.NONE=0,n.LOOP=1,n.REVERSE=2,n._tweens=[],n.IGNORE={},n._plugins={},n._inited=!1,n._lastTime=0,n}(t.EventDispatcher);t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var egret;!function(t){var e;!function(e){function n(e){if("function"==typeof e)return e;var n=t.Ease[e];return"function"==typeof n?n:null}function i(t,e,n,i){var r=t.prototype;r.__meta__=r.__meta__||{},r.__meta__[e]=n,i&&(r.__defaultProperty__=e)}var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=r,__reflect(r.prototype,"egret.tween.BasePath");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(r);e.To=s,__reflect(s.prototype,"egret.tween.To");var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(r);e.Wait=o,__reflect(o.prototype,"egret.tween.Wait");var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(r);e.Set=u,__reflect(u.prototype,"egret.tween.Set");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(r);e.Tick=a,__reflect(a.prototype,"egret.tween.Tick");var p=function(e){function i(){var t=e.call(this)||this;return t.isStop=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),i.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&void 0==t&&(t=0,this.isStop=!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween(t)},i.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},i.prototype.stop=function(){this.pause(),this.isStop=!0},i.prototype.createTween=function(e){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),void 0!==e&&null!==e&&this.tween.setPosition(e)},i.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},i.prototype.applyPath=function(t){var e=this;t instanceof s?this.tween.to(t.props,t.duration,n(t.ease)):t instanceof o?this.tween.wait(t.duration,t.passive):t instanceof u?this.tween.set(t.props):t instanceof a&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},i.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},i}(t.EventDispatcher);e.TweenItem=p,__reflect(p.prototype,"egret.tween.TweenItem"),i(p,"paths","Array",!0);var h=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(n){t?n.addEventListener("complete",e.itemComplete,e):n.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var n=this._items[e];n.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=h,__reflect(h.prototype,"egret.tween.TweenGroup"),i(h,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function o(n,i){void 0===n&&(n=""),void 0===i&&(i=0);var s=e.call(this)||this;return s._writeMessage="",s._readMessage="",s._connected=!1,s._connecting=!1,s._isReadySend=!1,s._bytesWrite=!1,s._type=o.TYPE_STRING,s._connected=!1,s._writeMessage="",s._readMessage="",s.socket=new t.ISocket,s.socket.addCallBacks(s.onConnect,s.onClose,s.onSocketData,s.onError,s),s}return __extends(o,e),o.prototype.connect=function(t,e){this._connecting||this._connected||(this._connecting=!0,this.socket.connect(t,e))},o.prototype.connectByUrl=function(t){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(t))},o.prototype.close=function(){this._connected&&this.socket.close()},o.prototype.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(t.Event.CONNECT)},o.prototype.onClose=function(){this._connected=!1,this.dispatchEventWith(t.Event.CLOSE)},o.prototype.onError=function(){this._connecting&&(this._connecting=!1),this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},o.prototype.onSocketData=function(e){"string"==typeof e?this._readMessage+=e:this._readByte._writeUint8Array(new Uint8Array(e)),t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.SOCKET_DATA)},o.prototype.flush=function(){return this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),void(this._isReadySend=!1)):void t.$warn(3101)},o.prototype.writeUTF=function(e){return this._connected?(this._type==o.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(e)):this._writeMessage+=e,void this.flush()):void t.$warn(3101)},o.prototype.readUTF=function(){var t;return this._type==o.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},o.prototype.writeBytes=function(e,o,n){return void 0===o&&(o=0),void 0===n&&(n=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(e,o,n),void this.flush()):void t.$warn(3102):void t.$warn(3101)},o.prototype.readBytes=function(e,o,n){return void 0===o&&(o=0),void 0===n&&(n=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(e,o,n),void this._readByte.clear()):void t.$warn(3102)},Object.defineProperty(o.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,e!=o.TYPE_BINARY||this._writeByte||(this._readByte=new t.ByteArray,this._writeByte=new t.ByteArray)},enumerable:!0,configurable:!0}),o.TYPE_STRING="webSocketTypeString",o.TYPE_BINARY="webSocketTypeBinary",o}(t.EventDispatcher);t.WebSocket=e,__reflect(e.prototype,"egret.WebSocket")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var o=function(){function t(){this.host="",this.port=0}return t.prototype.addCallBacks=function(t,e,o,n,i){this.onConnect=t,this.onClose=e,this.onSocketData=o,this.onError=n,this.thisObject=i},t.prototype.connect=function(t,e){this.host=t,this.port=e;var o="ws://"+this.host+":"+this.port;this.socket=new __global.egret_native.WebSocket(o),this._bindEvent()},t.prototype.connectByUrl=function(t){this.socket=new __global.egret_native.WebSocket(t),this._bindEvent()},t.prototype._bindEvent=function(){var t=this,e=this.socket;e.onOpen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onClose=function(){t.onClose&&t.onClose.call(t.thisObject)},e.onError=function(e){t.onError&&t.onError.call(t.thisObject)},e.onMessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e)}},t.prototype.send=function(t){this.socket.send(t)},t.prototype.close=function(){this.socket.close()},t.prototype.disconnect=function(){this.socket.disconnect&&this.socket.disconnect()},t}();e.NativeSocket=o,__reflect(o.prototype,"egret.native.NativeSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&(t.ISocket=o)}(e=t["native"]||(t["native"]={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var o=function(){function e(){this.host="",this.port=0,window.WebSocket||t.$error(3100)}return e.prototype.addCallBacks=function(t,e,o,n,i){this.onConnect=t,this.onClose=e,this.onSocketData=o,this.onError=n,this.thisObject=i},e.prototype.connect=function(t,e){this.host=t,this.port=e;var o="ws://"+this.host+":"+this.port;this.socket=new window.WebSocket(o),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype.connectByUrl=function(t){this.socket=new window.WebSocket(t),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype._bindEvent=function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(e){t.onClose&&t.onClose.call(t.thisObject)},e.onerror=function(e){t.onError&&t.onError.call(t.thisObject)},e.onmessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e.data)}},e.prototype.send=function(t){this.socket.send(t)},e.prototype.close=function(){this.socket.close()},e.prototype.disconnect=function(){this.socket.disconnect&&this.socket.disconnect()},e}();e.HTML5WebSocket=o,__reflect(o.prototype,"egret.web.HTML5WebSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.WEB&&(t.ISocket=o)}(e=t.web||(t.web={}))}(egret||(egret={}));"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return function(e,i){t(e,i);function a(){this.constructor=e}e.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();var dragonBones;(function(t){})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function e(i){this._clock=new t.WorldClock;this._events=[];this._objects=[];this._eventManager=null;this._eventManager=i;console.info("DragonBones: "+e.VERSION+"\nWebsite: http://www.dragonbones.com/\nSource: http://www.github.com/dragonbones/")}e.prototype.advanceTime=function(e){if(this._objects.length>0){for(var i=0,a=this._objects;i<a.length;i++){var r=a[i];r.returnToPool()}this._objects.length=0}this._clock.advanceTime(e);if(this._events.length>0){for(var n=0;n<this._events.length;++n){var s=this._events[n];var o=s.armature;if(o._armatureData!==null){o.eventDispatcher.dispatchDBEvent(s.type,s);if(s.type===t.EventObject.SOUND_EVENT){this._eventManager.dispatchDBEvent(s.type,s)}}this.bufferObject(s)}this._events.length=0}};e.prototype.bufferEvent=function(t){if(this._events.indexOf(t)<0){this._events.push(t)}};e.prototype.bufferObject=function(t){if(this._objects.indexOf(t)<0){this._objects.push(t)}};Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:true,configurable:true});e.VERSION="5.6.0";e.yDown=true;e.debug=false;e.debugDraw=false;e.webAssembly=false;return e}();t.DragonBones=e;if(!console.warn){console.warn=function(){}}if(!console.assert){console.assert=function(){}}})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(){this.hashCode=t._hashCode++;this._isInPool=false}t._returnObject=function(e){var i=String(e.constructor);var a=i in t._maxCountMap?t._maxCountMap[i]:t._defaultMaxCount;var r=t._poolsMap[i]=t._poolsMap[i]||[];if(r.length<a){if(!e._isInPool){e._isInPool=true;r.push(e)}else{console.warn("The object is already in the pool.")}}else{}};t.toString=function(){throw new Error};t.setMaxCount=function(e,i){if(i<0||i!==i){i=0}if(e!==null){var a=String(e);var r=a in t._poolsMap?t._poolsMap[a]:null;if(r!==null&&r.length>i){r.length=i}t._maxCountMap[a]=i}else{t._defaultMaxCount=i;for(var a in t._poolsMap){var r=t._poolsMap[a];if(r.length>i){r.length=i}if(a in t._maxCountMap){t._maxCountMap[a]=i}}}};t.clearPool=function(e){if(e===void 0){e=null}if(e!==null){var i=String(e);var a=i in t._poolsMap?t._poolsMap[i]:null;if(a!==null&&a.length>0){a.length=0}}else{for(var r in t._poolsMap){var a=t._poolsMap[r];a.length=0}}};t.borrowObject=function(e){var i=String(e);var a=i in t._poolsMap?t._poolsMap[i]:null;if(a!==null&&a.length>0){var r=a.pop();r._isInPool=false;return r}var n=new e;n._onClear();return n};t.prototype.returnToPool=function(){this._onClear();t._returnObject(this)};t._hashCode=0;t._defaultMaxCount=3e3;t._maxCountMap={};t._poolsMap={};return t}();t.BaseObject=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,i,a,r,n){if(t===void 0){t=1}if(e===void 0){e=0}if(i===void 0){i=0}if(a===void 0){a=1}if(r===void 0){r=0}if(n===void 0){n=0}this.a=t;this.b=e;this.c=i;this.d=a;this.tx=r;this.ty=n}t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty};t.prototype.copyFrom=function(t){this.a=t.a;this.b=t.b;this.c=t.c;this.d=t.d;this.tx=t.tx;this.ty=t.ty;return this};t.prototype.copyFromArray=function(t,e){if(e===void 0){e=0}this.a=t[e];this.b=t[e+1];this.c=t[e+2];this.d=t[e+3];this.tx=t[e+4];this.ty=t[e+5];return this};t.prototype.identity=function(){this.a=this.d=1;this.b=this.c=0;this.tx=this.ty=0;return this};t.prototype.concat=function(t){var e=this.a*t.a;var i=0;var a=0;var r=this.d*t.d;var n=this.tx*t.a+t.tx;var s=this.ty*t.d+t.ty;if(this.b!==0||this.c!==0){e+=this.b*t.c;i+=this.b*t.d;a+=this.c*t.a;r+=this.c*t.b}if(t.b!==0||t.c!==0){i+=this.a*t.b;a+=this.d*t.c;n+=this.ty*t.c;s+=this.tx*t.b}this.a=e;this.b=i;this.c=a;this.d=r;this.tx=n;this.ty=s;return this};t.prototype.invert=function(){var t=this.a;var e=this.b;var i=this.c;var a=this.d;var r=this.tx;var n=this.ty;if(e===0&&i===0){this.b=this.c=0;if(t===0||a===0){this.a=this.b=this.tx=this.ty=0}else{t=this.a=1/t;a=this.d=1/a;this.tx=-t*r;this.ty=-a*n}return this}var s=t*a-e*i;if(s===0){this.a=this.d=1;this.b=this.c=0;this.tx=this.ty=0;return this}s=1/s;var o=this.a=a*s;e=this.b=-e*s;i=this.c=-i*s;a=this.d=t*s;this.tx=-(o*r+i*n);this.ty=-(e*r+a*n);return this};t.prototype.transformPoint=function(t,e,i,a){if(a===void 0){a=false}i.x=this.a*t+this.c*e;i.y=this.b*t+this.d*e;if(!a){i.x+=this.tx;i.y+=this.ty}};t.prototype.transformRectangle=function(t,e){if(e===void 0){e=false}var i=this.a;var a=this.b;var r=this.c;var n=this.d;var s=e?0:this.tx;var o=e?0:this.ty;var l=t.x;var h=t.y;var u=l+t.width;var f=h+t.height;var _=i*l+r*h+s;var c=a*l+n*h+o;var p=i*u+r*h+s;var m=a*u+n*h+o;var d=i*u+r*f+s;var y=a*u+n*f+o;var g=i*l+r*f+s;var v=a*l+n*f+o;var b=0;if(_>p){b=_;_=p;p=b}if(d>g){b=d;d=g;g=b}t.x=Math.floor(_<d?_:d);t.width=Math.ceil((p>g?p:g)-t.x);if(c>m){b=c;c=m;m=b}if(y>v){b=y;y=v;v=b}t.y=Math.floor(c<y?c:y);t.height=Math.ceil((m>v?m:v)-t.y)};return t}();t.Matrix=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,i,a,r,n){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(a===void 0){a=0}if(r===void 0){r=1}if(n===void 0){n=1}this.x=t;this.y=e;this.skew=i;this.rotation=a;this.scaleX=r;this.scaleY=n}t.normalizeRadian=function(t){t=(t+Math.PI)%(Math.PI*2);t+=t>0?-Math.PI:Math.PI;return t};t.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+this.skew*180/Math.PI+" skewY:"+this.rotation*180/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.skew=t.skew;this.rotation=t.rotation;this.scaleX=t.scaleX;this.scaleY=t.scaleY;return this};t.prototype.identity=function(){this.x=this.y=0;this.skew=this.rotation=0;this.scaleX=this.scaleY=1;return this};t.prototype.add=function(t){this.x+=t.x;this.y+=t.y;this.skew+=t.skew;this.rotation+=t.rotation;this.scaleX*=t.scaleX;this.scaleY*=t.scaleY;return this};t.prototype.minus=function(t){this.x-=t.x;this.y-=t.y;this.skew-=t.skew;this.rotation-=t.rotation;this.scaleX/=t.scaleX;this.scaleY/=t.scaleY;return this};t.prototype.fromMatrix=function(e){var i=this.scaleX,a=this.scaleY;var r=t.PI_Q;this.x=e.tx;this.y=e.ty;this.rotation=Math.atan(e.b/e.a);var n=Math.atan(-e.c/e.d);this.scaleX=this.rotation>-r&&this.rotation<r?e.a/Math.cos(this.rotation):e.b/Math.sin(this.rotation);this.scaleY=n>-r&&n<r?e.d/Math.cos(n):-e.c/Math.sin(n);if(i>=0&&this.scaleX<0){this.scaleX=-this.scaleX;this.rotation=this.rotation-Math.PI}if(a>=0&&this.scaleY<0){this.scaleY=-this.scaleY;n=n-Math.PI}this.skew=n-this.rotation;return this};t.prototype.toMatrix=function(t){if(this.skew!==0||this.rotation!==0){t.a=Math.cos(this.rotation);t.b=Math.sin(this.rotation);if(this.skew===0){t.c=-t.b;t.d=t.a}else{t.c=-Math.sin(this.skew+this.rotation);t.d=Math.cos(this.skew+this.rotation)}if(this.scaleX!==1){t.a*=this.scaleX;t.b*=this.scaleX}if(this.scaleY!==1){t.c*=this.scaleY;t.d*=this.scaleY}}else{t.a=this.scaleX;t.b=0;t.c=0;t.d=this.scaleY}t.tx=this.x;t.ty=this.y;return this};t.PI_D=Math.PI*2;t.PI_H=Math.PI/2;t.PI_Q=Math.PI/4;t.RAD_DEG=180/Math.PI;t.DEG_RAD=Math.PI/180;return t}();t.Transform=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,i,a,r,n,s,o){if(t===void 0){t=1}if(e===void 0){e=1}if(i===void 0){i=1}if(a===void 0){a=1}if(r===void 0){r=0}if(n===void 0){n=0}if(s===void 0){s=0}if(o===void 0){o=0}this.alphaMultiplier=t;this.redMultiplier=e;this.greenMultiplier=i;this.blueMultiplier=a;this.alphaOffset=r;this.redOffset=n;this.greenOffset=s;this.blueOffset=o}t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier;this.redMultiplier=t.redMultiplier;this.greenMultiplier=t.greenMultiplier;this.blueMultiplier=t.blueMultiplier;this.alphaOffset=t.alphaOffset;this.redOffset=t.redOffset;this.greenOffset=t.greenOffset;this.blueOffset=t.blueOffset};t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1;this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0};return t}();t.ColorTransform=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e){if(t===void 0){t=0}if(e===void 0){e=0}this.x=t;this.y=e}t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y};t.prototype.clear=function(){this.x=this.y=0};return t}();t.Point=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,i,a){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(a===void 0){a=0}this.x=t;this.y=e;this.width=i;this.height=a}t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.width=t.width;this.height=t.height};t.prototype.clear=function(){this.x=this.y=0;this.width=this.height=0};return t}();t.Rectangle=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.ints=[];e.floats=[];e.strings=[];return e}e.toString=function(){return"[class dragonBones.UserData]"};e.prototype._onClear=function(){this.ints.length=0;this.floats.length=0;this.strings.length=0};e.prototype.addInt=function(t){this.ints.push(t)};e.prototype.addFloat=function(t){this.floats.push(t)};e.prototype.addString=function(t){this.strings.push(t)};e.prototype.getInt=function(t){if(t===void 0){t=0}return t>=0&&t<this.ints.length?this.ints[t]:0};e.prototype.getFloat=function(t){if(t===void 0){t=0}return t>=0&&t<this.floats.length?this.floats[t]:0};e.prototype.getString=function(t){if(t===void 0){t=0}return t>=0&&t<this.strings.length?this.strings[t]:""};return e}(t.BaseObject);t.UserData=e;var i=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.data=null;return e}e.toString=function(){return"[class dragonBones.ActionData]"};e.prototype._onClear=function(){if(this.data!==null){this.data.returnToPool()}this.type=0;this.name="";this.bone=null;this.slot=null;this.data=null};return e}(t.BaseObject);t.ActionData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.frameIndices=[];e.cachedFrames=[];e.armatureNames=[];e.armatures={};e.userData=null;return e}e.toString=function(){return"[class dragonBones.DragonBonesData]"};e.prototype._onClear=function(){for(var t in this.armatures){this.armatures[t].returnToPool();delete this.armatures[t]}if(this.userData!==null){this.userData.returnToPool()}this.autoSearch=false;this.frameRate=0;this.version="";this.name="";this.stage=null;this.frameIndices.length=0;this.cachedFrames.length=0;this.armatureNames.length=0;this.binary=null;this.intArray=null;this.floatArray=null;this.frameIntArray=null;this.frameFloatArray=null;this.frameArray=null;this.timelineArray=null;this.userData=null};e.prototype.addArmature=function(t){if(t.name in this.armatures){console.warn("Same armature: "+t.name);return}t.parent=this;this.armatures[t.name]=t;this.armatureNames.push(t.name)};e.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null};e.prototype.dispose=function(){console.warn("");this.returnToPool()};return e}(t.BaseObject);t.DragonBonesData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.aabb=new t.Rectangle;i.animationNames=[];i.sortedBones=[];i.sortedSlots=[];i.defaultActions=[];i.actions=[];i.bones={};i.slots={};i.constraints={};i.skins={};i.animations={};i.canvas=null;i.userData=null;return i}i.toString=function(){return"[class dragonBones.ArmatureData]"};i.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++){var i=e[t];i.returnToPool()}for(var a=0,r=this.actions;a<r.length;a++){var i=r[a];i.returnToPool()}for(var n in this.bones){this.bones[n].returnToPool();delete this.bones[n]}for(var n in this.slots){this.slots[n].returnToPool();delete this.slots[n]}for(var n in this.constraints){this.constraints[n].returnToPool();delete this.constraints[n]}for(var n in this.skins){this.skins[n].returnToPool();delete this.skins[n]}for(var n in this.animations){this.animations[n].returnToPool();delete this.animations[n]}if(this.canvas!==null){this.canvas.returnToPool()}if(this.userData!==null){this.userData.returnToPool()}this.type=0;this.frameRate=0;this.cacheFrameRate=0;this.scale=1;this.name="";this.aabb.clear();this.animationNames.length=0;this.sortedBones.length=0;this.sortedSlots.length=0;this.defaultActions.length=0;this.actions.length=0;this.defaultSkin=null;this.defaultAnimation=null;this.canvas=null;this.userData=null;this.parent=null};i.prototype.sortBones=function(){var t=this.sortedBones.length;if(t<=0){return}var e=this.sortedBones.concat();var i=0;var a=0;this.sortedBones.length=0;while(a<t){var r=e[i++];if(i>=t){i=0}if(this.sortedBones.indexOf(r)>=0){continue}var n=false;for(var s in this.constraints){var o=this.constraints[s];if(o.bone===r&&this.sortedBones.indexOf(o.target)<0){n=true;break}}if(n){continue}if(r.parent!==null&&this.sortedBones.indexOf(r.parent)<0){continue}this.sortedBones.push(r);a++}};i.prototype.cacheFrames=function(t){if(this.cacheFrameRate>0){return}this.cacheFrameRate=t;for(var e in this.animations){this.animations[e].cacheFrames(this.cacheFrameRate)}};i.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames;var a=i.length;i.length+=10;i[a]=t.a;i[a+1]=t.b;i[a+2]=t.c;i[a+3]=t.d;i[a+4]=t.tx;i[a+5]=t.ty;i[a+6]=e.rotation;i[a+7]=e.skew;i[a+8]=e.scaleX;i[a+9]=e.scaleY;return a};i.prototype.getCacheFrame=function(t,e,i){var a=this.parent.cachedFrames;t.a=a[i];t.b=a[i+1];t.c=a[i+2];t.d=a[i+3];t.tx=a[i+4];t.ty=a[i+5];e.rotation=a[i+6];e.skew=a[i+7];e.scaleX=a[i+8];e.scaleY=a[i+9];e.x=t.tx;e.y=t.ty};i.prototype.addBone=function(t){if(t.name in this.bones){console.warn("Same bone: "+t.name);return}this.bones[t.name]=t;this.sortedBones.push(t)};i.prototype.addSlot=function(t){if(t.name in this.slots){console.warn("Same slot: "+t.name);return}this.slots[t.name]=t;this.sortedSlots.push(t)};i.prototype.addConstraint=function(t){if(t.name in this.constraints){console.warn("Same constraint: "+t.name);return}this.constraints[t.name]=t};i.prototype.addSkin=function(t){if(t.name in this.skins){console.warn("Same skin: "+t.name);return}t.parent=this;this.skins[t.name]=t;if(this.defaultSkin===null){this.defaultSkin=t}};i.prototype.addAnimation=function(t){if(t.name in this.animations){console.warn("Same animation: "+t.name);return}t.parent=this;this.animations[t.name]=t;this.animationNames.push(t.name);if(this.defaultAnimation===null){this.defaultAnimation=t}};i.prototype.addAction=function(t,e){if(e){this.defaultActions.push(t)}else{this.actions.push(t)}};i.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null};i.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null};i.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null};i.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null};i.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null};return i}(t.BaseObject);t.ArmatureData=e;var i=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.transform=new t.Transform;i.userData=null;return i}i.toString=function(){return"[class dragonBones.BoneData]"};i.prototype._onClear=function(){if(this.userData!==null){this.userData.returnToPool()}this.inheritTranslation=false;this.inheritRotation=false;this.inheritScale=false;this.inheritReflection=false;this.length=0;this.name="";this.transform.identity();this.userData=null;this.parent=null};return i}(t.BaseObject);t.BoneData=i;var a=function(e){__extends(i,e);function i(){var t=e!==null&&e.apply(this,arguments)||this;t.color=null;t.userData=null;return t}i.createColor=function(){return new t.ColorTransform};i.toString=function(){return"[class dragonBones.SlotData]"};i.prototype._onClear=function(){if(this.userData!==null){this.userData.returnToPool()}this.blendMode=0;this.displayIndex=0;this.zOrder=0;this.name="";this.color=null;this.userData=null;this.parent=null};i.DEFAULT_COLOR=new t.ColorTransform;return i}(t.BaseObject);t.SlotData=a})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.CanvasData]"};e.prototype._onClear=function(){this.hasBackground=false;this.color=0;this.x=0;this.y=0;this.width=0;this.height=0};return e}(t.BaseObject);t.CanvasData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.displays={};return e}e.toString=function(){return"[class dragonBones.SkinData]"};e.prototype._onClear=function(){for(var t in this.displays){var e=this.displays[t];for(var i=0,a=e;i<a.length;i++){var r=a[i];if(r!==null){r.returnToPool()}}delete this.displays[t]}this.name="";this.parent=null};e.prototype.addDisplay=function(t,e){if(!(t in this.displays)){this.displays[t]=[]}if(e!==null){e.parent=this}var i=this.displays[t];i.push(e)};e.prototype.getDisplay=function(t,e){var i=this.getDisplays(t);if(i!==null){for(var a=0,r=i;a<r.length;a++){var n=r[a];if(n!==null&&n.name===e){return n}}}return null};e.prototype.getDisplays=function(t){if(!(t in this.displays)){return null}return this.displays[t]};return e}(t.BaseObject);t.SkinData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.order=0;this.name="";this.target=null;this.bone=null;this.root=null};return e}(t.BaseObject);t.ConstraintData=e;var i=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.IKConstraintData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.scaleEnabled=false;this.bendPositive=false;this.weight=1};return e}(e);t.IKConstraintData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.transform=new t.Transform;return i}i.prototype._onClear=function(){this.name="";this.path="";this.transform.identity();this.parent=null};return i}(t.BaseObject);t.DisplayData=e;var i=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.pivot=new t.Point;return i}i.toString=function(){return"[class dragonBones.ImageDisplayData]"};i.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=0;this.pivot.clear();this.texture=null};return i}(e);t.ImageDisplayData=i;var a=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.actions=[];return e}e.toString=function(){return"[class dragonBones.ArmatureDisplayData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions;e<i.length;e++){var a=i[e];a.returnToPool()}this.type=1;this.inheritAnimation=false;this.actions.length=0;this.armature=null};e.prototype.addAction=function(t){this.actions.push(t)};return e}(e);t.ArmatureDisplayData=a;var r=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.weight=null;return e}e.toString=function(){return"[class dragonBones.MeshDisplayData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);if(this.weight!==null){this.weight.returnToPool()}this.type=2;this.inheritAnimation=false;this.offset=0;this.weight=null};return e}(i);t.MeshDisplayData=r;var n=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.boundingBox=null;return e}e.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);if(this.boundingBox!==null){this.boundingBox.returnToPool()}this.type=3;this.boundingBox=null};return e}(e);t.BoundingBoxDisplayData=n;var s=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.bones=[];return e}e.toString=function(){return"[class dragonBones.WeightData]"};e.prototype._onClear=function(){this.count=0;this.offset=0;this.bones.length=0};e.prototype.addBone=function(t){this.bones.push(t)};return e}(t.BaseObject);t.WeightData=s})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.color=0;this.width=0;this.height=0};return e}(t.BaseObject);t.BoundingBoxData=e;var i=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"};e._computeOutCode=function(t,e,i,a,r,n){var s=0;if(t<i){s|=1}else if(t>r){s|=2}if(e<a){s|=4}else if(e>n){s|=8}return s};e.rectangleIntersectsSegment=function(t,i,a,r,n,s,o,l,h,u,f){if(h===void 0){h=null}if(u===void 0){u=null}if(f===void 0){f=null}var _=t>n&&t<o&&i>s&&i<l;var c=a>n&&a<o&&r>s&&r<l;if(_&&c){return-1}var p=0;var m=e._computeOutCode(t,i,n,s,o,l);var d=e._computeOutCode(a,r,n,s,o,l);while(true){if((m|d)===0){p=2;break}else if((m&d)!==0){break}var y=0;var g=0;var v=0;var b=m!==0?m:d;if((b&4)!==0){y=t+(a-t)*(s-i)/(r-i);g=s;if(f!==null){v=-Math.PI*.5}}else if((b&8)!==0){y=t+(a-t)*(l-i)/(r-i);g=l;if(f!==null){v=Math.PI*.5}}else if((b&2)!==0){g=i+(r-i)*(o-t)/(a-t);y=o;if(f!==null){v=0}}else if((b&1)!==0){g=i+(r-i)*(n-t)/(a-t);y=n;if(f!==null){v=Math.PI}}if(b===m){t=y;i=g;m=e._computeOutCode(t,i,n,s,o,l);if(f!==null){f.x=v}}else{a=y;r=g;d=e._computeOutCode(a,r,n,s,o,l);if(f!==null){f.y=v}}}if(p){if(_){p=2;if(h!==null){h.x=a;h.y=r}if(u!==null){u.x=a;u.y=a}if(f!==null){f.x=f.y+Math.PI}}else if(c){p=1;if(h!==null){h.x=t;h.y=i}if(u!==null){u.x=t;u.y=i}if(f!==null){f.y=f.x+Math.PI}}else{p=3;if(h!==null){h.x=t;h.y=i}if(u!==null){u.x=a;u.y=r}}}return p};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.type=0};e.prototype.containsPoint=function(t,e){var i=this.width*.5;if(t>=-i&&t<=i){var a=this.height*.5;if(e>=-a&&e<=a){return true}}return false};e.prototype.intersectsSegment=function(t,i,a,r,n,s,o){if(n===void 0){n=null}if(s===void 0){s=null}if(o===void 0){o=null}var l=this.width*.5;var h=this.height*.5;var u=e.rectangleIntersectsSegment(t,i,a,r,-l,-h,l,h,n,s,o);return u};return e}(e);t.RectangleBoundingBoxData=i;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.EllipseData]"};e.ellipseIntersectsSegment=function(t,e,i,a,r,n,s,o,l,h,u){if(l===void 0){l=null}if(h===void 0){h=null}if(u===void 0){u=null}var f=s/o;var _=f*f;e*=f;a*=f;var c=i-t;var p=a-e;var m=Math.sqrt(c*c+p*p);var d=c/m;var y=p/m;var g=(r-t)*d+(n-e)*y;var v=g*g;var b=t*t+e*e;var T=s*s;var D=T-b+v;var A=0;if(D>=0){var x=Math.sqrt(D);var O=g-x;var S=g+x;var E=O<0?-1:O<=m?0:1;var B=S<0?-1:S<=m?0:1;var M=E*B;if(M<0){return-1}else if(M===0){if(E===-1){A=2;i=t+S*d;a=(e+S*y)/f;if(l!==null){l.x=i;l.y=a}if(h!==null){h.x=i;h.y=a}if(u!==null){u.x=Math.atan2(a/T*_,i/T);u.y=u.x+Math.PI}}else if(B===1){A=1;t=t+O*d;e=(e+O*y)/f;if(l!==null){l.x=t;l.y=e}if(h!==null){h.x=t;h.y=e}if(u!==null){u.x=Math.atan2(e/T*_,t/T);u.y=u.x+Math.PI}}else{A=3;if(l!==null){l.x=t+O*d;l.y=(e+O*y)/f;if(u!==null){u.x=Math.atan2(l.y/T*_,l.x/T)}}if(h!==null){h.x=t+S*d;h.y=(e+S*y)/f;if(u!==null){u.y=Math.atan2(h.y/T*_,h.x/T)}}}}}return A};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.type=1};e.prototype.containsPoint=function(t,e){var i=this.width*.5;if(t>=-i&&t<=i){var a=this.height*.5;if(e>=-a&&e<=a){e*=i/a;return Math.sqrt(t*t+e*e)<=i}}return false};e.prototype.intersectsSegment=function(t,i,a,r,n,s,o){if(n===void 0){n=null}if(s===void 0){s=null}if(o===void 0){o=null}var l=e.ellipseIntersectsSegment(t,i,a,r,0,0,this.width*.5,this.height*.5,n,s,o);return l};return e}(e);t.EllipseBoundingBoxData=a;var r=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.vertices=[];e.weight=null;return e}e.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"};e.polygonIntersectsSegment=function(t,e,i,a,r,n,s,o){if(n===void 0){n=null}if(s===void 0){s=null}if(o===void 0){o=null}if(t===i){t=i+1e-6}if(e===a){e=a+1e-6}var l=r.length;var h=t-i;var u=e-a;var f=t*a-e*i;var _=0;var c=r[l-2];var p=r[l-1];var m=0;var d=0;var y=0;var g=0;var v=0;var b=0;for(var T=0;T<l;T+=2){var D=r[T];var A=r[T+1];if(c===D){c=D+1e-4}if(p===A){p=A+1e-4}var x=c-D;var O=p-A;var S=c*A-p*D;var E=h*O-u*x;var B=(f*x-h*S)/E;if((B>=c&&B<=D||B>=D&&B<=c)&&(h===0||B>=t&&B<=i||B>=i&&B<=t)){var M=(f*O-u*S)/E;if((M>=p&&M<=A||M>=A&&M<=p)&&(u===0||M>=e&&M<=a||M>=a&&M<=e)){if(s!==null){var w=B-t;if(w<0){w=-w}if(_===0){m=w;d=w;y=B;g=M;v=B;b=M;if(o!==null){o.x=Math.atan2(A-p,D-c)-Math.PI*.5;o.y=o.x}}else{if(w<m){m=w;y=B;g=M;if(o!==null){o.x=Math.atan2(A-p,D-c)-Math.PI*.5}}if(w>d){d=w;v=B;b=M;if(o!==null){o.y=Math.atan2(A-p,D-c)-Math.PI*.5}}}_++}else{y=B;g=M;v=B;b=M;_++;if(o!==null){o.x=Math.atan2(A-p,D-c)-Math.PI*.5;o.y=o.x}break}}}c=D;p=A}if(_===1){if(n!==null){n.x=y;n.y=g}if(s!==null){s.x=y;s.y=g}if(o!==null){o.y=o.x+Math.PI}}else if(_>1){_++;if(n!==null){n.x=y;n.y=g}if(s!==null){s.x=v;s.y=b}}return _};e.prototype._onClear=function(){t.prototype._onClear.call(this);if(this.weight!==null){this.weight.returnToPool()}this.type=2;this.x=0;this.y=0;this.vertices.length=0;this.weight=null};e.prototype.containsPoint=function(t,e){var i=false;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height){for(var a=0,r=this.vertices.length,n=r-2;a<r;a+=2){var s=this.vertices[n+1];var o=this.vertices[a+1];if(o<e&&s>=e||s<e&&o>=e){var l=this.vertices[n];var h=this.vertices[a];if((e-o)*(l-h)/(s-o)+h<t){i=!i}}n=a}}return i};e.prototype.intersectsSegment=function(t,a,r,n,s,o,l){if(s===void 0){s=null}if(o===void 0){o=null}if(l===void 0){l=null}var h=0;if(i.rectangleIntersectsSegment(t,a,r,n,this.x,this.y,this.width,this.height,null,null,null)!==0){h=e.polygonIntersectsSegment(t,a,r,n,this.vertices,s,o,l)}return h};return e}(e);t.PolygonBoundingBoxData=r})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.cachedFrames=[];e.boneTimelines={};e.slotTimelines={};e.constraintTimelines={};e.boneCachedFrameIndices={};e.slotCachedFrameIndices={};e.actionTimeline=null;e.zOrderTimeline=null;return e}e.toString=function(){return"[class dragonBones.AnimationData]"};e.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++){var a=i[e];a.returnToPool()}delete this.boneTimelines[t]}for(var t in this.slotTimelines){for(var r=0,n=this.slotTimelines[t];r<n.length;r++){var a=n[r];a.returnToPool()}delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var s=0,o=this.constraintTimelines[t];s<o.length;s++){var a=o[s];a.returnToPool()}delete this.constraintTimelines[t]}for(var t in this.boneCachedFrameIndices){delete this.boneCachedFrameIndices[t]}for(var t in this.slotCachedFrameIndices){delete this.slotCachedFrameIndices[t]}if(this.actionTimeline!==null){this.actionTimeline.returnToPool()}if(this.zOrderTimeline!==null){this.zOrderTimeline.returnToPool()}this.frameIntOffset=0;this.frameFloatOffset=0;this.frameOffset=0;this.frameCount=0;this.playTimes=0;this.duration=0;this.scale=1;this.fadeInTime=0;this.cacheFrameRate=0;this.name="";this.cachedFrames.length=0;this.actionTimeline=null;this.zOrderTimeline=null;this.parent=null};e.prototype.cacheFrames=function(t){if(this.cacheFrameRate>0){return}this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,a=this.cacheFrames.length;i<a;++i){this.cachedFrames[i]=false}for(var r=0,n=this.parent.sortedBones;r<n.length;r++){var s=n[r];var o=new Array(e);for(var i=0,a=o.length;i<a;++i){o[i]=-1}this.boneCachedFrameIndices[s.name]=o}for(var l=0,h=this.parent.sortedSlots;l<h.length;l++){var u=h[l];var o=new Array(e);for(var i=0,a=o.length;i<a;++i){o[i]=-1}this.slotCachedFrameIndices[u.name]=o}};e.prototype.addBoneTimeline=function(t,e){var i=t.name in this.boneTimelines?this.boneTimelines[t.name]:this.boneTimelines[t.name]=[];if(i.indexOf(e)<0){i.push(e)}};e.prototype.addSlotTimeline=function(t,e){var i=t.name in this.slotTimelines?this.slotTimelines[t.name]:this.slotTimelines[t.name]=[];if(i.indexOf(e)<0){i.push(e)}};e.prototype.addConstraintTimeline=function(t,e){var i=t.name in this.constraintTimelines?this.constraintTimelines[t.name]:this.constraintTimelines[t.name]=[];if(i.indexOf(e)<0){i.push(e)}};e.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null};e.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null};e.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null};e.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null};e.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null};return e}(t.BaseObject);t.AnimationData=e;var i=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.TimelineData]"};e.prototype._onClear=function(){this.type=10;this.offset=0;this.frameIndicesOffset=-1};return e}(t.BaseObject);t.TimelineData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.boneMask=[];return e}e.toString=function(){return"[class dragonBones.AnimationConfig]"};e.prototype._onClear=function(){this.pauseFadeOut=true;this.fadeOutMode=4;this.fadeOutTweenType=1;this.fadeOutTime=-1;this.actionEnabled=true;this.additiveBlending=false;this.displayControl=true;this.pauseFadeIn=true;this.resetToPose=true;this.fadeInTweenType=1;this.playTimes=-1;this.layer=0;this.position=0;this.duration=-1;this.timeScale=-100;this.weight=1;this.fadeInTime=-1;this.autoFadeOutTime=-1;this.name="";this.animation="";this.group="";this.boneMask.length=0};e.prototype.clear=function(){this._onClear()};e.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut;this.fadeOutMode=t.fadeOutMode;this.autoFadeOutTime=t.autoFadeOutTime;this.fadeOutTweenType=t.fadeOutTweenType;this.actionEnabled=t.actionEnabled;this.additiveBlending=t.additiveBlending;this.displayControl=t.displayControl;this.pauseFadeIn=t.pauseFadeIn;this.resetToPose=t.resetToPose;this.playTimes=t.playTimes;this.layer=t.layer;this.position=t.position;this.duration=t.duration;this.timeScale=t.timeScale;this.fadeInTime=t.fadeInTime;this.fadeOutTime=t.fadeOutTime;this.fadeInTweenType=t.fadeInTweenType;this.weight=t.weight;this.name=t.name;this.animation=t.animation;this.group=t.group;this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e){this.boneMask[e]=t.boneMask[e]}};e.prototype.containsBoneMask=function(t){return this.boneMask.length===0||this.boneMask.indexOf(t)>=0};e.prototype.addBoneMask=function(t,e,i){if(i===void 0){i=true}var a=t.getBone(e);if(a===null){return}if(this.boneMask.indexOf(e)<0){this.boneMask.push(e)}if(i){for(var r=0,n=t.getBones();r<n.length;r++){var s=n[r];if(this.boneMask.indexOf(s.name)<0&&a.contains(s)){this.boneMask.push(s.name)}}}};e.prototype.removeBoneMask=function(t,e,i){if(i===void 0){i=true}var a=this.boneMask.indexOf(e);if(a>=0){this.boneMask.splice(a,1)}if(i){var r=t.getBone(e);if(r!==null){if(this.boneMask.length>0){for(var n=0,s=t.getBones();n<s.length;n++){var o=s[n];var l=this.boneMask.indexOf(o.name);if(l>=0&&r.contains(o)){this.boneMask.splice(l,1)}}}else{for(var h=0,u=t.getBones();h<u.length;h++){var o=u[h];if(o===r){continue}if(!r.contains(o)){this.boneMask.push(o.name)}}}}}};return e}(t.BaseObject);t.AnimationConfig=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.textures={};return e}e.prototype._onClear=function(){for(var t in this.textures){this.textures[t].returnToPool();delete this.textures[t]}this.autoSearch=false;this.width=0;this.height=0;this.scale=1;this.name="";this.imagePath=""};e.prototype.copyFrom=function(t){this.autoSearch=t.autoSearch;this.scale=t.scale;this.width=t.width;this.height=t.height;this.name=t.name;this.imagePath=t.imagePath;for(var e in this.textures){this.textures[e].returnToPool();delete this.textures[e]}for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]);this.textures[e]=i}};e.prototype.addTexture=function(t){if(t.name in this.textures){console.warn("Same texture: "+t.name);return}t.parent=this;this.textures[t.name]=t};e.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null};return e}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.region=new t.Rectangle;i.frame=null;return i}i.createRectangle=function(){return new t.Rectangle};i.prototype._onClear=function(){this.rotated=false;this.name="";this.region.clear();this.parent=null;this.frame=null};i.prototype.copyFrom=function(t){this.rotated=t.rotated;this.name=t.name;this.region.copyFrom(t.region);this.parent=t.parent;if(this.frame===null&&t.frame!==null){this.frame=i.createRectangle()}else if(this.frame!==null&&t.frame===null){this.frame=null}if(this.frame!==null&&t.frame!==null){this.frame.copyFrom(t.frame)}};return i}(t.BaseObject);t.TextureData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var t=e!==null&&e.apply(this,arguments)||this;t._bones=[];t._slots=[];t._constraints=[];t._actions=[];t._animation=null;t._proxy=null;t._replaceTextureAtlasData=null;t._clock=null;return t}i.toString=function(){return"[class dragonBones.Armature]"};i._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1};i.prototype._onClear=function(){if(this._clock!==null){this._clock.remove(this)}for(var t=0,e=this._bones;t<e.length;t++){var i=e[t];i.returnToPool()}for(var a=0,r=this._slots;a<r.length;a++){var n=r[a];n.returnToPool()}for(var s=0,o=this._constraints;s<o.length;s++){var l=o[s];l.returnToPool()}if(this._animation!==null){this._animation.returnToPool()}if(this._proxy!==null){this._proxy.dbClear()}if(this._replaceTextureAtlasData!==null){this._replaceTextureAtlasData.returnToPool()}this.inheritAnimation=true;this.userData=null;this._lockUpdate=false;this._bonesDirty=false;this._slotsDirty=false;this._zOrderDirty=false;this._flipX=false;this._flipY=false;this._cacheFrameIndex=-1;this._bones.length=0;this._slots.length=0;this._constraints.length=0;this._actions.length=0;this._armatureData=null;this._animation=null;this._proxy=null;this._display=null;this._replaceTextureAtlasData=null;this._replacedTexture=null;this._dragonBones=null;this._clock=null;this._parent=null};i.prototype._sortBones=function(){var t=this._bones.length;if(t<=0){return}var e=this._bones.concat();var i=0;var a=0;this._bones.length=0;while(a<t){var r=e[i++];if(i>=t){i=0}if(this._bones.indexOf(r)>=0){continue}if(r._hasConstraint){var n=false;for(var s=0,o=this._constraints;s<o.length;s++){var l=o[s];if(l._bone===r&&this._bones.indexOf(l._target)<0){n=true;break}}if(n){continue}}if(r.parent!==null&&this._bones.indexOf(r.parent)<0){continue}this._bones.push(r);a++}};i.prototype._sortSlots=function(){this._slots.sort(i._onSortSlots)};i.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots;var a=t===null;if(this._zOrderDirty||!a){for(var r=0,n=i.length;r<n;++r){var s=a?r:t[e+r];if(s<0||s>=n){continue}var o=i[s];var l=this.getSlot(o.name);if(l!==null){l._setZorder(r)}}this._slotsDirty=true;this._zOrderDirty=!a}};i.prototype._addBoneToBoneList=function(t){if(this._bones.indexOf(t)<0){this._bonesDirty=true;this._bones.push(t)}};i.prototype._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);if(e>=0){this._bones.splice(e,1)}};i.prototype._addSlotToSlotList=function(t){if(this._slots.indexOf(t)<0){this._slotsDirty=true;this._slots.push(t)}};i.prototype._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);if(e>=0){this._slots.splice(e,1)}};i.prototype._bufferAction=function(t,e){if(this._actions.indexOf(t)<0){if(e){this._actions.push(t)}else{this._actions.unshift(t)}}};i.prototype.dispose=function(){if(this._armatureData!==null){this._lockUpdate=true;this._dragonBones.bufferObject(this)}};i.prototype.init=function(e,i,a,r){if(this._armatureData!==null){return}this._armatureData=e;this._animation=t.BaseObject.borrowObject(t.Animation);this._proxy=i;this._display=a;this._dragonBones=r;this._proxy.dbInit(this);this._animation.init(this);this._animation.animations=this._armatureData.animations};i.prototype.advanceTime=function(t){if(this._lockUpdate){return}if(this._armatureData===null){console.warn("The armature has been disposed.");return}else if(this._armatureData.parent===null){console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");return}var e=this._cacheFrameIndex;this._animation.advanceTime(t);if(this._bonesDirty){this._bonesDirty=false;this._sortBones()}if(this._slotsDirty){this._slotsDirty=false;this._sortSlots()}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==e){var i=0,a=0;for(i=0,a=this._bones.length;i<a;++i){this._bones[i].update(this._cacheFrameIndex)}for(i=0,a=this._slots.length;i<a;++i){this._slots[i].update(this._cacheFrameIndex)}}if(this._actions.length>0){this._lockUpdate=true;for(var r=0,n=this._actions;r<n.length;r++){var s=n[r];if(s.type===0){this._animation.fadeIn(s.name)}}this._actions.length=0;this._lockUpdate=false}this._proxy.dbUpdate()};i.prototype.invalidUpdate=function(t,e){if(t===void 0){t=null}if(e===void 0){e=false}if(t!==null&&t.length>0){var i=this.getBone(t);if(i!==null){i.invalidUpdate();if(e){for(var a=0,r=this._slots;a<r.length;a++){var n=r[a];if(n.parent===i){n.invalidUpdate()}}}}}else{for(var s=0,o=this._bones;s<o.length;s++){var i=o[s];i.invalidUpdate()}if(e){for(var l=0,h=this._slots;l<h.length;l++){var n=h[l];n.invalidUpdate()}}}};i.prototype.containsPoint=function(t,e){for(var i=0,a=this._slots;i<a.length;i++){var r=a[i];if(r.containsPoint(t,e)){return r}}return null};i.prototype.intersectsSegment=function(t,e,i,a,r,n,s){if(r===void 0){r=null}if(n===void 0){n=null}if(s===void 0){s=null}var o=t===i;var l=0;var h=0;var u=0;var f=0;var _=0;var c=0;var p=0;var m=0;var d=null;var y=null;for(var g=0,v=this._slots;g<v.length;g++){var b=v[g];var T=b.intersectsSegment(t,e,i,a,r,n,s);if(T>0){if(r!==null||n!==null){if(r!==null){var D=o?r.y-e:r.x-t;if(D<0){D=-D}if(d===null||D<l){l=D;u=r.x;f=r.y;d=b;if(s){p=s.x}}}if(n!==null){var D=n.x-t;if(D<0){D=-D}if(y===null||D>h){h=D;_=n.x;c=n.y;y=b;if(s!==null){m=s.y}}}}else{d=b;break}}}if(d!==null&&r!==null){r.x=u;r.y=f;if(s!==null){s.x=p}}if(y!==null&&n!==null){n.x=_;n.y=c;if(s!==null){s.y=m}}return d};i.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var a=i[e];if(a.name===t){return a}}return null};i.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e!==null?e.parent:null};i.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];if(a.name===t){return a}}return null};i.prototype.getSlotByDisplay=function(t){if(t!==null){for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];if(a.display===t){return a}}}return null};i.prototype.addBone=function(t,e){console.assert(t!==null);t._setArmature(this);t._setParent(e.length>0?this.getBone(e):null)};i.prototype.addSlot=function(t,e){var i=this.getBone(e);console.assert(t!==null&&i!==null);t._setArmature(this);t._setParent(i)};i.prototype.addConstraint=function(t){if(this._constraints.indexOf(t)<0){this._constraints.push(t)}};i.prototype.removeBone=function(t){console.assert(t!==null&&t.armature===this);t._setParent(null);t._setArmature(null)};i.prototype.removeSlot=function(t){console.assert(t!==null&&t.armature===this);t._setParent(null);t._setArmature(null)};i.prototype.getBones=function(){return this._bones};i.prototype.getSlots=function(){return this._slots};Object.defineProperty(i.prototype,"flipX",{get:function(){return this._flipX},set:function(t){if(this._flipX===t){return}this._flipX=t;this.invalidUpdate()},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"flipY",{get:function(){return this._flipY},set:function(t){if(this._flipY===t){return}this._flipY=t;this.invalidUpdate()},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];var r=a.childArmature;if(r!==null){r.cacheFrameRate=t}}}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"name",{get:function(){return this._armatureData.name},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animation",{get:function(){return this._animation},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"proxy",{get:function(){return this._proxy},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"display",{get:function(){return this._display},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture===t){return}if(this._replaceTextureAtlasData!==null){this._replaceTextureAtlasData.returnToPool();this._replaceTextureAtlasData=null}this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];a.invalidUpdate();a.update(-1)}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock===t){return}if(this._clock!==null){this._clock.remove(this)}this._clock=t;if(this._clock){this._clock.add(this)}for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];var r=a.childArmature;if(r!==null){r.clock=this._clock}}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});i.prototype.replaceTexture=function(t){this.replacedTexture=t};i.prototype.hasEventListener=function(t){return this._proxy.hasDBEventListener(t)};i.prototype.addEventListener=function(t,e,i){this._proxy.addDBEventListener(t,e,i)};i.prototype.removeEventListener=function(t,e,i){this._proxy.removeDBEventListener(t,e,i)};i.prototype.enableAnimationCache=function(t){this.cacheFrameRate=t};i.prototype.getDisplay=function(){return this._display};return i}(t.BaseObject);t.Armature=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.globalTransformMatrix=new t.Matrix;i.global=new t.Transform;i.offset=new t.Transform;return i}i.prototype._onClear=function(){this.globalTransformMatrix.identity();this.global.identity();this.offset.identity();this.origin=null;this.userData=null;this._globalDirty=false;this._armature=null;this._parent=null};i.prototype._setArmature=function(t){this._armature=t};i.prototype._setParent=function(t){this._parent=t};i.prototype.updateGlobalTransform=function(){if(this._globalDirty){this._globalDirty=false;this.global.fromMatrix(this.globalTransformMatrix)}};Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});i._helpMatrix=new t.Matrix;i._helpTransform=new t.Transform;i._helpPoint=new t.Point;return i}(t.BaseObject);t.TransformObject=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.animationPose=new t.Transform;return i}i.toString=function(){return"[class dragonBones.Bone]"};i.prototype._onClear=function(){e.prototype._onClear.call(this);this.offsetMode=1;this.animationPose.identity();this._transformDirty=false;this._childrenTransformDirty=false;this._blendDirty=false;this._localDirty=true;this._hasConstraint=false;this._visible=true;this._cachedFrameIndex=-1;this._blendLayer=0;this._blendLeftWeight=1;this._blendLayerWeight=0;this._boneData=null;this._cachedFrameIndices=null};i.prototype._updateGlobalTransformMatrix=function(e){var i=this._armature.flipX;var a=this._armature.flipY===t.DragonBones.yDown;var r=this._parent!==null;var n=0;var s=this.global;var o=this.globalTransformMatrix;if(this.offsetMode===1){s.x=this.origin.x+this.offset.x+this.animationPose.x;s.y=this.origin.y+this.offset.y+this.animationPose.y;s.skew=this.origin.skew+this.offset.skew+this.animationPose.skew;s.rotation=this.origin.rotation+this.offset.rotation+this.animationPose.rotation;s.scaleX=this.origin.scaleX*this.offset.scaleX*this.animationPose.scaleX;s.scaleY=this.origin.scaleY*this.offset.scaleY*this.animationPose.scaleY}else if(this.offsetMode===0){s.copyFrom(this.origin).add(this.animationPose)}else{r=false;s.copyFrom(this.offset)}if(r){var l=this._parent.globalTransformMatrix;if(this._boneData.inheritScale){if(!this._boneData.inheritRotation){this._parent.updateGlobalTransform();if(i&&a){n=s.rotation-(this._parent.global.rotation+Math.PI)}else if(i){n=s.rotation+this._parent.global.rotation+Math.PI}else if(a){n=s.rotation+this._parent.global.rotation}else{n=s.rotation-this._parent.global.rotation}s.rotation=n}s.toMatrix(o);o.concat(l);if(this._boneData.inheritTranslation){s.x=o.tx;s.y=o.ty}else{o.tx=s.x;o.ty=s.y}if(e){s.fromMatrix(o)}else{this._globalDirty=true}}else{if(this._boneData.inheritTranslation){var h=s.x;var u=s.y;s.x=l.a*h+l.c*u+l.tx;s.y=l.d*u+l.b*h+l.ty}else{if(i){s.x=-s.x}if(a){s.y=-s.y}}if(this._boneData.inheritRotation){this._parent.updateGlobalTransform();if(this._parent.global.scaleX<0){n=s.rotation+this._parent.global.rotation+Math.PI}else{n=s.rotation+this._parent.global.rotation}if(l.a*l.d-l.b*l.c<0){n-=s.rotation*2;if(i!==a||this._boneData.inheritReflection){s.skew+=Math.PI}}s.rotation=n}else if(i||a){if(i&&a){n=s.rotation+Math.PI}else{if(i){n=Math.PI-s.rotation}else{n=-s.rotation}s.skew+=Math.PI}s.rotation=n}s.toMatrix(o)}}else{if(i||a){if(i){s.x=-s.x}if(a){s.y=-s.y}if(i&&a){n=s.rotation+Math.PI}else{if(i){n=Math.PI-s.rotation}else{n=-s.rotation}s.skew+=Math.PI}s.rotation=n}s.toMatrix(o)}};i.prototype._setArmature=function(t){if(this._armature===t){return}var e=null;var i=null;if(this._armature!==null){e=this.getSlots();i=this.getBones();this._armature._removeBoneFromBoneList(this)}this._armature=t;if(this._armature!==null){this._armature._addBoneToBoneList(this)}if(e!==null){for(var a=0,r=e;a<r.length;a++){var n=r[a];if(n.parent===this){n._setArmature(this._armature)}}}if(i!==null){for(var s=0,o=i;s<o.length;s++){var l=o[s];if(l.parent===this){l._setArmature(this._armature)}}}};i.prototype.init=function(t){if(this._boneData!==null){return}this._boneData=t;this.origin=this._boneData.transform};i.prototype.update=function(t){this._blendDirty=false;if(t>=0&&this._cachedFrameIndices!==null){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e){this._transformDirty=false}else if(e>=0){this._transformDirty=true;this._cachedFrameIndex=e}else{if(this._hasConstraint){for(var i=0,a=this._armature._constraints;i<a.length;i++){var r=a[i];if(r._bone===this){r.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){this._transformDirty=true;this._cachedFrameIndex=-1}else if(this._cachedFrameIndex>=0){this._transformDirty=false;this._cachedFrameIndices[t]=this._cachedFrameIndex}else{this._transformDirty=true;this._cachedFrameIndex=-1}}}else{if(this._hasConstraint){for(var n=0,s=this._armature._constraints;n<s.length;n++){var r=s[n];if(r._bone===this){r.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){t=-1;this._transformDirty=true;this._cachedFrameIndex=-1}}if(this._transformDirty){this._transformDirty=false;this._childrenTransformDirty=true;if(this._cachedFrameIndex<0){var o=t>=0;if(this._localDirty){this._updateGlobalTransformMatrix(o)}if(o&&this._cachedFrameIndices!==null){this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}}else if(this._childrenTransformDirty){this._childrenTransformDirty=false}this._localDirty=true};i.prototype.updateByConstraint=function(){if(this._localDirty){this._localDirty=false;if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){this._updateGlobalTransformMatrix(true)}this._transformDirty=true}};i.prototype.invalidUpdate=function(){this._transformDirty=true};i.prototype.contains=function(t){if(t===this){return false}var e=t;while(e!==this&&e!==null){e=e.parent}return e===this};Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible===t){return}this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var a=i[e];if(a._parent===this){a._updateVisible()}}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"name",{get:function(){return this._boneData.name},enumerable:true,configurable:true});i.prototype.getBones=function(){var t=new Array;for(var e=0,i=this._armature.getBones();e<i.length;e++){var a=i[e];if(a.parent===this){t.push(a)}}return t};i.prototype.getSlots=function(){var t=new Array;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var a=i[e];if(a.parent===this){t.push(a)}}return t};Object.defineProperty(i.prototype,"slot",{get:function(){for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t];if(i.parent===this){return i}}return null},enumerable:true,configurable:true});return i}(t.TransformObject);t.Bone=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i._localMatrix=new t.Matrix;i._colorTransform=new t.ColorTransform;i._ffdVertices=[];i._displayDatas=[];i._displayList=[];i._meshBones=[];i._rawDisplay=null;i._meshDisplay=null;return i}i.prototype._onClear=function(){e.prototype._onClear.call(this);var i=[];for(var a=0,r=this._displayList;a<r.length;a++){var n=r[a];if(n!==null&&n!==this._rawDisplay&&n!==this._meshDisplay&&i.indexOf(n)<0){i.push(n)}}for(var s=0,o=i;s<o.length;s++){var n=o[s];if(n instanceof t.Armature){n.dispose()}else{this._disposeDisplay(n)}}if(this._meshDisplay!==null&&this._meshDisplay!==this._rawDisplay){this._disposeDisplay(this._meshDisplay)}if(this._rawDisplay!==null){this._disposeDisplay(this._rawDisplay)}this.displayController=null;this._displayDirty=false;this._zOrderDirty=false;this._blendModeDirty=false;this._colorDirty=false;this._meshDirty=false;this._transformDirty=false;this._visible=true;this._blendMode=0;this._displayIndex=-1;this._animationDisplayIndex=-1;this._zOrder=0;this._cachedFrameIndex=-1;this._pivotX=0;this._pivotY=0;this._localMatrix.identity();this._colorTransform.identity();this._ffdVertices.length=0;this._displayList.length=0;this._displayDatas.length=0;this._meshBones.length=0;this._slotData=null;this._rawDisplayDatas=null;this._displayData=null;this._textureData=null;this._meshData=null;this._boundingBoxData=null;this._rawDisplay=null;this._meshDisplay=null;this._display=null;this._childArmature=null;this._cachedFrameIndices=null};i.prototype._updateDisplayData=function(){var t=this._displayData;var e=this._textureData;var a=this._meshData;var r=this._displayIndex>=0&&this._rawDisplayDatas!==null&&this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;if(this._displayIndex>=0&&this._displayIndex<this._displayDatas.length){this._displayData=this._displayDatas[this._displayIndex]}else{this._displayData=null}if(this._displayData!==null){if(this._displayData.type===0||this._displayData.type===2){this._textureData=this._displayData.texture;if(this._displayData.type===2){this._meshData=this._displayData}else if(r!==null&&r.type===2){this._meshData=r}else{this._meshData=null}}else{this._textureData=null;this._meshData=null}}else{this._textureData=null;this._meshData=null}if(this._displayData!==null&&this._displayData.type===3){this._boundingBoxData=this._displayData.boundingBox}else if(r!==null&&r.type===3){this._boundingBoxData=r.boundingBox}else{this._boundingBoxData=null}if(this._displayData!==t||this._textureData!==e||this._meshData!==a){if(this._meshData!==null){this._pivotX=0;this._pivotY=0}else if(this._textureData!==null){var n=this._displayData;var s=this._textureData.parent.scale*this._armature._armatureData.scale;var o=this._textureData.frame;this._pivotX=n.pivot.x;this._pivotY=n.pivot.y;var l=o!==null?o:this._textureData.region;var h=l.width;var u=l.height;if(this._textureData.rotated&&o===null){h=l.height;u=l.width}this._pivotX*=h*s;this._pivotY*=u*s;if(o!==null){this._pivotX+=o.x*s;this._pivotY+=o.y*s}}else{this._pivotX=0;this._pivotY=0}if(this._meshData!==a){if(this._meshData!==null){if(this._meshData.weight!==null){this._ffdVertices.length=this._meshData.weight.count*2;this._meshBones.length=this._meshData.weight.bones.length;for(var f=0,_=this._meshBones.length;f<_;++f){this._meshBones[f]=this._armature.getBone(this._meshData.weight.bones[f].name)}}else{var c=this._meshData.parent.parent.parent.intArray[this._meshData.offset+0];this._ffdVertices.length=c*2;this._meshBones.length=0}for(var f=0,_=this._ffdVertices.length;f<_;++f){this._ffdVertices[f]=0}this._meshDirty=true}else{this._ffdVertices.length=0;this._meshBones.length=0}}else if(this._meshData!==null&&this._textureData!==e){this._meshDirty=true}if(this._displayData!==null&&r!==null&&this._displayData!==r&&this._meshData===null){r.transform.toMatrix(i._helpMatrix);i._helpMatrix.invert();i._helpMatrix.transformPoint(0,0,i._helpPoint);this._pivotX-=i._helpPoint.x;this._pivotY-=i._helpPoint.y;this._displayData.transform.toMatrix(i._helpMatrix);i._helpMatrix.invert();i._helpMatrix.transformPoint(0,0,i._helpPoint);this._pivotX+=i._helpPoint.x;this._pivotY+=i._helpPoint.y}if(r!==null){this.origin=r.transform}else if(this._displayData!==null){this.origin=this._displayData.transform}this._displayDirty=true;this._transformDirty=true}};i.prototype._updateDisplay=function(){var e=this._display!==null?this._display:this._rawDisplay;var i=this._childArmature;if(this._displayIndex>=0&&this._displayIndex<this._displayList.length){this._display=this._displayList[this._displayIndex];if(this._display!==null&&this._display instanceof t.Armature){this._childArmature=this._display;this._display=this._childArmature.display}else{this._childArmature=null}}else{this._display=null;this._childArmature=null}var a=this._display!==null?this._display:this._rawDisplay;if(a!==e){this._onUpdateDisplay();this._replaceDisplay(e);this._visibleDirty=true;this._blendModeDirty=true;this._colorDirty=true}if(a===this._rawDisplay||a===this._meshDisplay){this._updateFrame()}if(this._childArmature!==i){if(i!==null){i._parent=null;i.clock=null;if(i.inheritAnimation){i.animation.reset()}}if(this._childArmature!==null){this._childArmature._parent=this;this._childArmature.clock=this._armature.clock;if(this._childArmature.inheritAnimation){if(this._childArmature.cacheFrameRate===0){var r=this._armature.cacheFrameRate;if(r!==0){this._childArmature.cacheFrameRate=r}}var n=null;if(this._displayData!==null&&this._displayData.type===1){n=this._displayData.actions}else{var s=this._displayIndex>=0&&this._rawDisplayDatas!==null&&this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;if(s!==null&&s.type===1){n=s.actions}}if(n!==null&&n.length>0){for(var o=0,l=n;o<l.length;o++){var h=l[o];this._childArmature._bufferAction(h,false)}}else{this._childArmature.animation.play()}}}}};i.prototype._updateGlobalTransformMatrix=function(t){this.globalTransformMatrix.copyFrom(this._localMatrix);this.globalTransformMatrix.concat(this._parent.globalTransformMatrix);if(t){this.global.fromMatrix(this.globalTransformMatrix)}else{this._globalDirty=true}};i.prototype._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones;t<e.length;t++){var i=e[t];if(i!==null&&i._childrenTransformDirty){return true}}return false};i.prototype._setArmature=function(t){if(this._armature===t){return}if(this._armature!==null){this._armature._removeSlotFromSlotList(this)}this._armature=t;this._onUpdateDisplay();if(this._armature!==null){this._armature._addSlotToSlotList(this);this._addDisplay()}else{this._removeDisplay()}};i.prototype._setDisplayIndex=function(t,e){if(e===void 0){e=false}if(e){if(this._animationDisplayIndex===t){return false}this._animationDisplayIndex=t}if(this._displayIndex===t){return false}this._displayIndex=t;this._displayDirty=true;this._updateDisplayData();return this._displayDirty};i.prototype._setZorder=function(t){if(this._zOrder===t){}this._zOrder=t;this._zOrderDirty=true;return this._zOrderDirty};i.prototype._setColor=function(t){this._colorTransform.copyFrom(t);this._colorDirty=true;return this._colorDirty};i.prototype._setDisplayList=function(e){if(e!==null&&e.length>0){if(this._displayList.length!==e.length){this._displayList.length=e.length}for(var i=0,a=e.length;i<a;++i){var r=e[i];if(r!==null&&r!==this._rawDisplay&&r!==this._meshDisplay&&!(r instanceof t.Armature)&&this._displayList.indexOf(r)<0){this._initDisplay(r)}this._displayList[i]=r}}else if(this._displayList.length>0){this._displayList.length=0}if(this._displayIndex>=0&&this._displayIndex<this._displayList.length){this._displayDirty=this._display!==this._displayList[this._displayIndex]}else{this._displayDirty=this._display!==null}this._updateDisplayData();return this._displayDirty};i.prototype.init=function(t,e,i,a){if(this._slotData!==null){return}this._slotData=t;this._visibleDirty=true;this._blendModeDirty=true;this._colorDirty=true;this._blendMode=this._slotData.blendMode;this._zOrder=this._slotData.zOrder;this._colorTransform.copyFrom(this._slotData.color);this._rawDisplay=i;this._meshDisplay=a;this.rawDisplayDatas=e};i.prototype.update=function(t){if(this._displayDirty){this._displayDirty=false;this._updateDisplay();if(this._transformDirty){if(this.origin!==null){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)}else{this.global.copyFrom(this.offset).toMatrix(this._localMatrix)}}}if(this._zOrderDirty){this._zOrderDirty=false;this._updateZOrder()}if(t>=0&&this._cachedFrameIndices!==null){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e){this._transformDirty=false}else if(e>=0){this._transformDirty=true;this._cachedFrameIndex=e}else if(this._transformDirty||this._parent._childrenTransformDirty){this._transformDirty=true;this._cachedFrameIndex=-1}else if(this._cachedFrameIndex>=0){this._transformDirty=false;this._cachedFrameIndices[t]=this._cachedFrameIndex}else{this._transformDirty=true;this._cachedFrameIndex=-1}}else if(this._transformDirty||this._parent._childrenTransformDirty){t=-1;this._transformDirty=true;this._cachedFrameIndex=-1}if(this._display===null){return}if(this._visibleDirty){this._visibleDirty=false;this._updateVisible()}if(this._blendModeDirty){this._blendModeDirty=false;this._updateBlendMode()}if(this._colorDirty){this._colorDirty=false;this._updateColor()}if(this._meshData!==null&&this._display===this._meshDisplay){var i=this._meshData.weight!==null;if(this._meshDirty||i&&this._isMeshBonesUpdate()){this._meshDirty=false;this._updateMesh()}if(i){if(this._transformDirty){this._transformDirty=false;this._updateTransform(true)}return}}if(this._transformDirty){this._transformDirty=false;if(this._cachedFrameIndex<0){var a=t>=0;this._updateGlobalTransformMatrix(a);if(a&&this._cachedFrameIndices!==null){this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}this._updateTransform(false)}};i.prototype.updateTransformAndMatrix=function(){if(this._transformDirty){this._transformDirty=false;this._updateGlobalTransformMatrix(false)}};i.prototype.replaceDisplayData=function(t,e){if(e===void 0){e=-1}if(e<0){if(this._displayIndex<0){e=0}else{e=this._displayIndex}}if(this._displayDatas.length<=e){this._displayDatas.length=e+1;for(var i=0,a=this._displayDatas.length;i<a;++i){if(!this._displayDatas[i]){this._displayDatas[i]=null}}}this._displayDatas[e]=t};i.prototype.containsPoint=function(t,e){if(this._boundingBoxData===null){return false}this.updateTransformAndMatrix();i._helpMatrix.copyFrom(this.globalTransformMatrix);i._helpMatrix.invert();i._helpMatrix.transformPoint(t,e,i._helpPoint);return this._boundingBoxData.containsPoint(i._helpPoint.x,i._helpPoint.y)};i.prototype.intersectsSegment=function(t,e,a,r,n,s,o){if(n===void 0){n=null}if(s===void 0){s=null}if(o===void 0){o=null}if(this._boundingBoxData===null){return 0}this.updateTransformAndMatrix();i._helpMatrix.copyFrom(this.globalTransformMatrix);i._helpMatrix.invert();i._helpMatrix.transformPoint(t,e,i._helpPoint);t=i._helpPoint.x;e=i._helpPoint.y;i._helpMatrix.transformPoint(a,r,i._helpPoint);a=i._helpPoint.x;r=i._helpPoint.y;var l=this._boundingBoxData.intersectsSegment(t,e,a,r,n,s,o);if(l>0){if(l===1||l===2){if(n!==null){this.globalTransformMatrix.transformPoint(n.x,n.y,n);if(s!==null){s.x=n.x;s.y=n.y}}else if(s!==null){this.globalTransformMatrix.transformPoint(s.x,s.y,s)}}else{if(n!==null){this.globalTransformMatrix.transformPoint(n.x,n.y,n)}if(s!==null){this.globalTransformMatrix.transformPoint(s.x,s.y,s)}}if(o!==null){this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),i._helpPoint,true);o.x=Math.atan2(i._helpPoint.y,i._helpPoint.x);this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),i._helpPoint,true);o.y=Math.atan2(i._helpPoint.y,i._helpPoint.x)}}return l};i.prototype.invalidUpdate=function(){this._displayDirty=true;this._transformDirty=true};Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible===t){return}this._visible=t;this._updateVisible()},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){if(this._setDisplayIndex(t)){this.update(-1)}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"name",{get:function(){return this._slotData.name},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat();var a=new Array;if(this._setDisplayList(e)){this.update(-1)}for(var r=0,n=i;r<n.length;r++){var s=n[r];if(s!==null&&s!==this._rawDisplay&&s!==this._meshDisplay&&this._displayList.indexOf(s)<0&&a.indexOf(s)<0){a.push(s)}}for(var o=0,l=a;o<l.length;o++){var s=l[o];if(s instanceof t.Armature){s.dispose()}else{this._disposeDisplay(s)}}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"slotData",{get:function(){return this._slotData},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"rawDisplayDatas",{get:function(){return this._rawDisplayDatas},set:function(t){if(this._rawDisplayDatas===t){return}this._displayDirty=true;this._rawDisplayDatas=t;if(this._rawDisplayDatas){this._displayDatas.length=this._rawDisplayDatas.length;for(var e=0,i=this._displayDatas.length;e<i;++e){this._displayDatas[e]=this._rawDisplayDatas[e]}}else{this._displayDatas.length=0}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display===t){return}var e=this._displayList.length;if(this._displayIndex<0&&e===0){this._displayIndex=0}if(this._displayIndex<0){return}else{var i=this.displayList;if(e<=this._displayIndex){i.length=this._displayIndex+1}i[this._displayIndex]=t;this.displayList=i}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){if(this._childArmature===t){return}this.display=t},enumerable:true,configurable:true});i.prototype.getDisplay=function(){return this.display};i.prototype.setDisplay=function(t){this.display=t};return i}(t.TransformObject);t.Slot=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.prototype._onClear=function(){this._armature=null;this._target=null;this._bone=null;this._root=null};Object.defineProperty(i.prototype,"name",{get:function(){return this._constraintData.name},enumerable:true,configurable:true});i._helpMatrix=new t.Matrix;i._helpTransform=new t.Transform;i._helpPoint=new t.Point;return i}(t.BaseObject);t.Constraint=e;var i=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.toString=function(){return"[class dragonBones.IKConstraint]"};i.prototype._onClear=function(){e.prototype._onClear.call(this);this._scaleEnabled=false;this._bendPositive=false;this._weight=1;this._constraintData=null};i.prototype._computeA=function(){var t=this._target.global;var e=this._bone.global;var i=this._bone.globalTransformMatrix;var a=Math.atan2(t.y-e.y,t.x-e.x);if(e.scaleX<0){a+=Math.PI}e.rotation+=(a-e.rotation)*this._weight;e.toMatrix(i)};i.prototype._computeB=function(){var e=this._bone._boneData.length;var i=this._root;var a=this._target.global;var r=i.global;var n=this._bone.global;var s=this._bone.globalTransformMatrix;var o=s.a*e;var l=s.b*e;var h=o*o+l*l;var u=Math.sqrt(h);var f=n.x-r.x;var _=n.y-r.y;var c=f*f+_*_;var p=Math.sqrt(c);var m=n.rotation;var d=r.rotation;var y=Math.atan2(_,f);f=a.x-r.x;_=a.y-r.y;var g=f*f+_*_;var v=Math.sqrt(g);var b=0;if(u+p<=v||v+u<=p||v+p<=u){b=Math.atan2(a.y-r.y,a.x-r.x);if(u+p<=v){}else if(p<u){b+=Math.PI}}else{var T=(c-h+g)/(2*g);var D=Math.sqrt(c-T*T*g)/v;var A=r.x+f*T;var x=r.y+_*T;var O=-_*D;var S=f*D;var E=false;if(i._parent!==null){var B=i._parent.globalTransformMatrix;E=B.a*B.d-B.b*B.c<0}if(E!==this._bendPositive){n.x=A-O;n.y=x-S}else{n.x=A+O;n.y=x+S}b=Math.atan2(n.y-r.y,n.x-r.x)}var M=t.Transform.normalizeRadian(b-y);r.rotation=d+M*this._weight;r.toMatrix(i.globalTransformMatrix);var w=y+M*this._weight;n.x=r.x+Math.cos(w)*p;n.y=r.y+Math.sin(w)*p;var P=Math.atan2(a.y-n.y,a.x-n.x);if(n.scaleX<0){P+=Math.PI}n.rotation=r.rotation+m-d+t.Transform.normalizeRadian(P-M-m)*this._weight;n.toMatrix(s)};i.prototype.init=function(t,e){if(this._constraintData!==null){return}this._constraintData=t;this._armature=e;this._target=this._armature.getBone(this._constraintData.target.name);this._bone=this._armature.getBone(this._constraintData.bone.name);this._root=this._constraintData.root!==null?this._armature.getBone(this._constraintData.root.name):null;{var i=this._constraintData;this._scaleEnabled=i.scaleEnabled;this._bendPositive=i.bendPositive;this._weight=i.weight}this._bone._hasConstraint=true};i.prototype.update=function(){if(this._root===null){this._bone.updateByConstraint();this._computeA()}else{this._root.updateByConstraint();this._bone.updateByConstraint();this._computeB()}};i.prototype.invalidUpdate=function(){if(this._root===null){this._bone.invalidUpdate()}else{this._root.invalidUpdate();this._bone.invalidUpdate()}};return i}(e);t.IKConstraint=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t){if(t===void 0){t=-1}this.time=0;this.timeScale=1;this._animatebles=[];this._clock=null;if(t<0){this.time=(new Date).getTime()*.001}else{this.time=t}}t.prototype.advanceTime=function(t){if(t!==t){t=0}if(t<0){t=(new Date).getTime()*.001-this.time}if(this.timeScale!==1){t*=this.timeScale}if(t<0){this.time-=t}else{this.time+=t}if(t===0){return}var e=0,i=0,a=this._animatebles.length;for(;e<a;++e){var r=this._animatebles[e];if(r!==null){if(i>0){this._animatebles[e-i]=r;this._animatebles[e]=null}r.advanceTime(t)}else{i++}}if(i>0){a=this._animatebles.length;for(;e<a;++e){var n=this._animatebles[e];if(n!==null){this._animatebles[e-i]=n}else{i++}}this._animatebles.length-=i}};t.prototype.contains=function(t){if(t===this){return false}var e=t;while(e!==this&&e!==null){e=e.clock}return e===this};t.prototype.add=function(t){if(this._animatebles.indexOf(t)<0){this._animatebles.push(t);t.clock=this}};t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);if(e>=0){this._animatebles[e]=null;t.clock=null}};t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];if(i!==null){i.clock=null}}};Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock===t){return}if(this._clock!==null){this._clock.remove(this)}this._clock=t;if(this._clock!==null){this._clock.add(this)}},enumerable:true,configurable:true});t.clock=new t;return t}();t.WorldClock=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var t=e!==null&&e.apply(this,arguments)||this;t._animationNames=[];t._animationStates=[];t._animations={};t._animationConfig=null;return t}i.toString=function(){return"[class dragonBones.Animation]"};i.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];i.returnToPool()}for(var a in this._animations){delete this._animations[a]}if(this._animationConfig!==null){this._animationConfig.returnToPool()}this.timeScale=1;this._animationDirty=false;this._inheritTimeScale=1;this._animationNames.length=0;this._animationStates.length=0;this._armature=null;this._animationConfig=null;this._lastAnimationState=null};i.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++){var a=i[e];if(a.layer===t.layer){a.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 2:for(var r=0,n=this._animationStates;r<n.length;r++){var a=n[r];if(a.group===t.group){a.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 3:for(var s=0,o=this._animationStates;s<o.length;s++){var a=o[s];if(a.layer===t.layer&&a.group===t.group){a.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 4:for(var l=0,h=this._animationStates;l<h.length;l++){var a=h[l];a.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 0:case 5:default:break}};i.prototype.init=function(e){if(this._armature!==null){return}this._armature=e;this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig)};i.prototype.advanceTime=function(t){if(t<0){t=-t}if(this._armature.inheritAnimation&&this._armature._parent!==null){this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale}else{this._inheritTimeScale=this.timeScale}if(this._inheritTimeScale!==1){t*=this._inheritTimeScale}var e=this._animationStates.length;if(e===1){var i=this._animationStates[0];if(i._fadeState>0&&i._subFadeState>0){this._armature._dragonBones.bufferObject(i);this._animationStates.length=0;this._lastAnimationState=null}else{var a=i._animationData;var r=a.cacheFrameRate;if(this._animationDirty&&r>0){this._animationDirty=false;for(var n=0,s=this._armature.getBones();n<s.length;n++){var o=s[n];o._cachedFrameIndices=a.getBoneCachedFrameIndices(o.name)}for(var l=0,h=this._armature.getSlots();l<h.length;l++){var u=h[l];u._cachedFrameIndices=a.getSlotCachedFrameIndices(u.name)}}i.advanceTime(t,r)}}else if(e>1){for(var f=0,_=0;f<e;++f){var i=this._animationStates[f];if(i._fadeState>0&&i._subFadeState>0){_++;this._armature._dragonBones.bufferObject(i);this._animationDirty=true;if(this._lastAnimationState===i){this._lastAnimationState=null}}else{if(_>0){this._animationStates[f-_]=i}i.advanceTime(t,0)}if(f===e-1&&_>0){this._animationStates.length-=_;if(this._lastAnimationState===null&&this._animationStates.length>0){this._lastAnimationState=this._animationStates[this._animationStates.length-1]}}}this._armature._cacheFrameIndex=-1}else{this._armature._cacheFrameIndex=-1}};i.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];i.returnToPool()}this._animationDirty=false;this._animationConfig.clear();this._animationStates.length=0;this._lastAnimationState=null};i.prototype.stop=function(t){if(t===void 0){t=null}if(t!==null){var e=this.getState(t);if(e!==null){e.stop()}}else{for(var i=0,a=this._animationStates;i<a.length;i++){var e=a[i];e.stop()}}};i.prototype.playConfig=function(e){var i=e.animation;if(!(i in this._animations)){console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+i);return null}var a=this._animations[i];if(e.fadeOutMode===5){for(var r=0,n=this._animationStates;r<n.length;r++){var s=n[r];if(s._animationData===a){return s}}}if(this._animationStates.length===0){e.fadeInTime=0}else if(e.fadeInTime<0){e.fadeInTime=a.fadeInTime}if(e.fadeOutTime<0){e.fadeOutTime=e.fadeInTime}if(e.timeScale<=-100){e.timeScale=1/a.scale}if(a.frameCount>1){if(e.position<0){e.position%=a.duration;e.position=a.duration-e.position}else if(e.position===a.duration){e.position-=1e-6}else if(e.position>a.duration){e.position%=a.duration}if(e.duration>0&&e.position+e.duration>a.duration){e.duration=a.duration-e.position}if(e.playTimes<0){e.playTimes=a.playTimes}}else{e.playTimes=1;e.position=0;if(e.duration>0){e.duration=0}}if(e.duration===0){e.duration=-1}this._fadeOut(e);var o=t.BaseObject.borrowObject(t.AnimationState);o.init(this._armature,a,e);this._animationDirty=true;this._armature._cacheFrameIndex=-1;if(this._animationStates.length>0){var l=false;for(var h=0,u=this._animationStates.length;h<u;++h){if(o.layer>=this._animationStates[h].layer){}else{l=true;this._animationStates.splice(h+1,0,o);break}}if(!l){this._animationStates.push(o)}}else{this._animationStates.push(o)}for(var f=0,_=this._armature.getSlots();f<_.length;f++){var c=_[f];var p=c.childArmature;if(p!==null&&p.inheritAnimation&&p.animation.hasAnimation(i)&&p.animation.getState(i)===null){p.animation.fadeIn(i)}}if(e.fadeInTime<=0){this._armature.advanceTime(0)}this._lastAnimationState=o;return o};i.prototype.play=function(t,e){if(t===void 0){t=null}if(e===void 0){e=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=e;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t!==null?t:"";if(t!==null&&t.length>0){this.playConfig(this._animationConfig)}else if(this._lastAnimationState===null){var i=this._armature.armatureData.defaultAnimation;if(i!==null){this._animationConfig.animation=i.name;this.playConfig(this._animationConfig)}}else if(!this._lastAnimationState.isPlaying&&!this._lastAnimationState.isCompleted){this._lastAnimationState.play()}else{this._animationConfig.animation=this._lastAnimationState.name;this.playConfig(this._animationConfig)}return this._lastAnimationState};i.prototype.fadeIn=function(t,e,i,a,r,n){if(e===void 0){e=-1}if(i===void 0){i=-1}if(a===void 0){a=0}if(r===void 0){r=null}if(n===void 0){n=3}this._animationConfig.clear();this._animationConfig.fadeOutMode=n;this._animationConfig.playTimes=i;this._animationConfig.layer=a;this._animationConfig.fadeInTime=e;this._animationConfig.animation=t;this._animationConfig.group=r!==null?r:"";return this.playConfig(this._animationConfig)};i.prototype.gotoAndPlayByTime=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=i;this._animationConfig.position=e;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;return this.playConfig(this._animationConfig)};i.prototype.gotoAndPlayByFrame=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=i;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;var a=t in this._animations?this._animations[t]:null;if(a!==null){this._animationConfig.position=a.duration*e/a.frameCount}return this.playConfig(this._animationConfig)};i.prototype.gotoAndPlayByProgress=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=i;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;var a=t in this._animations?this._animations[t]:null;if(a!==null){this._animationConfig.position=a.duration*(e>0?e:0)}return this.playConfig(this._animationConfig)};i.prototype.gotoAndStopByTime=function(t,e){if(e===void 0){e=0}var i=this.gotoAndPlayByTime(t,e,1);if(i!==null){i.stop()}return i};i.prototype.gotoAndStopByFrame=function(t,e){if(e===void 0){e=0}var i=this.gotoAndPlayByFrame(t,e,1);if(i!==null){i.stop()}return i};i.prototype.gotoAndStopByProgress=function(t,e){if(e===void 0){e=0}var i=this.gotoAndPlayByProgress(t,e,1);if(i!==null){i.stop()}return i};i.prototype.getState=function(t){var e=this._animationStates.length;while(e--){var i=this._animationStates[e];if(i.name===t){return i}}return null};i.prototype.hasAnimation=function(t){return t in this._animations};i.prototype.getStates=function(){return this._animationStates};Object.defineProperty(i.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];if(i.isPlaying){return true}}return false},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];if(!i.isCompleted){return false}}return this._animationStates.length>0},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState!==null?this._lastAnimationState.name:""},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations===t){return}this._animationNames.length=0;for(var e in this._animations){delete this._animations[e]}for(var e in t){this._animationNames.push(e);this._animations[e]=t[e]}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animationConfig",{get:function(){this._animationConfig.clear();return this._animationConfig},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:true,configurable:true});i.prototype.gotoAndPlay=function(t,e,i,a,r,n,s,o,l){if(e===void 0){e=-1}if(i===void 0){i=-1}if(a===void 0){a=-1}if(r===void 0){r=0}if(n===void 0){n=null}if(s===void 0){s=3}if(o===void 0){o=true}if(l===void 0){l=true}o;l;this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.fadeOutMode=s;this._animationConfig.playTimes=a;this._animationConfig.layer=r;this._animationConfig.fadeInTime=e;this._animationConfig.animation=t;this._animationConfig.group=n!==null?n:"";var h=this._animations[t];if(h&&i>0){this._animationConfig.timeScale=h.duration/i}return this.playConfig(this._animationConfig)};i.prototype.gotoAndStop=function(t,e){if(e===void 0){e=0}return this.gotoAndStopByTime(t,e)};Object.defineProperty(i.prototype,"animationList",{get:function(){return this._animationNames},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animationDataList",{get:function(){var t=[];for(var e=0,i=this._animationNames.length;e<i;++e){t.push(this._animations[this._animationNames[e]])}return t},enumerable:true,configurable:true});return i}(t.BaseObject);t.Animation=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;t._boneMask=[];t._boneTimelines=[];t._slotTimelines=[];t._constraintTimelines=[];t._poseTimelines=[];t._bonePoses={};t._actionTimeline=null;t._zOrderTimeline=null;return t}a.toString=function(){return"[class dragonBones.AnimationState]"};a.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++){var i=e[t];i.returnToPool()}for(var a=0,r=this._slotTimelines;a<r.length;a++){var i=r[a];i.returnToPool()}for(var n=0,s=this._constraintTimelines;n<s.length;n++){var i=s[n];i.returnToPool()}for(var o in this._bonePoses){this._bonePoses[o].returnToPool();delete this._bonePoses[o]}if(this._actionTimeline!==null){this._actionTimeline.returnToPool()}if(this._zOrderTimeline!==null){this._zOrderTimeline.returnToPool()}this.actionEnabled=false;this.additiveBlending=false;this.displayControl=false;this.resetToPose=false;this.playTimes=1;this.layer=0;this.timeScale=1;this.weight=1;this.autoFadeOutTime=0;this.fadeTotalTime=0;this.name="";this.group="";this._timelineDirty=true;this._playheadState=0;this._fadeState=-1;this._subFadeState=-1;this._position=0;this._duration=0;this._fadeTime=0;this._time=0;this._fadeProgress=0;this._weightResult=0;this._boneMask.length=0;this._boneTimelines.length=0;this._slotTimelines.length=0;this._constraintTimelines.length=0;this._poseTimelines.length=0;this._animationData=null;this._armature=null;this._actionTimeline=null;this._zOrderTimeline=null};a.prototype._updateTimelines=function(){{var e={};for(var a=0,r=this._boneTimelines;a<r.length;a++){var n=r[a];var s=n.bone.name;if(!(s in e)){e[s]=[]}e[s].push(n)}for(var o=0,l=this._armature.getBones();o<l.length;o++){var h=l[o];var s=h.name;if(!this.containsBoneMask(s)){continue}var u=this._animationData.getBoneTimelines(s);if(s in e){delete e[s]}else{var f=s in this._bonePoses?this._bonePoses[s]:this._bonePoses[s]=t.BaseObject.borrowObject(i);if(u!==null){for(var _=0,c=u;_<c.length;_++){var p=c[_];switch(p.type){case 10:{var n=t.BaseObject.borrowObject(t.BoneAllTimelineState);n.bone=h;n.bonePose=f;n.init(this._armature,this,p);this._boneTimelines.push(n);break}case 11:{var n=t.BaseObject.borrowObject(t.BoneTranslateTimelineState);n.bone=h;n.bonePose=f;n.init(this._armature,this,p);this._boneTimelines.push(n);break}case 12:{var n=t.BaseObject.borrowObject(t.BoneRotateTimelineState);n.bone=h;n.bonePose=f;n.init(this._armature,this,p);this._boneTimelines.push(n);break}case 13:{var n=t.BaseObject.borrowObject(t.BoneScaleTimelineState);n.bone=h;n.bonePose=f;n.init(this._armature,this,p);this._boneTimelines.push(n);break}default:break}}}else if(this.resetToPose){var n=t.BaseObject.borrowObject(t.BoneAllTimelineState);n.bone=h;n.bonePose=f;n.init(this._armature,this,null);this._boneTimelines.push(n);this._poseTimelines.push(n)}}}for(var m in e){for(var d=0,y=e[m];d<y.length;d++){var n=y[d];this._boneTimelines.splice(this._boneTimelines.indexOf(n),1);n.returnToPool()}}}{var g={};var v=[];for(var b=0,T=this._slotTimelines;b<T.length;b++){var n=T[b];var s=n.slot.name;if(!(s in g)){g[s]=[]}g[s].push(n)}for(var D=0,A=this._armature.getSlots();D<A.length;D++){var x=A[D];var O=x.parent.name;if(!this.containsBoneMask(O)){continue}var s=x.name;var u=this._animationData.getSlotTimelines(s);if(s in g){delete g[s]}else{var S=false;var E=false;v.length=0;if(u!==null){for(var B=0,M=u;B<M.length;B++){var p=M[B];switch(p.type){case 20:{var n=t.BaseObject.borrowObject(t.SlotDislayTimelineState);n.slot=x;n.init(this._armature,this,p);this._slotTimelines.push(n);S=true;break}case 21:{var n=t.BaseObject.borrowObject(t.SlotColorTimelineState);n.slot=x;n.init(this._armature,this,p);this._slotTimelines.push(n);E=true;break}case 22:{var n=t.BaseObject.borrowObject(t.SlotFFDTimelineState);n.slot=x;n.init(this._armature,this,p);this._slotTimelines.push(n);v.push(n.meshOffset);break}default:break}}}if(this.resetToPose){if(!S){var n=t.BaseObject.borrowObject(t.SlotDislayTimelineState);n.slot=x;n.init(this._armature,this,null);this._slotTimelines.push(n);this._poseTimelines.push(n)}if(!E){var n=t.BaseObject.borrowObject(t.SlotColorTimelineState);n.slot=x;n.init(this._armature,this,null);this._slotTimelines.push(n);this._poseTimelines.push(n)}if(x.rawDisplayDatas!==null){for(var w=0,P=x.rawDisplayDatas;w<P.length;w++){var C=P[w];if(C!==null&&C.type===2){var I=C.offset;if(v.indexOf(I)<0){var n=t.BaseObject.borrowObject(t.SlotFFDTimelineState);n.meshOffset=I;n.slot=x;n.init(this._armature,this,null);this._slotTimelines.push(n);this._poseTimelines.push(n)}}}}}}}for(var m in g){for(var F=0,N=g[m];F<N.length;F++){var n=N[F];this._slotTimelines.splice(this._slotTimelines.indexOf(n),1);n.returnToPool()}}}{var R={};for(var j=0,k=this._constraintTimelines;j<k.length;j++){var n=k[j];var s=n.constraint.name;if(!(s in R)){R[s]=[]}R[s].push(n)}for(var L=0,U=this._armature._constraints;L<U.length;L++){var Y=U[L];var s=Y.name;var u=this._animationData.getConstraintTimelines(s);if(s in R){delete R[s]}else{if(u!==null){for(var V=0,$=u;V<$.length;V++){var p=$[V];switch(p.type){case 30:{var n=t.BaseObject.borrowObject(t.IKConstraintTimelineState);n.constraint=Y;n.init(this._armature,this,p);this._constraintTimelines.push(n);break}default:break}}}else if(this.resetToPose){var n=t.BaseObject.borrowObject(t.IKConstraintTimelineState);n.constraint=Y;n.init(this._armature,this,null);this._constraintTimelines.push(n);this._poseTimelines.push(n)}}}for(var m in R){for(var X=0,H=R[m];X<H.length;X++){var n=H[X];this._constraintTimelines.splice(this._constraintTimelines.indexOf(n),1);n.returnToPool()}}}};a.prototype._advanceFadeTime=function(e){var i=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var a=i?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(a)){var r=t.BaseObject.borrowObject(t.EventObject);r.type=a;r.armature=this._armature;r.animationState=this;this._armature._dragonBones.bufferEvent(r)}}if(e<0){e=-e}this._fadeTime+=e;if(this._fadeTime>=this.fadeTotalTime){this._subFadeState=1;this._fadeProgress=i?0:1}else if(this._fadeTime>0){this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime}else{this._fadeProgress=i?1:0}if(this._subFadeState>0){if(!i){this._playheadState|=1;this._fadeState=0}var a=i?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(a)){var r=t.BaseObject.borrowObject(t.EventObject);r.type=a;r.armature=this._armature;r.animationState=this;this._armature._dragonBones.bufferEvent(r)}}};a.prototype._blendBoneTimline=function(t){var e=this._weightResult>0?this._weightResult:-this._weightResult;var i=t.bone;var a=t.bonePose.result;var r=i.animationPose;if(!i._blendDirty){i._blendDirty=true;i._blendLayer=this.layer;i._blendLayerWeight=e;i._blendLeftWeight=1;r.x=a.x*e;r.y=a.y*e;r.rotation=a.rotation*e;r.skew=a.skew*e;r.scaleX=(a.scaleX-1)*e+1;r.scaleY=(a.scaleY-1)*e+1}else{e*=i._blendLeftWeight;i._blendLayerWeight+=e;r.x+=a.x*e;r.y+=a.y*e;r.rotation+=a.rotation*e;r.skew+=a.skew*e;r.scaleX+=(a.scaleX-1)*e;r.scaleY+=(a.scaleY-1)*e}if(this._fadeState!==0||this._subFadeState!==0){i._transformDirty=true}};a.prototype.init=function(e,i,a){if(this._armature!==null){return}this._armature=e;this._animationData=i;this.resetToPose=a.resetToPose;this.additiveBlending=a.additiveBlending;this.displayControl=a.displayControl;this.actionEnabled=a.actionEnabled;this.layer=a.layer;this.playTimes=a.playTimes;this.timeScale=a.timeScale;this.fadeTotalTime=a.fadeInTime;this.autoFadeOutTime=a.autoFadeOutTime;this.weight=a.weight;this.name=a.name.length>0?a.name:a.animation;this.group=a.group;if(a.pauseFadeIn){this._playheadState=2}else{this._playheadState=3}if(a.duration<0){this._position=0;this._duration=this._animationData.duration;if(a.position!==0){if(this.timeScale>=0){this._time=a.position}else{this._time=a.position-this._duration}}else{this._time=0}}else{this._position=a.position;this._duration=a.duration;this._time=0}if(this.timeScale<0&&this._time===0){this._time=-1e-6}if(this.fadeTotalTime<=0){this._fadeProgress=.999999}if(a.boneMask.length>0){this._boneMask.length=a.boneMask.length;for(var r=0,n=this._boneMask.length;r<n;++r){this._boneMask[r]=a.boneMask[r]}}this._actionTimeline=t.BaseObject.borrowObject(t.ActionTimelineState);this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline);this._actionTimeline.currentTime=this._time;if(this._actionTimeline.currentTime<0){this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime}if(this._animationData.zOrderTimeline!==null){this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState);this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline)}};a.prototype.advanceTime=function(e,i){if(this._fadeState!==0||this._subFadeState!==0){this._advanceFadeTime(e)}if(this._playheadState===3){if(this.timeScale!==1){e*=this.timeScale}this._time+=e}if(this._timelineDirty){this._timelineDirty=false;this._updateTimelines()}if(this.weight===0){return}var a=this._fadeState===0&&i>0;var r=true;var n=true;var s=this._time;this._weightResult=this.weight*this._fadeProgress;if(this._actionTimeline.playState<=0){this._actionTimeline.update(s)}if(a){var o=i*2;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*o)/o}if(this._zOrderTimeline!==null&&this._zOrderTimeline.playState<=0){this._zOrderTimeline.update(s)}if(a){var l=Math.floor(this._actionTimeline.currentTime*i);if(this._armature._cacheFrameIndex===l){r=false;n=false}else{this._armature._cacheFrameIndex=l;if(this._animationData.cachedFrames[l]){n=false}else{this._animationData.cachedFrames[l]=true}}}if(r){if(n){var h=null;var u=null;for(var f=0,_=this._boneTimelines.length;f<_;++f){var c=this._boneTimelines[f];if(h!==c.bone){if(h!==null){this._blendBoneTimline(u);if(h._blendDirty){if(h._blendLeftWeight>0){if(h._blendLayer!==this.layer){if(h._blendLayerWeight>=h._blendLeftWeight){h._blendLeftWeight=0;h=null}else{h._blendLayer=this.layer;h._blendLeftWeight-=h._blendLayerWeight;h._blendLayerWeight=0}}}else{h=null}}}h=c.bone}if(h!==null){if(c.playState<=0){c.update(s)}if(f===_-1){this._blendBoneTimline(c)}else{u=c}}}}if(this.displayControl){for(var f=0,_=this._slotTimelines.length;f<_;++f){var c=this._slotTimelines[f];var p=c.slot.displayController;if(p===null||p===this.name||p===this.group){if(c.playState<=0){c.update(s)}}}}for(var f=0,_=this._constraintTimelines.length;f<_;++f){var c=this._constraintTimelines[f];if(c.playState<=0){c.update(s)}}}if(this._fadeState===0){if(this._subFadeState>0){this._subFadeState=0;if(this._poseTimelines.length>0){for(var m=0,d=this._poseTimelines;m<d.length;m++){var c=d[m];if(c instanceof t.BoneTimelineState){var y=this._boneTimelines.indexOf(c);this._boneTimelines.splice(y,1)}else if(c instanceof t.SlotTimelineState){var y=this._slotTimelines.indexOf(c);this._slotTimelines.splice(y,1)}else if(c instanceof t.ConstraintTimelineState){var y=this._constraintTimelines.indexOf(c);this._constraintTimelines.splice(y,1)}c.returnToPool()}this._poseTimelines.length=0}}if(this._actionTimeline.playState>0){if(this.autoFadeOutTime>=0){this.fadeOut(this.autoFadeOutTime)}}}};a.prototype.play=function(){this._playheadState=3};a.prototype.stop=function(){this._playheadState&=1};a.prototype.fadeOut=function(t,e){if(e===void 0){e=true}if(t<0){t=0}if(e){this._playheadState&=2}if(this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime){return}}else{this._fadeState=1;this._subFadeState=-1;if(t<=0||this._fadeProgress<=0){this._fadeProgress=1e-6}for(var i=0,a=this._boneTimelines;i<a.length;i++){var r=a[i];r.fadeOut()}for(var n=0,s=this._slotTimelines;n<s.length;n++){var r=s[n];r.fadeOut()}}this.displayControl=false;this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0;this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)};a.prototype.containsBoneMask=function(t){return this._boneMask.length===0||this._boneMask.indexOf(t)>=0};a.prototype.addBoneMask=function(t,e){if(e===void 0){e=true}var i=this._armature.getBone(t);if(i===null){return}if(this._boneMask.indexOf(t)<0){this._boneMask.push(t)}if(e){for(var a=0,r=this._armature.getBones();a<r.length;a++){var n=r[a];if(this._boneMask.indexOf(n.name)<0&&i.contains(n)){this._boneMask.push(n.name)}}}this._timelineDirty=true};a.prototype.removeBoneMask=function(t,e){if(e===void 0){e=true}var i=this._boneMask.indexOf(t);if(i>=0){this._boneMask.splice(i,1)}if(e){var a=this._armature.getBone(t);if(a!==null){var r=this._armature.getBones();if(this._boneMask.length>0){for(var n=0,s=r;n<s.length;n++){var o=s[n];var l=this._boneMask.indexOf(o.name);if(l>=0&&a.contains(o)){this._boneMask.splice(l,1)}}}else{for(var h=0,u=r;h<u.length;h++){var o=u[h];if(o===a){continue}if(!a.contains(o)){this._boneMask.push(o.name)}}}}}this._timelineDirty=true};a.prototype.removeAllBoneMask=function(){this._boneMask.length=0;this._timelineDirty=true};Object.defineProperty(a.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isFadeComplete",{get:function(){return this._fadeState===0},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isPlaying",{get:function(){return(this._playheadState&2)!==0&&this._actionTimeline.playState<=0},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"totalTime",{get:function(){return this._duration},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if(t<0||this._duration<t){t=t%this._duration+e*this._duration;if(t<0){t+=this._duration}}if(this.playTimes>0&&e===this.playTimes-1&&t===this._duration){t=this._duration-1e-6}if(this._time===t){return}this._time=t;this._actionTimeline.setCurrentTime(this._time);if(this._zOrderTimeline!==null){this._zOrderTimeline.playState=-1}for(var i=0,a=this._boneTimelines;i<a.length;i++){var r=a[i];r.playState=-1}for(var n=0,s=this._slotTimelines;n<s.length;n++){var r=s[n];r.playState=-1}},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"animationData",{get:function(){return this._animationData},enumerable:true,configurable:true});return a}(t.BaseObject);t.AnimationState=e;var i=function(e){__extends(i,e);function i(){var i=e!==null&&e.apply(this,arguments)||this;i.current=new t.Transform;i.delta=new t.Transform;i.result=new t.Transform;return i}i.toString=function(){return"[class dragonBones.BonePose]"};i.prototype._onClear=function(){this.current.identity();this.delta.identity();this.result.identity()};return i}(t.BaseObject);t.BonePose=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.playState=-1;this.currentPlayTimes=-1;this.currentTime=-1;this._tweenState=0;this._frameRate=0;this._frameValueOffset=0;this._frameCount=0;this._frameOffset=0;this._frameIndex=-1;this._frameRateR=0;this._position=0;this._duration=0;this._timeScale=1;this._timeOffset=0;this._dragonBonesData=null;this._animationData=null;this._timelineData=null;this._armature=null;this._animationState=null;this._actionTimeline=null;this._frameArray=null;this._frameIntArray=null;this._frameFloatArray=null;this._timelineArray=null;this._frameIndices=null};e.prototype._setCurrentTime=function(t){var e=this.playState;var i=this.currentPlayTimes;var a=this.currentTime;if(this._actionTimeline!==null&&this._frameCount<=1){this.playState=this._actionTimeline.playState>=0?1:-1;this.currentPlayTimes=1;this.currentTime=this._actionTimeline.currentTime}else if(this._actionTimeline===null||this._timeScale!==1||this._timeOffset!==0){var r=this._animationState.playTimes;var n=r*this._duration;t*=this._timeScale;if(this._timeOffset!==0){t+=this._timeOffset*this._animationData.duration}if(r>0&&(t>=n||t<=-n)){if(this.playState<=0&&this._animationState._playheadState===3){this.playState=1}this.currentPlayTimes=r;if(t<0){this.currentTime=0}else{this.currentTime=this._duration}}else{if(this.playState!==0&&this._animationState._playheadState===3){this.playState=0}if(t<0){t=-t;this.currentPlayTimes=Math.floor(t/this._duration);this.currentTime=this._duration-t%this._duration}else{this.currentPlayTimes=Math.floor(t/this._duration);this.currentTime=t%this._duration}}this.currentTime+=this._position}else{this.playState=this._actionTimeline.playState;this.currentPlayTimes=this._actionTimeline.currentPlayTimes;this.currentTime=this._actionTimeline.currentTime}if(this.currentPlayTimes===i&&this.currentTime===a){return false}if(e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==i){this._frameIndex=-1}return true};e.prototype.init=function(t,e,i){this._armature=t;this._animationState=e;this._timelineData=i;this._actionTimeline=this._animationState._actionTimeline;if(this===this._actionTimeline){this._actionTimeline=null}this._animationData=this._animationState._animationData;this._frameRate=this._animationData.parent.frameRate;this._frameRateR=1/this._frameRate;this._position=this._animationState._position;this._duration=this._animationState._duration;this._dragonBonesData=this._animationData.parent.parent;if(this._timelineData!==null){this._frameIntArray=this._dragonBonesData.frameIntArray;this._frameFloatArray=this._dragonBonesData.frameFloatArray;this._frameArray=this._dragonBonesData.frameArray;this._timelineArray=this._dragonBonesData.timelineArray;this._frameIndices=this._dragonBonesData.frameIndices;this._frameCount=this._timelineArray[this._timelineData.offset+2];this._frameValueOffset=this._timelineArray[this._timelineData.offset+4];this._timeScale=100/this._timelineArray[this._timelineData.offset+0];this._timeOffset=this._timelineArray[this._timelineData.offset+1]*.01}};e.prototype.fadeOut=function(){};e.prototype.update=function(t){if(this._setCurrentTime(t)){if(this._frameCount>1){var e=Math.floor(this.currentTime*this._frameRate);var i=this._frameIndices[this._timelineData.frameIndicesOffset+e];if(this._frameIndex!==i){this._frameIndex=i;this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex];this._onArriveAtFrame()}}else if(this._frameIndex<0){this._frameIndex=0;if(this._timelineData!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]}this._onArriveAtFrame()}if(this._tweenState!==0){this._onUpdateFrame()}}};return e}(t.BaseObject);t.TimelineState=e;var i=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e._getEasingValue=function(t,e,i){var a=e;switch(t){case 3:a=Math.pow(e,2);break;case 4:a=1-Math.pow(1-e,2);break;case 5:a=.5*(1-Math.cos(e*Math.PI));break}return(a-e)*i+e};e._getEasingCurveValue=function(t,e,i,a){if(t<=0){return 0}else if(t>=1){return 1}var r=i+1;var n=Math.floor(t*r);var s=n===0?0:e[a+n-1];var o=n===r-1?1e4:e[a+n];return(s+(o-s)*(t*r-n))*1e-4};e.prototype._onClear=function(){t.prototype._onClear.call(this);this._tweenType=0;this._curveCount=0;this._framePosition=0;this._frameDurationR=0;this._tweenProgress=0;this._tweenEasing=0};e.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||this._animationState.playTimes===0||this._animationState.currentPlayTimes<this._animationState.playTimes-1)){this._tweenType=this._frameArray[this._frameOffset+1];this._tweenState=this._tweenType===0?1:2;if(this._tweenType===2){this._curveCount=this._frameArray[this._frameOffset+2]}else if(this._tweenType!==0&&this._tweenType!==1){this._tweenEasing=this._frameArray[this._frameOffset+2]*.01}this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR;if(this._frameIndex===this._frameCount-1){this._frameDurationR=1/(this._animationData.duration-this._framePosition)}else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1];var e=this._frameArray[t]*this._frameRateR-this._framePosition;if(e>0){this._frameDurationR=1/e}else{this._frameDurationR=0}}}else{this._tweenState=1}};e.prototype._onUpdateFrame=function(){if(this._tweenState===2){this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR;if(this._tweenType===2){this._tweenProgress=e._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3)}else if(this._tweenType!==1){this._tweenProgress=e._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)}}else{this._tweenProgress=0}};return e}(e);t.TweenTimelineState=i;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){t.prototype._onClear.call(this);this.bone=null;this.bonePose=null};return e}(i);t.BoneTimelineState=a;var r=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){t.prototype._onClear.call(this);this.slot=null};return e}(i);t.SlotTimelineState=r;var n=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){t.prototype._onClear.call(this);this.constraint=null};return e}(i);t.ConstraintTimelineState=n})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.toString=function(){return"[class dragonBones.ActionTimelineState]"};i.prototype._onCrossFrame=function(e){var i=this._armature.eventDispatcher;if(this._animationState.actionEnabled){var a=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+e];var r=this._frameArray[a+1];var n=this._animationData.parent.actions;for(var s=0;s<r;++s){var o=this._frameArray[a+2+s];var l=n[o];if(l.type===0){if(l.slot!==null){var h=this._armature.getSlot(l.slot.name);if(h!==null){var u=h.childArmature;if(u!==null){u._bufferAction(l,true)}}}else if(l.bone!==null){for(var f=0,_=this._armature.getSlots();f<_.length;f++){var h=_[f];var u=h.childArmature;if(u!==null&&h.parent._boneData===l.bone){u._bufferAction(l,true)}}}else{this._armature._bufferAction(l,true)}}else{var c=l.type===10?t.EventObject.FRAME_EVENT:t.EventObject.SOUND_EVENT;if(l.type===11||i.hasDBEventListener(c)){var p=t.BaseObject.borrowObject(t.EventObject);p.time=this._frameArray[a]/this._frameRate;p.type=c;p.name=l.name;p.data=l.data;p.armature=this._armature;p.animationState=this._animationState;if(l.bone!==null){p.bone=this._armature.getBone(l.bone.name)}if(l.slot!==null){p.slot=this._armature.getSlot(l.slot.name)}this._armature._dragonBones.bufferEvent(p)}}}}};i.prototype._onArriveAtFrame=function(){};i.prototype._onUpdateFrame=function(){};i.prototype.update=function(e){var i=this.playState;var a=this.currentPlayTimes;var r=this.currentTime;if(this._setCurrentTime(e)){var n=this._armature.eventDispatcher;if(i<0){if(this.playState!==i){if(this._animationState.displayControl&&this._animationState.resetToPose){this._armature._sortZOrder(null,0)}a=this.currentPlayTimes;if(n.hasDBEventListener(t.EventObject.START)){var s=t.BaseObject.borrowObject(t.EventObject);s.type=t.EventObject.START;s.armature=this._armature;s.animationState=this._animationState;this._armature._dragonBones.bufferEvent(s)}}else{return}}var o=this._animationState.timeScale<0;var l=null;var h=null;if(this.currentPlayTimes!==a){if(n.hasDBEventListener(t.EventObject.LOOP_COMPLETE)){l=t.BaseObject.borrowObject(t.EventObject);l.type=t.EventObject.LOOP_COMPLETE;l.armature=this._armature;l.animationState=this._animationState}if(this.playState>0){if(n.hasDBEventListener(t.EventObject.COMPLETE)){h=t.BaseObject.borrowObject(t.EventObject);h.type=t.EventObject.COMPLETE;h.armature=this._armature;h.animationState=this._animationState}}}if(this._frameCount>1){var u=this._timelineData;var f=Math.floor(this.currentTime*this._frameRate);var _=this._frameIndices[u.frameIndicesOffset+f];if(this._frameIndex!==_){var c=this._frameIndex;this._frameIndex=_;if(this._timelineArray!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[u.offset+5+this._frameIndex];if(o){if(c<0){var p=Math.floor(r*this._frameRate);c=this._frameIndices[u.frameIndicesOffset+p];if(this.currentPlayTimes===a){if(c===_){c=-1}}}while(c>=0){var m=this._animationData.frameOffset+this._timelineArray[u.offset+5+c];var d=this._frameArray[m]/this._frameRate;if(this._position<=d&&d<=this._position+this._duration){this._onCrossFrame(c)}if(l!==null&&c===0){this._armature._dragonBones.bufferEvent(l);l=null}if(c>0){c--}else{c=this._frameCount-1}if(c===_){break}}}else{if(c<0){var p=Math.floor(r*this._frameRate);c=this._frameIndices[u.frameIndicesOffset+p];var m=this._animationData.frameOffset+this._timelineArray[u.offset+5+c];var d=this._frameArray[m]/this._frameRate;if(this.currentPlayTimes===a){if(r<=d){if(c>0){c--}else{c=this._frameCount-1}}else if(c===_){c=-1}}}while(c>=0){if(c<this._frameCount-1){c++}else{c=0}var m=this._animationData.frameOffset+this._timelineArray[u.offset+5+c];var d=this._frameArray[m]/this._frameRate;if(this._position<=d&&d<=this._position+this._duration){this._onCrossFrame(c)}if(l!==null&&c===0){this._armature._dragonBones.bufferEvent(l);l=null}if(c===_){break}}}}}}else if(this._frameIndex<0){this._frameIndex=0;if(this._timelineData!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];var d=this._frameArray[this._frameOffset]/this._frameRate;if(this.currentPlayTimes===a){if(r<=d){this._onCrossFrame(this._frameIndex)}}else if(this._position<=d){if(!o&&l!==null){this._armature._dragonBones.bufferEvent(l);l=null}this._onCrossFrame(this._frameIndex)}}}if(l!==null){this._armature._dragonBones.bufferEvent(l)}if(h!==null){this._armature._dragonBones.bufferEvent(h)}}};i.prototype.setCurrentTime=function(t){this._setCurrentTime(t);this._frameIndex=-1};return i}(t.TimelineState);t.ActionTimelineState=e;var i=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"};e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this._frameArray[this._frameOffset+1];if(t>0){this._armature._sortZOrder(this._frameArray,this._frameOffset+2)}else{this._armature._sortZOrder(null,0)}}};e.prototype._onUpdateFrame=function(){};return e}(t.TimelineState);t.ZOrderTimelineState=i;var a=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.toString=function(){return"[class dragonBones.BoneAllTimelineState]"};i.prototype._onArriveAtFrame=function(){e.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var t=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*6;var i=this._armature._armatureData.scale;var a=this._frameFloatArray;var r=this.bonePose.current;var n=this.bonePose.delta;r.x=a[t++]*i;r.y=a[t++]*i;r.rotation=a[t++];r.skew=a[t++];r.scaleX=a[t++];r.scaleY=a[t++];if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){t=this._animationData.frameFloatOffset+this._frameValueOffset}n.x=a[t++]*i-r.x;n.y=a[t++]*i-r.y;n.rotation=a[t++]-r.rotation;n.skew=a[t++]-r.skew;n.scaleX=a[t++]-r.scaleX;n.scaleY=a[t++]-r.scaleY}else{n.x=0;n.y=0;n.rotation=0;n.skew=0;n.scaleX=0;n.scaleY=0}}else{var r=this.bonePose.current;var n=this.bonePose.delta;r.x=0;r.y=0;r.rotation=0;r.skew=0;r.scaleX=1;r.scaleY=1;n.x=0;n.y=0;n.rotation=0;n.skew=0;n.scaleX=0;n.scaleY=0}};i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current;var i=this.bonePose.delta;var a=this.bonePose.result;this.bone._transformDirty=true;if(this._tweenState!==2){this._tweenState=0}a.x=t.x+i.x*this._tweenProgress;a.y=t.y+i.y*this._tweenProgress;a.rotation=t.rotation+i.rotation*this._tweenProgress;a.skew=t.skew+i.skew*this._tweenProgress;a.scaleX=t.scaleX+i.scaleX*this._tweenProgress;a.scaleY=t.scaleY+i.scaleY*this._tweenProgress};i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation);e.skew=t.Transform.normalizeRadian(e.skew)};return i}(t.BoneTimelineState);t.BoneAllTimelineState=a;var r=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"};e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*2;var i=this._armature._armatureData.scale;var a=this._frameFloatArray;var r=this.bonePose.current;var n=this.bonePose.delta;r.x=a[e++]*i;r.y=a[e++]*i;if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){e=this._animationData.frameFloatOffset+this._frameValueOffset}n.x=a[e++]*i-r.x;n.y=a[e++]*i-r.y}else{n.x=0;n.y=0}}else{var r=this.bonePose.current;var n=this.bonePose.delta;r.x=0;r.y=0;n.x=0;n.y=0}};e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current;var i=this.bonePose.delta;var a=this.bonePose.result;this.bone._transformDirty=true;if(this._tweenState!==2){this._tweenState=0}a.x=e.x+i.x*this._tweenProgress;a.y=e.y+i.y*this._tweenProgress};return e}(t.BoneTimelineState);t.BoneTranslateTimelineState=r;var n=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"};i.prototype._onArriveAtFrame=function(){e.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var t=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*2;var i=this._frameFloatArray;var a=this.bonePose.current;var r=this.bonePose.delta;a.rotation=i[t++];a.skew=i[t++];if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){t=this._animationData.frameFloatOffset+this._frameValueOffset}r.rotation=i[t++]-a.rotation;r.skew=i[t++]-a.skew}else{r.rotation=0;r.skew=0}}else{var a=this.bonePose.current;var r=this.bonePose.delta;a.rotation=0;a.skew=0;r.rotation=0;r.skew=0}};i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current;var i=this.bonePose.delta;var a=this.bonePose.result;this.bone._transformDirty=true;if(this._tweenState!==2){this._tweenState=0}a.rotation=t.rotation+i.rotation*this._tweenProgress;a.skew=t.skew+i.skew*this._tweenProgress};i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation);e.skew=t.Transform.normalizeRadian(e.skew)};return i}(t.BoneTimelineState);t.BoneRotateTimelineState=n;var s=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"};e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*2;var i=this._frameFloatArray;var a=this.bonePose.current;var r=this.bonePose.delta;a.scaleX=i[e++];a.scaleY=i[e++];if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){e=this._animationData.frameFloatOffset+this._frameValueOffset}r.scaleX=i[e++]-a.scaleX;r.scaleY=i[e++]-a.scaleY}else{r.scaleX=0;r.scaleY=0}}else{var a=this.bonePose.current;var r=this.bonePose.delta;a.scaleX=1;a.scaleY=1;r.scaleX=0;r.scaleY=0}};e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current;var i=this.bonePose.delta;var a=this.bonePose.result;this.bone._transformDirty=true;if(this._tweenState!==2){this._tweenState=0}a.scaleX=e.scaleX+i.scaleX*this._tweenProgress;a.scaleY=e.scaleY+i.scaleY*this._tweenProgress};return e}(t.BoneTimelineState);t.BoneScaleTimelineState=s;var o=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.SlotDislayTimelineState]"};e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this._timelineData!==null?this._frameArray[this._frameOffset+1]:this.slot._slotData.displayIndex;if(this.slot.displayIndex!==t){this.slot._setDisplayIndex(t,true)}}};return e}(t.SlotTimelineState);t.SlotDislayTimelineState=o;var l=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._current=[0,0,0,0,0,0,0,0];e._delta=[0,0,0,0,0,0,0,0];e._result=[0,0,0,0,0,0,0,0];return e}e.toString=function(){return"[class dragonBones.SlotColorTimelineState]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this._dirty=false};e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var e=this._dragonBonesData.intArray;var i=this._frameIntArray;var a=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex*1;var r=i[a];if(r<0){r+=32767}this._current[0]=e[r++];this._current[1]=e[r++];this._current[2]=e[r++];this._current[3]=e[r++];this._current[4]=e[r++];this._current[5]=e[r++];this._current[6]=e[r++];this._current[7]=e[r++];if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){r=i[this._animationData.frameIntOffset+this._frameValueOffset]}else{r=i[a+1*1]}if(r<0){r+=32767}this._delta[0]=e[r++]-this._current[0];this._delta[1]=e[r++]-this._current[1];this._delta[2]=e[r++]-this._current[2];this._delta[3]=e[r++]-this._current[3];this._delta[4]=e[r++]-this._current[4];this._delta[5]=e[r++]-this._current[5];this._delta[6]=e[r++]-this._current[6];this._delta[7]=e[r++]-this._current[7]}}else{var n=this.slot._slotData.color;this._current[0]=n.alphaMultiplier*100;this._current[1]=n.redMultiplier*100;this._current[2]=n.greenMultiplier*100;this._current[3]=n.blueMultiplier*100;this._current[4]=n.alphaOffset;this._current[5]=n.redOffset;this._current[6]=n.greenOffset;this._current[7]=n.blueOffset}};e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);this._dirty=true;if(this._tweenState!==2){this._tweenState=0}this._result[0]=(this._current[0]+this._delta[0]*this._tweenProgress)*.01;this._result[1]=(this._current[1]+this._delta[1]*this._tweenProgress)*.01;this._result[2]=(this._current[2]+this._delta[2]*this._tweenProgress)*.01;this._result[3]=(this._current[3]+this._delta[3]*this._tweenProgress)*.01;this._result[4]=this._current[4]+this._delta[4]*this._tweenProgress;this._result[5]=this._current[5]+this._delta[5]*this._tweenProgress;this._result[6]=this._current[6]+this._delta[6]*this._tweenProgress;this._result[7]=this._current[7]+this._delta[7]*this._tweenProgress};e.prototype.fadeOut=function(){this._tweenState=0;this._dirty=false};e.prototype.update=function(e){t.prototype.update.call(this,e);if(this._tweenState!==0||this._dirty){var i=this.slot._colorTransform;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){if(i.alphaMultiplier!==this._result[0]||i.redMultiplier!==this._result[1]||i.greenMultiplier!==this._result[2]||i.blueMultiplier!==this._result[3]||i.alphaOffset!==this._result[4]||i.redOffset!==this._result[5]||i.greenOffset!==this._result[6]||i.blueOffset!==this._result[7]){var a=Math.pow(this._animationState._fadeProgress,4);i.alphaMultiplier+=(this._result[0]-i.alphaMultiplier)*a;i.redMultiplier+=(this._result[1]-i.redMultiplier)*a;i.greenMultiplier+=(this._result[2]-i.greenMultiplier)*a;i.blueMultiplier+=(this._result[3]-i.blueMultiplier)*a;i.alphaOffset+=(this._result[4]-i.alphaOffset)*a;i.redOffset+=(this._result[5]-i.redOffset)*a;i.greenOffset+=(this._result[6]-i.greenOffset)*a;i.blueOffset+=(this._result[7]-i.blueOffset)*a;this.slot._colorDirty=true}}else if(this._dirty){this._dirty=false;if(i.alphaMultiplier!==this._result[0]||i.redMultiplier!==this._result[1]||i.greenMultiplier!==this._result[2]||i.blueMultiplier!==this._result[3]||i.alphaOffset!==this._result[4]||i.redOffset!==this._result[5]||i.greenOffset!==this._result[6]||i.blueOffset!==this._result[7]){i.alphaMultiplier=this._result[0];i.redMultiplier=this._result[1];i.greenMultiplier=this._result[2];i.blueMultiplier=this._result[3];i.alphaOffset=this._result[4];i.redOffset=this._result[5];i.greenOffset=this._result[6];i.blueOffset=this._result[7];this.slot._colorDirty=true}}}};return e}(t.SlotTimelineState);t.SlotColorTimelineState=l;var h=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._current=[];e._delta=[];e._result=[];return e}e.toString=function(){return"[class dragonBones.SlotFFDTimelineState]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.meshOffset=0;this._dirty=false;this._frameFloatOffset=0;this._valueCount=0;this._ffdCount=0;this._valueOffset=0;this._current.length=0;this._delta.length=0;this._result.length=0};e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount;var i=this._armature._armatureData.scale;var a=this._frameFloatArray;if(this._tweenState===2){var r=e+this._valueCount;if(this._frameIndex===this._frameCount-1){r=this._animationData.frameFloatOffset+this._frameValueOffset}for(var n=0;n<this._valueCount;++n){this._delta[n]=a[r+n]*i-(this._current[n]=a[e+n]*i)}}else{for(var n=0;n<this._valueCount;++n){this._current[n]=a[e+n]*i}}}else{for(var n=0;n<this._valueCount;++n){this._current[n]=0}}};e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);this._dirty=true;if(this._tweenState!==2){this._tweenState=0}for(var e=0;e<this._valueCount;++e){this._result[e]=this._current[e]+this._delta[e]*this._tweenProgress}};e.prototype.init=function(e,i,a){t.prototype.init.call(this,e,i,a);if(this._timelineData!==null){var r=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this.meshOffset=this._frameIntArray[r+0];this._ffdCount=this._frameIntArray[r+1];this._valueCount=this._frameIntArray[r+2];this._valueOffset=this._frameIntArray[r+3];this._frameFloatOffset=this._frameIntArray[r+4]+this._animationData.frameFloatOffset}else{this._valueCount=0}this._current.length=this._valueCount;this._delta.length=this._valueCount;this._result.length=this._valueCount;for(var n=0;n<this._valueCount;++n){this._delta[n]=0}};e.prototype.fadeOut=function(){this._tweenState=0;this._dirty=false};e.prototype.update=function(e){if(this.slot._meshData===null||this.slot._meshData.offset!==this.meshOffset){return}t.prototype.update.call(this,e);if(this._tweenState!==0||this._dirty){var i=this.slot._ffdVertices;if(this._timelineData!==null){if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){var a=Math.pow(this._animationState._fadeProgress,2);for(var r=0;r<this._ffdCount;++r){if(r<this._valueOffset){i[r]+=(this._frameFloatArray[this._frameFloatOffset+r]-i[r])*a}else if(r<this._valueOffset+this._valueCount){i[r]+=(this._result[r-this._valueOffset]-i[r])*a}else{i[r]+=(this._frameFloatArray[this._frameFloatOffset+r-this._valueCount]-i[r])*a}}this.slot._meshDirty=true}else if(this._dirty){this._dirty=false;for(var r=0;r<this._ffdCount;++r){if(r<this._valueOffset){i[r]=this._frameFloatArray[this._frameFloatOffset+r]}else if(r<this._valueOffset+this._valueCount){i[r]=this._result[r-this._valueOffset]}else{i[r]=this._frameFloatArray[this._frameFloatOffset+r-this._valueCount]}}this.slot._meshDirty=true}}else{this._ffdCount=i.length;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){var a=Math.pow(this._animationState._fadeProgress,2);for(var r=0;r<this._ffdCount;++r){i[r]+=(0-i[r])*a}this.slot._meshDirty=true}else if(this._dirty){this._dirty=false;for(var r=0;r<this._ffdCount;++r){i[r]=0}this.slot._meshDirty=true}}}};return e}(t.SlotTimelineState);t.SlotFFDTimelineState=h;var u=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this._current=0;this._delta=0};e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);var e=this.constraint;if(this._timelineData!==null){var i=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex*2;var a=this._frameIntArray;var r=a[i++]!==0;this._current=a[i++]*.01;if(this._tweenState===2){if(this._frameIndex===this._frameCount-1){i=this._animationData.frameIntOffset+this._frameValueOffset}this._delta=a[i+1]*.01-this._current}else{this._delta=0}e._bendPositive=r}else{var n=e._constraintData;this._current=n.weight;this._delta=0;e._bendPositive=n.bendPositive}e.invalidUpdate()};e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);if(this._tweenState!==2){this._tweenState=0}var e=this.constraint;e._weight=this._current+this._delta*this._tweenProgress;e.invalidUpdate()};return e}(t.ConstraintTimelineState);t.IKConstraintTimelineState=u})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.EventObject]"};e.prototype._onClear=function(){this.time=0;this.type="";this.name="";this.armature=null;this.bone=null;this.slot=null;this.animationState=null;this.data=null};e.START="start";e.LOOP_COMPLETE="loopComplete";e.COMPLETE="complete";e.FADE_IN="fadeIn";e.FADE_IN_COMPLETE="fadeInComplete";e.FADE_OUT="fadeOut";e.FADE_OUT_COMPLETE="fadeOutComplete";e.FRAME_EVENT="frameEvent";e.SOUND_EVENT="soundEvent";return e}(t.BaseObject);t.EventObject=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function e(){}e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}};e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;default:return 0}};e._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}};e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}};e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}};e.parseDragonBonesData=function(e){if(e instanceof ArrayBuffer){return t.BinaryDataParser.getInstance().parseDragonBonesData(e)}else{return t.ObjectDataParser.getInstance().parseDragonBonesData(e)}};e.parseTextureAtlasData=function(i,a){if(a===void 0){a=1}console.warn("");var r={};var n=i[e.SUB_TEXTURE];for(var s=0,o=n.length;s<o;s++){var l=n[s];var h=l[e.NAME];var u=new t.Rectangle;var f=null;u.x=l[e.X]/a;u.y=l[e.Y]/a;u.width=l[e.WIDTH]/a;u.height=l[e.HEIGHT]/a;if(e.FRAME_WIDTH in l){f=new t.Rectangle;f.x=l[e.FRAME_X]/a;f.y=l[e.FRAME_Y]/a;f.width=l[e.FRAME_WIDTH]/a;f.height=l[e.FRAME_HEIGHT]/a}r[h]={region:u,frame:f,rotated:false}}return r};e.DATA_VERSION_2_3="2.3";e.DATA_VERSION_3_0="3.0";e.DATA_VERSION_4_0="4.0";e.DATA_VERSION_4_5="4.5";e.DATA_VERSION_5_0="5.0";e.DATA_VERSION_5_5="5.5";e.DATA_VERSION=e.DATA_VERSION_5_5;e.DATA_VERSIONS=[e.DATA_VERSION_4_0,e.DATA_VERSION_4_5,e.DATA_VERSION_5_0,e.DATA_VERSION_5_5];e.TEXTURE_ATLAS="textureAtlas";e.SUB_TEXTURE="SubTexture";e.FORMAT="format";e.IMAGE_PATH="imagePath";e.WIDTH="width";e.HEIGHT="height";e.ROTATED="rotated";e.FRAME_X="frameX";e.FRAME_Y="frameY";e.FRAME_WIDTH="frameWidth";e.FRAME_HEIGHT="frameHeight";e.DRADON_BONES="dragonBones";e.USER_DATA="userData";e.ARMATURE="armature";e.BONE="bone";e.SLOT="slot";e.CONSTRAINT="constraint";e.IK="ik";e.SKIN="skin";e.DISPLAY="display";e.ANIMATION="animation";e.Z_ORDER="zOrder";e.FFD="ffd";e.FRAME="frame";e.TRANSLATE_FRAME="translateFrame";e.ROTATE_FRAME="rotateFrame";e.SCALE_FRAME="scaleFrame";e.DISPLAY_FRAME="displayFrame";e.COLOR_FRAME="colorFrame";e.DEFAULT_ACTIONS="defaultActions";e.ACTIONS="actions";e.EVENTS="events";e.INTS="ints";e.FLOATS="floats";e.STRINGS="strings";e.CANVAS="canvas";e.TRANSFORM="transform";e.PIVOT="pivot";e.AABB="aabb";e.COLOR="color";e.VERSION="version";e.COMPATIBLE_VERSION="compatibleVersion";e.FRAME_RATE="frameRate";e.TYPE="type";e.SUB_TYPE="subType";e.NAME="name";e.PARENT="parent";e.TARGET="target";e.STAGE="stage";e.SHARE="share";e.PATH="path";e.LENGTH="length";e.DISPLAY_INDEX="displayIndex";e.BLEND_MODE="blendMode";e.INHERIT_TRANSLATION="inheritTranslation";e.INHERIT_ROTATION="inheritRotation";e.INHERIT_SCALE="inheritScale";e.INHERIT_REFLECTION="inheritReflection";e.INHERIT_ANIMATION="inheritAnimation";e.INHERIT_FFD="inheritFFD";e.BEND_POSITIVE="bendPositive";e.CHAIN="chain";e.WEIGHT="weight";e.FADE_IN_TIME="fadeInTime";e.PLAY_TIMES="playTimes";e.SCALE="scale";e.OFFSET="offset";e.POSITION="position";e.DURATION="duration";e.TWEEN_EASING="tweenEasing";e.TWEEN_ROTATE="tweenRotate";e.TWEEN_SCALE="tweenScale";e.CLOCK_WISE="clockwise";e.CURVE="curve";e.SOUND="sound";e.EVENT="event";e.ACTION="action";e.X="x";e.Y="y";e.SKEW_X="skX";e.SKEW_Y="skY";e.SCALE_X="scX";e.SCALE_Y="scY";e.VALUE="value";e.ROTATE="rotate";e.SKEW="skew";e.ALPHA_OFFSET="aO";e.RED_OFFSET="rO";e.GREEN_OFFSET="gO";e.BLUE_OFFSET="bO";e.ALPHA_MULTIPLIER="aM";e.RED_MULTIPLIER="rM";e.GREEN_MULTIPLIER="gM";e.BLUE_MULTIPLIER="bM";e.UVS="uvs";e.VERTICES="vertices";e.TRIANGLES="triangles";e.WEIGHTS="weights";e.SLOT_POSE="slotPose";e.BONE_POSE="bonePose";e.GOTO_AND_PLAY="gotoAndPlay";e.DEFAULT_NAME="default";return e}();t.DataParser=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(a,e);function a(){var i=e!==null&&e.apply(this,arguments)||this;i._rawTextureAtlasIndex=0;i._rawBones=[];i._data=null;i._armature=null;i._bone=null;i._slot=null;i._skin=null;i._mesh=null;i._animation=null;i._timeline=null;i._rawTextureAtlases=null;i._defaultColorOffset=-1;i._prevClockwise=0;i._prevRotation=0;i._helpMatrixA=new t.Matrix;i._helpMatrixB=new t.Matrix;i._helpTransform=new t.Transform;i._helpColorTransform=new t.ColorTransform;i._helpPoint=new t.Point;i._helpArray=[];i._intArray=[];i._floatArray=[];i._frameIntArray=[];i._frameFloatArray=[];i._frameArray=[];i._timelineArray=[];i._actionFrames=[];i._weightSlotPose={};i._weightBonePoses={};i._cacheBones={};i._cacheMeshs={};i._slotChildActions={};return i}a._getBoolean=function(t,e,i){if(e in t){var a=t[e];var r=typeof a;if(r==="boolean"){return a}else if(r==="string"){switch(a){case"0":case"NaN":case"":case"false":case"null":case"undefined":return false;default:return true}}else{return!!a}}return i};a._getNumber=function(t,e,i){if(e in t){var a=t[e];if(a===null||a==="NaN"){return i}return+a||0}return i};a._getString=function(e,i,a){if(i in e){var r=e[i];var n=typeof r;if(n==="string"){if(t.DragonBones.webAssembly){for(var s=0,o=r.length;s<o;++s){if(r.charCodeAt(s)>255){return encodeURI(r)}}}return r}return String(r)}return a};a.prototype._getCurvePoint=function(t,e,i,a,r,n,s,o,l,h){var u=1-l;var f=u*u;var _=l*l;var c=u*f;var p=3*l*f;var m=3*u*_;var d=l*_;h.x=c*t+p*i+m*r+d*s;h.y=c*e+p*a+m*n+d*o};a.prototype._samplingEasingCurve=function(t,e){var i=t.length;var a=-2;for(var r=0,n=e.length;r<n;++r){var s=(r+1)/(n+1);while((a+6<i?t[a+6]:1)<s){a+=6}var o=a>=0&&a+6<i;var l=o?t[a]:0;var h=o?t[a+1]:0;var u=t[a+2];var f=t[a+3];var _=t[a+4];var c=t[a+5];var p=o?t[a+6]:1;var m=o?t[a+7]:1;var d=0;var y=1;while(y-d>1e-4){var g=(y+d)*.5;this._getCurvePoint(l,h,u,f,_,c,p,m,g,this._helpPoint);if(s-this._helpPoint.x>0){d=g}else{y=g}}e[r]=this._helpPoint.y}};a.prototype._parseActionDataInFrame=function(t,e,i,r){if(a.EVENT in t){this._mergeActionFrame(t[a.EVENT],e,10,i,r)}if(a.SOUND in t){this._mergeActionFrame(t[a.SOUND],e,11,i,r)}if(a.ACTION in t){this._mergeActionFrame(t[a.ACTION],e,0,i,r)}if(a.EVENTS in t){this._mergeActionFrame(t[a.EVENTS],e,10,i,r)}if(a.ACTIONS in t){this._mergeActionFrame(t[a.ACTIONS],e,0,i,r)}};a.prototype._mergeActionFrame=function(e,a,r,n,s){var o=t.DragonBones.webAssembly?this._armature.actions.size():this._armature.actions.length;var l=this._parseActionData(e,r,n,s);var h=0;var u=null;for(var f=0,_=l;f<_.length;f++){var c=_[f];this._armature.addAction(c,false)}if(this._actionFrames.length===0){u=new i;u.frameStart=0;this._actionFrames.push(u);u=null}for(var p=0,m=this._actionFrames;p<m.length;p++){var d=m[p];if(d.frameStart===a){u=d;break}else if(d.frameStart>a){break}h++}if(u===null){u=new i;u.frameStart=a;this._actionFrames.splice(h+1,0,u)}for(var y=0;y<l.length;++y){u.actions.push(o+y)}};a.prototype._parseArmature=function(e,i){var r=t.BaseObject.borrowObject(t.ArmatureData);r.name=a._getString(e,a.NAME,"");r.frameRate=a._getNumber(e,a.FRAME_RATE,this._data.frameRate);r.scale=i;if(a.TYPE in e&&typeof e[a.TYPE]==="string"){r.type=a._getArmatureType(e[a.TYPE])}else{r.type=a._getNumber(e,a.TYPE,0)}if(r.frameRate===0){r.frameRate=24}this._armature=r;if(a.CANVAS in e){var n=e[a.CANVAS];var s=t.BaseObject.borrowObject(t.CanvasData);if(a.COLOR in n){s.hasBackground=true}else{s.hasBackground=false}s.color=a._getNumber(n,a.COLOR,0);s.x=a._getNumber(n,a.X,0)*r.scale;s.y=a._getNumber(n,a.Y,0)*r.scale;s.width=a._getNumber(n,a.WIDTH,0)*r.scale;s.height=a._getNumber(n,a.HEIGHT,0)*r.scale;r.canvas=s}if(a.AABB in e){var o=e[a.AABB];r.aabb.x=a._getNumber(o,a.X,0)*r.scale;r.aabb.y=a._getNumber(o,a.Y,0)*r.scale;r.aabb.width=a._getNumber(o,a.WIDTH,0)*r.scale;r.aabb.height=a._getNumber(o,a.HEIGHT,0)*r.scale}if(a.BONE in e){var l=e[a.BONE];for(var h=0,u=l;h<u.length;h++){var f=u[h];var _=a._getString(f,a.PARENT,"");var c=this._parseBone(f);if(_.length>0){var p=r.getBone(_);if(p!==null){c.parent=p}else{if(!(_ in this._cacheBones)){this._cacheBones[_]=[]}this._cacheBones[_].push(c)}}if(c.name in this._cacheBones){for(var m=0,d=this._cacheBones[c.name];m<d.length;m++){var y=d[m];y.parent=c}delete this._cacheBones[c.name]}r.addBone(c);this._rawBones.push(c)}}if(a.IK in e){var g=e[a.IK];for(var v=0,b=g;v<b.length;v++){var T=b[v];var D=this._parseIKConstraint(T);if(D){r.addConstraint(D)}}}r.sortBones();if(a.SLOT in e){var A=0;var x=e[a.SLOT];for(var O=0,S=x;O<S.length;O++){var E=S[O];r.addSlot(this._parseSlot(E,A++))}}if(a.SKIN in e){var B=e[a.SKIN];for(var M=0,w=B;M<w.length;M++){var P=w[M];r.addSkin(this._parseSkin(P))}}for(var C in this._cacheMeshs){var I=r.getSkin(C);if(I===null){continue}var F=this._cacheMeshs[C];for(var N in F){var R=F[N];for(var j in R){var k=I.getDisplay(N,j);if(k===null){continue}for(var L=0,U=R[j];L<U.length;L++){var Y=U[L];Y.offset=k.offset;Y.weight=k.weight}}}}if(a.ANIMATION in e){var V=e[a.ANIMATION];for(var $=0,X=V;$<X.length;$++){var H=X[$];var W=this._parseAnimation(H);r.addAnimation(W)}}if(a.DEFAULT_ACTIONS in e){var z=this._parseActionData(e[a.DEFAULT_ACTIONS],0,null,null);for(var G=0,K=z;G<K.length;G++){var Z=K[G];r.addAction(Z,true);if(Z.type===0){var W=r.getAnimation(Z.name);if(W!==null){r.defaultAnimation=W}}}}if(a.ACTIONS in e){var z=this._parseActionData(e[a.ACTIONS],0,null,null);for(var q=0,J=z;q<J.length;q++){var Z=J[q];r.addAction(Z,false)}}this._rawBones.length=0;this._armature=null;for(var Q in this._weightSlotPose){delete this._weightSlotPose[Q]}for(var Q in this._weightBonePoses){delete this._weightBonePoses[Q]}for(var Q in this._cacheMeshs){delete this._cacheMeshs[Q]}for(var Q in this._cacheBones){delete this._cacheBones[Q]}for(var Q in this._slotChildActions){delete this._slotChildActions[Q]}return r};a.prototype._parseBone=function(e){var i=t.BaseObject.borrowObject(t.BoneData);i.inheritTranslation=a._getBoolean(e,a.INHERIT_TRANSLATION,true);i.inheritRotation=a._getBoolean(e,a.INHERIT_ROTATION,true);i.inheritScale=a._getBoolean(e,a.INHERIT_SCALE,true);i.inheritReflection=a._getBoolean(e,a.INHERIT_REFLECTION,true);i.length=a._getNumber(e,a.LENGTH,0)*this._armature.scale;i.name=a._getString(e,a.NAME,"");if(a.TRANSFORM in e){this._parseTransform(e[a.TRANSFORM],i.transform,this._armature.scale)}return i};a.prototype._parseIKConstraint=function(e){var i=this._armature.getBone(a._getString(e,a.BONE,""));if(i===null){return null}var r=this._armature.getBone(a._getString(e,a.TARGET,""));if(r===null){return null}var n=t.BaseObject.borrowObject(t.IKConstraintData);n.scaleEnabled=a._getBoolean(e,a.SCALE,false);n.bendPositive=a._getBoolean(e,a.BEND_POSITIVE,true);n.weight=a._getNumber(e,a.WEIGHT,1);n.name=a._getString(e,a.NAME,"");n.bone=i;n.target=r;var s=a._getNumber(e,a.CHAIN,0);if(s>0){n.root=i.parent}return n};a.prototype._parseSlot=function(e,i){var r=t.BaseObject.borrowObject(t.SlotData);r.displayIndex=a._getNumber(e,a.DISPLAY_INDEX,0);r.zOrder=i;r.name=a._getString(e,a.NAME,"");r.parent=this._armature.getBone(a._getString(e,a.PARENT,""));if(a.BLEND_MODE in e&&typeof e[a.BLEND_MODE]==="string"){r.blendMode=a._getBlendMode(e[a.BLEND_MODE])}else{r.blendMode=a._getNumber(e,a.BLEND_MODE,0)}if(a.COLOR in e){r.color=t.SlotData.createColor();this._parseColorTransform(e[a.COLOR],r.color)}else{r.color=t.SlotData.DEFAULT_COLOR}if(a.ACTIONS in e){this._slotChildActions[r.name]=this._parseActionData(e[a.ACTIONS],0,null,null)}return r};a.prototype._parseSkin=function(e){var i=t.BaseObject.borrowObject(t.SkinData);i.name=a._getString(e,a.NAME,a.DEFAULT_NAME);if(i.name.length===0){i.name=a.DEFAULT_NAME}if(a.SLOT in e){var r=e[a.SLOT];this._skin=i;for(var n=0,s=r;n<s.length;n++){var o=s[n];var l=a._getString(o,a.NAME,"");var h=this._armature.getSlot(l);if(h!==null){this._slot=h;if(a.DISPLAY in o){var u=o[a.DISPLAY];for(var f=0,_=u;f<_.length;f++){var c=_[f];i.addDisplay(l,this._parseDisplay(c))}}this._slot=null}}this._skin=null}return i};a.prototype._parseDisplay=function(e){var i=a._getString(e,a.NAME,"");var r=a._getString(e,a.PATH,"");var n=0;var s=null;if(a.TYPE in e&&typeof e[a.TYPE]==="string"){n=a._getDisplayType(e[a.TYPE])}else{n=a._getNumber(e,a.TYPE,n)}switch(n){case 0:var o=s=t.BaseObject.borrowObject(t.ImageDisplayData);o.name=i;o.path=r.length>0?r:i;this._parsePivot(e,o);break;case 1:var l=s=t.BaseObject.borrowObject(t.ArmatureDisplayData);l.name=i;l.path=r.length>0?r:i;l.inheritAnimation=true;if(a.ACTIONS in e){var h=this._parseActionData(e[a.ACTIONS],0,null,null);for(var u=0,f=h;u<f.length;u++){var _=f[u];l.addAction(_)}}else if(this._slot.name in this._slotChildActions){var c=this._skin.getDisplays(this._slot.name);if(c===null?this._slot.displayIndex===0:this._slot.displayIndex===c.length){for(var p=0,m=this._slotChildActions[this._slot.name];p<m.length;p++){var _=m[p];l.addAction(_)}delete this._slotChildActions[this._slot.name]}}break;case 2:var d=a._getString(e,a.SHARE,"");var y=s=t.BaseObject.borrowObject(t.MeshDisplayData);y.name=i;y.path=r.length>0?r:i;y.inheritAnimation=a._getBoolean(e,a.INHERIT_FFD,true);this._parsePivot(e,y);if(d.length>0){var g=a._getString(e,a.SKIN,"");var v=this._slot.name;if(g.length===0){g=a.DEFAULT_NAME}if(!(g in this._cacheMeshs)){this._cacheMeshs[g]={}}var b=this._cacheMeshs[g];if(!(v in b)){b[v]={}}var T=b[v];if(!(d in T)){T[d]=[]}T[d].push(y)}else{this._parseMesh(e,y)}break;case 3:var D=this._parseBoundingBox(e);if(D!==null){var A=s=t.BaseObject.borrowObject(t.BoundingBoxDisplayData);A.name=i;A.path=r.length>0?r:i;A.boundingBox=D}break}if(s!==null){if(a.TRANSFORM in e){this._parseTransform(e[a.TRANSFORM],s.transform,this._armature.scale)}}return s};a.prototype._parsePivot=function(t,e){if(a.PIVOT in t){var i=t[a.PIVOT];e.pivot.x=a._getNumber(i,a.X,0);e.pivot.y=a._getNumber(i,a.Y,0)}else{e.pivot.x=.5;e.pivot.y=.5}};a.prototype._parseMesh=function(e,i){var r=e[a.VERTICES];var n=e[a.UVS];var s=e[a.TRIANGLES];var o=Math.floor(r.length/2);var l=Math.floor(s.length/3);var h=this._floatArray.length;var u=h+o*2;var f=this._intArray.length;i.offset=f;this._intArray.length+=1+1+1+1+l*3;this._intArray[f+0]=o;this._intArray[f+1]=l;this._intArray[f+2]=h;for(var _=0,c=l*3;_<c;++_){this._intArray[f+4+_]=s[_]}this._floatArray.length+=o*2+o*2;for(var _=0,c=o*2;_<c;++_){this._floatArray[h+_]=r[_];this._floatArray[u+_]=n[_]}if(a.WEIGHTS in e){var p=e[a.WEIGHTS];var m=e[a.SLOT_POSE];var d=e[a.BONE_POSE];var y=this._armature.sortedBones;var g=new Array;var v=Math.floor(d.length/7);var b=this._floatArray.length;var T=Math.floor(p.length-o)/2;var D=this._intArray.length;var A=t.BaseObject.borrowObject(t.WeightData);A.count=T;A.offset=D;g.length=v;this._intArray.length+=1+1+v+o+T;this._intArray[D+1]=b;for(var _=0;_<v;++_){var x=d[_*7];var O=this._rawBones[x];A.addBone(O);g[_]=x;this._intArray[D+2+_]=y.indexOf(O)}this._floatArray.length+=T*3;this._helpMatrixA.copyFromArray(m,0);for(var _=0,S=0,E=D+2+v,B=b;_<o;++_){var M=_*2;var w=this._intArray[E++]=p[S++];var P=this._floatArray[h+M];var C=this._floatArray[h+M+1];this._helpMatrixA.transformPoint(P,C,this._helpPoint);P=this._helpPoint.x;C=this._helpPoint.y;for(var I=0;I<w;++I){var x=p[S++];var F=g.indexOf(x);this._helpMatrixB.copyFromArray(d,F*7+1);this._helpMatrixB.invert();this._helpMatrixB.transformPoint(P,C,this._helpPoint);this._intArray[E++]=F;this._floatArray[B++]=p[S++];this._floatArray[B++]=this._helpPoint.x;this._floatArray[B++]=this._helpPoint.y}}i.weight=A;var N=this._skin.name+"_"+this._slot.name+"_"+i.name;this._weightSlotPose[N]=m;this._weightBonePoses[N]=d}};a.prototype._parseBoundingBox=function(e){var i=null;var r=0;if(a.SUB_TYPE in e&&typeof e[a.SUB_TYPE]==="string"){r=a._getBoundingBoxType(e[a.SUB_TYPE])}else{r=a._getNumber(e,a.SUB_TYPE,r)}switch(r){case 0:i=t.BaseObject.borrowObject(t.RectangleBoundingBoxData);break;case 1:i=t.BaseObject.borrowObject(t.EllipseBoundingBoxData);break;case 2:i=this._parsePolygonBoundingBox(e);break}if(i!==null){i.color=a._getNumber(e,a.COLOR,0);if(i.type===0||i.type===1){i.width=a._getNumber(e,a.WIDTH,0);i.height=a._getNumber(e,a.HEIGHT,0)}}return i};a.prototype._parsePolygonBoundingBox=function(e){var i=t.BaseObject.borrowObject(t.PolygonBoundingBoxData);if(a.VERTICES in e){var r=e[a.VERTICES];var n=i.vertices;if(t.DragonBones.webAssembly){n.resize(r.length,0)}else{n.length=r.length}for(var s=0,o=r.length;s<o;s+=2){var l=r[s];var h=r[s+1];if(t.DragonBones.webAssembly){n.set(s,l);n.set(s+1,h)}else{n[s]=l;n[s+1]=h}if(s===0){i.x=l;i.y=h;i.width=l;i.height=h}else{if(l<i.x){i.x=l}else if(l>i.width){i.width=l}if(h<i.y){i.y=h}else if(h>i.height){i.height=h}}}}else{console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.")}return i};a.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.frameCount=Math.max(a._getNumber(e,a.DURATION,1),1);i.playTimes=a._getNumber(e,a.PLAY_TIMES,1);i.duration=i.frameCount/this._armature.frameRate;i.fadeInTime=a._getNumber(e,a.FADE_IN_TIME,0);i.scale=a._getNumber(e,a.SCALE,1);i.name=a._getString(e,a.NAME,a.DEFAULT_NAME);if(i.name.length===0){i.name=a.DEFAULT_NAME}i.frameIntOffset=this._frameIntArray.length;i.frameFloatOffset=this._frameFloatArray.length;i.frameOffset=this._frameArray.length;this._animation=i;if(a.FRAME in e){var r=e[a.FRAME];var n=r.length;if(n>0){for(var s=0,o=0;s<n;++s){var l=r[s];this._parseActionDataInFrame(l,o,null,null);o+=a._getNumber(l,a.DURATION,1)}}}if(a.Z_ORDER in e){this._animation.zOrderTimeline=this._parseTimeline(e[a.Z_ORDER],null,a.FRAME,1,false,false,0,this._parseZOrderFrame)}if(a.BONE in e){var h=e[a.BONE];for(var u=0,f=h;u<f.length;u++){var _=f[u];this._parseBoneTimeline(_)}}if(a.SLOT in e){var h=e[a.SLOT];for(var c=0,p=h;c<p.length;c++){var _=p[c];this._parseSlotTimeline(_)}}if(a.FFD in e){var h=e[a.FFD];for(var m=0,d=h;m<d.length;m++){var _=d[m];var y=a._getString(_,a.SKIN,"");var g=a._getString(_,a.SLOT,"");var v=a._getString(_,a.NAME,"");if(y.length===0){y=a.DEFAULT_NAME}this._skin=this._armature.getSkin(y);if(this._skin===null){continue}this._slot=this._armature.getSlot(g);this._mesh=this._skin.getDisplay(g,v);if(this._skin===null||this._slot===null||this._mesh===null){continue}var b=this._parseTimeline(_,null,a.FRAME,22,false,true,0,this._parseSlotFFDFrame);if(b!==null){this._animation.addSlotTimeline(this._slot,b)}this._skin=null;this._slot=null;this._mesh=null}}if(a.IK in e){var h=e[a.IK];for(var T=0,D=h;T<D.length;T++){var _=D[T];var A=a._getString(_,a.NAME,"");var x=this._armature.getConstraint(A);if(x===null){continue}var O=this._parseTimeline(_,null,a.FRAME,30,true,false,2,this._parseIKConstraintFrame);if(O!==null){this._animation.addConstraintTimeline(x,O)}}}if(this._actionFrames.length>0){this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,false,false,0,this._parseActionFrame);this._actionFrames.length=0}this._animation=null;return i};a.prototype._parseTimeline=function(e,r,n,s,o,l,h,u){if(e!==null&&n.length>0&&n in e){r=e[n]}if(r===null){return null}var f=r.length;if(f===0){return null}var _=this._frameIntArray.length;var c=this._frameFloatArray.length;var p=t.BaseObject.borrowObject(t.TimelineData);var m=this._timelineArray.length;this._timelineArray.length+=1+1+1+1+1+f;if(e!==null){this._timelineArray[m+0]=Math.round(a._getNumber(e,a.SCALE,1)*100);this._timelineArray[m+1]=Math.round(a._getNumber(e,a.OFFSET,0)*100)}else{this._timelineArray[m+0]=100;this._timelineArray[m+1]=0}this._timelineArray[m+2]=f;this._timelineArray[m+3]=h;if(o){this._timelineArray[m+4]=_-this._animation.frameIntOffset}else if(l){this._timelineArray[m+4]=c-this._animation.frameFloatOffset}else{this._timelineArray[m+4]=0}this._timeline=p;p.type=s;p.offset=m;if(f===1){p.frameIndicesOffset=-1;this._timelineArray[m+5+0]=u.call(this,r[0],0,0)-this._animation.frameOffset}else{var d=this._animation.frameCount+1;var y=this._data.frameIndices;var g=0;if(t.DragonBones.webAssembly){g=y.size();y.resize(g+d,0)}else{g=y.length;y.length+=d}p.frameIndicesOffset=g;for(var v=0,b=0,T=0,D=0;v<d;++v){if(T+D<=v&&b<f){var A=r[b];T=v;if(b===f-1){D=this._animation.frameCount-T}else{if(A instanceof i){D=this._actionFrames[b+1].frameStart-T}else{D=a._getNumber(A,a.DURATION,1)}}this._timelineArray[m+5+b]=u.call(this,A,T,D)-this._animation.frameOffset;b++}if(t.DragonBones.webAssembly){y.set(g+v,b-1)}else{y[g+v]=b-1}}}this._timeline=null;return p};a.prototype._parseBoneTimeline=function(t){var e=this._armature.getBone(a._getString(t,a.NAME,""));if(e===null){return}this._bone=e;this._slot=this._armature.getSlot(this._bone.name);if(a.TRANSLATE_FRAME in t){var i=this._parseTimeline(t,null,a.TRANSLATE_FRAME,11,false,true,2,this._parseBoneTranslateFrame);if(i!==null){this._animation.addBoneTimeline(e,i)}}if(a.ROTATE_FRAME in t){var i=this._parseTimeline(t,null,a.ROTATE_FRAME,12,false,true,2,this._parseBoneRotateFrame);if(i!==null){this._animation.addBoneTimeline(e,i)}}if(a.SCALE_FRAME in t){var i=this._parseTimeline(t,null,a.SCALE_FRAME,13,false,true,2,this._parseBoneScaleFrame);if(i!==null){this._animation.addBoneTimeline(e,i)}}if(a.FRAME in t){var i=this._parseTimeline(t,null,a.FRAME,10,false,true,6,this._parseBoneAllFrame);if(i!==null){this._animation.addBoneTimeline(e,i)}}this._bone=null;this._slot=null};a.prototype._parseSlotTimeline=function(t){var e=this._armature.getSlot(a._getString(t,a.NAME,""));if(e===null){return}this._slot=e;var i=null;if(a.DISPLAY_FRAME in t){i=this._parseTimeline(t,null,a.DISPLAY_FRAME,20,false,false,0,this._parseSlotDisplayFrame)}else{i=this._parseTimeline(t,null,a.FRAME,20,false,false,0,this._parseSlotDisplayFrame)}if(i!==null){this._animation.addSlotTimeline(e,i)}var r=null;if(a.COLOR_FRAME in t){r=this._parseTimeline(t,null,a.COLOR_FRAME,21,true,false,1,this._parseSlotColorFrame)}else{r=this._parseTimeline(t,null,a.FRAME,21,true,false,1,this._parseSlotColorFrame)}if(r!==null){this._animation.addSlotTimeline(e,r)}this._slot=null};a.prototype._parseFrame=function(t,e,i){t;i;var a=this._frameArray.length;this._frameArray.length+=1;this._frameArray[a+0]=e;return a};a.prototype._parseTweenFrame=function(t,e,i){var r=this._parseFrame(t,e,i);if(i>0){if(a.CURVE in t){var n=i+1;this._helpArray.length=n;this._samplingEasingCurve(t[a.CURVE],this._helpArray);this._frameArray.length+=1+1+this._helpArray.length;this._frameArray[r+1]=2;this._frameArray[r+2]=n;for(var s=0;s<n;++s){this._frameArray[r+3+s]=Math.round(this._helpArray[s]*1e4)}}else{var o=-2;var l=o;if(a.TWEEN_EASING in t){l=a._getNumber(t,a.TWEEN_EASING,o)}if(l===o){this._frameArray.length+=1;this._frameArray[r+1]=0}else if(l===0){this._frameArray.length+=1;this._frameArray[r+1]=1}else if(l<0){this._frameArray.length+=1+1;this._frameArray[r+1]=3;this._frameArray[r+2]=Math.round(-l*100)}else if(l<=1){this._frameArray.length+=1+1;this._frameArray[r+1]=4;this._frameArray[r+2]=Math.round(l*100)}else{this._frameArray.length+=1+1;this._frameArray[r+1]=5;this._frameArray[r+2]=Math.round(l*100-100)}}}else{this._frameArray.length+=1;this._frameArray[r+1]=0}return r};a.prototype._parseActionFrame=function(t,e,i){i;var a=this._frameArray.length;var r=t.actions.length;this._frameArray.length+=1+1+r;this._frameArray[a+0]=e;this._frameArray[a+0+1]=r;for(var n=0;n<r;++n){this._frameArray[a+0+2+n]=t.actions[n]}return a};a.prototype._parseZOrderFrame=function(t,e,i){var r=this._parseFrame(t,e,i);if(a.Z_ORDER in t){var n=t[a.Z_ORDER];if(n.length>0){var s=this._armature.sortedSlots.length;var o=new Array(s-n.length/2);var l=new Array(s);for(var h=0;h<o.length;++h){o[h]=0}for(var u=0;u<s;++u){l[u]=-1}var f=0;var _=0;for(var c=0,p=n.length;c<p;c+=2){var m=n[c];var d=n[c+1];while(f!==m){o[_++]=f++}l[f+d]=f++}while(f<s){o[_++]=f++}this._frameArray.length+=1+s;this._frameArray[r+1]=s;var y=s;while(y--){if(l[y]===-1){this._frameArray[r+2+y]=o[--_]||0}else{this._frameArray[r+2+y]=l[y]||0}}return r}}this._frameArray.length+=1;this._frameArray[r+1]=0;return r};a.prototype._parseBoneAllFrame=function(e,i,r){this._helpTransform.identity();if(a.TRANSFORM in e){this._parseTransform(e[a.TRANSFORM],this._helpTransform,1)}var n=this._helpTransform.rotation;if(i!==0){if(this._prevClockwise===0){n=this._prevRotation+t.Transform.normalizeRadian(n-this._prevRotation)}else{if(this._prevClockwise>0?n>=this._prevRotation:n<=this._prevRotation){this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1}n=this._prevRotation+n-this._prevRotation+t.Transform.PI_D*this._prevClockwise}}this._prevClockwise=a._getNumber(e,a.TWEEN_ROTATE,0);this._prevRotation=n;var s=this._parseTweenFrame(e,i,r);var o=this._frameFloatArray.length;this._frameFloatArray.length+=6;this._frameFloatArray[o++]=this._helpTransform.x;this._frameFloatArray[o++]=this._helpTransform.y;this._frameFloatArray[o++]=n;this._frameFloatArray[o++]=this._helpTransform.skew;this._frameFloatArray[o++]=this._helpTransform.scaleX;this._frameFloatArray[o++]=this._helpTransform.scaleY;this._parseActionDataInFrame(e,i,this._bone,this._slot);return s};a.prototype._parseBoneTranslateFrame=function(t,e,i){var r=this._parseTweenFrame(t,e,i);var n=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[n++]=a._getNumber(t,a.X,0);this._frameFloatArray[n++]=a._getNumber(t,a.Y,0);return r};a.prototype._parseBoneRotateFrame=function(e,i,r){var n=a._getNumber(e,a.ROTATE,0)*t.Transform.DEG_RAD;if(i!==0){if(this._prevClockwise===0){n=this._prevRotation+t.Transform.normalizeRadian(n-this._prevRotation)}else{if(this._prevClockwise>0?n>=this._prevRotation:n<=this._prevRotation){this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1}n=this._prevRotation+n-this._prevRotation+t.Transform.PI_D*this._prevClockwise}}this._prevClockwise=a._getNumber(e,a.CLOCK_WISE,0);this._prevRotation=n;var s=this._parseTweenFrame(e,i,r);var o=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[o++]=n;this._frameFloatArray[o++]=a._getNumber(e,a.SKEW,0)*t.Transform.DEG_RAD;return s};a.prototype._parseBoneScaleFrame=function(t,e,i){var r=this._parseTweenFrame(t,e,i);var n=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[n++]=a._getNumber(t,a.X,1);this._frameFloatArray[n++]=a._getNumber(t,a.Y,1);return r};a.prototype._parseSlotDisplayFrame=function(t,e,i){var r=this._parseFrame(t,e,i);this._frameArray.length+=1;if(a.VALUE in t){this._frameArray[r+1]=a._getNumber(t,a.VALUE,0)}else{this._frameArray[r+1]=a._getNumber(t,a.DISPLAY_INDEX,0)}this._parseActionDataInFrame(t,e,this._slot.parent,this._slot);return r};a.prototype._parseSlotColorFrame=function(t,e,i){var r=this._parseTweenFrame(t,e,i);var n=-1;if(a.VALUE in t||a.COLOR in t){var s=a.VALUE in t?t[a.VALUE]:t[a.COLOR];for(var o in s){o;this._parseColorTransform(s,this._helpColorTransform);n=this._intArray.length;this._intArray.length+=8;this._intArray[n++]=Math.round(this._helpColorTransform.alphaMultiplier*100);this._intArray[n++]=Math.round(this._helpColorTransform.redMultiplier*100);this._intArray[n++]=Math.round(this._helpColorTransform.greenMultiplier*100);this._intArray[n++]=Math.round(this._helpColorTransform.blueMultiplier*100);this._intArray[n++]=Math.round(this._helpColorTransform.alphaOffset);this._intArray[n++]=Math.round(this._helpColorTransform.redOffset);this._intArray[n++]=Math.round(this._helpColorTransform.greenOffset);this._intArray[n++]=Math.round(this._helpColorTransform.blueOffset);n-=8;break}}if(n<0){if(this._defaultColorOffset<0){this._defaultColorOffset=n=this._intArray.length;this._intArray.length+=8;this._intArray[n++]=100;this._intArray[n++]=100;this._intArray[n++]=100;this._intArray[n++]=100;this._intArray[n++]=0;this._intArray[n++]=0;this._intArray[n++]=0;this._intArray[n++]=0}n=this._defaultColorOffset}var l=this._frameIntArray.length;this._frameIntArray.length+=1;this._frameIntArray[l]=n;return r};a.prototype._parseSlotFFDFrame=function(t,e,i){var r=this._frameFloatArray.length;var n=this._parseTweenFrame(t,e,i);var s=a.VERTICES in t?t[a.VERTICES]:null;var o=a._getNumber(t,a.OFFSET,0);var l=this._intArray[this._mesh.offset+0];var h=this._skin.name+"_"+this._slot.name+"_"+this._mesh.name;var u=0;var f=0;var _=0;var c=0;if(this._mesh.weight!==null){var p=this._weightSlotPose[h];this._helpMatrixA.copyFromArray(p,0);this._frameFloatArray.length+=this._mesh.weight.count*2;_=this._mesh.weight.offset+2+this._mesh.weight.bones.length}else{this._frameFloatArray.length+=l*2}for(var m=0;m<l*2;m+=2){if(s===null){u=0;f=0}else{if(m<o||m-o>=s.length){u=0}else{u=s[m-o]}if(m+1<o||m+1-o>=s.length){f=0}else{f=s[m+1-o]}}if(this._mesh.weight!==null){var d=this._weightBonePoses[h];var y=this._intArray[_++];this._helpMatrixA.transformPoint(u,f,this._helpPoint,true);u=this._helpPoint.x;f=this._helpPoint.y;for(var g=0;g<y;++g){var v=this._intArray[_++];this._helpMatrixB.copyFromArray(d,v*7+1);this._helpMatrixB.invert();this._helpMatrixB.transformPoint(u,f,this._helpPoint,true);this._frameFloatArray[r+c++]=this._helpPoint.x;this._frameFloatArray[r+c++]=this._helpPoint.y}}else{this._frameFloatArray[r+m]=u;this._frameFloatArray[r+m+1]=f}}if(e===0){var b=this._frameIntArray.length;this._frameIntArray.length+=1+1+1+1+1;this._frameIntArray[b+0]=this._mesh.offset;this._frameIntArray[b+1]=this._frameFloatArray.length-r;this._frameIntArray[b+2]=this._frameFloatArray.length-r;this._frameIntArray[b+3]=0;this._frameIntArray[b+4]=r;this._timelineArray[this._timeline.offset+3]=b-this._animation.frameIntOffset}return n};a.prototype._parseIKConstraintFrame=function(t,e,i){var r=this._parseTweenFrame(t,e,i);var n=this._frameIntArray.length;this._frameIntArray.length+=2;this._frameIntArray[n++]=a._getBoolean(t,a.BEND_POSITIVE,true)?1:0;this._frameIntArray[n++]=Math.round(a._getNumber(t,a.WEIGHT,1)*100);return r};a.prototype._parseActionData=function(e,i,r,n){var s=new Array;if(typeof e==="string"){var o=t.BaseObject.borrowObject(t.ActionData);o.type=i;o.name=e;o.bone=r;o.slot=n;s.push(o)}else if(e instanceof Array){for(var l=0,h=e;l<h.length;l++){var u=h[l];var o=t.BaseObject.borrowObject(t.ActionData);if(a.GOTO_AND_PLAY in u){o.type=0;o.name=a._getString(u,a.GOTO_AND_PLAY,"")}else{if(a.TYPE in u&&typeof u[a.TYPE]==="string"){o.type=a._getActionType(u[a.TYPE])}else{o.type=a._getNumber(u,a.TYPE,i)}o.name=a._getString(u,a.NAME,"")}if(a.BONE in u){var f=a._getString(u,a.BONE,"");o.bone=this._armature.getBone(f)}else{o.bone=r}if(a.SLOT in u){var _=a._getString(u,a.SLOT,"");o.slot=this._armature.getSlot(_)}else{o.slot=n}var c=null;if(a.INTS in u){if(c===null){c=t.BaseObject.borrowObject(t.UserData)}var p=u[a.INTS];for(var m=0,d=p;m<d.length;m++){var y=d[m];c.addInt(y)}}if(a.FLOATS in u){if(c===null){c=t.BaseObject.borrowObject(t.UserData)}var g=u[a.FLOATS];for(var v=0,b=g;v<b.length;v++){var y=b[v];c.addFloat(y)}}if(a.STRINGS in u){if(c===null){c=t.BaseObject.borrowObject(t.UserData)}var T=u[a.STRINGS];for(var D=0,A=T;D<A.length;D++){var y=A[D];c.addString(y)}}o.data=c;s.push(o)}}return s};a.prototype._parseTransform=function(e,i,r){i.x=a._getNumber(e,a.X,0)*r;i.y=a._getNumber(e,a.Y,0)*r;if(a.ROTATE in e||a.SKEW in e){i.rotation=t.Transform.normalizeRadian(a._getNumber(e,a.ROTATE,0)*t.Transform.DEG_RAD);i.skew=t.Transform.normalizeRadian(a._getNumber(e,a.SKEW,0)*t.Transform.DEG_RAD)}else if(a.SKEW_X in e||a.SKEW_Y in e){i.rotation=t.Transform.normalizeRadian(a._getNumber(e,a.SKEW_Y,0)*t.Transform.DEG_RAD);i.skew=t.Transform.normalizeRadian(a._getNumber(e,a.SKEW_X,0)*t.Transform.DEG_RAD)-i.rotation}i.scaleX=a._getNumber(e,a.SCALE_X,1);i.scaleY=a._getNumber(e,a.SCALE_Y,1)};a.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=a._getNumber(t,a.ALPHA_MULTIPLIER,100)*.01;e.redMultiplier=a._getNumber(t,a.RED_MULTIPLIER,100)*.01;e.greenMultiplier=a._getNumber(t,a.GREEN_MULTIPLIER,100)*.01;e.blueMultiplier=a._getNumber(t,a.BLUE_MULTIPLIER,100)*.01;e.alphaOffset=a._getNumber(t,a.ALPHA_OFFSET,0);e.redOffset=a._getNumber(t,a.RED_OFFSET,0);e.greenOffset=a._getNumber(t,a.GREEN_OFFSET,0);e.blueOffset=a._getNumber(t,a.BLUE_OFFSET,0)};a.prototype._parseArray=function(t){t;this._intArray.length=0;this._floatArray.length=0;this._frameIntArray.length=0;this._frameFloatArray.length=0;this._frameArray.length=0;this._timelineArray.length=0};a.prototype._modifyArray=function(){if(this._intArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._intArray.push(0)}if(this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._frameIntArray.push(0)}if(this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._frameArray.push(0)}if(this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!==0){this._timelineArray.push(0)}var e=this._intArray.length*Int16Array.BYTES_PER_ELEMENT;var i=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT;var a=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT;var r=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT;var n=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT;var s=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT;var o=e+i+a+r+n+s;if(t.DragonBones.webAssembly){var l=t.webAssemblyModule.HEAP16.buffer;var h=t.webAssemblyModule._malloc(o);var u=new Int16Array(l,h,this._intArray.length);var f=new Float32Array(l,h+e,this._floatArray.length);var _=new Int16Array(l,h+e+i,this._frameIntArray.length);var c=new Float32Array(l,h+e+i+a,this._frameFloatArray.length);var p=new Int16Array(l,h+e+i+a+r,this._frameArray.length);var m=new Uint16Array(l,h+e+i+a+r+n,this._timelineArray.length);for(var d=0,y=this._intArray.length;d<y;++d){u[d]=this._intArray[d]}for(var d=0,y=this._floatArray.length;d<y;++d){f[d]=this._floatArray[d]}for(var d=0,y=this._frameIntArray.length;d<y;++d){_[d]=this._frameIntArray[d]}for(var d=0,y=this._frameFloatArray.length;d<y;++d){c[d]=this._frameFloatArray[d]}for(var d=0,y=this._frameArray.length;d<y;++d){p[d]=this._frameArray[d]}for(var d=0,y=this._timelineArray.length;d<y;++d){m[d]=this._timelineArray[d]}t.webAssemblyModule.setDataBinary(this._data,h,e,i,a,r,n,s)}else{var g=new ArrayBuffer(o);var u=new Int16Array(g,0,this._intArray.length);var f=new Float32Array(g,e,this._floatArray.length);var _=new Int16Array(g,e+i,this._frameIntArray.length);var c=new Float32Array(g,e+i+a,this._frameFloatArray.length);var p=new Int16Array(g,e+i+a+r,this._frameArray.length);var m=new Uint16Array(g,e+i+a+r+n,this._timelineArray.length);for(var d=0,y=this._intArray.length;d<y;++d){u[d]=this._intArray[d]}for(var d=0,y=this._floatArray.length;d<y;++d){f[d]=this._floatArray[d]}for(var d=0,y=this._frameIntArray.length;d<y;++d){_[d]=this._frameIntArray[d]}for(var d=0,y=this._frameFloatArray.length;d<y;++d){c[d]=this._frameFloatArray[d]}for(var d=0,y=this._frameArray.length;d<y;++d){p[d]=this._frameArray[d]}for(var d=0,y=this._timelineArray.length;d<y;++d){m[d]=this._timelineArray[d]}this._data.binary=g;this._data.intArray=u;this._data.floatArray=f;this._data.frameIntArray=_;this._data.frameFloatArray=c;this._data.frameArray=p;this._data.timelineArray=m}this._defaultColorOffset=-1};a.prototype.parseDragonBonesData=function(e,i){if(i===void 0){i=1}console.assert(e!==null&&e!==undefined,"Data error.");var r=a._getString(e,a.VERSION,"");var n=a._getString(e,a.COMPATIBLE_VERSION,"");if(a.DATA_VERSIONS.indexOf(r)>=0||a.DATA_VERSIONS.indexOf(n)>=0){var s=t.BaseObject.borrowObject(t.DragonBonesData);s.version=r;s.name=a._getString(e,a.NAME,"");s.frameRate=a._getNumber(e,a.FRAME_RATE,24);if(s.frameRate===0){s.frameRate=24}if(a.ARMATURE in e){this._data=s;this._parseArray(e);var o=e[a.ARMATURE];for(var l=0,h=o;l<h.length;l++){var u=h[l];s.addArmature(this._parseArmature(u,i))}if(!this._data.binary){this._modifyArray()}if(a.STAGE in e){s.stage=s.getArmature(a._getString(e,a.STAGE,""))}else if(s.armatureNames.length>0){s.stage=s.getArmature(s.armatureNames[0])}this._data=null}if(a.TEXTURE_ATLAS in e){this._rawTextureAtlases=e[a.TEXTURE_ATLAS]}return s}else{console.assert(false,"Nonsupport data version: "+r+"\n"+"Please convert DragonBones data to support version.\n"+"Read more: https://github.com/DragonBones/Tools/")}return null};a.prototype.parseTextureAtlasData=function(e,i,r){if(r===void 0){r=1}console.assert(e!==undefined);if(e===null){if(this._rawTextureAtlases===null||this._rawTextureAtlases.length===0){return false}var n=this._rawTextureAtlases[this._rawTextureAtlasIndex++];this.parseTextureAtlasData(n,i,r);if(this._rawTextureAtlasIndex>=this._rawTextureAtlases.length){this._rawTextureAtlasIndex=0;this._rawTextureAtlases=null}return true}i.width=a._getNumber(e,a.WIDTH,0);i.height=a._getNumber(e,a.HEIGHT,0);i.scale=r===1?1/a._getNumber(e,a.SCALE,1):r;i.name=a._getString(e,a.NAME,"");i.imagePath=a._getString(e,a.IMAGE_PATH,"");if(a.SUB_TEXTURE in e){var s=e[a.SUB_TEXTURE];for(var o=0,l=s.length;o<l;++o){var h=s[o];var u=i.createTexture();u.rotated=a._getBoolean(h,a.ROTATED,false);u.name=a._getString(h,a.NAME,"");u.region.x=a._getNumber(h,a.X,0);u.region.y=a._getNumber(h,a.Y,0);u.region.width=a._getNumber(h,a.WIDTH,0);u.region.height=a._getNumber(h,a.HEIGHT,0);var f=a._getNumber(h,a.FRAME_WIDTH,-1);var _=a._getNumber(h,a.FRAME_HEIGHT,-1);if(f>0&&_>0){u.frame=t.TextureData.createRectangle();u.frame.x=a._getNumber(h,a.FRAME_X,0);u.frame.y=a._getNumber(h,a.FRAME_Y,0);u.frame.width=f;u.frame.height=_}i.addTexture(u)}}return true};a.getInstance=function(){if(a._objectDataParserInstance===null){a._objectDataParserInstance=new a}return a._objectDataParserInstance};a._objectDataParserInstance=null;return a}(t.DataParser);t.ObjectDataParser=e;var i=function(){function t(){this.frameStart=0;this.actions=[]}return t}();t.ActionFrame=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}i.prototype._inRange=function(t,e,i){return e<=t&&t<=i};i.prototype._decodeUTF8=function(t){var e=-1;var i=-1;var a=65533;var r=0;var n="";var s;var o=0;var l=0;var h=0;var u=0;while(t.length>r){var f=t[r++];if(f===e){if(l!==0){s=a}else{s=i}}else{if(l===0){if(this._inRange(f,0,127)){s=f}else{if(this._inRange(f,194,223)){l=1;u=128;o=f-192}else if(this._inRange(f,224,239)){l=2;u=2048;o=f-224}else if(this._inRange(f,240,244)){l=3;u=65536;o=f-240}else{}o=o*Math.pow(64,l);s=null}}else if(!this._inRange(f,128,191)){o=0;l=0;h=0;u=0;r--;s=f}else{h+=1;o=o+(f-128)*Math.pow(64,l-h);if(h!==l){s=null}else{var _=o;var c=u;o=0;l=0;h=0;u=0;if(this._inRange(_,c,1114111)&&!this._inRange(_,55296,57343)){s=_}else{s=f}}}}if(s!==null&&s!==i){if(s<=65535){if(s>0)n+=String.fromCharCode(s)}else{s-=65536;n+=String.fromCharCode(55296+(s>>10&1023));n+=String.fromCharCode(56320+(s&1023))}}}return n};i.prototype._getUTF16Key=function(t){for(var e=0,i=t.length;e<i;++e){if(t.charCodeAt(e)>255){return encodeURI(t)}}return t};i.prototype._parseBinaryTimeline=function(e,i,a){if(a===void 0){a=null}var r=a!==null?a:t.BaseObject.borrowObject(t.TimelineData);r.type=e;r.offset=i;this._timeline=r;var n=this._timelineArrayBuffer[r.offset+2];if(n===1){r.frameIndicesOffset=-1}else{var s=0;var o=this._animation.frameCount+1;var l=this._data.frameIndices;if(t.DragonBones.webAssembly){s=l.size();l.resize(s+o,0)}else{s=l.length;l.length+=o}r.frameIndicesOffset=s;for(var h=0,u=0,f=0,_=0;h<o;++h){if(f+_<=h&&u<n){f=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+u]];if(u===n-1){_=this._animation.frameCount-f}else{_=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+u+1]]-f}u++}if(t.DragonBones.webAssembly){l.set(s+h,u-1)}else{l[s+h]=u-1}}}this._timeline=null;return r};i.prototype._parseMesh=function(e,i){i.offset=e[t.ObjectDataParser.OFFSET];var a=this._intArrayBuffer[i.offset+3];if(a>=0){var r=t.BaseObject.borrowObject(t.WeightData);var n=this._intArrayBuffer[i.offset+0];var s=this._intArrayBuffer[a+0];r.offset=a;for(var o=0;o<s;++o){var l=this._intArrayBuffer[a+2+o];r.addBone(this._rawBones[l])}var h=a+2+s;var u=0;for(var o=0,f=n;o<f;++o){var _=this._intArrayBuffer[h++];u+=_;h+=_}r.count=u;i.weight=r}};i.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.frameCount=Math.max(t.ObjectDataParser._getNumber(e,t.ObjectDataParser.DURATION,1),1);i.playTimes=t.ObjectDataParser._getNumber(e,t.ObjectDataParser.PLAY_TIMES,1);i.duration=i.frameCount/this._armature.frameRate;i.fadeInTime=t.ObjectDataParser._getNumber(e,t.ObjectDataParser.FADE_IN_TIME,0);i.scale=t.ObjectDataParser._getNumber(e,t.ObjectDataParser.SCALE,1);i.name=t.ObjectDataParser._getString(e,t.ObjectDataParser.NAME,t.ObjectDataParser.DEFAULT_NAME);if(i.name.length===0){i.name=t.ObjectDataParser.DEFAULT_NAME}var a=e[t.ObjectDataParser.OFFSET];i.frameIntOffset=a[0];i.frameFloatOffset=a[1];i.frameOffset=a[2];this._animation=i;if(t.ObjectDataParser.ACTION in e){i.actionTimeline=this._parseBinaryTimeline(0,e[t.ObjectDataParser.ACTION])}if(t.ObjectDataParser.Z_ORDER in e){i.zOrderTimeline=this._parseBinaryTimeline(1,e[t.ObjectDataParser.Z_ORDER])}if(t.ObjectDataParser.BONE in e){var r=e[t.ObjectDataParser.BONE];for(var n in r){var s=r[n];if(t.DragonBones.webAssembly){n=this._getUTF16Key(n)}var o=this._armature.getBone(n);if(o===null){continue}for(var l=0,h=s.length;l<h;l+=2){var u=s[l];var f=s[l+1];var _=this._parseBinaryTimeline(u,f);this._animation.addBoneTimeline(o,_)}}}if(t.ObjectDataParser.SLOT in e){var r=e[t.ObjectDataParser.SLOT];for(var n in r){var s=r[n];if(t.DragonBones.webAssembly){n=this._getUTF16Key(n)}var c=this._armature.getSlot(n);if(c===null){continue}for(var l=0,h=s.length;l<h;l+=2){var u=s[l];var f=s[l+1];var _=this._parseBinaryTimeline(u,f);this._animation.addSlotTimeline(c,_)}}}if(t.ObjectDataParser.CONSTRAINT in e){var r=e[t.ObjectDataParser.CONSTRAINT];for(var n in r){var s=r[n];if(t.DragonBones.webAssembly){n=this._getUTF16Key(n)}var p=this._armature.getConstraint(n);if(p===null){continue}for(var l=0,h=s.length;l<h;l+=2){var u=s[l];var f=s[l+1];var _=this._parseBinaryTimeline(u,f);this._animation.addConstraintTimeline(p,_)}}}this._animation=null;return i};i.prototype._parseArray=function(e){var i=e[t.ObjectDataParser.OFFSET];var a=i[1];var r=i[3];var n=i[5];var s=i[7];var o=i[9];var l=i[11];var h=new Int16Array(this._binary,this._binaryOffset+i[0],a/Int16Array.BYTES_PER_ELEMENT);var u=new Float32Array(this._binary,this._binaryOffset+i[2],r/Float32Array.BYTES_PER_ELEMENT);var f=new Int16Array(this._binary,this._binaryOffset+i[4],n/Int16Array.BYTES_PER_ELEMENT);var _=new Float32Array(this._binary,this._binaryOffset+i[6],s/Float32Array.BYTES_PER_ELEMENT);var c=new Int16Array(this._binary,this._binaryOffset+i[8],o/Int16Array.BYTES_PER_ELEMENT);var p=new Uint16Array(this._binary,this._binaryOffset+i[10],l/Uint16Array.BYTES_PER_ELEMENT);if(t.DragonBones.webAssembly){var m=a+r+n+s+o+l;var d=t.webAssemblyModule._malloc(m);var y=new Uint8Array(this._binary,this._binaryOffset,m/Uint8Array.BYTES_PER_ELEMENT);var g=new Uint8Array(t.webAssemblyModule.HEAP16.buffer,d,y.length);for(var v=0,b=y.length;v<b;++v){g[v]=y[v]}t.webAssemblyModule.setDataBinary(this._data,d,a,r,n,s,o,l);this._intArrayBuffer=h;this._floatArrayBuffer=u;this._frameIntArrayBuffer=f;this._frameFloatArrayBuffer=_;this._frameArrayBuffer=c;this._timelineArrayBuffer=p}else{this._data.binary=this._binary;this._data.intArray=this._intArrayBuffer=h;this._data.floatArray=this._floatArrayBuffer=u;this._data.frameIntArray=this._frameIntArrayBuffer=f;this._data.frameFloatArray=this._frameFloatArrayBuffer=_;this._data.frameArray=this._frameArrayBuffer=c;this._data.timelineArray=this._timelineArrayBuffer=p}};i.prototype.parseDragonBonesData=function(t,i){if(i===void 0){i=1}console.assert(t!==null&&t!==undefined&&t instanceof ArrayBuffer,"Data error.");var a=new Uint8Array(t,0,8);if(a[0]!=="D".charCodeAt(0)||a[1]!=="B".charCodeAt(0)||a[2]!=="D".charCodeAt(0)||a[3]!=="T".charCodeAt(0)){console.assert(false,"Nonsupport data.");return null}var r=new Uint32Array(t,8,1)[0];var n=new Uint8Array(t,8+4,r);var s=this._decodeUTF8(n);var o=JSON.parse(s);this._binaryOffset=8+4+r;this._binary=t;return e.prototype.parseDragonBonesData.call(this,o,i)};i.getInstance=function(){if(i._binaryDataParserInstance===null){i._binaryDataParserInstance=new i}return i._binaryDataParserInstance};i._binaryDataParserInstance=null;return i}(t.ObjectDataParser);t.BinaryDataParser=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function e(i){if(i===void 0){i=null}this.autoSearch=false;this._dragonBonesDataMap={};this._textureAtlasDataMap={};this._dragonBones=null;this._dataParser=null;if(e._objectParser===null){e._objectParser=new t.ObjectDataParser}if(e._binaryParser===null){e._binaryParser=new t.BinaryDataParser}this._dataParser=i!==null?i:e._objectParser}e.prototype._isSupportMesh=function(){return true};e.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap){for(var i=0,a=this._textureAtlasDataMap[t];i<a.length;i++){var r=a[i];var n=r.getTexture(e);if(n!==null){return n}}}if(this.autoSearch){for(var s in this._textureAtlasDataMap){for(var o=0,l=this._textureAtlasDataMap[s];o<l.length;o++){var r=l[o];if(r.autoSearch){var n=r.getTexture(e);if(n!==null){return n}}}}}return null};e.prototype._fillBuildArmaturePackage=function(t,e,i,a,r){var n=null;var s=null;if(e.length>0){if(e in this._dragonBonesDataMap){n=this._dragonBonesDataMap[e];s=n.getArmature(i)}}if(s===null&&(e.length===0||this.autoSearch)){for(var o in this._dragonBonesDataMap){n=this._dragonBonesDataMap[o];if(e.length===0||n.autoSearch){s=n.getArmature(i);if(s!==null){e=o;break}}}}if(s!==null){t.dataName=e;t.textureAtlasName=r;t.data=n;t.armature=s;t.skin=null;if(a.length>0){t.skin=s.getSkin(a);if(t.skin===null&&this.autoSearch){for(var o in this._dragonBonesDataMap){var l=this._dragonBonesDataMap[o];var h=l.getArmature(a);if(h!==null){t.skin=h.defaultSkin;break}}}}if(t.skin===null){t.skin=s.defaultSkin}return true}return false};e.prototype._buildBones=function(e,i){for(var a=0,r=e.armature.sortedBones;a<r.length;a++){var n=r[a];var s=t.BaseObject.borrowObject(t.Bone);s.init(n);if(n.parent!==null){i.addBone(s,n.parent.name)}else{i.addBone(s,"")}}var o=e.armature.constraints;for(var l in o){var h=o[l];var u=t.BaseObject.borrowObject(t.IKConstraint);u.init(h,i);i.addConstraint(u)}};e.prototype._buildSlots=function(e,i){var a=e.skin;var r=e.armature.defaultSkin;if(a===null||r===null){return}var n={};for(var s in r.displays){var o=r.getDisplays(s);n[s]=o}if(a!==r){for(var s in a.displays){var o=a.getDisplays(s);n[s]=o}}for(var l=0,h=e.armature.sortedSlots;l<h.length;l++){var u=h[l];var o=u.name in n?n[u.name]:null;var f=this._buildSlot(e,u,o,i);i.addSlot(f,u.parent.name);if(o!==null){var _=new Array;for(var c=0,p=t.DragonBones.webAssembly?o.size():o.length;c<p;++c){var m=t.DragonBones.webAssembly?o.get(c):o[c];if(m!==null){_.push(this._getSlotDisplay(e,m,null,f))}else{_.push(null)}}f._setDisplayList(_)}f._setDisplayIndex(u.displayIndex,true)}};e.prototype._buildChildArmature=function(t,e,i){e;return this.buildArmature(i.path,t!==null?t.dataName:"","",t!==null?t.textureAtlasName:"")};e.prototype._getSlotDisplay=function(t,e,i,a){var r=t!==null?t.dataName:e.parent.parent.parent.name;var n=null;switch(e.type){case 0:{var s=e;if(s.texture===null){s.texture=this._getTextureData(r,e.path)}else if(t!==null&&t.textureAtlasName.length>0){s.texture=this._getTextureData(t.textureAtlasName,e.path)}if(i!==null&&i.type===2&&this._isSupportMesh()){n=a.meshDisplay}else{n=a.rawDisplay}break}case 2:{var o=e;if(o.texture===null){o.texture=this._getTextureData(r,o.path)}else if(t!==null&&t.textureAtlasName.length>0){o.texture=this._getTextureData(t.textureAtlasName,o.path)}if(this._isSupportMesh()){n=a.meshDisplay}else{n=a.rawDisplay}break}case 1:{var l=e;var h=this._buildChildArmature(t,a,e);if(h!==null){h.inheritAnimation=l.inheritAnimation;if(!h.inheritAnimation){var u=l.actions.length>0?l.actions:h.armatureData.defaultActions;if(u.length>0){for(var f=0,_=u;f<_.length;f++){var c=_[f];h._bufferAction(c,true)}}else{h.animation.play()}}l.armature=h.armatureData}n=h;break}case 3:break;default:break}return n};e.prototype.parseDragonBonesData=function(t,i,a){if(i===void 0){i=null}if(a===void 0){a=1}var r=t instanceof ArrayBuffer?e._binaryParser:this._dataParser;var n=r.parseDragonBonesData(t,a);while(true){var s=this._buildTextureAtlasData(null,null);if(r.parseTextureAtlasData(null,s,a)){this.addTextureAtlasData(s,i)}else{s.returnToPool();break}}if(n!==null){this.addDragonBonesData(n,i)}return n};e.prototype.parseTextureAtlasData=function(t,e,i,a){if(i===void 0){i=null}if(a===void 0){a=1}var r=this._buildTextureAtlasData(null,null);this._dataParser.parseTextureAtlasData(t,r,a);this._buildTextureAtlasData(r,e||null);this.addTextureAtlasData(r,i);return r};e.prototype.updateTextureAtlasData=function(t,e){var i=this.getTextureAtlasData(t);if(i!==null){for(var a=0,r=i.length;a<r;++a){if(a<e.length){this._buildTextureAtlasData(i[a],e[a])}}}};e.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null};e.prototype.addDragonBonesData=function(t,e){if(e===void 0){e=null}e=e!==null?e:t.name;if(e in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t){return}console.warn("Can not add same name data: "+e);return}this._dragonBonesDataMap[e]=t};e.prototype.removeDragonBonesData=function(t,e){if(e===void 0){e=true}if(t in this._dragonBonesDataMap){if(e){this._dragonBones.bufferObject(this._dragonBonesDataMap[t])}delete this._dragonBonesDataMap[t]}};e.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null};e.prototype.addTextureAtlasData=function(t,e){if(e===void 0){e=null}e=e!==null?e:t.name;var i=e in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];if(i.indexOf(t)<0){i.push(t)}};e.prototype.removeTextureAtlasData=function(t,e){if(e===void 0){e=true}if(t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e){for(var a=0,r=i;a<r.length;a++){var n=r[a];this._dragonBones.bufferObject(n)}}delete this._textureAtlasDataMap[t]}};e.prototype.getArmatureData=function(t,e){if(e===void 0){e=""}var a=new i;if(!this._fillBuildArmaturePackage(a,e,t,"","")){return null}return a.armature};e.prototype.clear=function(t){if(t===void 0){t=true}for(var e in this._dragonBonesDataMap){if(t){this._dragonBones.bufferObject(this._dragonBonesDataMap[e])}delete this._dragonBonesDataMap[e]}for(var e in this._textureAtlasDataMap){if(t){var i=this._textureAtlasDataMap[e];for(var a=0,r=i;a<r.length;a++){var n=r[a];this._dragonBones.bufferObject(n)}}delete this._textureAtlasDataMap[e]}};e.prototype.buildArmature=function(t,e,a,r){if(e===void 0){e=""}if(a===void 0){a=""}if(r===void 0){r=""}var n=new i;if(!this._fillBuildArmaturePackage(n,e||"",t,a||"",r||"")){console.warn("No armature data: "+t+", "+(e!==null?e:""));return null}var s=this._buildArmature(n);this._buildBones(n,s);this._buildSlots(n,s);s.invalidUpdate(null,true);s.advanceTime(0);return s};e.prototype.replaceDisplay=function(e,i,a){if(a===void 0){a=-1}if(a<0){a=e.displayIndex}if(a<0){a=0}e.replaceDisplayData(i,a);var r=e.displayList;if(r.length<=a){r.length=a+1;for(var n=0,s=r.length;n<s;++n){if(!r[n]){r[n]=null}}}if(i!==null){var o=e.rawDisplayDatas;var l=null;if(o){if(t.DragonBones.webAssembly){if(a<o.size()){l=o.get(a)}}else{if(a<o.length){l=o[a]}}}r[a]=this._getSlotDisplay(null,i,l,e)}else{r[a]=null}e.displayList=r};e.prototype.replaceSlotDisplay=function(t,e,i,a,r,n){if(n===void 0){n=-1}var s=this.getArmatureData(e,t||"");if(!s||!s.defaultSkin){return false}var o=s.defaultSkin.getDisplay(i,a);if(!o){return false}this.replaceDisplay(r,o,n);return true};e.prototype.replaceSlotDisplayList=function(e,i,a,r){var n=this.getArmatureData(i,e||"");if(!n||!n.defaultSkin){return false}var s=n.defaultSkin.getDisplays(a);if(!s){return false}var o=0;for(var l=0,h=t.DragonBones.webAssembly?s.size():s.length;l<h;++l){var u=t.DragonBones.webAssembly?s.get(l):s[l];this.replaceDisplay(r,u,o++)}return true};e.prototype.replaceSkin=function(e,i,a){if(a===void 0){a=null}var r=false;for(var n=0,s=e.getSlots();n<s.length;n++){var o=s[n];if(a!==null&&a.indexOf(o.name)>=0){continue}var l=i.getDisplays(o.name);if(!l){continue}var h=t.DragonBones.webAssembly?l.size():l.length;var u=o.displayList;u.length=h;for(var f=0,_=h;f<_;++f){var c=t.DragonBones.webAssembly?l.get(f):l[f];if(c!==null){u[f]=this._getSlotDisplay(null,c,null,o)}else{u[f]=null}}r=true;o.rawDisplayDatas=l;o.displayList=u}return r};e.prototype.replaceAnimation=function(e,i,a){if(a===void 0){a=true}var r=i.defaultSkin;if(r===null){return false}if(a){e.animation.animations=i.animations}else{var n=e.animation.animations;var s={};for(var o in n){s[o]=n[o]}for(var o in i.animations){s[o]=i.animations[o]}e.animation.animations=s}for(var l=0,h=e.getSlots();l<h.length;l++){var u=h[l];var f=0;for(var _=0,c=u.displayList;_<c.length;_++){var p=c[_];if(p instanceof t.Armature){var m=r.getDisplays(u.name);if(m!==null&&f<(t.DragonBones.webAssembly?m.size():m.length)){var d=t.DragonBones.webAssembly?m.get(f):m[f];if(d!==null&&d.type===1){var y=this.getArmatureData(d.path,d.parent.parent.parent.name);if(y){this.replaceAnimation(p,y,a)}}}}f++}}return true};e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap};e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap};Object.defineProperty(e.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:true,configurable:true});e.prototype.changeSkin=function(t,e,i){if(i===void 0){i=null}return this.replaceSkin(t,e,i)};e.prototype.copyAnimationsToArmature=function(t,e,i,a,r){if(i===void 0){i=""}if(a===void 0){a=""}if(r===void 0){r=true}i;var n=this.getArmatureData(e,a);if(!n){return false}return this.replaceAnimation(t,n,r)};e._objectParser=null;e._binaryParser=null;return e}();t.BaseFactory=e;var i=function(){function t(){this.dataName="";this.textureAtlasName="";this.skin=null}return t}();t.BuildArmaturePackage=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;t._renderTexture=null;return t}a.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"};a.prototype._onClear=function(){e.prototype._onClear.call(this);if(this.disposeEnabled&&this._renderTexture!==null){this._renderTexture.dispose()}this.disposeEnabled=false;this._renderTexture=null};a.prototype.createTexture=function(){return t.BaseObject.borrowObject(i)};Object.defineProperty(a.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(e){if(this._renderTexture===e){return}this._renderTexture=e;if(this._renderTexture!==null){var i=this._renderTexture.bitmapData;var a=this.width>0?this.width:i.width;var r=this.height>0?this.height:i.height;for(var n in this.textures){var s=egret.$TextureScaleFactor;var o=this.textures[n];var l=o.region.width;var h=o.region.height;if(o.renderTexture===null){o.renderTexture=new egret.Texture}if(t.EgretFactory._isV5){o.renderTexture["$bitmapData"]=i}else{o.renderTexture._bitmapData=i}if(o.rotated){o.renderTexture.$initData(o.region.x*s,o.region.y*s,h*s,l*s,0,0,h*s,l*s,a,r,o.rotated)}else{o.renderTexture.$initData(o.region.x*s,o.region.y*s,l*s,h*s,0,0,l*s,h*s,a,r)}}}else{for(var n in this.textures){var o=this.textures[n];o.renderTexture=null}}},enumerable:true,configurable:true});a.prototype.dispose=function(){console.warn("");this.returnToPool()};Object.defineProperty(a.prototype,"texture",{get:function(){console.warn("");return this.renderTexture},enumerable:true,configurable:true});return a}(t.TextureAtlasData);t.EgretTextureAtlasData=e;var i=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.renderTexture=null;return e}e.toString=function(){return"[class dragonBones.EgretTextureData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);if(this.renderTexture!==null){}this.renderTexture=null};return e}(t.TextureData);t.EgretTextureData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(i.prototype,"eventObject",{get:function(){return this.data},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animationName",{get:function(){var t=this.eventObject.animationState;return t!==null?t.name:""},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"armature",{get:function(){return this.eventObject.armature},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"bone",{get:function(){return this.eventObject.bone},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"slot",{get:function(){return this.eventObject.slot},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"animationState",{get:function(){return this.eventObject.animationState},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"frameLabel",{get:function(){return this.eventObject.name},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"sound",{get:function(){return this.eventObject.name},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"movementID",{get:function(){return this.animationName},enumerable:true,configurable:true});i.START=t.EventObject.START;i.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE;i.COMPLETE=t.EventObject.COMPLETE;i.FADE_IN=t.EventObject.FADE_IN;i.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE;i.FADE_OUT=t.EventObject.FADE_OUT;i.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE;i.FRAME_EVENT=t.EventObject.FRAME_EVENT;i.SOUND_EVENT=t.EventObject.SOUND_EVENT;i.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT;i.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT;i.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT;i.SOUND=t.EventObject.SOUND_EVENT;return i}(egret.Event);t.EgretEvent=e;var i=function(i){__extends(a,i);function a(){var t=i!==null&&i.apply(this,arguments)||this;t._batchEnabled=!__global["nativeRender"];t._childDirty=true;t._debugDraw=false;t._disposeProxy=false;t._armature=null;t._bounds=null;t._debugDrawer=null;return t}a._cleanBeforeRender=function(){};a.prototype.dbInit=function(t){this._armature=t;if(this._batchEnabled){this.$renderNode=new egret.sys.GroupNode;this.$renderNode.cleanBeforeRender=a._cleanBeforeRender}};a.prototype.dbClear=function(){this._armature=null;this._bounds=null;this._debugDrawer=null};a.prototype.dbUpdate=function(){var e=t.DragonBones.debugDraw;if(e||this._debugDraw){this._debugDraw=e;if(this._debugDraw){if(this._debugDrawer===null){this._debugDrawer=new egret.Sprite}this.addChild(this._debugDrawer);this._debugDrawer.graphics.clear();for(var i=0,a=this._armature.getBones();i<a.length;i++){var r=a[i];var n=r.boneData.length;var s=r.globalTransformMatrix.tx;var o=r.globalTransformMatrix.ty;var l=s+r.globalTransformMatrix.a*n;var h=o+r.globalTransformMatrix.b*n;this._debugDrawer.graphics.lineStyle(2,65535,.7);this._debugDrawer.graphics.moveTo(s,o);this._debugDrawer.graphics.lineTo(l,h);this._debugDrawer.graphics.lineStyle(0,0,0);this._debugDrawer.graphics.beginFill(65535,.7);this._debugDrawer.graphics.drawCircle(s,o,3);this._debugDrawer.graphics.endFill()}for(var u=0,f=this._armature.getSlots();u<f.length;u++){var _=f[u];var c=_.boundingBoxData;if(c!==null){var p=this._debugDrawer.getChildByName(_.name);if(p===null){p=new egret.Shape;p.name=_.name;this._debugDrawer.addChild(p)}p.graphics.clear();p.graphics.beginFill(c.color?c.color:16711935,.3);switch(c.type){case 0:p.graphics.drawRect(-c.width*.5,-c.height*.5,c.width,c.height);break;case 1:p.graphics.drawEllipse(-c.width*.5,-c.height*.5,c.width,c.height);break;case 2:var m=c.vertices;for(var d=0;d<m.length;d+=2){if(d===0){p.graphics.moveTo(m[d],m[d+1])}else{p.graphics.lineTo(m[d],m[d+1])}}break;default:break}p.graphics.endFill();_.updateTransformAndMatrix();_.updateGlobalTransform();p.$setMatrix(_.globalTransformMatrix,true)}else{var p=this._debugDrawer.getChildByName(_.name);if(p!==null){this._debugDrawer.removeChild(p)}}}}else if(this._debugDrawer!==null&&this._debugDrawer.parent===this){this.removeChild(this._debugDrawer)}}if(!t.EgretFactory._isV5&&this._batchEnabled&&this._childDirty){this.$invalidateContentBounds()}};a.prototype.dispose=function(t){if(t===void 0){t=true}this._disposeProxy=t;if(this._armature!==null){this._armature.dispose();this._armature=null}};a.prototype.dispatchDBEvent=function(t,a){var r=egret.Event.create(e,t);r.data=a;i.prototype.dispatchEvent.call(this,r);egret.Event.release(r)};a.prototype.hasDBEventListener=function(t){return this.hasEventListener(t)};a.prototype.addDBEventListener=function(t,e,i){this.addEventListener(t,e,i)};a.prototype.removeDBEventListener=function(t,e,i){this.removeEventListener(t,e,i)};a.prototype.disableBatch=function(){if(!this._batchEnabled||!this._armature){return}for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t];var a=i._meshData?i.meshDisplay:i.rawDisplay;var r=a.$renderNode;if(r.matrix){a.$setMatrix(i.globalTransformMatrix,false)}this.addChild(a)}this._batchEnabled=false;this.$renderNode.cleanBeforeRender=null;this.$renderNode=null;this.armature.invalidUpdate(null,true)};Object.defineProperty(a.prototype,"armature",{get:function(){return this._armature},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"animation",{get:function(){return this._armature.animation},enumerable:true,configurable:true});a.prototype.$measureContentBounds=function(e){if(this._batchEnabled&&this._armature){if(this._childDirty){this._childDirty=false;var a=true;var r=new egret.Rectangle;for(var n=0,s=this._armature.getSlots();n<s.length;n++){var o=s[n];var l=o.display;if(!l){continue}var h=l.$renderNode.matrix;if(l===o.meshDisplay){var u=l.$renderNode.vertices;if(u&&u.length>0){r.setTo(999999,999999,-999999,-999999);for(var f=0,_=u.length;f<_;f+=2){var c=u[f];var p=u[f+1];if(r.x>c)r.x=c;if(r.width<c)r.width=c;if(r.y>p)r.y=p;if(r.height<p)r.height=p}r.width-=r.x;r.height-=r.y}else{continue}}else{var m=o._displayDatas[o.displayIndex];if(m&&m instanceof t.ImageDisplayData&&m.texture){var d=m.texture.parent.scale;r.x=0;r.y=0;r.width=m.texture.region.width*d;r.height=m.texture.region.height*d}else{continue}}h.$transformBounds(r);var y=r.x;var g=r.y;var v=r.x+r.width;var b=r.y+r.height;if(a){a=false;e.x=y;e.y=g;e.width=v;e.height=b}else{if(y<e.x){e.x=y}if(g<e.y){e.y=g}if(v>e.width){e.width=v}if(b>e.height){e.height=b}}}e.width-=e.x;e.height-=e.y;if(t.EgretFactory._isV5){if(this._bounds===null){this._bounds=new egret.Rectangle}this._bounds.copyFrom(e)}}else if(t.EgretFactory._isV5){if(this._bounds===null){this._bounds=new egret.Rectangle}e.copyFrom(this._bounds)}return e}return i.prototype.$measureContentBounds.call(this,e)};a.prototype.hasEvent=function(t){return this.hasDBEventListener(t)};a.prototype.addEvent=function(t,e,i){this.addDBEventListener(t,e,i)};a.prototype.removeEvent=function(t,e,i){this.removeDBEventListener(t,e,i)};a.prototype.advanceTimeBySelf=function(e){if(e){this._armature.clock=t.EgretFactory.factory.clock}else{this._armature.clock=null}};return a}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=i;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(e);t.Event=a;var r=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(e);t.ArmatureEvent=r;var n=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(e);t.AnimationEvent=n;var s=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(e);t.FrameEvent=s;var o=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(e);t.SoundEvent=o;var l=function(e){__extends(i,e);function i(i,a,r){if(r===void 0){r=1}var n=e.call(this)||this;console.warn("");n._onClear();t.ObjectDataParser.getInstance().parseTextureAtlasData(a,n,r);n.renderTexture=i;return n}i.toString=function(){return"[class dragonBones.EgretTextureAtlas]"};return i}(t.EgretTextureAtlasData);t.EgretTextureAtlas=l;var h=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(l);t.EgretSheetAtlas=h;var u=function(){function e(){}e.getInstance=function(){console.warn("");return t.EgretFactory.factory.soundEventManager};return e}();t.SoundEventManager=u;var f=function(){function t(){console.warn("")}return t}();t.AnimationCacheManager=f})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(){var t=e!==null&&e.apply(this,arguments)||this;t.transformUpdateEnabled=false;t._armatureDisplay=null;t._renderDisplay=null;t._colorFilter=null;return t}i.toString=function(){return"[class dragonBones.EgretSlot]"};i.prototype.init=function(i,a,r,n){e.prototype.init.call(this,i,a,r,n);if(t.EgretFactory._isV5){this._updateTransform=this._updateTransformV5}else{this._updateTransform=this._updateTransformV4}};i.prototype._onClear=function(){e.prototype._onClear.call(this);this._armatureDisplay=null;this._renderDisplay=null;this._colorFilter=null};i.prototype._initDisplay=function(t){t};i.prototype._disposeDisplay=function(t){t};i.prototype._onUpdateDisplay=function(){this._armatureDisplay=this._armature.display;this._renderDisplay=this._display!==null?this._display:this._rawDisplay;if(t.EgretFactory._isV5){if(this._renderDisplay===this._rawDisplay&&!(this._renderDisplay.$renderNode instanceof egret.sys.BitmapNode)){this._renderDisplay.$renderNode=new egret.sys.BitmapNode}}if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;if(!e.matrix){e.matrix=new egret.Matrix}if(this._renderDisplay!==this._rawDisplay&&this._renderDisplay!==this._meshDisplay){this._armatureDisplay.disableBatch()}}};i.prototype._addDisplay=function(){if(this._armatureDisplay._batchEnabled){this._armatureDisplay.$renderNode.addNode(this._renderDisplay.$renderNode)}else{this._armatureDisplay.addChild(this._renderDisplay)}};i.prototype._replaceDisplay=function(t){var e=t;if(this._armatureDisplay._batchEnabled){var i=this._armatureDisplay.$renderNode.drawData;i[i.indexOf(e.$renderNode)]=this._renderDisplay.$renderNode}else{this._armatureDisplay.addChild(this._renderDisplay);this._armatureDisplay.swapChildren(this._renderDisplay,e);this._armatureDisplay.removeChild(e)}};i.prototype._removeDisplay=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t.splice(t.indexOf(this._renderDisplay.$renderNode),1)}else{this._renderDisplay.parent.removeChild(this._renderDisplay)}};i.prototype._updateZOrder=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t[this._zOrder]=this._renderDisplay.$renderNode}else{var e=this._armatureDisplay.getChildIndex(this._renderDisplay);if(e===this._zOrder){return}this._armatureDisplay.addChildAt(this._renderDisplay,this._zOrder)}};i.prototype._updateVisible=function(){var t=this._parent.visible&&this._visible;if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.alpha=t?1:0}else{this._renderDisplay.visible=t}};i.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE;break;default:break}if(this._armatureDisplay._batchEnabled){var t=this._renderDisplay.$renderNode;t.blendMode=egret.sys.blendModeToNumber(this._renderDisplay.blendMode)}};i.prototype._updateColor=function(){if(this._colorTransform.redMultiplier!==1||this._colorTransform.greenMultiplier!==1||this._colorTransform.blueMultiplier!==1||this._colorTransform.redOffset!==0||this._colorTransform.greenOffset!==0||this._colorTransform.blueOffset!==0||this._colorTransform.alphaOffset!==0){if(this._colorFilter===null){this._colorFilter=new egret.ColorMatrixFilter}var t=this._colorFilter.matrix;t[0]=this._colorTransform.redMultiplier;t[6]=this._colorTransform.greenMultiplier;t[12]=this._colorTransform.blueMultiplier;t[18]=this._colorTransform.alphaMultiplier;t[4]=this._colorTransform.redOffset;t[9]=this._colorTransform.greenOffset;t[14]=this._colorTransform.blueOffset;t[19]=this._colorTransform.alphaOffset;this._colorFilter.matrix=t;if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.filter=this._colorFilter;e.alpha=1}var i=this._renderDisplay.filters;if(!i){i=[]}if(i.indexOf(this._colorFilter)<0){i.push(this._colorFilter)}this._renderDisplay.filters=i;this._renderDisplay.$setAlpha(1)}else{if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.filter=null;e.alpha=this._colorTransform.alphaMultiplier}this._renderDisplay.filters=null;this._renderDisplay.$setAlpha(this._colorTransform.alphaMultiplier)}};i.prototype._updateFrame=function(){var e=this._display===this._meshDisplay?this._meshData:null;var i=this._textureData;if(this._displayIndex>=0&&this._display!==null&&i!==null){if(this._armature.replacedTexture!==null&&this._rawDisplayDatas!==null&&this._rawDisplayDatas.indexOf(this._displayData)>=0){var a=i.parent;if(this._armature._replaceTextureAtlasData===null){a=t.BaseObject.borrowObject(t.EgretTextureAtlasData);a.copyFrom(i.parent);a.renderTexture=this._armature.replacedTexture;this._armature._replaceTextureAtlasData=a}else{a=this._armature._replaceTextureAtlasData}i=a.getTexture(i.name)}if(i.renderTexture!==null){if(e!==null){var r=e.parent.parent.parent;var n=r.intArray;var s=r.floatArray;var o=n[e.offset+0];var l=n[e.offset+1];var h=n[e.offset+2];if(h<0){h+=65536}var u=h+o*2;var f=this._renderDisplay;var _=f.$renderNode;_.uvs.length=o*2;_.vertices.length=o*2;_.indices.length=l*3;for(var c=0,p=o*2;c<p;++c){_.vertices[c]=s[h+c];_.uvs[c]=s[u+c]}for(var c=0;c<l*3;++c){_.indices[c]=n[e.offset+4+c]}if(this._armatureDisplay._batchEnabled){var m=i.renderTexture;var d=this._renderDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(d);if(t.EgretFactory._isV5){d.image=m["$bitmapData"]}else{d.image=m._bitmapData}if(t.EgretFactory._isV5){d.image=m["$bitmapData"];d.drawMesh(m.$bitmapX,m.$bitmapY,m.$bitmapWidth,m.$bitmapHeight,m.$offsetX,m.$offsetY,m.textureWidth,m.textureHeight);d.imageWidth=m.$sourceWidth;d.imageHeight=m.$sourceHeight}else{d.image=m._bitmapData;d.drawMesh(m._bitmapX,m._bitmapY,m._bitmapWidth,m._bitmapHeight,m._offsetX,m._offsetY,m.textureWidth,m.textureHeight);d.imageWidth=m._sourceWidth;d.imageHeight=m._sourceHeight}this._blendModeDirty=true;this._colorDirty=true}f.texture=i.renderTexture;f.$setAnchorOffsetX(this._pivotX);f.$setAnchorOffsetY(this._pivotY);f.$updateVertices();if(!t.EgretFactory._isV5){f.$invalidateTransform()}}else{var y=i.parent.scale*this._armature._armatureData.scale;var g=(i.rotated?i.region.height:i.region.width)*y;var v=(i.rotated?i.region.width:i.region.height)*y;var b=this._renderDisplay;var m=i.renderTexture;b.texture=m;if(this._armatureDisplay._batchEnabled){var d=this._renderDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(d);if(t.EgretFactory._isV5){d.image=m["$bitmapData"];d.drawImage(m.$bitmapX,m.$bitmapY,m.$bitmapWidth,m.$bitmapHeight,m.$offsetX,m.$offsetY,g,v);d.imageWidth=m.$sourceWidth;d.imageHeight=m.$sourceHeight}else{d.image=m._bitmapData;d.drawImage(m._bitmapX,m._bitmapY,m._bitmapWidth,m._bitmapHeight,m._offsetX,m._offsetY,g,v);d.imageWidth=m._sourceWidth;d.imageHeight=m._sourceHeight}this._blendModeDirty=true;this._colorDirty=true}else{b.width=g;b.height=v}b.$setAnchorOffsetX(this._pivotX);b.$setAnchorOffsetY(this._pivotY)}this._visibleDirty=true;return}}if(this._armatureDisplay._batchEnabled){this._renderDisplay.$renderNode.image=null}var T=this._renderDisplay;T.$setBitmapData(null);T.x=0;T.y=0;T.visible=false};i.prototype._updateMesh=function(){var e=this._ffdVertices.length>0;var i=this._armature._armatureData.scale;var a=this._meshData;var r=a.weight;var n=this._renderDisplay;var s=n.$renderNode;if(r!==null){var o=a.parent.parent.parent;var l=o.intArray;var h=o.floatArray;var u=l[a.offset+0];var f=l[r.offset+1];if(f<0){f+=65536}for(var _=0,c=0,p=r.offset+2+r.bones.length,m=f,d=0;_<u;++_){var y=l[p++];var g=0,v=0;for(var b=0;b<y;++b){var T=l[p++];var D=this._meshBones[T];if(D!==null){var A=D.globalTransformMatrix;var x=h[m++];var O=h[m++]*i;var S=h[m++]*i;if(e){O+=this._ffdVertices[d++];S+=this._ffdVertices[d++]}g+=(A.a*O+A.c*S+A.tx)*x;v+=(A.b*O+A.d*S+A.ty)*x}}s.vertices[c++]=g;s.vertices[c++]=v}n.$updateVertices();if(!t.EgretFactory._isV5){n.$invalidateTransform()}}else if(e){var o=a.parent.parent.parent;var l=o.intArray;var h=o.floatArray;var u=l[a.offset+0];var E=l[a.offset+2];if(E<0){E+=65536}for(var _=0,B=u*2;_<B;++_){s.vertices[_]=h[E+_]*i+this._ffdVertices[_]}n.$updateVertices();if(!t.EgretFactory._isV5){n.$invalidateTransform()}}if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true}};i.prototype._updateTransform=function(t){t;throw new Error};i.prototype._updateTransformV4=function(t){if(t){if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var e=this._renderDisplay.$renderNode.matrix;e.a=1;e.b=0;e.c=0;e.d=1;e.tx=0;e.ty=0}else{var i=this._renderDisplay.matrix;i.identity();this._renderDisplay.$setMatrix(i,this.transformUpdateEnabled)}}else{var a=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var e=this._renderDisplay.$renderNode.matrix;e.a=a.a;e.b=a.b;e.c=a.c;e.d=a.d;e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY);e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else if(this.transformUpdateEnabled){this._renderDisplay.$setMatrix(a,true)}else{var r=this._renderDisplay.$DisplayObject;var e=r[6];e.a=this.globalTransformMatrix.a;e.b=this.globalTransformMatrix.b;e.c=this.globalTransformMatrix.c;e.d=this.globalTransformMatrix.d;e.tx=this.globalTransformMatrix.tx;e.ty=this.globalTransformMatrix.ty;this._renderDisplay.$removeFlags(8);this._renderDisplay.$invalidatePosition()}}};i.prototype._updateTransformV5=function(t){if(t){var e=this._renderDisplay.matrix;e.identity();this._renderDisplay.$setMatrix(e,this.transformUpdateEnabled)}else{var i=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var a=this._renderDisplay.$renderNode.matrix;a.a=i.a;a.b=i.b;a.c=i.c;a.d=i.d;a.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY);a.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else{this._renderDisplay.$setMatrix(i,this.transformUpdateEnabled)}}};return i}(t.Slot);t.EgretSlot=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(i,e);function i(a){if(a===void 0){a=null}var r=e.call(this,a)||this;if(i._dragonBonesInstance===null){i._isV5=Number(egret.Capabilities.engineVersion.substr(0,3))>=5.1;var n=new t.EgretArmatureDisplay;i._dragonBonesInstance=new t.DragonBones(n);i._dragonBonesInstance.clock.time=egret.getTimer()*.001;egret.startTick(i._clockHandler,i)}r._dragonBones=i._dragonBonesInstance;return r}i._clockHandler=function(t){t*=.001;var e=i._dragonBonesInstance.clock;var a=t-e.time;i._dragonBonesInstance.advanceTime(a);e.time=t;return false};Object.defineProperty(i,"factory",{get:function(){if(i._factory===null){i._factory=new i}return i._factory},enumerable:true,configurable:true});i.prototype._isSupportMesh=function(){if(egret.Capabilities.renderMode==="webgl"||egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE){return true}console.warn("Canvas can not support mesh, please change renderMode to webgl.");return false};i.prototype._buildTextureAtlasData=function(e,i){if(e!==null){if(i instanceof egret.Texture){e.renderTexture=i}else{var a=new egret.Texture;a.bitmapData=new egret.BitmapData(i);e.disposeEnabled=true;e.renderTexture=a}}else{e=t.BaseObject.borrowObject(t.EgretTextureAtlasData)}return e};i.prototype._buildArmature=function(e){var i=t.BaseObject.borrowObject(t.Armature);var a=new t.EgretArmatureDisplay;i.init(e.armature,a,a,this._dragonBones);return i};i.prototype._buildSlot=function(e,i,a,r){e;r;var n=t.BaseObject.borrowObject(t.EgretSlot);n.init(i,a,new egret.Bitmap,new egret.Mesh);return n};i.prototype.buildArmatureDisplay=function(t,e,i,a){if(e===void 0){e=""}if(i===void 0){i=""}if(a===void 0){a=""}var r=this.buildArmature(t,e||"",i||"",a||"");if(r!==null){this._dragonBones.clock.add(r);return r.display}return null};i.prototype.getTextureDisplay=function(t,e){if(e===void 0){e=null}var i=this._getTextureData(e!==null?e:"",t);if(i!==null&&i.renderTexture!==null){var a=i.renderTexture;var r=new egret.Bitmap(a);r.width=a.textureWidth*i.parent.scale;r.height=a.textureHeight*i.parent.scale;return r}return null};Object.defineProperty(i.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:true,configurable:true});Object.defineProperty(i,"clock",{get:function(){return i.factory.clock},enumerable:true,configurable:true});i.prototype.addSkeletonData=function(t,e){if(e===void 0){e=null}console.warn("");this.addDragonBonesData(t,e)};i.prototype.getSkeletonData=function(t){console.warn("");return this.getDragonBonesData(t)};i.prototype.removeSkeletonData=function(t){console.warn("");this.removeDragonBonesData(t)};i.prototype.addTextureAtlas=function(t,e){if(e===void 0){e=null}console.warn("");this.addTextureAtlasData(t,e)};i.prototype.getTextureAtlas=function(t){console.warn("");return this.getTextureAtlasData(t)};i.prototype.removeTextureAtlas=function(t){console.warn("");this.removeTextureAtlasData(t)};i.prototype.buildFastArmature=function(t,e,i){if(e===void 0){e=""}if(i===void 0){i=""}console.warn("");return this.buildArmature(t,e||"",i||"")};i.prototype.dispose=function(){console.warn("");this.clear()};i._isV5=false;i._dragonBonesInstance=null;i._factory=null;return i}(t.BaseFactory);t.EgretFactory=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=new egret.Rectangle;var i=new egret.Matrix;var a={};function r(t,e){for(var i=0,a=t.length;i<a;++i){var r=t[i];if(r.name===e){return r}}return null}function n(t){if(t.groupName){var e=a[t.groupName];if(e){var i=r(e.movie||e.animation,t.movieName);if(i){t.groupConfig=e;t.movieConfig=i;return true}}}if(!t.groupName){for(var n in a){var e=a[n];if(!t.groupName){var i=r(e.movie||e.animation,t.movieName);if(i){t.groupName=n;t.groupConfig=e;t.movieConfig=i;return true}}}}return false}function s(t){return t in a}t.hasMovieGroup=s;function o(t,e,i){if(i===void 0){i=null}if(t){var r=new egret.ByteArray(t);r.endian=egret.Endian.LITTLE_ENDIAN;r.position=8;var n=JSON.parse(r.readUTF());n.offset=r.position;n.arrayBuffer=t;n.textures=[];var s=n.offset%4;if(s){n.offset+=4-s}for(var o=0,l=n.position.length;o<l;o+=3){switch(o/3){case 1:n.displayFrameArray=new Int16Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 2:n.rectangleArray=new Float32Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 3:n.transformArray=new Float32Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 4:n.colorArray=new Int16Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break}}i=i||n.name;if(a[i]){console.warn("Replace group: "+i)}a[i]=n;if(e instanceof Array){for(var o=0,l=e.length;o<l;++o){var h=e[o];n.textures.push(h)}}else{n.textures.push(e)}}else{throw new Error}}t.addMovieGroup=o;function l(t){var e=a[t];if(e){delete a[t]}}t.removeMovieGroup=l;function h(){for(var t in a){delete a[t]}}t.removeAllMovieGroup=h;function u(e,i){if(i===void 0){i=null}var a={movieName:e,groupName:i};if(n(a)){var r=new p(a);r.clock=t.EgretFactory.factory.clock;return r}else{console.warn("No movie named: "+e)}return null}t.buildMovie=u;function f(t){var e=a[t];if(e){var i=[];var r=e.movie||e.animation;for(var n=0,s=r.length;n<s;++n){i.push(r[n].name)}return i}else{console.warn("No group named: "+t)}return null}t.getMovieNames=f;var _=function(t){__extends(e,t);function e(e){var i=t.call(this,e)||this;i.name="";i.slotName="";i.clipName="";return i}Object.defineProperty(e.prototype,"armature",{get:function(){return this.movie},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bone",{get:function(){return null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationState",{get:function(){return{name:this.clipName}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frameLabel",{get:function(){return this.name},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"movementID",{get:function(){return this.clipName},enumerable:true,configurable:true});e.START="start";e.LOOP_COMPLETE="loopComplete";e.COMPLETE="complete";e.FRAME_EVENT="frameEvent";e.SOUND_EVENT="soundEvent";return e}(egret.Event);t.MovieEvent=_;var c=function(t){__extends(e,t);function e(e){var i=t.call(this)||this;i.displayIndex=-1;i.colorIndex=-1;i.transformIndex=-1;i.rawDisplay=new egret.Bitmap;i.childMovies={};i.displayConfig=null;i.childMovie=null;i.colorFilter=null;i.display=i.rawDisplay;i.config=e;i.rawDisplay.name=i.config.name;if(!i.config.blendMode){i.config.blendMode=0}return i}e.prototype.dispose=function(){this.rawDisplay=null;this.childMovies=null;this.config=null;this.displayConfig=null;this.display=null;this.childMovie=null;this.colorFilter=null};return e}(egret.HashObject);var p=function(a){__extends(r,a);function r(t){var e=a.call(this)||this;e.timeScale=1;e.clipTimeScale=1;e._batchEnabled=true;e._isLockDispose=false;e._isDelayDispose=false;e._isStarted=false;e._isPlaying=false;e._isReversing=false;e._isCompleted=false;e._playTimes=0;e._time=0;e._currentTime=0;e._currentPlayTimes=0;e._cacheFrameIndex=0;e._frameSize=0;e._cacheRectangle=null;e._clock=null;e._currentFrameConfig=null;e._clipNames=[];e._slots=[];e._childMovies=[];e._groupConfig=t.groupConfig;e._config=t.movieConfig;e._batchEnabled=!(e._config.isNested||e._config.hasChildAnimation);if(e._batchEnabled){e.$renderNode=new egret.sys.GroupNode;e.$renderNode.cleanBeforeRender=r._cleanBeforeRender}e._clipNames.length=0;for(var i=0,n=e._config.clip.length;i<n;++i){e._clipNames.push(e._config.clip[i].name)}for(var i=0,n=e._config.slot.length;i<n;++i){var s=new c(e._config.slot[i]);e._updateSlotBlendMode(s);e._slots.push(s);if(e._batchEnabled){e.$renderNode.addNode(s.rawDisplay.$renderNode)}else{e.addChild(s.rawDisplay)}}e._frameSize=(1+1)*e._slots.length;e.name=e._config.name;e.play();e.advanceTime(1e-6);e.stop();return e}r._cleanBeforeRender=function(){};r.prototype._configToEvent=function(t,e){e.movie=this;e.clipName=this._clipConfig.name;e.name=t.name;e.slotName=t.slot||""};r.prototype._onCrossFrame=function(e){for(var i=0,a=e.actionAndEvent.length;i<a;++i){var r=e.actionAndEvent[i];if(r){switch(r.type){case 11:if(t.EgretFactory.factory.soundEventManager.hasEventListener(_.SOUND_EVENT)){var n=egret.Event.create(_,_.SOUND_EVENT);this._configToEvent(r,n);t.EgretFactory.factory.soundEventManager.dispatchEvent(n);egret.Event.release(n)}break;case 10:if(this.hasEventListener(_.FRAME_EVENT)){var s=egret.Event.create(_,_.FRAME_EVENT);this._configToEvent(r,s);this.dispatchEvent(s);egret.Event.release(s)}break;case 0:if(r.slot){var o=this._getSlot(r.slot);if(o&&o.childMovie){o.childMovie.play(r.name)}}else{this.play(r.name)}break}}}};r.prototype._updateSlotBlendMode=function(t){var e="";switch(t.config.blendMode){case 0:e=egret.BlendMode.NORMAL;break;case 1:e=egret.BlendMode.ADD;break;case 5:e=egret.BlendMode.ERASE;break;default:break}if(e){if(this._batchEnabled){t.display.$renderNode.blendMode=egret.sys.blendModeToNumber(e)}else{t.display.blendMode=e}}};r.prototype._updateSlotColor=function(t,e,i,a,r,n,s,o,l){if(i!==1||a!==1||r!==1||s!==0||o!==0||l!==0||n!==0){if(!t.colorFilter){t.colorFilter=new egret.ColorMatrixFilter}var h=t.colorFilter.matrix;h[0]=i;h[6]=a;h[12]=r;h[18]=e;h[4]=s;h[9]=o;h[14]=l;h[19]=n;t.colorFilter.matrix=h;if(this._batchEnabled){t.display.$renderNode.filter=t.colorFilter;t.display.$renderNode.alpha=1}else{var u=t.display.filters;if(!u){u=[]}if(u.indexOf(t.colorFilter)<0){u.push(t.colorFilter)}t.display.filters=u;t.display.$setAlpha(1)}}else{if(t.colorFilter){t.colorFilter=null}if(this._batchEnabled){t.display.$renderNode.filter=null;t.display.$renderNode.alpha=e}else{t.display.filters=null;t.display.$setAlpha(e)}}};r.prototype._updateSlotDisplay=function(e){var i=e.display||e.rawDisplay;var a=e.childMovie;if(e.displayIndex>=0){e.displayConfig=this._groupConfig.display[e.displayIndex];if(e.displayConfig.type===1){var r=e.displayConfig.name in e.childMovies?e.childMovies[e.displayConfig.name]:null;if(!r){r=u(e.displayConfig.name,this._groupConfig.name);if(r){e.childMovies[e.displayConfig.name]=r}}if(r){e.display=r;e.childMovie=r}else{e.display=e.rawDisplay;e.childMovie=null}}else{e.display=e.rawDisplay;e.childMovie=null}}else{e.displayConfig=null;e.display=e.rawDisplay;e.childMovie=null}if(e.display!==i){if(i){this.addChild(e.display);this.swapChildren(e.display,i);this.removeChild(i)}this._updateSlotBlendMode(e)}if(e.display===e.rawDisplay){if(e.displayConfig&&e.displayConfig.regionIndex!==null&&e.displayConfig.regionIndex!==undefined){if(!e.displayConfig.texture){var n=this._groupConfig.textures[e.displayConfig.textureIndex||0];var s=e.displayConfig.regionIndex*4;var o=this._groupConfig.rectangleArray[s];var l=this._groupConfig.rectangleArray[s+1];var h=this._groupConfig.rectangleArray[s+2];var f=this._groupConfig.rectangleArray[s+3];e.displayConfig.texture=new egret.Texture;if(t.EgretFactory._isV5){e.displayConfig.texture["$bitmapData"]=n["$bitmapData"]}else{e.displayConfig.texture._bitmapData=n._bitmapData}e.displayConfig.texture.$initData(o,l,Math.min(h,n.textureWidth-o),Math.min(f,n.textureHeight-l),0,0,Math.min(h,n.textureWidth-o),Math.min(f,n.textureHeight-l),n.textureWidth,n.textureHeight)}if(this._batchEnabled){var _=e.displayConfig.texture;var c=e.rawDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(e.rawDisplay.$renderNode);if(t.EgretFactory._isV5){c.image=_["$bitmapData"];c.drawImage(_.$bitmapX,_.$bitmapY,_.$bitmapWidth,_.$bitmapHeight,_.$offsetX,_.$offsetY,_.textureWidth,_.textureHeight);c.imageWidth=_._sourceWidth;c.imageHeight=_._sourceHeight}else{c.image=_._bitmapData;c.drawImage(_._bitmapX,_._bitmapY,_._bitmapWidth,_._bitmapHeight,_._offsetX,_._offsetY,_.textureWidth,_.textureHeight);c.imageWidth=_._sourceWidth;c.imageHeight=_._sourceHeight}}else{e.rawDisplay.visible=true;e.rawDisplay.$setBitmapData(e.displayConfig.texture)}}else{if(this._batchEnabled){e.rawDisplay.$renderNode.image=null}else{e.rawDisplay.visible=false;e.rawDisplay.$setBitmapData(null)}}}if(e.childMovie!==a){if(a){a.stop();this._childMovies.slice(this._childMovies.indexOf(a),1)}if(e.childMovie){if(this._childMovies.indexOf(e.childMovie)<0){this._childMovies.push(e.childMovie)}if(e.config.action){e.childMovie.play(e.config.action)}else{e.childMovie.play(e.childMovie._config.action)}}}};r.prototype._getSlot=function(t){for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];if(a.config.name===t){return a}}return null};r.prototype.$render=function(){if(this._batchEnabled){}else{a.prototype.$render.call(this)}};r.prototype.$measureContentBounds=function(t){if(this._batchEnabled&&this._cacheRectangle){t.setTo(this._cacheRectangle.x,this._cacheRectangle.y,this._cacheRectangle.width-this._cacheRectangle.x,this._cacheRectangle.height-this._cacheRectangle.y)}else{a.prototype.$measureContentBounds.call(this,t)}};r.prototype.$doAddChild=function(t,e,i){if(this._batchEnabled){console.warn("Can not add child.");return null}return a.prototype.$doAddChild.call(this,t,e,i)};r.prototype.$doRemoveChild=function(t,e){if(this._batchEnabled){console.warn("Can not remove child.");return null}return a.prototype.$doRemoveChild.call(this,t,e)};r.prototype.dispose=function(){if(this._isLockDispose){this._isDelayDispose=true}else{if(this._clock){this._clock.remove(this)}if(this._slots){for(var t=0,e=this._slots.length;t<e;++t){this._slots[t].dispose()}}this._isPlaying=false;this._cacheRectangle=null;this._clock=null;this._groupConfig=null;this._config=null;this._clipConfig=null;this._currentFrameConfig=null;this._clipArray=null;this._clipNames=null;this._slots=null;this._childMovies=null}};r.prototype.advanceTime=function(t){if(this._isPlaying){this._isLockDispose=true;if(t<0){t=-t}t*=this.timeScale;this._time+=t*this.clipTimeScale;var a=this._clipConfig.duration;var r=a*this._playTimes;var n=this._time;var s=this._currentPlayTimes;if(this._playTimes>0&&(n>=r||n<=-r)){this._isCompleted=true;s=this._playTimes;if(n<0){n=0}else{n=a}}else{this._isCompleted=false;if(n<0){s=Math.floor(-n/a);n=a- -n%a}else{s=Math.floor(n/a);n%=a}if(this._playTimes>0&&s>this._playTimes){s=this._playTimes}}if(this._currentTime===n){return}var o=Math.floor(n*this._clipConfig.cacheTimeToFrameScale);if(this._cacheFrameIndex!==o){this._cacheFrameIndex=o;var l=this._groupConfig.displayFrameArray;var h=this._groupConfig.transformArray;var u=this._groupConfig.colorArray;var f=true;var c=false;var p=false;var m=this._cacheRectangle;this._cacheRectangle=this._clipConfig.cacheRectangles[this._cacheFrameIndex];if(this._batchEnabled&&!this._cacheRectangle){p=true;this._cacheRectangle=new egret.Rectangle;this._clipConfig.cacheRectangles[this._cacheFrameIndex]=this._cacheRectangle}for(var d=0,y=this._slots.length;d<y;++d){var g=this._slots[d];var v=this._frameSize*this._cacheFrameIndex+d*2;if(v>=this._clipArray.length){v=this._frameSize*(this._cacheFrameIndex-1)+d*2}var b=this._clipArray[v]*2;if(b>=0){var T=l[b];var D=l[b+1]*8;var A=this._clipArray[v+1]*6;var x=false;if(g.displayIndex!==T){g.displayIndex=T;x=true;this._updateSlotDisplay(g)}if(g.colorIndex!==D||x){g.colorIndex=D;if(g.colorIndex>=0){this._updateSlotColor(g,u[D]*.01,u[D+1]*.01,u[D+2]*.01,u[D+3]*.01,u[D+4],u[D+5],u[D+6],u[D+7])}else{this._updateSlotColor(g,1,1,1,1,0,0,0,0)}}c=true;if(g.transformIndex!==A){g.transformIndex=A;if(this._batchEnabled){var O=g.display.$renderNode.matrix;if(!O){O=g.display.$renderNode.matrix=new egret.Matrix}O.a=h[A];O.b=h[A+1];O.c=h[A+2];O.d=h[A+3];O.tx=h[A+4];O.ty=h[A+5]}else{i.a=h[A];i.b=h[A+1];i.c=h[A+2];i.d=h[A+3];i.tx=h[A+4];i.ty=h[A+5];g.display.$setMatrix(i)}}if(this._batchEnabled&&p&&g.displayConfig){var O=g.display.$renderNode.matrix;e.x=0;e.y=0;e.width=g.displayConfig.texture.textureWidth;e.height=g.displayConfig.texture.textureHeight;O.$transformBounds(e);if(f){f=false;this._cacheRectangle.x=e.x;this._cacheRectangle.width=e.x+e.width;this._cacheRectangle.y=e.y;this._cacheRectangle.height=e.y+e.height}else{this._cacheRectangle.x=Math.min(this._cacheRectangle.x,e.x);this._cacheRectangle.width=Math.max(this._cacheRectangle.width,e.x+e.width);this._cacheRectangle.y=Math.min(this._cacheRectangle.y,e.y);this._cacheRectangle.height=Math.max(this._cacheRectangle.height,e.y+e.height)}}}else if(g.displayIndex!==-1){g.displayIndex=-1;this._updateSlotDisplay(g)}}if(this._cacheRectangle){if(c&&p&&f&&m){this._cacheRectangle.x=m.x;this._cacheRectangle.y=m.y;this._cacheRectangle.width=m.width;this._cacheRectangle.height=m.height}this.$invalidateContentBounds()}}if(this._isCompleted){this._isPlaying=false}if(!this._isStarted){this._isStarted=true;if(this.hasEventListener(_.START)){var S=egret.Event.create(_,_.START);S.movie=this;S.clipName=this._clipConfig.name;S.name="";S.slotName="";this.dispatchEvent(S)}}this._isReversing=this._currentTime>n&&this._currentPlayTimes===s;this._currentTime=n;var E=this._clipConfig.frame?this._clipConfig.frame.length:0;if(E>0){var B=Math.floor(this._currentTime*this._config.frameRate);var M=this._groupConfig.frame[this._clipConfig.frame[B]];if(this._currentFrameConfig!==M){if(E>1){var w=this._currentFrameConfig;this._currentFrameConfig=M;if(!w){var P=Math.floor(this._currentTime*this._config.frameRate);w=this._groupConfig.frame[this._clipConfig.frame[P]];if(this._isReversing){}else{if(this._currentTime<=w.position||this._currentPlayTimes!==s){w=this._groupConfig.frame[w.prev]}}}if(this._isReversing){while(w!==M){this._onCrossFrame(w);w=this._groupConfig.frame[w.prev]}}else{while(w!==M){w=this._groupConfig.frame[w.next];this._onCrossFrame(w)}}}else{this._currentFrameConfig=M;if(this._currentFrameConfig){this._onCrossFrame(this._currentFrameConfig)}}}}if(this._currentPlayTimes!==s){this._currentPlayTimes=s;if(this.hasEventListener(_.LOOP_COMPLETE)){var C=egret.Event.create(_,_.LOOP_COMPLETE);C.movie=this;C.clipName=this._clipConfig.name;C.name="";C.slotName="";this.dispatchEvent(C);egret.Event.release(C)}if(this._isCompleted&&this.hasEventListener(_.COMPLETE)){var I=egret.Event.create(_,_.COMPLETE);I.movie=this;I.clipName=this._clipConfig.name;I.name="";I.slotName="";this.dispatchEvent(I);egret.Event.release(I)}}}this._isLockDispose=false;if(this._isDelayDispose){this.dispose()}};r.prototype.play=function(t,e){if(t===void 0){t=null}if(e===void 0){e=-1}if(t){var i=null;for(var a=0,r=this._config.clip.length;a<r;++a){var n=this._config.clip[a];if(n.name===t){i=n}}if(i){this._clipConfig=i;this._clipArray=new Int16Array(this._groupConfig.arrayBuffer,this._groupConfig.offset+this._groupConfig.position[0]+this._clipConfig.p,this._clipConfig.s/this._groupConfig.position[2]);if(!this._clipConfig.cacheRectangles){this._clipConfig.cacheRectangles=[]}this._isPlaying=true;this._isStarted=false;this._isCompleted=false;if(e<0||e!==e){this._playTimes=this._clipConfig.playTimes}else{this._playTimes=e}this._time=0;this._currentTime=0;this._currentPlayTimes=0;this._cacheFrameIndex=-1;this._currentFrameConfig=null;this._cacheRectangle=null;this.clipTimeScale=1/this._clipConfig.scale}else{console.warn("No clip in movie.",this._config.name,t)}}else if(this._clipConfig){if(this._isPlaying||this._isCompleted){this.play(this._clipConfig.name,this._playTimes)}else{this._isPlaying=true}}else if(this._config.action){this.play(this._config.action,e)}};r.prototype.stop=function(){this._isPlaying=false};r.prototype.gotoAndPlay=function(t,e,i){if(t===void 0){t=null}if(i===void 0){i=-1}e%=this._clipConfig.duration;if(e<0){e+=this._clipConfig.duration}this.play(t,i);this._time=e;this._currentTime=e};r.prototype.gotoAndStop=function(t,e){if(t===void 0){t=null}e%=this._clipConfig.duration;if(e<0){e+=this._clipConfig.duration}this.play(t,1);this._time=e;this._currentTime=e;this.advanceTime(.001);this.stop()};r.prototype.hasClip=function(t){for(var e=0,i=this._config.clip.length;e<i;++e){var a=this._config.clip[e];if(a.name===t){return true}}return false};Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._isCompleted},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"isComplete",{get:function(){return this._isCompleted},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"totalTime",{get:function(){return this._clipConfig?this._clipConfig.duration:0},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"currentPlayTimes",{get:function(){return this._currentPlayTimes},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"playTimes",{get:function(){return this._playTimes},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"groupName",{get:function(){return this._groupConfig.name},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"clipName",{get:function(){return this._clipConfig?this._clipConfig.name:""},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"clipNames",{get:function(){return this._clipNames},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock===t){return}var e=this._clock;if(e){e.remove(this)}this._clock=t;if(this._clock){this._clock.add(this)}},enumerable:true,configurable:true});r.prototype.advanceTimeBySelf=function(e){if(e){this.clock=t.EgretFactory.clock}else{this.clock=null}};Object.defineProperty(r.prototype,"display",{get:function(){return this},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"animation",{get:function(){return this},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"armature",{get:function(){return this},enumerable:true,configurable:true});r.prototype.getAnimation=function(){return this};r.prototype.getArmature=function(){return this};r.prototype.getDisplay=function(){return this};r.prototype.hasAnimation=function(t){return this.hasClip(t)};r.prototype.invalidUpdate=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}t};Object.defineProperty(r.prototype,"lastAnimationName",{get:function(){return this.clipName},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"animationNames",{get:function(){return this.clipNames},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"animationList",{get:function(){return this.clipNames},enumerable:true,configurable:true});return r}(egret.DisplayObjectContainer);t.Movie=p})(dragonBones||(dragonBones={}));!function(e,t){"function"==typeof define&&define.amd?define([],t):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t():(e.dcodeIO=e.dcodeIO||{}).Long=t()}(this,function(){"use strict";function e(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function t(e){return(e&&e.__isLong__)===!0}function i(e,t){return t?0<=(e>>>=0)&&256>e:-128<=(e|=0)&&128>e}function r(e,t){var r,n,o;return t?(o=i(e>>>=0,!0))&&(n=h[e])?n:(r=s(e,0>(0|e)?-1:0,!0),o&&(h[e]=r),r):(o=i(e|=0,!1))&&(n=a[e])?n:(r=s(e,0>e?-1:0,!1),o&&(a[e]=r),r)}function n(e,t){if(isNaN(e)||!isFinite(e))return t?v:E;if(t){if(0>e)return v;if(e>=d)return I}else{if(-g>=e)return S;if(e+1>=g)return T}return 0>e?n(-e,t).neg():s(e%p|0,e/p|0,t)}function s(t,i,r){return new e(t,i,r)}function o(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return E;if("number"==typeof t&&(i=t,t=!1),i=i||10,2>i||i>36)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return o(e.substring(1),t,i).neg();for(var s=n(l(i,8)),f=E,a=0;a<e.length;a+=8){var h=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+h),i);if(8>h){var c=n(l(i,h));f=f.mul(c).add(n(u))}else f=f.mul(s),f=f.add(n(u))}return f.unsigned=t,f}function f(t){return t instanceof e?t:"number"==typeof t?n(t):"string"==typeof t?o(t):s(t.low,t.high,t.unsigned)}e.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var a={},h={};e.fromInt=r,e.fromNumber=n,e.fromBits=s;var l=Math.pow;e.fromString=o,e.fromValue=f;var u=65536,c=1<<24,p=u*u,d=p*p,g=d/2,y=r(c),E=r(0);e.ZERO=E;var v=r(0,!0);e.UZERO=v;var w=r(1);e.ONE=w;var m=r(1,!0);e.UONE=m;var b=r(-1);e.NEG_ONE=b;var T=s(-1,2147483647,!1);e.MAX_VALUE=T;var I=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=I;var S=s(0,-2147483648,!1);e.MIN_VALUE=S;var P=e.prototype;return P.toInt=function(){return this.unsigned?this.low>>>0:this.low},P.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},P.toString=function(e){if(e=e||10,2>e||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=n(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=n(l(e,6),this.unsigned),o=this,f="";;){var a=o.div(s),h=o.sub(a.mul(s)).toInt()>>>0,u=h.toString(e);if(o=a,o.isZero())return u+f;for(;u.length<6;)u="0"+u;f=""+u+f}},P.getHighBits=function(){return this.high},P.getHighBitsUnsigned=function(){return this.high>>>0},P.getLowBits=function(){return this.low},P.getLowBitsUnsigned=function(){return this.low>>>0},P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},P.isZero=function(){return 0===this.high&&0===this.low},P.isNegative=function(){return!this.unsigned&&this.high<0},P.isPositive=function(){return this.unsigned||this.high>=0},P.isOdd=function(){return 1===(1&this.low)},P.isEven=function(){return 0===(1&this.low)},P.equals=function(e){return t(e)||(e=f(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},P.eq=P.equals,P.notEquals=function(e){return!this.eq(e)},P.neq=P.notEquals,P.lessThan=function(e){return this.comp(e)<0},P.lt=P.lessThan,P.lessThanOrEqual=function(e){return this.comp(e)<=0},P.lte=P.lessThanOrEqual,P.greaterThan=function(e){return this.comp(e)>0},P.gt=P.greaterThan,P.greaterThanOrEqual=function(e){return this.comp(e)>=0},P.gte=P.greaterThanOrEqual,P.compare=function(e){if(t(e)||(e=f(e)),this.eq(e))return 0;var i=this.isNegative(),r=e.isNegative();return i&&!r?-1:!i&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},P.comp=P.compare,P.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(w)},P.neg=P.negate,P.add=function(e){t(e)||(e=f(e));var i=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,a=e.high>>>16,h=65535&e.high,l=e.low>>>16,u=65535&e.low,c=0,p=0,d=0,g=0;return g+=o+u,d+=g>>>16,g&=65535,d+=n+l,p+=d>>>16,d&=65535,p+=r+h,c+=p>>>16,p&=65535,c+=i+a,c&=65535,s(d<<16|g,c<<16|p,this.unsigned)},P.subtract=function(e){return t(e)||(e=f(e)),this.add(e.neg())},P.sub=P.subtract,P.multiply=function(e){if(this.isZero())return E;if(t(e)||(e=f(e)),e.isZero())return E;if(this.eq(S))return e.isOdd()?S:E;if(e.eq(S))return this.isOdd()?S:E;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return n(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,h=e.high>>>16,l=65535&e.high,u=e.low>>>16,c=65535&e.low,p=0,d=0,g=0,v=0;return v+=a*c,g+=v>>>16,v&=65535,g+=o*c,d+=g>>>16,g&=65535,g+=a*u,d+=g>>>16,g&=65535,d+=r*c,p+=d>>>16,d&=65535,d+=o*u,p+=d>>>16,d&=65535,d+=a*l,p+=d>>>16,d&=65535,p+=i*c+r*u+o*l+a*h,p&=65535,s(g<<16|v,p<<16|d,this.unsigned)},P.mul=P.multiply,P.divide=function(e){if(t(e)||(e=f(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?v:E;var i,r,s;if(this.eq(S)){if(e.eq(w)||e.eq(b))return S;if(e.eq(S))return w;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(E)?e.isNegative()?w:b:(r=this.sub(e.mul(i)),s=i.add(r.div(e)))}if(e.eq(S))return this.unsigned?v:E;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();for(s=E,r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),h=48>=a?1:l(2,a-48),u=n(i),c=u.mul(e);c.isNegative()||c.gt(r);)i-=h,u=n(i,this.unsigned),c=u.mul(e);u.isZero()&&(u=w),s=s.add(u),r=r.sub(c)}return s},P.div=P.divide,P.modulo=function(e){return t(e)||(e=f(e)),this.sub(this.div(e).mul(e))},P.mod=P.modulo,P.not=function(){return s(~this.low,~this.high,this.unsigned)},P.and=function(e){return t(e)||(e=f(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},P.or=function(e){return t(e)||(e=f(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},P.xor=function(e){return t(e)||(e=f(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},P.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},P.shl=P.shiftLeft,P.shiftRight=function(e){return t(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},P.shr=P.shiftRight,P.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),e&=63,0===e)return this;var i=this.high;if(32>e){var r=this.low;return s(r>>>e|i<<32-e,i>>>e,this.unsigned)}return 32===e?s(i,0,this.unsigned):s(i>>>e-32,0,this.unsigned)},P.shru=P.shiftRightUnsigned,P.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},P.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},e}),function(e,t){"function"==typeof define&&define.amd?define(["long"],t):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=function(){var e;try{e=require("long")}catch(i){}return t(e)}():(e.dcodeIO=e.dcodeIO||{}).ByteBuffer=t(e.dcodeIO.Long)}(this,function(e){"use strict";function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function i(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,i,r,n){var s,o,f=8*n-r-1,a=(1<<f)-1,h=a>>1,l=-7,u=i?n-1:0,c=i?-1:1,p=e[t+u];for(u+=c,s=p&(1<<-l)-1,p>>=-l,l+=f;l>0;s=256*s+e[t+u],u+=c,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=r;l>0;o=256*o+e[t+u],u+=c,l-=8);if(0===s)s=1-h;else{if(s===a)return o?0/0:(p?-1:1)*(1/0);o+=Math.pow(2,r),s-=h}return(p?-1:1)*o*Math.pow(2,s-r)}function n(e,t,i,r,n,s){var o,f,a,h=8*s-n-1,l=(1<<h)-1,u=l>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,d=r?1:-1,g=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(f=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-o))<1&&(o--,a*=2),t+=o+u>=1?c/a:c*Math.pow(2,1-u),t*a>=2&&(o++,a/=2),o+u>=l?(f=0,o=l):o+u>=1?(f=(t*a-1)*Math.pow(2,n),o+=u):(f=t*Math.pow(2,u-1)*Math.pow(2,n),o=0));n>=8;e[i+p]=255&f,p+=d,f/=256,n-=8);for(o=o<<n|f,h+=n;h>0;e[i+p]=255&o,p+=d,o/=256,h-=8);e[i+p-d]|=128*g}var s=function(e,t,i){if("undefined"==typeof e&&(e=s.DEFAULT_CAPACITY),"undefined"==typeof t&&(t=s.DEFAULT_ENDIAN),"undefined"==typeof i&&(i=s.DEFAULT_NOASSERT),!i){if(e=0|e,0>e)throw RangeError("Illegal capacity");t=!!t,i=!!i}this.buffer=0===e?f:new ArrayBuffer(e),this.view=0===e?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian=t,this.noAssert=i};s.VERSION="5.0.0",s.LITTLE_ENDIAN=!0,s.BIG_ENDIAN=!1,s.DEFAULT_CAPACITY=16,s.DEFAULT_ENDIAN=s.BIG_ENDIAN,s.DEFAULT_NOASSERT=!1,s.Long=e||null;var o=s.prototype;o.__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var f=new ArrayBuffer(0),a=String.fromCharCode;s.accessor=function(){return Uint8Array},s.allocate=function(e,t,i){return new s(e,t,i)},s.concat=function(e,t,i,r){("boolean"==typeof t||"string"!=typeof t)&&(r=i,i=t,t=void 0);for(var n,o=0,f=0,a=e.length;a>f;++f)s.isByteBuffer(e[f])||(e[f]=s.wrap(e[f],t)),n=e[f].limit-e[f].offset,n>0&&(o+=n);if(0===o)return new s(0,i,r);var h,l=new s(o,i,r);for(f=0;a>f;)h=e[f++],n=h.limit-h.offset,0>=n||(l.view.set(h.view.subarray(h.offset,h.limit),l.offset),l.offset+=n);return l.limit=l.offset,l.offset=0,l},s.isByteBuffer=function(e){return(e&&e.__isByteBuffer__)===!0},s.type=function(){return ArrayBuffer},s.wrap=function(e,t,i,r){if("string"!=typeof t&&(r=i,i=t,t=void 0),"string"==typeof e)switch("undefined"==typeof t&&(t="utf8"),t){case"base64":return s.fromBase64(e,i);case"hex":return s.fromHex(e,i);case"binary":return s.fromBinary(e,i);case"utf8":return s.fromUTF8(e,i);case"debug":return s.fromDebug(e,i);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");var n;if(s.isByteBuffer(e))return n=o.clone.call(e),n.markedOffset=-1,n;if(e instanceof Uint8Array)n=new s(0,i,r),e.length>0&&(n.buffer=e.buffer,n.offset=e.byteOffset,n.limit=e.byteOffset+e.byteLength,n.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)n=new s(0,i,r),e.byteLength>0&&(n.buffer=e,n.offset=0,n.limit=e.byteLength,n.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");n=new s(e.length,i,r),n.limit=e.length;for(var f=0;f<e.length;++f)n.view[f]=e[f]}return n},o.readBytes=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}var r=this.slice(t,t+e);return i&&(this.offset+=e),r},o.writeBytes=o.append,o.writeInt8=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,i&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=this.view[e];return 128===(128&i)&&(i=-(255-i+1)),t&&(this.offset+=1),i},o.readByte=o.readInt8,o.writeUint8=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,i&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=this.view[e];return t&&(this.offset+=1),i},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),i&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e],i|=this.view[e+1]<<8):(i=this.view[e]<<8,i|=this.view[e+1]),32768===(32768&i)&&(i=-(65535-i+1)),t&&(this.offset+=2),i},o.readShort=o.readInt16,o.writeUint16=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),i&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e],i|=this.view[e+1]<<8):(i=this.view[e]<<8,i|=this.view[e+1]),t&&(this.offset+=2),i},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),i&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e+2]<<16,i|=this.view[e+1]<<8,i|=this.view[e],i+=this.view[e+3]<<24>>>0):(i=this.view[e+1]<<16,i|=this.view[e+2]<<8,i|=this.view[e+3],i+=this.view[e]<<24>>>0),i|=0,t&&(this.offset+=4),i},o.readInt=o.readInt32,o.writeUint32=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),i&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e+2]<<16,i|=this.view[e+1]<<8,i|=this.view[e],i+=this.view[e+3]<<24>>>0):(i=this.view[e+1]<<16,i|=this.view[e+2]<<8,i|=this.view[e+3],i+=this.view[e]<<24>>>0),t&&(this.offset+=4),i},o.readUInt32=o.readUint32,e&&(o.writeInt64=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var s=t.low,o=t.high;return this.littleEndian?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o):(this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),r&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,n=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var s=new e(r,n,!1);return i&&(this.offset+=8),s},o.readLong=o.readInt64,o.writeUint64=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var s=t.low,o=t.high;return this.littleEndian?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o):(this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),r&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,n=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var s=new e(r,n,!0);return i&&(this.offset+=8),s},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,n(this.view,e,t,this.littleEndian,23,4),i&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=r(this.view,e,this.littleEndian,23,4);return t&&(this.offset+=4),i},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=8,n(this.view,e,t,this.littleEndian,52,8),i&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var i=r(this.view,e,this.littleEndian,52,8);return t&&(this.offset+=8),i},o.readDouble=o.readFloat64,s.MAX_VARINT32_BYTES=5,s.calculateVarint32=function(e){return e>>>=0,128>e?1:16384>e?2:1<<21>e?3:1<<28>e?4:5},s.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},s.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},o.writeVarint32=function(e,t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,n=s.calculateVarint32(e);t+=n;var o=this.buffer.byteLength;for(t>o&&this.resize((o*=2)>t?o:t),t-=n,e>>>=0;e>=128;)r=127&e|128,this.view[t++]=r,e>>>=7;return this.view[t++]=e,i?(this.offset=t,this):n},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(s.zigZagEncode32(e),t)},o.readVarint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i,r=0,n=0;do{if(!this.noAssert&&e>this.limit){var s=Error("Truncated");throw s.truncated=!0,s}i=this.view[e++],5>r&&(n|=(127&i)<<7*r),++r}while(0!==(128&i));return n|=0,t?(this.offset=e,n):{value:n,length:r}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=s.zigZagDecode32(t.value):t=s.zigZagDecode32(t),t},e&&(s.MAX_VARINT64_BYTES=10,s.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var i=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,n=t.shiftRightUnsigned(56).toInt()>>>0;return 0==n?0==r?16384>i?128>i?1:2:1<<21>i?3:4:16384>r?128>r?5:6:1<<21>r?7:8:128>n?9:10},s.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},s.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned());var n=s.calculateVarint64(t),o=t.toInt()>>>0,f=t.shiftRightUnsigned(28).toInt()>>>0,a=t.shiftRightUnsigned(56).toInt()>>>0;i+=n;var h=this.buffer.byteLength;switch(i>h&&this.resize((h*=2)>i?h:i),i-=n,n){case 10:this.view[i+9]=a>>>7&1;case 9:this.view[i+8]=9!==n?128|a:127&a;case 8:this.view[i+7]=8!==n?f>>>21|128:f>>>21&127;case 7:this.view[i+6]=7!==n?f>>>14|128:f>>>14&127;case 6:this.view[i+5]=6!==n?f>>>7|128:f>>>7&127;case 5:this.view[i+4]=5!==n?128|f:127&f;case 4:this.view[i+3]=4!==n?o>>>21|128:o>>>21&127;case 3:this.view[i+2]=3!==n?o>>>14|128:o>>>14&127;case 2:this.view[i+1]=2!==n?o>>>7|128:o>>>7&127;case 1:this.view[i]=1!==n?128|o:127&o}return r?(this.offset+=n,this):n},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(s.zigZagEncode64(e),t)},o.readVarint64=function(t){var i="undefined"==typeof t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r=t,n=0,s=0,o=0,f=0;if(f=this.view[t++],n=127&f,128&f&&(f=this.view[t++],n|=(127&f)<<7,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],n|=(127&f)<<14,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],n|=(127&f)<<21,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],s=127&f,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],s|=(127&f)<<7,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],s|=(127&f)<<14,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],s|=(127&f)<<21,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],o=127&f,(128&f||this.noAssert&&"undefined"==typeof f)&&(f=this.view[t++],o|=(127&f)<<7,128&f||this.noAssert&&"undefined"==typeof f))))))))))throw Error("Buffer overrun");var a=e.fromBits(n|s<<28,s>>>4|o<<24,!1);return i?(this.offset=t,a):{value:a,length:t-r}},o.readVarint64ZigZag=function(t){var i=this.readVarint64(t);return i&&i.value instanceof e?i.value=s.zigZagDecode64(i.value):i=s.zigZagDecode64(i),i}),o.writeCString=function(e,i){var r="undefined"==typeof i;r&&(i=this.offset);var n,s=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(n=0;s>n;++n)if(0===e.charCodeAt(n))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=l.calculateUTF16asUTF8(t(e))[1],i+=s+1;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=s+1,l.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),this.view[i++]=0,r?(this.offset=i,this):s},o.readCString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,n=e,s=-1;return l.decodeUTF8toUTF16(function(){if(0===s)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return s=this.view[e++],0===s?null:s}.bind(this),r=i(),!0),t?(this.offset=e,r()):{string:r(),length:e-n}},o.writeIString=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,s=i;n=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],i+=4+n;var o=this.buffer.byteLength;if(i>o&&this.resize((o*=2)>i?o:i),i-=4+n,this.littleEndian?(this.view[i+3]=n>>>24&255,this.view[i+2]=n>>>16&255,this.view[i+1]=n>>>8&255,this.view[i]=255&n):(this.view[i]=n>>>24&255,this.view[i+1]=n>>>16&255,this.view[i+2]=n>>>8&255,this.view[i+3]=255&n),i+=4,l.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),i!==s+4+n)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+n));return r?(this.offset=i,this):i-s},o.readIString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=e,r=this.readUint32(e),n=this.readUTF8String(r,s.METRICS_BYTES,e+=4);return e+=n.length,t?(this.offset=e,n.string):{string:n.string,length:e-i}},s.METRICS_CHARS="c",s.METRICS_BYTES="b",o.writeUTF8String=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,s=i;n=l.calculateUTF16asUTF8(t(e))[1],i+=n;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=n,l.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),r?(this.offset=i,this):i-s},o.writeString=o.writeUTF8String,s.calculateUTF8Chars=function(e){return l.calculateUTF16asUTF8(t(e))[0]
},s.calculateUTF8Bytes=function(e){return l.calculateUTF16asUTF8(t(e))[1]},s.calculateString=s.calculateUTF8Bytes,o.readUTF8String=function(e,t,r){"number"==typeof t&&(r=t,t=void 0);var n="undefined"==typeof r;if(n&&(r=this.offset),"undefined"==typeof t&&(t=s.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var o,f=0,a=r;if(t===s.METRICS_CHARS){if(o=i(),l.decodeUTF8(function(){return e>f&&r<this.limit?this.view[r++]:null}.bind(this),function(e){++f,l.UTF8toUTF16(e,o)}),f!==e)throw RangeError("Illegal range: Truncated data, "+f+" == "+e);return n?(this.offset=r,o()):{string:o(),length:r-a}}if(t===s.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}var h=r+e;if(l.decodeUTF8toUTF16(function(){return h>r?this.view[r++]:null}.bind(this),o=i(),this.noAssert),r!==h)throw RangeError("Illegal range: Truncated data, "+r+" == "+h);return n?(this.offset=r,o()):{string:o(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,o,f=i;n=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],o=s.calculateVarint32(n),i+=o+n;var a=this.buffer.byteLength;if(i>a&&this.resize((a*=2)>i?a:i),i-=o+n,i+=this.writeVarint32(n,i),l.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),i!==f+n+o)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+n+o));return r?(this.offset=i,this):i-f},o.readVString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=e,r=this.readVarint32(e),n=this.readUTF8String(r.value,s.METRICS_BYTES,e+=r.length);return e+=n.length,t?(this.offset=e,n.string):{string:n.string,length:e-i}},o.append=function(e,t,i){("number"==typeof t||"string"!=typeof t)&&(i=t,t=void 0);var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}e instanceof s||(e=s.wrap(e,t));var n=e.limit-e.offset;if(0>=n)return this;i+=n;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=n,this.view.set(e.view.subarray(e.offset,e.limit),i),e.offset+=n,r&&(this.offset+=n),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new s(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var i=t-e;if(0===i)return this.buffer=f,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(i),n=new Uint8Array(r);return n.set(this.view.subarray(e,t)),this.buffer=r,this.view=n,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=i,this},o.copy=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new s(0,this.littleEndian,this.noAssert);var i=t-e,r=new s(i,this.littleEndian,this.noAssert);return r.offset=0,r.limit=i,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},o.copyTo=function(e,t,i,r){var n,o;if(!this.noAssert&&!s.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o="undefined"==typeof t)?e.offset:0|t,i=(n="undefined"==typeof i)?this.offset:0|i,r="undefined"==typeof r?this.limit:0|r,0>t||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(0>i||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+i+" <= "+this.buffer.byteLength);var f=r-i;return 0===f?e:(e.ensureCapacity(t+f),e.view.set(this.view.subarray(i,r),t),n&&(this.offset+=f),o&&(e.offset+=f),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,i){var r="undefined"==typeof t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),"undefined"==typeof t&&(t=this.offset),"undefined"==typeof i&&(i=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!==0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,0>t||t>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t>=i)return this;for(;i>t;)this.view[t++]=e;return r&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian="undefined"!=typeof e?!!e:!0,this},o.BE=function(e){return this.littleEndian="undefined"!=typeof e?!e:!1,this},o.prepend=function(e,t,i){("number"==typeof t||"string"!=typeof t)&&(i=t,t=void 0);var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,0>i||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}e instanceof s||(e=s.wrap(e,t));var n=e.limit-e.offset;if(0>=n)return this;var o=n-i;if(o>0){var f=new ArrayBuffer(this.buffer.byteLength+o),a=new Uint8Array(f);a.set(this.view.subarray(i,this.buffer.byteLength),n),this.buffer=f,this.view=a,this.offset+=o,this.markedOffset>=0&&(this.markedOffset+=o),this.limit+=o,i+=o}else{new Uint8Array(this.buffer)}return this.view.set(e.view.subarray(e.offset,e.limit),i-n),e.offset=e.limit,r&&(this.offset-=n),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,0>e)throw RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e),i=new Uint8Array(t);i.set(this.view),this.buffer=t,this.view=i}return this},o.reverse=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(this.view.subarray(e,t)),this)},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(0>t||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var i=this.clone();return i.offset=e,i.limit=t,i},o.toBuffer=function(e){var t=this.offset,i=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!==0)throw TypeError("Illegal limit: Not an integer");if(i>>>=0,0>t||t>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(!e&&0===t&&i===this.buffer.byteLength)return this.buffer;if(t===i)return f;var r=new ArrayBuffer(i-t);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(t,i),0),r},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,i){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(e="utf8",t=e,i=t),e){case"utf8":return this.toUTF8(t,i);case"base64":return this.toBase64(t,i);case"hex":return this.toHex(t,i);case"binary":return this.toBinary(t,i);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var h=function(){"use strict";for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[],r=0,n=t.length;n>r;++r)i[t[r]]=r;return e.encode=function(e,i){for(var r,n;null!==(r=e());)i(t[r>>2&63]),n=(3&r)<<4,null!==(r=e())?(n|=r>>4&15,i(t[63&(n|r>>4&15)]),n=(15&r)<<2,null!==(r=e())?(i(t[63&(n|r>>6&3)]),i(t[63&r])):(i(t[63&n]),i(61))):(i(t[63&n]),i(61),i(61))},e.decode=function(e,t){function r(e){throw Error("Illegal character code: "+e)}for(var n,s,o;null!==(n=e());)if(s=i[n],"undefined"==typeof s&&r(n),null!==(n=e())&&(o=i[n],"undefined"==typeof o&&r(n),t(s<<2>>>0|(48&o)>>4),null!==(n=e()))){if(s=i[n],"undefined"==typeof s){if(61===n)break;r(n)}if(t((15&o)<<4>>>0|(60&s)>>2),null!==(n=e())){if(o=i[n],"undefined"==typeof o){if(61===n)break;r(n)}t((3&s)<<6>>>0|o)}}},e.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},e}();o.toBase64=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),e=0|e,t=0|t,0>e||t>this.capacity||e>t)throw RangeError("begin, end");var r;return h.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=i()),r()},s.fromBase64=function(e,i){if("string"!=typeof e)throw TypeError("str");var r=new s(e.length/4*3,i),n=0;return h.decode(t(e),function(e){r.view[n++]=e}),r.limit=n,r},s.btoa=function(e){return s.fromBinary(e).toBase64()},s.atob=function(e){return s.fromBase64(e).toBinary()},o.toBinary=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),e|=0,t|=0,0>e||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var i=[],r=[];t>e;)i.push(this.view[e++]),i.length>=1024&&(r.push(String.fromCharCode.apply(String,i)),i=[]);return r.join("")+String.fromCharCode.apply(String,i)},s.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var i,r=0,n=e.length,o=new s(n,t);n>r;){if(i=e.charCodeAt(r),i>255)throw RangeError("illegal char code: "+i);o.view[r++]=i}return o.limit=n,o},o.toDebug=function(e){for(var t,i=-1,r=this.buffer.byteLength,n="",s="",o="";r>i;){if(-1!==i&&(t=this.view[i],n+=16>t?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(s+=t>32&&127>t?String.fromCharCode(t):".")),++i,e&&i>0&&i%16===0&&i!==r){for(;n.length<51;)n+=" ";o+=n+s+"\n",n=s=""}n+=i===this.offset&&i===this.limit?i===this.markedOffset?"!":"|":i===this.offset?i===this.markedOffset?"[":"<":i===this.limit?i===this.markedOffset?"]":">":i===this.markedOffset?"'":e||0!==i&&i!==r?" ":""}if(e&&" "!==n){for(;n.length<51;)n+=" ";o+=n+s+"\n"}return e?o:n},s.fromDebug=function(e,t,i){for(var r,n,o=e.length,f=new s((o+1)/3|0,t,i),a=0,h=0,l=!1,u=!1,c=!1,p=!1,d=!1;o>a;){switch(r=e.charAt(a++)){case"!":if(!i){if(u||c||p){d=!0;break}u=c=p=!0}f.offset=f.markedOffset=f.limit=h,l=!1;break;case"|":if(!i){if(u||p){d=!0;break}u=p=!0}f.offset=f.limit=h,l=!1;break;case"[":if(!i){if(u||c){d=!0;break}u=c=!0}f.offset=f.markedOffset=h,l=!1;break;case"<":if(!i){if(u){d=!0;break}u=!0}f.offset=h,l=!1;break;case"]":if(!i){if(p||c){d=!0;break}p=c=!0}f.limit=f.markedOffset=h,l=!1;break;case">":if(!i){if(p){d=!0;break}p=!0}f.limit=h,l=!1;break;case"'":if(!i){if(c){d=!0;break}c=!0}f.markedOffset=h,l=!1;break;case" ":l=!1;break;default:if(!i&&l){d=!0;break}if(n=parseInt(r+e.charAt(a++),16),!i&&(isNaN(n)||0>n||n>255))throw TypeError("Illegal str: Not a debug encoded string");f.view[h++]=n,l=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!i){if(!u||!p)throw TypeError("Illegal str: Missing offset or limit");if(h<f.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+h+" < "+o)}return f},o.toHex=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var i,r=new Array(t-e);t>e;)i=this.view[e++],16>i?r.push("0",i.toString(16)):r.push(i.toString(16));return r.join("")},s.fromHex=function(e,t,i){if(!i){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,n=e.length,o=new s(n/2|0,t),f=0,a=0;n>f;f+=2){if(r=parseInt(e.substring(f,f+2),16),!i&&(!isFinite(r)||0>r||r>255))throw TypeError("Illegal str: Contains non-hex characters");o.view[a++]=r}return o.limit=a,o};var l=function(){"use strict";var e={};return e.MAX_CODEPOINT=1114111,e.encodeUTF8=function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)128>i?t(127&i):2048>i?(t(i>>6&31|192),t(63&i|128)):65536>i?(t(i>>12&15|224),t(i>>6&63|128),t(63&i|128)):(t(i>>18&7|240),t(i>>12&63|128),t(i>>6&63|128),t(63&i|128)),i=null},e.decodeUTF8=function(e,t){for(var i,r,n,s,o=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(i=e());)if(0===(128&i))t(i);else if(192===(224&i))null===(r=e())&&o([i,r]),t((31&i)<<6|63&r);else if(224===(240&i))(null===(r=e())||null===(n=e()))&&o([i,r,n]),t((15&i)<<12|(63&r)<<6|63&n);else{if(240!==(248&i))throw RangeError("Illegal starting byte: "+i);(null===(r=e())||null===(n=e())||null===(s=e()))&&o([i,r,n,s]),t((7&i)<<18|(63&r)<<12|(63&n)<<6|63&s)}},e.UTF16toUTF8=function(e,t){for(var i,r=null;;){if(null===(i=null!==r?r:e()))break;i>=55296&&57343>=i&&null!==(r=e())&&r>=56320&&57343>=r?(t(1024*(i-55296)+r-56320+65536),r=null):t(i)}null!==r&&t(r)},e.UTF8toUTF16=function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)65535>=i?t(i):(i-=65536,t((i>>10)+55296),t(i%1024+56320)),i=null},e.encodeUTF16toUTF8=function(t,i){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,i)})},e.decodeUTF8toUTF16=function(t,i){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,i)})},e.calculateCodePoint=function(e){return 128>e?1:2048>e?2:65536>e?3:4},e.calculateUTF8=function(e){for(var t,i=0;null!==(t=e());)i+=128>t?1:2048>t?2:65536>t?3:4;return i},e.calculateUTF16asUTF8=function(t){var i=0,r=0;return e.UTF16toUTF8(t,function(e){++i,r+=128>e?1:2048>e?2:65536>e?3:4}),[i,r]},e}();return o.toUTF8=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{l.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=i())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},s.fromUTF8=function(e,i,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var n=new s(l.calculateUTF16asUTF8(t(e),!0)[1],i,r),o=0;return l.encodeUTF16toUTF8(t(e),function(e){n.view[o++]=e}),n.limit=o,n},s}),function(e,t){"function"==typeof define&&define.amd?define(["bytebuffer"],t):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t(require("bytebuffer"),!0):(e.dcodeIO=e.dcodeIO||{}).ProtoBuf=t(e.dcodeIO.ByteBuffer)}(this,function(e,t){"use strict";var i={};return i.ByteBuffer=e,i.Long=e.Long||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},"double":{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},"float":{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},"enum":{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){"use strict";var e={};return e.IS_NODE=!("object"!=typeof process||process+""!="[object process]"||process.browser),e.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,i=0;i<e.length;i++){try{t=e[i]()}catch(r){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},e.fetch=function(t,i){if(i&&"function"!=typeof i&&(i=null),e.IS_NODE){var r=require("fs");if(i)r.readFile(t,function(e,t){i(e?null:""+t)});else try{return r.readFileSync(t)}catch(n){return null}}else{var s=e.XHR();if(s.open("GET",t,i?!0:!1),s.setRequestHeader("Accept","text/plain"),"function"==typeof s.overrideMimeType&&s.overrideMimeType("text/plain"),!i)return s.send(null),200==s.status||0==s.status&&"string"==typeof s.responseText?s.responseText:null;if(s.onreadystatechange=function(){4==s.readyState&&i(200==s.status||0==s.status&&"string"==typeof s.responseText?s.responseText:null)},4==s.readyState)return;s.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){"use strict";function i(e,i){var r=-1,n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(0>n?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=n*r|0,!i&&0>r)throw Error("illegal id value: "+(0>n?"-":"")+e);return r}function r(e){var i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return i*parseInt(e,10);if(t.NUMBER_HEX.test(e))return i*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return i*parseInt(e.substring(1),8);if("inf"===e)return i*(1/0);if("nan"===e)return 0/0;if(t.NUMBER_FLT.test(e))return i*parseFloat(e);throw Error("illegal number value: "+(0>i?"-":"")+e)}function n(e,t,i){"undefined"==typeof e[t]?e[t]=i:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(i))}var s={},o=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},f=o.prototype;f._readString=function(){var e='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;e.lastIndex=this.index-1;var i=e.exec(this.source);if(!i)throw Error("unterminated string");return this.index=e.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,i[1]},f.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var e,i,r;do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;i=r,r=this.source.charAt(this.index)}while("*"!==i||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;var n=this.index;t.DELIM.lastIndex=0;var s=t.DELIM.test(this.source.charAt(n++));if(!s)for(;n<this.source.length&&!t.DELIM.test(this.source.charAt(n));)++n;var o=this.source.substring(this.index,this.index=n);return('"'===o||"'"===o)&&(this._stringOpen=o),o},f.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},f.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},f.omit=function(e){return this.peek()===e?(this.next(),!0):!1},f.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},s.Tokenizer=o;var a=function(e){this.tn=new o(e),this.proto3=!1},h=a.prototype;return h.parse=function(){var e,i={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==i["package"])throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),i["package"]=e;break;case"import":if(!r)throw Error("unexpected 'import'");e=this.tn.peek(),"public"===e&&this.tn.next(),e=this._readString(),this.tn.skip(";"),i.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(i.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(i,null),r=!1;break;case"enum":this._parseEnum(i),r=!1;break;case"option":this._parseOption(i);break;case"service":this._parseService(i);break;case"extend":this._parseExtend(i);break;default:throw Error("unexpected '"+e+"'")}}catch(n){throw n.message="Parse error at line "+this.tn.line+": "+n.message,n}return delete i.name,i},a.parse=function(e){return new a(e).parse()},h._readString=function(){var e,t,i="";do{if(t=this.tn.next(),"'"!==t&&'"'!==t)throw Error("illegal string delimiter: "+t);i+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return i},h._readValue=function(e){var i=this.tn.peek();if('"'===i||"'"===i)return this._readString();if(this.tn.next(),t.NUMBER.test(i))return r(i);if(t.BOOL.test(i))return"true"===i.toLowerCase();if(e&&t.TYPEREF.test(i))return i;throw Error("illegal value: "+i)},h._parseOption=function(e,i){var r=this.tn.next(),n=!1;if("("===r&&(n=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal option name: "+r);var s=r;n&&(this.tn.skip(")"),s="("+s+")",r=this.tn.peek(),t.FQTYPEREF.test(r)&&(s+=r,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,s),i||this.tn.skip(";")},h._parseOptionValue=function(e,i){var r=this.tn.peek();if("{"!==r)n(e.options,i,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+i+"."+r);this.tn.omit(":")?n(e.options,i+"."+r,this._readValue(!0)):this._parseOptionValue(e,i+"."+r)}},h._parseService=function(e){var i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal service name at line "+this.tn.line+": "+i);var r=i,n={name:r,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if("option"===i)this._parseOption(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},h._parseServiceRPC=function(e){var i="rpc",r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal rpc service method name: "+r);var n=r,s={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),r=this.tn.next(),"stream"===r.toLowerCase()&&(s.request_stream=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal rpc service request type: "+r);if(s.request=r,this.tn.skip(")"),r=this.tn.next(),"returns"!==r.toLowerCase())throw Error("illegal rpc service request type delimiter: "+r);if(this.tn.skip("("),r=this.tn.next(),"stream"===r.toLowerCase()&&(s.response_stream=!0,r=this.tn.next()),s.response=r,this.tn.skip(")"),r=this.tn.peek(),"{"===r){for(this.tn.next();"}"!==(r=this.tn.next());){if("option"!==r)throw Error("illegal rpc service token: "+r);this._parseOption(s)}this.tn.omit(";")}else this.tn.skip(";");"undefined"==typeof e[i]&&(e[i]={}),e[i][n]=s},h._parseMessage=function(e,r){var n=!!r,s=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(s))throw Error("illegal "+(n?"group":"message")+" name: "+s);for(o.name=s,n&&(this.tn.skip("="),r.id=i(this.tn.next()),o.isGroup=!0),s=this.tn.peek(),"["===s&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(s=this.tn.next());)if(t.RULE.test(s))this._parseMessageField(o,s);else if("oneof"===s)this._parseMessageOneOf(o);else if("enum"===s)this._parseEnum(o);else if("message"===s)this._parseMessage(o);else if("option"===s)this._parseOption(o);else if("service"===s)this._parseService(o);else if("extensions"===s)o.extensions=this._parseExtensionRanges();else if("reserved"===s)this._parseIgnored();else if("extend"===s)this._parseExtend(o);else{if(!t.TYPEREF.test(s))throw Error("illegal message token: "+s);if(!this.proto3)throw Error("illegal field rule: "+s);this._parseMessageField(o,"optional",s)}return this.tn.omit(";"),e.messages.push(o),o},h._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},h._parseMessageField=function(e,r,n){if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);var s,o={rule:r,type:"",name:"",options:{},id:0};if("map"===r){if(n)throw Error("illegal type: "+n);if(this.tn.skip("<"),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field type: "+s);if(o.keytype=s,this.tn.skip(","),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field: "+s);if(o.type=s,this.tn.skip(">"),s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=i(this.tn.next()),s=this.tn.peek(),"["===s&&this._parseFieldOptions(o),this.tn.skip(";")}else if(n="undefined"!=typeof n?n:this.tn.next(),"group"===n){var f=this._parseMessage(e,o);if(!/^[A-Z]/.test(f.name))throw Error("illegal group name: "+f.name);o.type=f.name,o.name=f.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(n)&&!t.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(o.type=n,s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=i(this.tn.next()),s=this.tn.peek(),"["===s&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},h._parseMessageOneOf=function(e){var i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal oneof name: "+i);var r,n=i,s=[];for(this.tn.skip("{");"}"!==(i=this.tn.next());)r=this._parseMessageField(e,"optional",i),r.oneof=n,s.push(r.id);this.tn.omit(";"),e.oneofs[n]=s},h._parseFieldOptions=function(e){this.tn.skip("[");for(var t,i=!0;"]"!==(t=this.tn.peek());)i||this.tn.skip(","),this._parseOption(e,!0),i=!1;this.tn.next()},h._parseEnum=function(e){var r={name:"",values:[],options:{}},n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal name: "+n);
for(r.name=n,this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(r);else{if(!t.NAME.test(n))throw Error("illegal name: "+n);this.tn.skip("=");var s={name:n,id:i(this.tn.next(),!0)};n=this.tn.peek(),"["===n&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),r.values.push(s)}this.tn.omit(";"),e.enums.push(r)},h._parseExtensionRanges=function(){var t,i,n,s=[];do{for(i=[];;){switch(t=this.tn.next()){case"min":n=e.ID_MIN;break;case"max":n=e.ID_MAX;break;default:n=r(t)}if(i.push(n),2===i.length)break;if("to"!==this.tn.peek()){i.push(n);break}this.tn.next()}s.push(i)}while(this.tn.omit(","));return this.tn.skip(";"),s},h._parseExtend=function(e){var i=this.tn.next();if(!t.TYPEREF.test(i))throw Error("illegal extend reference: "+i);var r={ref:i,fields:[]};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(r,i);else{if(!t.TYPEREF.test(i))throw Error("illegal extend token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(r,"optional",i)}return this.tn.omit(";"),e.messages.push(r),r},h.toString=function(){return"Parser at line "+this.tn.line},s.Parser=a,s}(i,i.Lang),i.Reflect=function(t){"use strict";function i(i){if("string"==typeof i&&(i=t.TYPES[i]),"undefined"==typeof i.defaultValue)throw Error("default value for type "+i.name+" is not supported");return i==t.TYPES.bytes?new e(0):i.defaultValue}function r(e,i){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new t.Long(e.low,e.high,"undefined"==typeof i?e.unsigned:i);if("string"==typeof e)return t.Long.fromString(e,i||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,i||!1);throw Error("not convertible to Long")}function n(e,i){var r=i.readVarint32(),s=7&r,o=r>>>3;switch(s){case t.WIRE_TYPES.VARINT:do r=i.readUint8();while(128===(128&r));break;case t.WIRE_TYPES.BITS64:i.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=i.readVarint32(),i.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:n(o,i);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+s)}return!0}var s={},o=function(e,t,i){this.builder=e,this.parent=t,this.name=i,this.className},f=o.prototype;f.fqn=function(){for(var e=this.name,t=this;;){if(t=t.parent,null==t)break;e=t.name+"."+e}return e},f.toString=function(e){return(e?this.className+" ":"")+this.fqn()},f.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},s.T=o;var a=function(e,t,i,r,n){o.call(this,e,t,i),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=n||"proto2"},h=a.prototype=Object.create(o.prototype);h.getChildren=function(e){if(e=e||null,null==e)return this.children.slice();for(var t=[],i=0,r=this.children.length;r>i;++i)this.children[i]instanceof e&&t.push(this.children[i]);return t},h.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof c.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof c.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},h.getChild=function(e){for(var t="number"==typeof e?"id":"name",i=0,r=this.children.length;r>i;++i)if(this.children[i][t]===e)return this.children[i];return null},h.resolve=function(e,t){var i="string"==typeof e?e.split("."):e,r=this,n=0;if(""===i[n]){for(;null!==r.parent;)r=r.parent;n++}var o;do{do{if(!(r instanceof s.Namespace)){r=null;break}if(o=r.getChild(i[n]),!o||!(o instanceof s.T)||t&&!(o instanceof s.Namespace)){r=null;break}r=o,n++}while(n<i.length);if(null!=r)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=r);return r},h.qn=function(e){var t=[],i=e;do t.unshift(i.name),i=i.parent;while(null!==i);for(var r=1;r<=t.length;r++){var n=t.slice(t.length-r);if(e===this.resolve(n,e instanceof s.Namespace))return n.join(".")}return e.fqn()},h.build=function(){for(var e,t={},i=this.children,r=0,n=i.length;n>r;++r)e=i[r],e instanceof a&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},h.buildOpt=function(){for(var e={},t=Object.keys(this.options),i=0,r=t.length;r>i;++i){var n=t[i],s=this.options[t[i]];e[n]=s}return e},h.getOption=function(e){return"undefined"==typeof e?this.options:"undefined"!=typeof this.options[e]?this.options[e]:null},s.Namespace=a;var l=function(e,i,r,n){if(this.type=e,this.resolvedType=i,this.isMapKey=r,this.syntax=n,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},u=l.prototype;l.defaultFieldValue=i,u.verifyValue=function(i){var n=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),i>4294967295?0|i:i;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),0>i?i>>>0:i;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return r(i,!1)}catch(s){n(typeof i,s.message)}else n(typeof i,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return r(i,!0)}catch(s){n(typeof i,s.message)}else n(typeof i,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case t.TYPES["float"]:case t.TYPES["double"]:return"number"!=typeof i&&n(typeof i,"not a number"),i;case t.TYPES.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case t.TYPES.bytes:return e.isByteBuffer(i)?i:e.wrap(i,"base64");case t.TYPES["enum"]:var o=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(a=0;a<o.length;a++){if(o[a].name==i)return o[a].id;if(o[a].id==i)return o[a].id}if("proto3"===this.syntax)return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),(i>4294967295||0>i)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.resolvedType.clazz)return i;if(i instanceof t.Builder.Message){var f={};for(var a in i)i.hasOwnProperty(a)&&(f[a]=i[a]);i=f}return new this.resolvedType.clazz(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},u.calculateLength=function(i,r){if(null===r)return 0;var n;switch(this.type){case t.TYPES.int32:return 0>r?e.calculateVarint64(r):e.calculateVarint32(r);case t.TYPES.uint32:return e.calculateVarint32(r);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES["float"]:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(r);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES["enum"]:return e.calculateVarint32(r);case t.TYPES["double"]:return 8;case t.TYPES.string:return n=e.calculateUTF8Bytes(r),e.calculateVarint32(n)+n;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return e.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return n=this.resolvedType.calculate(r),e.calculateVarint32(n)+n;case t.TYPES.group:return n=this.resolvedType.calculate(r),n+e.calculateVarint32(i<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},u.encodeValue=function(i,r,n){if(null===r)return n;switch(this.type){case t.TYPES.int32:0>r?n.writeVarint64(r):n.writeVarint32(r);break;case t.TYPES.uint32:n.writeVarint32(r);break;case t.TYPES.sint32:n.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:n.writeUint32(r);break;case t.TYPES.sfixed32:n.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:n.writeVarint64(r);break;case t.TYPES.sint64:n.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:n.writeUint64(r);break;case t.TYPES.sfixed64:n.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?n.writeVarint32("false"===r.toLowerCase()?0:!!r):n.writeVarint32(r?1:0);break;case t.TYPES["enum"]:n.writeVarint32(r);break;case t.TYPES["float"]:n.writeFloat32(r);break;case t.TYPES["double"]:n.writeFloat64(r);break;case t.TYPES.string:n.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");var s=r.offset;n.writeVarint32(r.remaining()),n.append(r),r.offset=s;break;case t.TYPES.message:var o=(new e).LE();this.resolvedType.encode(r,o),n.writeVarint32(o.offset),n.append(o.flip());break;case t.TYPES.group:this.resolvedType.encode(r,n),n.writeVarint32(i<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return n},u.decode=function(e,i,r){if(i!=this.type.wireType)throw Error("Unexpected wire type for element");var n,s;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES["enum"]:return e.readVarint32();case t.TYPES["float"]:return e.readFloat();case t.TYPES["double"]:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(s=e.readVarint32(),e.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+e.remaining());return n=e.clone(),n.limit=n.offset+s,e.offset+=s,n;case t.TYPES.message:return s=e.readVarint32(),this.resolvedType.decode(e,s);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},u.valueFromString=function(i){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(i));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(i);case t.TYPES.bool:return"true"===i;case t.TYPES.string:return this.verifyValue(i);case t.TYPES.bytes:return e.fromBinary(i)}},u.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},s.Element=l;var c=function(e,t,i,r,n,s){a.call(this,e,t,i,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!n,this._fields=null,this._fieldsById=null,this._fieldsByName=null},p=c.prototype=Object.create(a.prototype);p.build=function(i){if(this.clazz&&!i)return this.clazz;var r=function(t,i){function r(i,n,s,o){if(null===i||"object"!=typeof i){if(o&&o instanceof t.Reflect.Enum){var f=t.Reflect.Enum.getName(o.object,i);if(null!==f)return f}return i}if(e.isByteBuffer(i))return n?i.toBase64():i.toBuffer();if(t.Long.isLong(i))return s?i.toString():t.Long.fromValue(i);var a;if(Array.isArray(i))return a=[],i.forEach(function(e,t){a[t]=r(e,n,s,o)}),a;if(a={},i instanceof t.Map){for(var h=i.entries(),l=h.next();!l.done;l=h.next())a[i.keyElem.valueToString(l.value[0])]=r(l.value[1],n,s,i.valueElem.resolvedType);return a}var u=i.$type,c=void 0;for(var p in i)i.hasOwnProperty(p)&&(u&&(c=u.getChild(p))?a[p]=r(i[p],n,s,c.resolvedType):a[p]=r(i[p],n,s));return a}var n=i.getChildren(t.Reflect.Message.Field),s=i.getChildren(t.Reflect.Message.OneOf),o=function(r,f){t.Builder.Message.call(this);for(var a=0,h=s.length;h>a;++a)this[s[a].name]=null;for(a=0,h=n.length;h>a;++a){var l=n[a];this[l.name]=l.repeated?[]:l.map?new t.Map(l):null,!l.required&&"proto3"!==i.syntax||null===l.defaultValue||(this[l.name]=l.defaultValue)}if(arguments.length>0){var u;if(1!==arguments.length||null===r||"object"!=typeof r||!("function"!=typeof r.encode||r instanceof o)||Array.isArray(r)||r instanceof t.Map||e.isByteBuffer(r)||r instanceof ArrayBuffer||t.Long&&r instanceof t.Long)for(a=0,h=arguments.length;h>a;++a)"undefined"!=typeof(u=arguments[a])&&this.$set(n[a].name,u);else this.$set(r)}},f=o.prototype=Object.create(t.Builder.Message.prototype);f.add=function(e,r,n){var s=i._fieldsByName[e];if(!n){if(!s)throw Error(this+"#"+e+" is undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));if(!s.repeated)throw Error(this+"#"+e+" is not a repeated field");r=s.verifyValue(r,!0)}return null===this[e]&&(this[e]=[]),this[e].push(r),this},f.$add=f.add,f.set=function(e,r,n){if(e&&"object"==typeof e){n=r;for(var s in e)e.hasOwnProperty(s)&&"undefined"!=typeof(r=e[s])&&this.$set(s,r,n);return this}var o=i._fieldsByName[e];if(n)this[e]=r;else{if(!o)throw Error(this+"#"+e+" is not a field: undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));this[o.name]=r=o.verifyValue(r)}if(o&&o.oneof){var f=this[o.oneof.name];null!==r?(null!==f&&f!==o.name&&(this[f]=null),this[o.oneof.name]=o.name):f===e&&(this[o.oneof.name]=null)}return this},f.$set=f.set,f.get=function(e,r){if(r)return this[e];var n=i._fieldsByName[e];if(!(n&&n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},f.$get=f.get;for(var a=0;a<n.length;a++){var h=n[a];h instanceof t.Reflect.Message.ExtensionField||i.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var r=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),n=function(t,i){return this[e.name]=i?t:e.verifyValue(t),this},s=function(){return this[e.name]};null===i.getChild("set"+t)&&(f["set"+t]=n),null===i.getChild("set_"+r)&&(f["set_"+r]=n),null===i.getChild("get"+t)&&(f["get"+t]=s),null===i.getChild("get_"+r)&&(f["get_"+r]=s)}(h)}f.encode=function(t,r){"boolean"==typeof t&&(r=t,t=void 0);var n=!1;t||(t=new e,n=!0);var s=t.littleEndian;try{return i.encode(this,t.LE(),r),(n?t.flip():t).LE(s)}catch(o){throw t.LE(s),o}},o.encode=function(e,t,i){return new o(e).encode(t,i)},f.calculate=function(){return i.calculate(this)},f.encodeDelimited=function(t){var r=!1;t||(t=new e,r=!0);var n=(new e).LE();return i.encode(this,n).flip(),t.writeVarint32(n.remaining()),t.append(n),r?t.flip():t},f.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},f.toArrayBuffer=f.encodeAB,f.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},f.toBuffer=f.encodeNB,f.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},f.toBase64=f.encode64,f.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},f.toHex=f.encodeHex,f.toRaw=function(e,t){return r(this,!!e,!!t,this.$type)},f.encodeJSON=function(){return JSON.stringify(r(this,!0,!0,this.$type))},o.decode=function(t,r){"string"==typeof t&&(t=e.wrap(t,r?r:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t);var n=t.littleEndian;try{var s=i.decode(t.LE());return t.LE(n),s}catch(o){throw t.LE(n),o}},o.decodeDelimited=function(t,r){if("string"==typeof t&&(t=e.wrap(t,r?r:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t),t.remaining()<1)return null;var n=t.offset,s=t.readVarint32();if(t.remaining()<s)return t.offset=n,null;try{var o=i.decode(t.slice(t.offset,t.offset+s).LE());return t.offset+=s,o}catch(f){throw t.offset+=s,f}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.decodeJSON=function(e){return new o(JSON.parse(e))},f.toString=function(){return i.toString()};return Object.defineProperty&&(Object.defineProperty(o,"$options",{value:i.buildOpt()}),Object.defineProperty(f,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:i}),Object.defineProperty(f,"$type",{value:i})),o}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var n,s=0,o=this.children.length;o>s;s++)if(n=this.children[s],n instanceof v||n instanceof c||n instanceof T){if(r.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");r[n.name]=n.build()}else if(n instanceof c.Field)n.build(),this._fields.push(n),this._fieldsById[n.id]=n,this._fieldsByName[n.name]=n;else if(!(n instanceof c.OneOf||n instanceof b))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=r},p.encode=function(e,t,i){for(var r,n,s=null,o=0,f=this._fields.length;f>o;++o)r=this._fields[o],n=e[r.name],r.required&&null===n?null===s&&(s=r):r.encode(i?n:r.verifyValue(n),t,e);if(null!==s){var a=Error("Missing at least one required field for "+this.toString(!0)+": "+s);throw a.encoded=t,a}return t},p.calculate=function(e){for(var t,i,r=0,n=0,s=this._fields.length;s>n;++n){if(t=this._fields[n],i=e[t.name],t.required&&null===i)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(i,e)}return r},p.decode=function(e,i,r){i="number"==typeof i?i:-1;for(var s,o,f,a,h=e.offset,l=new this.clazz;e.offset<h+i||-1===i&&e.remaining()>0;){if(s=e.readVarint32(),o=7&s,f=s>>>3,o===t.WIRE_TYPES.ENDGROUP){if(f!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+f+" ("+(r?r+" expected":"not a group")+")");break}if(a=this._fieldsById[f]){if(a.repeated&&!a.options.packed)l[a.name].push(a.decode(o,e));else if(a.map){var u=a.decode(o,e);l[a.name].set(u[0],u[1])}else if(l[a.name]=a.decode(o,e),a.oneof){var c=l[a.oneof.name];null!==c&&c!==a.name&&(l[c]=null),l[a.oneof.name]=a.name}}else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var p=e.readVarint32();e.offset+=p;break;case t.WIRE_TYPES.STARTGROUP:for(;n(f,e););break;default:throw Error("Illegal wire type for unknown field "+f+" in "+this.toString(!0)+"#decode: "+o)}}for(var d=0,g=this._fields.length;g>d;++d)if(a=this._fields[d],null===l[a.name])if("proto3"===this.syntax)l[a.name]=a.defaultValue;else{if(a.required){var y=Error("Missing at least one required field for "+this.toString(!0)+": "+a.name);throw y.decoded=l,y}t.populateDefaults&&null!==a.defaultValue&&(l[a.name]=a.defaultValue)}return l},s.Message=c;var d=function(e,i,r,n,s,f,a,h,l,u){o.call(this,e,i,f),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=n||null,this.type=s,this.resolvedType=null,this.id=a,this.options=h||{},this.defaultValue=null,this.oneof=l||null,this.syntax=u||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof c.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},g=d.prototype=Object.create(o.prototype);g.build=function(){this.element=new l(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new l(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?"undefined"!=typeof this.options["default"]&&(this.defaultValue=this.verifyValue(this.options["default"])):this.defaultValue=l.defaultFieldValue(this.type)},g.verifyValue=function(e,i){i=i||!1;var r=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);if(null===e)return this.required&&r(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&r(typeof e,"proto3 field without field presence cannot be null"),null;var n;if(this.repeated&&!i){Array.isArray(e)||(e=[e]);var s=[];for(n=0;n<e.length;n++)s.push(this.element.verifyValue(e[n]));return s}return this.map&&!i?e instanceof t.Map?e:(e instanceof Object||r(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(typeof e,"no array expected"),this.element.verifyValue(e))},g.hasWirePresence=function(e,i){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&i[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES["float"]:case t.TYPES["double"]:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES["enum"]:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},g.encode=function(i,r,n){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return r;try{if(this.repeated){var s;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1);var o=r.offset;for(s=0;s<i.length;s++)this.element.encodeValue(this.id,i[s],r);var f=r.offset-o,a=e.calculateVarint32(f);if(a>1){var h=r.slice(o,r.offset);o+=a-1,r.offset=o,r.append(h)}r.writeVarint32(f,o-a)}else for(s=0;s<i.length;s++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i[s],r)}else this.map?i.forEach(function(i,n,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(o),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,n,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,i,r)},this):this.hasWirePresence(i,n)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i,r))}catch(l){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+l+")")}return r},g.calculate=function(i,r){if(i=this.verifyValue(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var n=0;try{if(this.repeated){var s,o;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),o=0,s=0;s<i.length;s++)o+=this.element.calculateLength(this.id,i[s]);n+=e.calculateVarint32(o),n+=o}else for(s=0;s<i.length;s++)n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i[s])}else this.map?i.forEach(function(i,r,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n+=e.calculateVarint32(o),n+=o},this):this.hasWirePresence(i,r)&&(n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i))}catch(f){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+f+")")}return n},g.decode=function(e,i,r){var n,s,o=!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM;if(!o)throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){s=i.readVarint32(),s=i.offset+s;for(var f=[];i.offset<s;)f.push(this.decode(this.type.wireType,i,!0));return f}if(this.map){var a=l.defaultFieldValue(this.keyType);if(n=l.defaultFieldValue(this.type),s=i.readVarint32(),i.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.remaining());var h=i.clone();for(h.limit=h.offset+s,i.offset+=s;h.remaining()>0;){var u=h.readVarint32();e=7&u;var c=u>>>3;if(1===c)a=this.keyElement.decode(h,e,c);else{if(2!==c)throw Error("Unexpected tag in map field key/value submessage");n=this.element.decode(h,e,c)}}return[a,n]}return this.element.decode(i,e,this.id)},s.Message.Field=d;var y=function(e,t,i,r,n,s,o){d.call(this,e,t,i,null,r,n,s,o),this.extension};y.prototype=Object.create(d.prototype),s.Message.ExtensionField=y;var E=function(e,t,i){o.call(this,e,t,i),this.fields=[]};s.Message.OneOf=E;var v=function(e,t,i,r,n){a.call(this,e,t,i,r,n),this.className="Enum",this.object=null};v.getName=function(e,t){for(var i,r=Object.keys(e),n=0;n<r.length;++n)if(e[i=r[n]]===t)return i;return null};var w=v.prototype=Object.create(a.prototype);w.build=function(e){if(this.object&&!e)return this.object;for(var i=new t.Builder.Enum,r=this.getChildren(v.Value),n=0,s=r.length;s>n;++n)i[r[n].name]=r[n].id;return Object.defineProperty&&Object.defineProperty(i,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=i},s.Enum=v;var m=function(e,t,i,r){o.call(this,e,t,i),this.className="Enum.Value",this.id=r};m.prototype=Object.create(o.prototype),s.Enum.Value=m;var b=function(e,t,i,r){o.call(this,e,t,i),this.field=r};b.prototype=Object.create(o.prototype),s.Extension=b;var T=function(e,t,i,r){a.call(this,e,t,i,r),this.className="Service",this.clazz=null},I=T.prototype=Object.create(a.prototype);I.build=function(i){return this.clazz&&!i?this.clazz:this.clazz=function(t,i){for(var r=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,i){setTimeout(i.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},n=r.prototype=Object.create(t.Builder.Service.prototype),s=i.getChildren(t.Reflect.Service.RPCMethod),o=0;o<s.length;o++)!function(t){n[t.name]=function(r,n){try{try{r=t.resolvedRequestType.clazz.decode(e.wrap(r))}catch(s){if(!(s instanceof TypeError))throw s}if(null===r||"object"!=typeof r)throw Error("Illegal arguments");r instanceof t.resolvedRequestType.clazz||(r=new t.resolvedRequestType.clazz(r)),this.rpcImpl(t.fqn(),r,function(e,r){if(e)return void n(e);try{r=t.resolvedResponseType.clazz.decode(r)}catch(s){}return r&&r instanceof t.resolvedResponseType.clazz?void n(null,r):void n(Error("Illegal response type received in service method "+i.name+"#"+t.name))})}catch(s){setTimeout(n.bind(this,s),0)}},r[t.name]=function(e,i,n){new r(e)[t.name](i,n)},Object.defineProperty&&(Object.defineProperty(r[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(n[t.name],"$options",{value:r[t.name].$options}))}(s[o]);return Object.defineProperty&&(Object.defineProperty(r,"$options",{value:i.buildOpt()}),Object.defineProperty(n,"$options",{value:r.$options}),Object.defineProperty(r,"$type",{value:i}),Object.defineProperty(n,"$type",{value:i})),r}(t,this)},s.Service=T;var S=function(e,t,i,r){o.call(this,e,t,i),this.className="Service.Method",this.options=r||{}},P=S.prototype=Object.create(o.prototype);P.buildOpt=h.buildOpt,s.Service.Method=S;var R=function(e,t,i,r,n,s,o,f){S.call(this,e,t,i,f),this.className="Service.RPCMethod",this.requestName=r,this.responseName=n,this.requestStream=s,this.responseStream=o,this.resolvedRequestType=null,this.resolvedResponseType=null};return R.prototype=Object.create(S.prototype),s.Service.RPCMethod=R,s}(i),i.Builder=function(e,t,i){"use strict";function r(e){e.messages&&e.messages.forEach(function(t){t.syntax=e.syntax,r(t)}),e.enums&&e.enums.forEach(function(t){t.syntax=e.syntax})}var n=function(e){this.ns=new i.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},s=n.prototype;return n.isMessage=function(e){return"string"!=typeof e.name?!1:"undefined"!=typeof e.values||"undefined"!=typeof e.rpc?!1:!0},n.isMessageField=function(e){return"string"!=typeof e.rule||"string"!=typeof e.name||"string"!=typeof e.type||"undefined"==typeof e.id?!1:!0},n.isEnum=function(e){return"string"!=typeof e.name?!1:"undefined"!=typeof e.values&&Array.isArray(e.values)&&0!==e.values.length?!0:!1},n.isService=function(e){return"string"==typeof e.name&&"object"==typeof e.rpc&&e.rpc?!0:!1},n.isExtend=function(e){return"string"!=typeof e.ref?!1:!0},s.reset=function(){return this.ptr=this.ns,this},s.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach(function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new i.Namespace(this,this.ptr,e)),this.ptr=t},this),this},s.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var s=t.shift();if(n.isMessage(s)){var o=new i.Message(this,this.ptr,s.name,s.options,s.isGroup,s.syntax),f={};s.oneofs&&Object.keys(s.oneofs).forEach(function(e){o.addChild(f[e]=new i.Message.OneOf(this,o,e))},this),s.fields&&s.fields.forEach(function(e){if(null!==o.getChild(0|e.id))throw Error("duplicate or invalid field id in "+o.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+o.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=f[e.oneof]))throw Error("illegal oneof in "+o.name+"#"+e.name+": "+e.oneof);e=new i.Message.Field(this,o,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,s.syntax),t&&t.fields.push(e),o.addChild(e)},this);var a=[];if(s.enums&&s.enums.forEach(function(e){a.push(e)}),s.messages&&s.messages.forEach(function(e){a.push(e)}),s.services&&s.services.forEach(function(e){a.push(e)}),s.extensions&&("number"==typeof s.extensions[0]?o.extensions=[s.extensions]:o.extensions=s.extensions),this.ptr.addChild(o),a.length>0){r.push(t),t=a,a=null,this.ptr=o,o=null;continue}a=null}else if(n.isEnum(s))o=new i.Enum(this,this.ptr,s.name,s.options,s.syntax),s.values.forEach(function(e){o.addChild(new i.Enum.Value(this,o,e.name,e.id))},this),this.ptr.addChild(o);else if(n.isService(s))o=new i.Service(this,this.ptr,s.name,s.options),Object.keys(s.rpc).forEach(function(e){var t=s.rpc[e];o.addChild(new i.Service.RPCMethod(this,o,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))},this),this.ptr.addChild(o);else{if(!n.isExtend(s))throw Error("not a valid definition: "+JSON.stringify(s));if(o=this.ptr.resolve(s.ref,!0))s.fields.forEach(function(t){if(null!==o.getChild(0|t.id))throw Error("duplicate extended field id in "+o.name+": "+t.id);if(o.extensions){var r=!1;if(o.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)}),!r)throw Error("illegal extended field id in "+o.name+": "+t.id+" (not within valid ranges)")}var n=t.name;this.options.convertFieldsToCamelCase&&(n=e.Util.toCamelCase(n));var s=new i.Message.ExtensionField(this,o,t.rule,t.type,this.ptr.fqn()+"."+n,t.id,t.options),f=new i.Extension(this,this.ptr,t.name,s);s.extension=f,this.ptr.addChild(f),o.addChild(s)},this);else if(!/\.?google\.protobuf\./.test(s.ref))throw Error("extended message "+s.ref+" is not defined")
}s=null,o=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},s["import"]=function(t,i){var n="/";if("string"==typeof i){if(e.Util.IS_NODE&&(i=require("path").resolve(i)),this.files[i]===!0)return this.reset();this.files[i]=!0}else if("object"==typeof i){var s=i.root;e.Util.IS_NODE&&(s=require("path").resolve(s)),(s.indexOf("\\")>=0||i.file.indexOf("\\")>=0)&&(n="\\");var o=s+n+i.file;if(this.files[o]===!0)return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){var f,a=!1;"object"==typeof i?(this.importRoot=i.root,a=!0,f=this.importRoot,i=i.file,(f.indexOf("\\")>=0||i.indexOf("\\")>=0)&&(n="\\")):"string"==typeof i?this.importRoot?f=this.importRoot:i.indexOf("/")>=0?(f=i.replace(/\/[^\/]*$/,""),""===f&&(f="/")):i.indexOf("\\")>=0?(f=i.replace(/\\[^\\]*$/,""),n="\\"):f=".":f=null;for(var h=0;h<t.imports.length;h++)if("string"==typeof t.imports[h]){if(!f)throw Error("cannot determine import root");var l=t.imports[h];if("google/protobuf/descriptor.proto"===l)continue;if(l=f+n+l,this.files[l]===!0)continue;/\.proto$/i.test(l)&&!e.DotProto&&(l=l.replace(/\.proto$/,".json"));var u=e.Util.fetch(l);if(null===u)throw Error("failed to import '"+l+"' in '"+i+"': file not found");/\.json$/i.test(l)?this["import"](JSON.parse(u+""),l):this["import"](e.DotProto.Parser.parse(u),l)}else i?/\.(\w+)$/.test(i)?this["import"](t.imports[h],i.replace(/^(.+)\.(\w+)$/,function(e,t,i){return t+"_import"+h+"."+i})):this["import"](t.imports[h],i+"_import"+h):this["import"](t.imports[h]);a&&(this.importRoot=null)}t["package"]&&this.define(t["package"]),t.syntax&&r(t);var c=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){c.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=c),t.enums&&(this.create(t.enums),this.ptr=c),t.services&&(this.create(t.services),this.ptr=c),t["extends"]&&this.create(t["extends"]),this.reset()},s.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof i.Namespace)this.ptr.children.forEach(function(e){this.ptr=e,this.resolveAll()},this);else if(this.ptr instanceof i.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(r=(this.ptr instanceof i.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!r)throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof i.Enum){if(this.ptr.type=e.TYPES["enum"],"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof i.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(r=this.ptr.parent.resolve(this.ptr.requestName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,r=this.ptr.parent.resolve(this.ptr.responseName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},s.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,i=this.result,r=0;r<t.length;r++){if(!i[t[r]]){i=null;break}i=i[t[r]]}return i},s.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},s.toString=function(){return"Builder"},n.Message=function(){},n.Enum=function(){},n.Service=function(){},n}(i,i.Lang,i.Reflect),i.Map=function(e,t){"use strict";function i(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,i){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var r=Object.keys(i),n=0;n<r.length;n++){var s=this.keyElem.valueFromString(r[n]),o=this.valueElem.verifyValue(i[r[n]]);this.map[this.keyElem.valueToString(s)]={key:s,value:o}}},n=r.prototype;return n.clear=function(){this.map={}},n["delete"]=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),i=t in this.map;return delete this.map[t],i},n.entries=function(){for(var e,t=[],r=Object.keys(this.map),n=0;n<r.length;n++)t.push([(e=this.map[r[n]]).key,e.value]);return i(t)},n.keys=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].key);return i(e)},n.values=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].value);return i(e)},n.forEach=function(e,t){for(var i,r=Object.keys(this.map),n=0;n<r.length;n++)e.call(t,(i=this.map[r[n]]).value,i.key,this)},n.set=function(e,t){var i=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(i)]={key:i,value:r},this},n.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},n.has=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map},r}(i,i.Reflect),i.loadProto=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,r)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null===n)return void t(Error("Failed to fetch file"));try{t(null,i.loadProto(n,r,e))}catch(s){t(s)}});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadProto(n,r,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return e=e||{},"undefined"==typeof e.convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),"undefined"==typeof e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=null),t&&"object"==typeof t||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t["import"](e,r),t.resolveAll(),t},i.loadJsonFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null===n)return void t(Error("Failed to fetch file"));try{t(null,i.loadJson(JSON.parse(n),r,e))}catch(s){t(s)}});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadJson(JSON.parse(n),r,e)},i});!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var u=Object.prototype.toString,i=Array.isArray||function(n){return"[object Array]"===u.call(n)},c=function(n,t){if(n.forEach)return n.forEach(t);for(var e=0;e<n.length;e+=1)t(n[e],e,n)},a=function(n,t){if(n.map)return n.map(t);var e=[];return c(n,function(n,r,u){e.push(t(n,r,u))}),e},o=function(n,t,e){return n.reduce?n.reduce(t,e):(c(n,function(n,r,u){e=t(e,n,r,u)}),e)},l=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,"undefined"!=typeof setImmediate?r.setImmediate=function(n){setImmediate(n)}:r.setImmediate=r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){function u(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r())}if(r=r||function(){},!t.length)return r();var i=0;c(t,function(t){e(t,n(u))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,u=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e():u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=f(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var f=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var u=0,i=0,c=0;!function a(){if(u>=t.length)return r();for(;n>c&&i<t.length;)i+=1,c+=1,e(t[i-1],function(n){n?(r(n),r=function(){}):(u+=1,c-=1,u>=t.length?r():a())})}()}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},p=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[f(n)].concat(e))}},d=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},y=function(n,t,e,r){if(t=a(t,function(n,t){return{index:t,value:n}}),r){var u=[];n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})}else n(t,function(n,t){e(n.value,function(n){t(n)})})};r.map=s(y),r.mapSeries=d(y),r.mapLimit=function(n,t,e,r){return m(t)(n,e,r)};var m=function(n){return p(n,y)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var i=a(n,function(n){return n}).reverse();r.reduce(i,t,e,u)},r.foldr=r.reduceRight;var v=function(n,t,e,r){var u=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(n){r(a(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=s(v),r.filterSeries=d(v),r.select=r.filter,r.selectSeries=r.filterSeries;var h=function(n,t,e,r){var u=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(n){r(a(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=s(h),r.rejectSeries=d(h);var g=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(n){r()})};r.detect=s(g),r.detectSeries=d(g),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(n){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(n){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,a(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=l(n),u=e.length;if(!u)return t();var a={},f=[],s=function(n){f.unshift(n)},p=function(n){for(var t=0;t<f.length;t+=1)if(f[t]===n)return void f.splice(t,1)},d=function(){u--,c(f.slice(0),function(n){n()})};s(function(){if(!u){var n=t;t=function(){},n(null,a)}}),c(e,function(e){var u=i(n[e])?n[e]:[n[e]],f=function(n){var u=Array.prototype.slice.call(arguments,1);if(u.length<=1&&(u=u[0]),n){var i={};c(l(a),function(n){i[n]=a[n]}),i[e]=u,t(n,i),t=function(){}}else a[e]=u,r.setImmediate(d)},y=u.slice(0,Math.abs(u.length-1))||[],m=function(){return o(y,function(n,t){return n&&a.hasOwnProperty(t)},!0)&&!a.hasOwnProperty(e)};if(m())u[u.length-1](f,a);else{var v=function(){m()&&(p(v),u[u.length-1](f,a))};s(v)}})},r.retry=function(n,t,e){var u=5,i=[];"function"==typeof n&&(e=t,t=n,n=u),n=parseInt(n,10)||u;var c=function(u,c){for(var a=function(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},c)}};n;)i.push(a(t,!(n-=1)));r.series(i,function(n,t){t=t[t.length-1],(u||e)(t.err,t.result)})};return e?c():c},r.waterfall=function(n,t){if(t=t||function(){},!i(n)){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var u=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),c=n.next();c?i.push(u(c)):i.push(t),r.setImmediate(function(){n.apply(null,i)})}}};u(r.iterator(n))()};var k=function(n,t,e){if(e=e||function(){},i(t))n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(l(t),function(n,e){t[n](function(t){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){k({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){k({map:m(t),each:f(t)},n,e)},r.series=function(n,t){if(t=t||function(){},i(n))r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(l(n),function(t,r){n[t](function(n){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var A=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=s(A),r.concatSeries=d(A),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(u){if(u)return e(u);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?r.doWhilst(n,t,e):e()})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(u){if(u)return e(u);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?e():r.doUntil(n,t,e)})},r.queue=function(t,e){function u(n,t,e,u){return n.started||(n.started=!0),i(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var i={data:t,callback:"function"==typeof u?u:null};e?n.tasks.unshift(i):n.tasks.push(i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var a=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,t){u(o,n,!1,t)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(n,t){u(o,n,!0,t)},process:function(){if(!o.paused&&a<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),a+=1;var r=function(){a-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+a===0&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return a},idle:function(){return o.tasks.length+a===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var n=1;n<=o.concurrency;n++)r.setImmediate(o.process)}}};return o},r.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function u(n,t,e){for(var r=-1,u=n.length-1;u>r;){var i=r+(u-r+1>>>1);e(t,n[i])>=0?r=i:u=i-1}return r}function a(n,t,a,o){return n.started||(n.started=!0),i(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var i={data:t,priority:a,callback:"function"==typeof o?o:null};n.tasks.splice(u(n.tasks,i,e)+1,0,i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var o=r.queue(n,t);return o.push=function(n,t,e){a(o,n,t,e)},delete o.unshift,o},r.cargo=function(n,t){var e=!1,u=[],o={tasks:u,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(n,e){i(n)||(n=[n]),c(n,function(n){u.push({data:n,callback:"function"==typeof e?e:null}),o.drained=!1,o.saturated&&u.length===t&&o.saturated()}),r.setImmediate(o.process)},process:function l(){if(!e){if(0===u.length)return o.drain&&!o.drained&&o.drain(),void(o.drained=!0);var r="number"==typeof t?u.splice(0,t):u.splice(0,u.length),i=a(r,function(n){return n.data});o.empty&&o.empty(),e=!0,n(i,function(){e=!1;var n=arguments;c(r,function(t){t.callback&&t.callback.apply(null,n)}),l()})}},length:function(){return u.length},running:function(){return e}};return o};var x=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))}]))}};r.log=x("log"),r.dir=x("dir"),r.memoize=function(n,t){var e={},u={};t=t||function(n){return n};var i=function(){var i=Array.prototype.slice.call(arguments),c=i.pop(),a=t.apply(null,i);a in e?r.nextTick(function(){c.apply(null,e[a])}):a in u?u[a].push(c):(u[a]=[c],n.apply(null,i.concat([function(){e[a]=arguments;var n=u[a];delete u[a];for(var t=0,r=n.length;r>t;t++)n[t].apply(null,arguments)}])))};return i.memo=e,i.unmemoized=n,i},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.seq=function(){var n=arguments;return function(){var t=this,e=Array.prototype.slice.call(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var S=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=s(S),r.applyEachSeries=d(S),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):t.async=r}();function md5(n){var r,d,e,t,o,a,i,H,F,G=Array(),I=7,g=12,u=17,f=22,s=5,c=9,U=14,C=20,h=4,v=11,T=16,m=23,x=6,S=10,w=15,A=21;for(n=uTF8Encode(n),G=convertToWordArray(n),a=1732584193,i=4023233417,H=2562383102,F=271733878,r=0;r<G.length;r+=16)d=a,e=i,t=H,o=F,a=FF(a,i,H,F,G[r+0],I,3614090360),F=FF(F,a,i,H,G[r+1],g,3905402710),H=FF(H,F,a,i,G[r+2],u,606105819),i=FF(i,H,F,a,G[r+3],f,3250441966),a=FF(a,i,H,F,G[r+4],I,4118548399),F=FF(F,a,i,H,G[r+5],g,1200080426),H=FF(H,F,a,i,G[r+6],u,2821735955),i=FF(i,H,F,a,G[r+7],f,4249261313),a=FF(a,i,H,F,G[r+8],I,1770035416),F=FF(F,a,i,H,G[r+9],g,2336552879),H=FF(H,F,a,i,G[r+10],u,4294925233),i=FF(i,H,F,a,G[r+11],f,2304563134),a=FF(a,i,H,F,G[r+12],I,1804603682),F=FF(F,a,i,H,G[r+13],g,4254626195),H=FF(H,F,a,i,G[r+14],u,2792965006),i=FF(i,H,F,a,G[r+15],f,1236535329),a=GG(a,i,H,F,G[r+1],s,4129170786),F=GG(F,a,i,H,G[r+6],c,3225465664),H=GG(H,F,a,i,G[r+11],U,643717713),i=GG(i,H,F,a,G[r+0],C,3921069994),a=GG(a,i,H,F,G[r+5],s,3593408605),F=GG(F,a,i,H,G[r+10],c,38016083),H=GG(H,F,a,i,G[r+15],U,3634488961),i=GG(i,H,F,a,G[r+4],C,3889429448),a=GG(a,i,H,F,G[r+9],s,568446438),F=GG(F,a,i,H,G[r+14],c,3275163606),H=GG(H,F,a,i,G[r+3],U,4107603335),i=GG(i,H,F,a,G[r+8],C,1163531501),a=GG(a,i,H,F,G[r+13],s,2850285829),F=GG(F,a,i,H,G[r+2],c,4243563512),H=GG(H,F,a,i,G[r+7],U,1735328473),i=GG(i,H,F,a,G[r+12],C,2368359562),a=HH(a,i,H,F,G[r+5],h,4294588738),F=HH(F,a,i,H,G[r+8],v,2272392833),H=HH(H,F,a,i,G[r+11],T,1839030562),i=HH(i,H,F,a,G[r+14],m,4259657740),a=HH(a,i,H,F,G[r+1],h,2763975236),F=HH(F,a,i,H,G[r+4],v,1272893353),H=HH(H,F,a,i,G[r+7],T,4139469664),i=HH(i,H,F,a,G[r+10],m,3200236656),a=HH(a,i,H,F,G[r+13],h,681279174),F=HH(F,a,i,H,G[r+0],v,3936430074),H=HH(H,F,a,i,G[r+3],T,3572445317),i=HH(i,H,F,a,G[r+6],m,76029189),a=HH(a,i,H,F,G[r+9],h,3654602809),F=HH(F,a,i,H,G[r+12],v,3873151461),H=HH(H,F,a,i,G[r+15],T,530742520),i=HH(i,H,F,a,G[r+2],m,3299628645),a=II(a,i,H,F,G[r+0],x,4096336452),F=II(F,a,i,H,G[r+7],S,1126891415),H=II(H,F,a,i,G[r+14],w,2878612391),i=II(i,H,F,a,G[r+5],A,4237533241),a=II(a,i,H,F,G[r+12],x,1700485571),F=II(F,a,i,H,G[r+3],S,2399980690),H=II(H,F,a,i,G[r+10],w,4293915773),i=II(i,H,F,a,G[r+1],A,2240044497),a=II(a,i,H,F,G[r+8],x,1873313359),F=II(F,a,i,H,G[r+15],S,4264355552),H=II(H,F,a,i,G[r+6],w,2734768916),i=II(i,H,F,a,G[r+13],A,1309151649),a=II(a,i,H,F,G[r+4],x,4149444226),F=II(F,a,i,H,G[r+11],S,3174756917),H=II(H,F,a,i,G[r+2],w,718787259),i=II(i,H,F,a,G[r+9],A,3951481745),a=addUnsigned(a,d),i=addUnsigned(i,e),H=addUnsigned(H,t),F=addUnsigned(F,o);var L=wordToHex(a)+wordToHex(i)+wordToHex(H)+wordToHex(F);return L.toLowerCase()}var rotateLeft=function(n,r){return n<<r|n>>>32-r},addUnsigned=function(n,r){var d,e,t,o,a;return t=2147483648&n,o=2147483648&r,d=1073741824&n,e=1073741824&r,a=(1073741823&n)+(1073741823&r),d&e?2147483648^a^t^o:d|e?1073741824&a?3221225472^a^t^o:1073741824^a^t^o:a^t^o},F=function(n,r,d){return n&r|~n&d},G=function(n,r,d){return n&d|r&~d},H=function(n,r,d){return n^r^d},I=function(n,r,d){return r^(n|~d)},FF=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(F(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},GG=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(G(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},HH=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(H(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},II=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(I(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},convertToWordArray=function(n){for(var r,d=n.length,e=d+8,t=(e-e%64)/64,o=16*(t+1),a=Array(o-1),i=0,H=0;d>H;)r=(H-H%4)/4,i=H%4*8,a[r]=a[r]|n.charCodeAt(H)<<i,H++;return r=(H-H%4)/4,i=H%4*8,a[r]=a[r]|128<<i,a[o-2]=d<<3,a[o-1]=d>>>29,a},wordToHex=function(n){var r,d,e="",t="";for(d=0;3>=d;d++)r=n>>>8*d&255,t="0"+r.toString(16),e+=t.substr(t.length-2,2);return e},uTF8Encode=function(n){n=n.replace(/\x0d\x0a/g,"\n");for(var r="",d=0;d<n.length;d++){var e=n.charCodeAt(d);128>e?r+=String.fromCharCode(e):e>127&&2048>e?(r+=String.fromCharCode(e>>6|192),r+=String.fromCharCode(63&e|128)):(r+=String.fromCharCode(e>>12|224),r+=String.fromCharCode(e>>6&63|128),r+=String.fromCharCode(63&e|128))}return r};!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Clipboard=t()}}(function(){var t;return function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n||e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,e,n){function o(t,e){for(;t&&t.nodeType!==r;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}var r=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}e.exports=o},{}],2:[function(t,e,n){function o(t,e,n,o,i){var a=r.apply(this,arguments);return t.addEventListener(n,a,i),{destroy:function(){t.removeEventListener(n,a,i)}}}function r(t,e,n,o){return function(n){n.delegateTarget=i(n.target,e),n.delegateTarget&&o.call(t,n)}}var i=t("./closest");e.exports=o},{"./closest":1}],3:[function(t,e,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e,n){function o(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!c.string(e))throw new TypeError("Second argument must be a String");if(!c.fn(n))throw new TypeError("Third argument must be a Function");if(c.node(t))return r(t,e,n);if(c.nodeList(t))return i(t,e,n);if(c.string(t))return a(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function r(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function i(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function a(t,e,n){return s(document.body,t,e,n)}var c=t("./is"),s=t("delegate");e.exports=o},{"./is":3,delegate:2}],5:[function(t,e,n){function o(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var o=window.getSelection(),r=document.createRange();r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r),e=o.toString()}return e}e.exports=o},{}],6:[function(t,e,n){function o(){}o.prototype={on:function(t,e,n){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function o(){r.off(t,o),e.apply(n,arguments)}var r=this;return o._=e,this.on(t,o,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),o=0,r=n.length;for(o;r>o;o++)n[o].fn.apply(n[o].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),o=n[t],r=[];if(o&&e)for(var i=0,a=o.length;a>i;i++)o[i].fn!==e&&o[i].fn._!==e&&r.push(o[i]);return r.length?n[t]=r:delete n[t],this}},e.exports=o},{}],7:[function(e,n,o){!function(r,i){if("function"==typeof t&&t.amd)t(["module","select"],i);else if(void 0!==o)i(n,e("select"));else{var a={exports:{}};i(a,r.select),r.clipboardAction=a.exports}}(this,function(t,e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(e),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=function(){function t(e){o(this,t),this.resolveOptions(e),this.initSelection()}return a(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,r["default"])(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r["default"])(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=c})},{select:5}],8:[function(e,n,o){!function(r,i){if("function"==typeof t&&t.amd)t(["module","./clipboard-action","tiny-emitter","good-listener"],i);else if(void 0!==o)i(n,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var a={exports:{}};i(a,r.clipboardAction,r.tinyEmitter,r.goodListener),r.clipboard=a.exports}}(this,function(t,e,n,o){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){var n="data-clipboard-"+t;return e.hasAttribute(n)?e.getAttribute(n):void 0}var u=r(e),l=r(n),f=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function(t){function e(t,n){i(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.resolveOptions(n),o.listenClick(t),o}return c(e,t),h(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===d(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,f["default"])(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new u["default"]({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return s("action",t)}},{key:"defaultTarget",value:function(t){var e=s("target",t);return e?document.querySelector(e):void 0}},{key:"defaultText",value:function(t){return s("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach(function(t){n=n&&!!document.queryCommandSupported(t)}),n}}]),e}(l["default"]);t.exports=p})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),egret;!function(t){var e=function(){function t(){}return t.BINARY="binary",t.TEXT="text",t.VARIABLES="variables",t.TEXTURE="texture",t.SOUND="sound",t}();t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){var o=t.call(this)||this;return o._name=e,o._frame=0|r,i&&(o._end=0|i),o}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(r,e),r.prototype.$init=function(t,e,r){this.textureData=e,this.spriteSheet=r,this.setMCData(t)},r.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},r.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var r=this.getTextureByResName(e.res);return r}return null},r.prototype.$getOffsetByFrame=function(t,e){var r=this.getKeyFrameData(t);r.res&&e.setTo(0|r.x,0|r.y)},r.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var r=this.textureData[t];e=this.spriteSheet.createTexture(t,r.x,r.y,r.w,r.h)}return e},r.prototype.$isDataValid=function(){return this.frames.length>0},r.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},r.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},r.prototype.fillFramesData=function(t){for(var e,r=this.frames,i=t?t.length:0,o=0;i>o;o++){var n=t[o];if(r.push(n),n.duration){var s=parseInt(n.duration);if(s>1){e=r.length;for(var a=1;s>a;a++)r.push({frame:e})}}}this.numFrames=r.length},r.prototype.fillFrameLabelsData=function(e){if(e){var r=e.length;if(r>0){this.labels=[];for(var i=0;r>i;i++){var o=e[i];this.labels.push(new t.FrameLabel(o.name,o.frame,o.end))}}}},r.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var r=0;e>r;r++){var i=t[r];this.events[i.frame]=i.name}}}},Object.defineProperty(r.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),r.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},r}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r){var i=e.call(this)||this;return i.enableCache=!0,i.$mcDataCache={},i.$mcDataSet=t,i.setTexture(r),i}return __extends(r,e),r.prototype.clearCache=function(){this.$mcDataCache={}},r.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var r=this.findFromCache(e,this.$mcDataCache);return r||(r=new t.MovieClipData,this.fillData(e,r,this.$mcDataCache)),r},r.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},r.prototype.fillData=function(t,e,r){if(this.$mcDataSet){var i=this.$mcDataSet.mc[t];i&&(e.$init(i,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(r[t]=e))}},Object.defineProperty(r.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),r.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},r}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null);var n=e.call(this,t,r,i)||this;return n.frameLabel=null,n.frameLabel=o,n}return __extends(r,e),r.dispatchMovieClipEvent=function(e,i,o){void 0===o&&(o=null);var n=t.Event.create(r,i);n.frameLabel=o;var s=e.dispatchEvent(n);return t.Event.release(n),s},r.FRAME_LABEL="frame_label",r}(t.Event);t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),e}();t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var r=function(e){function r(t,r,i){var o=e.call(this)||this;return o._target=null,o._useTicks=!1,o.ignoreGlobalPause=!1,o.loop=!1,o.pluginData=null,o._steps=null,o._actions=null,o.paused=!1,o.duration=0,o._prevPos=-1,o.position=null,o._prevPosition=0,o._stepPosition=0,o.passive=!1,o.initialize(t,r,i),o}return __extends(r,e),r.get=function(t,e,i,o){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=!1),o&&r.removeTweens(t),new r(t,e,i)},r.removeTweens=function(t){if(t.tween_count){for(var e=r._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},r.tick=function(t,e){void 0===e&&(e=!1);var i=t-r._lastTime;r._lastTime=t;for(var o=r._tweens.concat(),n=o.length-1;n>=0;n--){var s=o[n];e&&!s.ignoreGlobalPause||s.paused||s.tick(s._useTicks?1:i)}return!1},r._register=function(e,i){var o=e._target,n=r._tweens;if(i)o&&(o.tween_count=o.tween_count>0?o.tween_count+1:1),n.push(e),r._inited||(r._lastTime=t.getTimer(),t.ticker.$startTick(r.tick,null),r._inited=!0);else{o&&o.tween_count--;for(var s=n.length;s--;)if(n[s]==e)return void n.splice(s,1)}},r.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&r.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:r._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},r.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var r=t,i=!1;if(r>=this.duration&&(this.loop?r%=this.duration:(r=this.duration,i=!0)),r==this._prevPos)return i;var o=this._prevPos;if(this.position=this._prevPos=r,this._prevPosition=t,this._target)if(i)this._updateTargetProps(null,1);else if(this._steps.length>0){var n=void 0,s=this._steps.length;for(n=0;s>n&&!(this._steps[n].t>r);n++);var a=this._steps[n-1];this._updateTargetProps(a,(this._stepPosition=r-a.t)/a.d)}return i&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(r,r):1==e&&o>r?(o!=this.duration&&this._runActions(o,this.duration),this._runActions(0,r,!0)):this._runActions(o,r)),this.dispatchEventWith("change"),i},r.prototype._runActions=function(t,e,r){void 0===r&&(r=!1);var i=t,o=e,n=-1,s=this._actions.length,a=1;for(t>e&&(i=e,o=t,n=s,s=a=-1);(n+=a)!=s;){var l=this._actions[n],c=l.t;(c==o||c>i&&o>c||r&&c==t)&&l.f.apply(l.o,l.p)}},r.prototype._updateTargetProps=function(t,e){var i,o,n,s,a,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,o=t.p1}else this.passive=!1,i=o=this._curQueueProps;for(var c in this._initQueueProps){null==(s=i[c])&&(i[c]=s=this._initQueueProps[c]),null==(a=o[c])&&(o[c]=a=s),n=s==a||0==e||1==e||"number"!=typeof s?1==e?a:s:s+(a-s)*e;var h=!1;if(l=r._plugins[c])for(var u=0,p=l.length;p>u;u++){var _=l[u].tween(this,c,n,i,o,e,!!t&&i==o,!t);_==r.IGNORE?h=!0:n=_}h||(this._target[c]=n)}},r.prototype.setPaused=function(t){return this.paused=t,r._register(this,!t),this},r.prototype._cloneProps=function(t){var e={};for(var r in t)e[r]=t[r];return e},r.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},r.prototype._appendQueueProps=function(t){var e,i,o,n,s;for(var a in t)if(void 0===this._initQueueProps[a]){if(i=this._target[a],e=r._plugins[a])for(o=0,n=e.length;n>o;o++)i=e[o].init(this,a,i);this._initQueueProps[a]=this._curQueueProps[a]=void 0===i?null:i}else i=this._curQueueProps[a];for(var a in t){if(i=this._curQueueProps[a],e=r._plugins[a])for(s=s||{},o=0,n=e.length;n>o;o++)e[o].step&&e[o].step(this,a,i,t[a],s);this._curQueueProps[a]=t[a]}return s&&this._appendQueueProps(s),this._curQueueProps},r.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},r.prototype.to=function(t,e,r){return void 0===r&&(r=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:r,p1:this._cloneProps(this._appendQueueProps(t))})},r.prototype.call=function(t,e,r){return void 0===e&&(e=void 0),void 0===r&&(r=void 0),this._addAction({f:t,p:r?r:[],o:e?e:this._target})},r.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},r._tweens=[],r.IGNORE={},r._plugins={},r._inited=!1,r._lastTime=0,r}(t.EventDispatcher);t.ScrollTween=r,__reflect(r.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.scrollBeginThreshold=10,i.scrollSpeed=1,i._content=null,i.delayTouchBeginEvent=null,i.touchBeginTimer=null,i.touchEnabled=!0,i._ScrV_Props_=new t.ScrollViewProperties,r&&i.setContent(r),i}return __extends(r,e),Object.defineProperty(r.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),r.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},r.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(r.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),r.prototype.setScrollPosition=function(t,e,r){if(void 0===r&&(r=!1),(!r||0!=t||0!=e)&&(r||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var i=this._ScrV_Props_._scrollTop,o=this._ScrV_Props_._scrollLeft;if(r){var n=this.getMaxScrollLeft(),s=this.getMaxScrollTop();(0>=i||i>=s)&&(t/=2),(0>=o||o>=n)&&(e/=2);var a=i+t,l=o+e,c=this._ScrV_Props_._bounces;c||((0>=a||a>=s)&&(a=Math.max(0,Math.min(a,s))),(0>=l||l>=n)&&(l=Math.max(0,Math.min(l,n)))),this._ScrV_Props_._scrollTop=a,this._ScrV_Props_._scrollLeft=l}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},r.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var r=this.height,i=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-r)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,i>r?i-r/2:r/2)}if(e){var o=this.width,n=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-o)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,n>o?n-o/2:o/2)}},r.prototype.$setWidth=function(t){if(this.$getExplicitWidth()==t)return!1;var r=e.prototype.$setWidth.call(this,t);return this._updateContentPosition(),r},r.prototype.$setHeight=function(t){if(this.$getExplicitHeight()==t)return!1;e.prototype.$setHeight.call(this,t);return this._updateContentPosition(),!0},r.prototype._updateContentPosition=function(){var e=this.height,r=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),r,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},r.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var r=this._ScrV_Props_._verticalScrollPolicy,i=this.__checkScrollPolicy(r,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=i,e||i},r.prototype.__checkScrollPolicy=function(t,e,r){return"on"==t?!0:"off"==t?!1:e>r},r.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var r=this._checkScrollPolicy();r&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},r.prototype._onTouchBeginCapture=function(e){var r=this._checkScrollPolicy();if(r){for(var i=e.target;i!=this;){if("_checkScrollPolicy"in i&&(r=i._checkScrollPolicy()))return;i=i.parent}e.stopPropagation();var o=this.cloneTouchEvent(e);this.delayTouchBeginEvent=o,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},r.prototype._onTouchEndCapture=function(e){var r=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var i=this.cloneTouchEvent(e);t.callLater(function(){r.stage&&r.dispatchPropagationEvent(i)},this)}},r.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},r.prototype.dispatchPropagationEvent=function(e){for(var r=e.$target,i=this.$getPropagationList(r),o=i.length,n=.5*i.length,s=-1,a=0;o>a;a++)if(i[a]===this._content){s=a;break}i.splice(0,s+1),n-=s+1,this.$dispatchPropagationEvent(e,i,n),t.Event.release(e)},r.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,r=t.stageY-this._ScrV_Props_._touchStartPosition.y,i=Math.sqrt(e*e+r*r);if(i<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var o=this._getPointChange(t);this.setScrollPosition(o.y,o.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},r.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},r.prototype._onEnterFrame=function(e){var r=t.getTimer();r-this._ScrV_Props_._lastTouchTime>100&&r-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},r.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},r.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},r.prototype._calcVelocitys=function(e){var r=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=r);var i=this._getPointChange(e),o=r-this._ScrV_Props_._lastTouchTime;i.x/=o,i.y/=o,this._ScrV_Props_._velocitys.push(i),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},r.prototype._getContentWidth=function(){return this._content.$getExplicitWidth()||this._content.width},r.prototype._getContentHeight=function(){return this._content.$getExplicitHeight()||this._content.height},r.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},r.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},r.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,i=0;i<this._ScrV_Props_._velocitys.length;i++){var o=this._ScrV_Props_._velocitys[i],n=r.weight[i];t.x+=o.x*n,t.y+=o.y*n,e+=n}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var s=t.x/e*this.scrollSpeed,a=t.y/e*this.scrollSpeed,l=Math.abs(s),c=Math.abs(a),h=this.getMaxScrollLeft(),u=this.getMaxScrollTop(),p=l>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollLeft,h):{position:this._ScrV_Props_._scrollLeft,duration:1},_=c>.02?this.getAnimationDatas(a,this._ScrV_Props_._scrollTop,u):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(_.position,_.duration)}},r.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},r.prototype._onScrollStarted=function(){},r.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},r.prototype.setScrollTop=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==r)return void(this.scrollTop=i);0==this._ScrV_Props_._bounces&&(e=i);var o=t.ScrollTween.get(this).to({scrollTop:e},r,t.ScrollEase.quartOut);i!=e&&o.to({scrollTop:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=o,o.call(this.onTweenFinished,this,[o]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},r.prototype.setScrollLeft=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==r)return void(this.scrollLeft=i);0==this._ScrV_Props_._bounces&&(e=i);var o=t.ScrollTween.get(this).to({scrollLeft:e},r,t.ScrollEase.quartOut);i!=e&&o.to({scrollLeft:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=o,o.call(this.onTweenFinished,this,[o]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},r.prototype.getAnimationDatas=function(t,e,r){var i=Math.abs(t),o=.95,n=0,s=.998,a=.02,l=e+500*t;if(0>l||l>r)for(l=e;Math.abs(t)!=1/0&&Math.abs(t)>a;)l+=t,t*=0>l||l>r?s*o:s,n++;else n=500*-Math.log(a/i);var c={position:Math.min(r+50,Math.max(l,-50)),duration:n};return c},r.prototype.cloneTouchEvent=function(e){var r=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return r.touchPointID=e.touchPointID,r.$stageX=e.stageX,r.$stageY=e.stageY,r.touchDown=e.touchDown,r.$isDefaultPrevented=!1,r.$target=e.target,r},r.prototype.throwNotSupportedError=function(){t.$error(1023)},r.prototype.addChild=function(t){return this.throwNotSupportedError(),null},r.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},r.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},r.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},r.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},r.weight=[1,1.33,1.66,2,2.33],r}(t.DisplayObjectContainer);t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var r=e.url;return-1==r.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(r=r+"?"+e.data.toString()),r}var r=function(r){function i(e){void 0===e&&(e=null);var i=r.call(this)||this;return i.dataFormat=t.URLLoaderDataFormat.TEXT,i.data=null,i._request=null,i._status=-1,e&&i.load(e),i}return __extends(i,r),i.prototype.load=function(r){this._request=r,this.data=null;var i=this;if(i.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(i);if(i.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(i);var o=e(r),n=new t.HttpRequest;n.open(o,r.method==t.URLRequestMethod.POST?t.HttpMethod.POST:t.HttpMethod.GET);var s;if(r.method!=t.URLRequestMethod.GET&&r.data)if(r.data instanceof t.URLVariables){t.Capabilities.runtimeType==t.RuntimeType.WEB&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=r.data;s=a.toString()}else t.Capabilities.runtimeType==t.RuntimeType.WEB&&n.setRequestHeader("Content-Type","multipart/form-data"),s=r.data;else;for(var l=r.requestHeaders.length,c=0;l>c;c++){var h=r.requestHeaders[c];n.setRequestHeader(h.name,h.value)}n.addEventListener(t.Event.COMPLETE,function(){i.data=n.response,t.Event.dispatchEvent(i,t.Event.COMPLETE)},this),n.addEventListener(t.IOErrorEvent.IO_ERROR,function(){t.IOErrorEvent.dispatchIOErrorEvent(i)},this),n.responseType=i.dataFormat==t.URLLoaderDataFormat.BINARY?t.HttpResponseType.ARRAY_BUFFER:t.HttpResponseType.TEXT,n.send(s)},i.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},i.prototype.loadSound=function(e){function r(t){e.dispatchEvent(t)}function i(t){n(),e.dispatchEvent(t)}function o(r){n(),e.data=l,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},0)}function n(){l.removeEventListener(t.Event.COMPLETE,o,s),l.removeEventListener(t.IOErrorEvent.IO_ERROR,i,s),l.removeEventListener(t.ProgressEvent.PROGRESS,r,s)}var s=this,a=e._request.url,l=new t.Sound;l.addEventListener(t.Event.COMPLETE,o,s),l.addEventListener(t.IOErrorEvent.IO_ERROR,i,s),l.addEventListener(t.ProgressEvent.PROGRESS,r,s),l.load(a)},i.prototype.loadTexture=function(e){function r(t){e.dispatchEvent(t)}function i(t){n(),e.dispatchEvent(t)}function o(r){n();var i=l.data;t.Capabilities.runtimeType==t.RuntimeType.WEB&&i.source.setAttribute("bitmapSrc",a);var o=new t.Texture;o._setBitmapData(i),e.data=o,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},s)}function n(){l.removeEventListener(t.Event.COMPLETE,o,s),l.removeEventListener(t.IOErrorEvent.IO_ERROR,i,s),l.removeEventListener(t.ProgressEvent.PROGRESS,r,s)}var s=this,a=e._request.url,l=new t.ImageLoader;l.addEventListener(t.Event.COMPLETE,o,s),l.addEventListener(t.IOErrorEvent.IO_ERROR,i,s),l.addEventListener(t.ProgressEvent.PROGRESS,r,s),l.load(a)},i.prototype.__recycle=function(){this._request=null,this.data=null},i}(t.EventDispatcher);t.URLLoader=r,__reflect(r.prototype,"egret.URLLoader")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i.$bitmapData=null,i.offsetPoint=t.Point.create(0,0),i.$movieClipData=null,i.frames=null,i.$totalFrames=0,i.frameLabels=null,i.$frameLabelStart=0,i.$frameLabelEnd=0,i.frameEvents=null,i.frameIntervalTime=0,i.$eventPool=null,i.$isPlaying=!1,i.isStopped=!0,i.playTimes=0,i.$currentFrameNum=0,i.$nextFrameNum=1,i.displayedKeyFrameNum=0,i.passedTime=0,i.$frameRate=0/0,i.lastTime=0,i.$smoothing=t.Bitmap.defaultSmoothing,i.$renderNode=new t.sys.BitmapNode,i.setMovieClipData(r),i}return __extends(r,e),Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t=!!t,t!=this.$smoothing&&(this.$smoothing=t,this.$invalidate())},enumerable:!0,configurable:!0}),r.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},r.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},r.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},r.prototype.$render=function(){var e=this.$bitmapData;if(e){var r=Math.round(this.offsetPoint.x),i=Math.round(this.offsetPoint.y),o=e._bitmapWidth,n=e._bitmapHeight,s=e.$getTextureWidth(),a=e.$getTextureHeight(),l=Math.round(e.$getScaleBitmapWidth()),c=Math.round(e.$getScaleBitmapHeight()),h=e._sourceWidth,u=e._sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e._bitmapData,e._bitmapX,e._bitmapY,o,n,r,i,s,a,l,c,h,u,null,t.BitmapFillMode.SCALE,this.$smoothing)}},r.prototype.$measureContentBounds=function(t){var e=this.$bitmapData;if(e){var r=this.offsetPoint.x,i=this.offsetPoint.y,o=e.$getTextureWidth(),n=e.$getTextureHeight();t.setTo(r,i,o,n)}else t.setEmpty()},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},r.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var r=this.frameLabels;if(r)for(var i=null,o=0;o<r.length;o++)if(i=r[o],e?i.name.toLowerCase()==t:i.name==t)return i;return null},r.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],t==r.name){this.$frameLabelStart=r.frame,this.$frameLabelEnd=r.end;break}},r.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],r.frame==t)return r;return null},r.prototype.getFrameLabelForFrame=function(t){var e=null,r=null,i=this.frameLabels;if(i)for(var o=0;o<i.length;o++){if(r=i[o],r.frame>t)return e;e=r}return e},r.prototype.play=function(t){void 0===t&&(t=0),this.$isPlaying=!0,this.setPlayTimes(t),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},r.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},r.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},r.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},r.prototype.gotoAndPlay=function(e,r){void 0===r&&(r=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(r),this.gotoFrame(e)},r.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},r.prototype.gotoFrame=function(e){var r;"string"==typeof e?r=this.getFrameLabelByName(e).frame:(r=parseInt(e+"",10),r!=e&&t.$error(1022,"Frame Label Not Found")),1>r?r=1:r>this.$totalFrames&&(r=this.$totalFrames),r!=this.$nextFrameNum&&(this.$nextFrameNum=r,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},r.prototype.advanceTime=function(e){var r=this,i=e-r.lastTime;r.lastTime=e;var o=r.frameIntervalTime,n=r.passedTime+i;r.passedTime=n%o;var s=n/o;if(1>s)return!1;for(;s>=1;){if(s--,r.$nextFrameNum++,r.$nextFrameNum>r.$totalFrames||r.$frameLabelStart>0&&r.$nextFrameNum>r.$frameLabelEnd)if(-1==r.playTimes)r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1;else{if(r.playTimes--,!(r.playTimes>0)){r.$nextFrameNum=r.$totalFrames,r.$eventPool.push(t.Event.COMPLETE),r.stop();break}r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1}r.$currentFrameNum==r.$frameLabelEnd&&(r.$nextFrameNum=r.$frameLabelStart),r.advanceFrame()}return r.constructFrame(),r.handlePendingEvent(),!1},r.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},r.prototype.constructFrame=function(){var t=this.$currentFrameNum;this.displayedKeyFrameNum!=t&&(this.$bitmapData=this.$movieClipData.getTextureByFrame(t),this.$movieClipData.$getOffsetByFrame(t,this.offsetPoint),this.$invalidateContentBounds(),this.displayedKeyFrameNum=t)},r.prototype.$renderFrame=function(){this.$bitmapData=this.$movieClipData.getTextureByFrame(this.$currentFrameNum),this.$invalidateContentBounds()},r.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();
for(var e=this.$eventPool,r=e.length,i=!1,o=!1,n=0;r>n;n++){var s=e.pop();s==t.Event.LOOP_COMPLETE?o=!0:s==t.Event.COMPLETE?i=!0:this.dispatchEventWith(s)}o&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),i&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(r.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),r.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},r.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},r.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.ticker.$startTick(this.advanceTime,this)))},r}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.data=null,i.method=t.URLRequestMethod.GET,i.url="",i.requestHeaders=[],i.url=r,i}return __extends(r,e),r}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="get",t.POST="post",t}();t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.variables=null,null!==e&&r.decode(e),r}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,r=/[?&]?([^=]+)=([^&]*)/g;e=r.exec(t);){var i=decodeURIComponent(e[1]),o=decodeURIComponent(e[2]);if(i in this.variables!=0){var n=this.variables[i];n instanceof Array?n.push(o):this.variables[i]=[n,o]}else this.variables[i]=o}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var r in t)e.push(this.encodeValue(r,t[r]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var i=e.call(this)||this;return i._timeScale=1,i._paused=!1,i._callIndex=-1,i._lastTime=0,i.callBackList=[],null!=r.instance,t.ticker.$startTick(i.update,i),i._lastTime=t.getTimer(),i}return __extends(r,e),r.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var r=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var i=this._callList[this._callIndex];i.listener.call(i.thisObject,r)}return this._callIndex=-1,this._callList=null,!1},r.prototype.register=function(t,e,r){void 0===r&&(r=0),this.$insertEventBin(this.callBackList,"",t,e,!1,r,!1)},r.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},r.prototype.setTimeScale=function(t){this._timeScale=t},r.prototype.getTimeScale=function(){return this._timeScale},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){this._paused=!1},r.getInstance=function(){return null==r.instance&&(r.instance=new r),r.instance},r}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){return e.call(this)||this}return __extends(r,e),Object.defineProperty(r.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(r,"runtimeType",{get:function(){return t.$warn(1041,"egret.MainContext.runtimeType","egret.Capabilities.runtimeType"),r._runtimeType},enumerable:!0,configurable:!0}),r.prototype.run=function(){},Object.defineProperty(r,"instance",{get:function(){return null==r._instance&&(r._instance=new r),r._instance},enumerable:!0,configurable:!0}),r.deviceType=null,r.DEVICE_PC="web",r.DEVICE_MOBILE="native",r.RUNTIME_HTML5="runtimeHtml5",r.RUNTIME_NATIVE="runtimeNative",r}(t.EventDispatcher);t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={})),egret.testDeviceType1=function(){if(!this.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.testRuntimeType1=function(){return this.navigator?!0:!1},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,egret.MainContext._runtimeType=egret.testRuntimeType1()?egret.MainContext.RUNTIME_HTML5:egret.MainContext.RUNTIME_NATIVE,delete egret.testDeviceType1,delete egret.testRuntimeType1;var egret;!function(t){var e=function(e){function r(t){void 0===t&&(t=300);var r=e.call(this)||this;return r.objectPool=[],r._length=0,1>t&&(t=1),r.autoDisposeTime=t,r.frameCount=0,r}return __extends(r,e),r.$init=function(){t.ticker.$startTick(r.onUpdate,r)},r.onUpdate=function(t){for(var e=r._callBackList,i=e.length-1;i>=0;i--)e[i].$checkFrame();return!1},r.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(r.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),r.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,r._callBackList.push(this)))},r.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},r.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=r._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},r._callBackList=[],r}(t.HashObject);t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,r,l){for(var c=[],h=3;h<arguments.length;h++)c[h-3]=arguments[h];var u={listener:e,thisObject:r,delay:l,originDelay:l,params:c};return s++,1==s&&(a=t.getTimer(),t.ticker.$startTick(i,null)),n++,o[n]=u,n}function r(e){o[e]&&(s--,delete o[e],0==s&&t.ticker.$stopTick(i,null))}function i(t){var e=t-a;a=t;for(var r in o){var i=o[r];i.delay-=e,i.delay<=0&&(i.delay=i.originDelay,i.listener.apply(i.thisObject,i.params))}return!1}var o={},n=0,s=0,a=0;t.setInterval=e,t.clearInterval=r}(egret||(egret={}));var egret;!function(t){function e(e,r,l){for(var c=[],h=3;h<arguments.length;h++)c[h-3]=arguments[h];var u={listener:e,thisObject:r,delay:l,params:c};return s++,1==s&&t.ticker&&(a=t.getTimer(),t.ticker.$startTick(i,null)),n++,o[n]=u,n}function r(e){o[e]&&(s--,delete o[e],0==s&&t.ticker&&t.ticker.$stopTick(i,null))}function i(t){var e=t-a;a=t;for(var i in o){var n=i,s=o[n];s.delay-=e,s.delay<=0&&(s.listener.apply(s.thisObject,s.params),r(n))}return!1}var o={},n=0,s=0,a=0;t.setTimeout=e,t.clearTimeout=r}(egret||(egret={}));function customClickEvent(){var t;return window.CustomEvent?t=new window.CustomEvent("click",{canBubble:!0,cancelable:!0}):(t=document.createEvent("Event"),t.initEvent("click",!0,!0)),t}var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Seat=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setUserOffline=function(t){this.offline_img.visible=t},e.prototype._onTouchHead=function(){if(this._userInfoData){var t=(100*this._userInfoData.getWinRate()).toFixed(0)+"%",e=this._userInfoData.redcoingot,n=this._userInfoData.nickname,i=this._userInfoData.gold,o=this._userInfoData.imageid,a=this._userInfoData.totalwincnt+this._userInfoData.totallosecnt+this._userInfoData.totaldrawcnt,r=this._userInfoData.seatid,s=this._userInfoData.uid,h={nick:n,gold:i,head:o,winRate:t,game:a,redBeg:e,seatId:r,uid:s};PanelPlayerInfo.getInstance().show(h)}},e.prototype.setHeadTouch=function(t){this.userInfoView.avatar.setHeadTouch(t),this.userInfoView.avatar.setHeadTouchFunc(this._onTouchHead.bind(this))},e.prototype.reset=function(t){return void 0===t&&(t=!1),this.labChange.visible=!1,this.setUserOffline(!1),this.stopCD(),t||(this.cleanHand(),this.cleanDesk()),this},e.prototype.clean=function(t,e){return this.reset(t),e&&this.userInfoView.clean(),this},e.prototype.addCards=function(t,e){void 0===e&&(e=!0)},e.prototype.useCards=function(t){},e.prototype.startCD=function(t){},e.prototype.stopCD=function(){},e.prototype.cleanDesk=function(){this.deskCardGroup.clean()},e.prototype.cleanHand=function(){this.handCardGroup.clean()},e.prototype.playChat=function(t){},e.prototype.playChangeEffect=function(t,e){void 0===e&&(e=0);var n=this.labChange;n.font=RES.getRes(t>0?"font_num_1":"font_num_2");var i=Utils.currencyRatio(Math.abs(t));n.text=t>0?"+"+i:"-"+i,n.y+=50,n.alpha=0,n.visible=!0,egret.Tween.get(n).wait(e).to({y:n.y-50,alpha:1},1e3,egret.Ease.cubicOut)},Object.defineProperty(e.prototype,"userInfoData",{get:function(){return this._userInfoData},set:function(t){this._setUserInfoData(t)},enumerable:!0,configurable:!0}),e.prototype._setUserInfoData=function(t){this._userInfoData=t,this._userInfoData||this.userInfoView.clean()},e.prototype.updateUserInfoData=function(t){this._userInfoData.initData(t),this.userInfoView.update(this._userInfoData)},e.prototype.setQuitFlagVisible=function(t){this.userInfoView.avatar.setQuitFlagVisible(t)},e.prototype.setOwnerFlagVisible=function(t){this.userInfoView.avatar.setOwnerFlagVisible(t)},e.prototype.playWinGoldAnimate=function(){this.userInfoView.playWinGoldAnimate()},e.prototype.getHeadCenterPos=function(){return this.userInfoView.avatar.getHeadCenGlobalPos()},e.prototype.getAvatarPos=function(){return this._avatarglobalPos||(this._avatarglobalPos=this.userInfoView.localToGlobal(this.userInfoView.avatar.x,this.userInfoView.avatar.y),this._avatarglobalPos.x+=.65*this.userInfoView.avatar.width/2,this._avatarglobalPos.y+=.65*this.userInfoView.avatar.height/2),this._avatarglobalPos},e}(eui.Component);__reflect(Seat.prototype,"Seat");var alien;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._needActive=!0,t.init(),t}return __extends(n,e),n.prototype.init=function(){this._pageStack=[],this._pageCache={}},n.prototype.push=function(e,i,o,a){var r=this;if(void 0===i&&(i=!0),void 0===o&&(o=null),void 0===a&&(a=!0),e&&!this.playing){var s=e.defName,h=this._pageCache[s];h||(this._pageCache[s]=h=new e,h.navigation=this),this._currentPage=h;var c="push";if(this.addChild(h),this._pageStack.length>0&&h.beforeShow(c,o),a&&this.dispatchEventWith(n.NAVIGATE,!1,{action:c,page:h}),this._pageStack.length>0){var l=t.StageProxy.width,u=this._pageStack[this._pageStack.length-1];this._pageStack.push(h);var p=function(){u.onHide(c,o),r.removeChild(u)},d=function(){u.onShow(c,o),r._tween=null};h.x=l,u.beforeHide(c,o),i?egret.Tween.get(u).to({x:-l},n.duration,egret.Ease.quartInOut).call(p,this):(u.x=-l,p.call(this)),i?this._tween=egret.Tween.get(h).to({x:0},n.duration,egret.Ease.quartInOut).call(d,this):(h.x=0,d.call(this))}else this._pageStack.push(h),h.onShow(c,o)}},n.prototype.pop=function(e,i,o){var a=this;if(void 0===e&&(e=!0),void 0===i&&(i=null),void 0===o&&(o=!0),!this.playing&&this._pageStack.length>1){var r="pop",s=t.StageProxy.width,h=this._pageStack.pop(),c=this._currentPage=this._pageStack[this._pageStack.length-1];this.addChild(c),o&&this.dispatchEventWith(n.NAVIGATE,!1,{action:r,page:c});var l=function(){h.onHide(r,i),a.removeChild(h),a._tween=null},u=function(){c.onShow(r,i)};c.beforeShow(r,i),e?egret.Tween.get(c).to({x:0},n.duration,egret.Ease.quartInOut).call(u,this):(c.x=0,u.call(this)),h.beforeHide(r,i),e?this._tween=egret.Tween.get(h).to({x:s},n.duration,egret.Ease.quartInOut).call(l,this):(h.x=s,l.call(this))}},n.prototype.popAll=function(e,i,o){var a=this;if(void 0===e&&(e=!0),void 0===i&&(i=null),void 0===o&&(o=!0),!this.playing)if(this._pageStack.length>1){var r="pop",s=t.StageProxy.width,h=this._pageStack.pop();this._pageStack.splice(1);var c=this._currentPage=this._pageStack[this._pageStack.length-1];this.addChild(c),o&&this.dispatchEventWith(n.NAVIGATE,!1,{action:r,page:c}),c.beforeShow(r,i),h.beforeHide(r,i),e?(egret.Tween.get(c).to({x:0},n.duration,egret.Ease.quartInOut).call(function(){c.onShow(r,i)}),this._tween=egret.Tween.get(h).to({x:s},n.duration,egret.Ease.quartInOut).call(function(){h.onHide(r,i),a.removeChild(h),a._tween=null})):(c.x=0,h.x=s,c.onShow(r,i),h.onHide(r,i),this.removeChild(h))}else this._needActive=!0,this.active(o)},n.prototype.active=function(t){void 0===t&&(t=!0),this._needActive&&(this._needActive=!1,t&&(this._currentPage.beforeShow("active"),this.dispatchEventWith(n.NAVIGATE,!1,{action:"pop",page:this._currentPage})))},n.prototype.deactive=function(){this._needActive=!0,this._currentPage.beforeHide("deactive")},Object.defineProperty(n.prototype,"size",{get:function(){return this._pageStack.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"playing",{get:function(){return!!this._tween},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPage",{get:function(){return this._currentPage},enumerable:!0,configurable:!0}),n.NAVIGATE="navigate",n.duration=500,n}(eui.Group);t.Navigator=e,__reflect(e.prototype,"alien.Navigator");var n=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e}return __extends(e,t),e.prototype.beforeShow=function(t,e){void 0===e&&(e=null)},e.prototype.beforeHide=function(t,e){void 0===e&&(e=null)},e.prototype.onShow=function(t,e){void 0===e&&(e=null)},e.prototype.onHide=function(t,e){void 0===e&&(e=null)},e}(eui.Component);t.NavigationPage=n,__reflect(n.prototype,"alien.NavigationPage")}(alien||(alien={}));var DDZSeat=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.ddzHandCardGroup=this.handCardGroup,this.ddzDeskCardGroup=this.deskCardGroup,this.ddzHandCardGroup.onCardAdded=this.onCardAdded.bind(this),this.btnCancleTrust.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelTrust,this)},e.prototype.onCancelTrust=function(t){server.hang(!1)},e.prototype.reset=function(e){return void 0===e&&(e=!1),this.cdClock.visible=this.imgStatus.visible=!1,this.labCardCount.text="0",this.hideJingDeng(),this.showDoubleFlag(!1),this.setMaster(!1,!1),this.setHang(!1),this.ddzHandCardGroup.initData(),t.prototype.reset.call(this,e)},e.prototype.clean=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!0),this.cleanPlayer(n),t.prototype.clean.call(this,e,n)},e.prototype.cleanPlayer=function(t){void 0===t&&(t=!0),this.cdClock.stop(),this.robot.visible=!1,this.labCardCount.text="0",this.hideJingDeng(),this.showDoubleFlag(!1),this.imgMaster.visible=!1,this.imgStatus.visible=!1,this.imgReady.visible=!1,t&&(this.userInfoData=null)},e.prototype.initData=function(t){var e=t.cleanUserInfo;this.clean(!1,e),6==t.matchType?this.userInfoView.gold.visible=!1:(this.userInfoView.gold.visible=!0,this.userInfoView.gold.setType(t.isMatch,t.matchType),10==t.roomType&&(t.isSelf||this.userInfoView.gold.showDiamond()))},e.prototype.cleanDesk=function(){t.prototype.cleanDesk.call(this),this.setStatus()},e.prototype.addCards=function(e,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),i&&this.setStatus(),t.prototype.addCards.call(this,e)},e.prototype.onCardAdded=function(t){},e.prototype.setCardsShadowSize=function(t){this.cardShadow&&(this.cardShadow.width=GameConfig.CARD_WIDTH+(t-1)*GameConfig.CARD_GAP_H)},e.prototype.useCard=function(t,e,n){void 0===t&&(t=null),void 0===e&&(e=!1),void 0===n&&(n=!0);var i=0;if(!e&&n){var o=CardsType.GetType(t);i=o.ct;var a=Utils.pid2poker(t[0]);GameSoundManager.playCardType(this._sexVoice,i,a.num),alien.Dispatcher.dispatch(EventNames.SHOW_GAME_EFFECT,{cardType:i,state:this.currentState})}if(0==t.length)this.stopCD(),e?this.setStatus():this.setStatus(ResNames.play_word_4);else{this.cleanDesk();var r=this.ddzHandCardGroup.useCards(t,this.ddzDeskCardGroup,n);!e&&n&&this.updateCardCount(r),this.setStatus(),this.setCardsShadowSize(this.handCardGroup.cardCount)}return i},e.prototype.setStatus=function(t){void 0===t&&(t=null),t&&(this.imgStatus.source=t),this.imgStatus.visible=!!t},e.prototype.setShowCardShadow=function(t){this.cardShadow&&(this.cardShadow.visible=t,this.setCardsShadowSize(this.handCardGroup.cardCount))},e.prototype.setHang=function(t){this.robot.visible=t,this.btnCancleTrust&&(this.btnCancleTrust.visible=t),this.setShowCardShadow(t)},e.prototype.startCD=function(t,e){void 0===e&&(e=null),this.cdClock.visible=!0,this.cdClock.start(t,e)},e.prototype.stopCD=function(){this.cdClock.visible=!1,this.cdClock.stop()},e.prototype.showScore=function(t){0==t?this.setStatus(ResNames.play_word_5):0>t||this.setStatus("play_word_"+t),GameSoundManager.playScore(this._sexVoice,t)},e.prototype.hideScore=function(){this.setStatus()},e.prototype.showDoubleFlag=function(t){this.doubleFlag_img.visible=t},e.prototype.showDoubleTip=function(t,e){var n=this;void 0===e&&(e=!1);var i="noDouble2";e&&(i="double2"),this.setStatus(i),egret.setTimeout(function(){("noDouble2"==n.imgStatus.source||"double2"==n.imgStatus.source)&&n.setStatus()},this,3e3),GameSoundManager.playDouble(this._sexVoice,e)},e.prototype.updateCardCount=function(t){3>=t?this.showJingDeng():this.hideJingDeng()},e.prototype.showJingDeng=function(){this.jingdeng||(this.jingdeng=new DragonJingDeng),this.jingdeng.parent||this.jingdengGroup.addChild(this.jingdeng)},e.prototype.hideJingDeng=function(){this.jingdeng&&this.jingdeng.parent&&this.jingdeng.parent.removeChild(this.jingdeng)},e.prototype.setMaster=function(t,e){if(this.imgMaster.visible=!1,this._isMaster=t,this.ddzHandCardGroup.isMaster=t,this.ddzDeskCardGroup.isMaster=t,t){var n=this.globalToLocal(alien.StageProxy.width/2-this.imgMaster.width/2,alien.StageProxy.height/2-this.imgMaster.height/2);n={x:n.x,y:n.y,visible:!0};var i={x:this.imgMaster.x,y:this.imgMaster.y},o=egret.Tween.get(this.imgMaster).set({visible:!0}).to(n);e?o.wait(1e3).to(i,500,egret.Ease.cubicIn):o.to(i)}},Object.defineProperty(e.prototype,"isMaster",{get:function(){return this._isMaster},enumerable:!0,configurable:!0}),e.prototype._setUserInfoData=function(e){t.prototype._setUserInfoData.call(this,e),this.userInfoData&&(this._sexVoice=e.sexVoiceStr)},e.prototype.updateUserInfoData=function(e){t.prototype.updateUserInfoData.call(this,e),this.userInfoData&&(this._sexVoice=this._userInfoData.sexVoiceStr)},e.prototype.updateGold=function(t,e){void 0===e&&(e=!1);var n=this.userInfoData.gold+=t;!e&&0>n&&(n=0),this.userInfoView.updateGold(n)},e.prototype.updateRednormalGold=function(t,e){void 0===e&&(e=!1);var n=this.userInfoView.gold.nGold;e&&(n=this.userInfoView.diamond.nGold);var i=Number(n)+t;0>i&&(i=0),e?this.userInfoView.updateDiamond(i):this.userInfoView.updateGold(i)},e.prototype.updateDiamond=function(t){0>t||this.userInfoView.updateDiamond(t)},e.prototype.showDiamond=function(t){this.userInfoView.diamond.visible=t},e.prototype.setReady=function(t){this.imgReady.visible=t&&!server.isMatch},e}(Seat);__reflect(DDZSeat.prototype,"DDZSeat");var CardGroup=function(t){function e(){var e=t.call(this)||this;return e.scale=1,e.align=.5,e.warpCount=100,e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.initData=function(t){void 0===t&&(t=null),this.clean()},e.prototype.clean=function(){Utils.recycleCards(this),this.cardCount=0},e.prototype.addCards=function(t,e){var n=this;return void 0===e&&(e=!0),t.forEach(function(t,e){var i=Card.create({pid:t});n.addCard(i,e)}),this.adjustCards(e),this.numChildren},e.prototype.addCard=function(t,e){var n=this;void 0===e&&(e=0),t.scaleX=t.scaleY=this.scale,alien.Utils.enumChildren(this,function(e,i){return t.pokerId>e.pokerId?(n.addChildAt(t,i),!0):void 0}),t.parent||this.addChild(t),this.cardCount++,t.addPlaying=!0},e.prototype.sendCardsToGroup=function(t,e,n){void 0===n&&(n=!0),t.receiveCardsFromGroup.call(t,this,e),n&&(this.cardCount-=e.length),this.adjustCards(!0)},e.prototype.getCardGapH=function(t){return t&&GameConfig.CARD_GAP_H*(t-1)+GameConfig.CARD_WIDTH*GameConfig.CARD_SCALE>alien.StageProxy.stage.stageWidth?(alien.StageProxy.stage.stageWidth-GameConfig.CARD_WIDTH*GameConfig.CARD_SCALE)/(t-1):GameConfig.CARD_GAP_H},e.prototype.receiveCardsFromGroup=function(t,e){var n=this,i=this.scale;e.sort(function(t,e){return e.pokerId-t.pokerId});var o=e.length,a=0,r=this.getCardGapH(o),s=(this.width-(r*Math.min(o,this.warpCount)+GameConfig.CARD_OFFSET)*i)*this.align,h=this.localToGlobal(s,0),c=t.globalToLocal(h.x,h.y);e.forEach(function(t,e){t.select=!1,t.sending=!0;var h=Math.floor(e/n.warpCount),l=c.x+e%n.warpCount*r*i,u=c.y+h*GameConfig.CARD_GAP_V*i;t.animate({x:l,y:u,scaleX:i,scaleY:i},0,null,200).call(function(e){t.sending=!1,n.addChildAt(t,0),t.x=s+e%n.warpCount*r*i,t.y=h*GameConfig.CARD_GAP_V*i,a++,a==o&&n.adjustCardsEnd()},n,[e])})},Object.defineProperty(e.prototype,"stageCenterPos",{get:function(){if(!this._stageCenterPos){var t=this.globalToLocal(alien.StageProxy.width/2-GameConfig.CARD_WIDTH/2,alien.StageProxy.height/2-GameConfig.CARD_HEIGHT/2);this._stageCenterPos={x:t.x,y:t.y}}return this._stageCenterPos},enumerable:!0,configurable:!0}),e.prototype.adjustCards=function(t){var e=this;void 0===t&&(t=!0);var n=0,i=this.getCardGapH(this.cardCount),o=this.width-(i*this.cardCount+GameConfig.CARD_OFFSET)*this.scale>>1,a=0,r=0;alien.Utils.enumChildren(this,function(t){t.sending||r++}),alien.Utils.enumChildren(this,function(s){if(!s.sending){var h=o+a*i*e.scale,c=0;if(t){var l=void 0;s.addPlaying?(alien.Utils.injectProp(s,{alpha:0,scaleX:.2,scaleY:.2}),l=s.animate({alpha:1,scaleX:e.scale,scaleY:e.scale,x:h,y:c},20*n,e.stageCenterPos),l.call(function(){s.addPlaying=!1,e.onCardAdded&&e.onCardAdded(s)})):l=s.animate({x:h,y:c,alpha:1}),l.call(function(){n++,n>=r&&e.adjustCardsEnd()})}else s.x=h,s.y=c,s.addPlaying=!1;a++}}),t||this.adjustCardsEnd()},e.prototype.adjustCardsEnd=function(){},e.prototype.destroyCard=function(t){var e=this;egret.Tween.get(t).to({alpha:0},100).call(function(t){e.removeChild(t),Card.recycle(t)},this,[t])},e}(eui.Group);__reflect(CardGroup.prototype,"CardGroup");var alien;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.onStageResize(),n.touchChildren=!0,n.touchEnabled=!1,t.StageProxy.stage.addEventListener(egret.Event.RESIZE,n.onStageResize,n),n}return __extends(n,e),n.prototype.onStageResize=function(e){void 0===e&&(e=null),this.width=t.StageProxy.stage.stageWidth,this.height=t.StageProxy.stage.stageHeight},n.prototype._beforeShow=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.beforeShow(t,e)},n.prototype._beforeHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.beforeHide(t,e)},n.prototype._onShow=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.onShow(t,e)},n.prototype._onHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.onHide(t,e)},n.prototype.beforeShow=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1)},n.prototype.beforeHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1)},n.prototype.onShow=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1)},n.prototype.onHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1)},n}(eui.Component);t.SceneBase=e,__reflect(e.prototype,"alien.SceneBase")}(alien||(alien={}));var alien;!function(t){var e=function(){function e(){this.mapSceneDef=new t.HashMap,this.mapScene=new t.HashMap,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}return Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.init=function(t,n){void 0===n&&(n="loading"),e.instance.init(t,n)},e.addMostTopScene=function(t,n){e.instance.addMostTopScene(t,n)},e.addTopScene=function(t,n){e.instance.addTopScene(t,n)},e.addEffectScene=function(t,n){e.instance.addEffectScene(t,n)},e.addBottomScene=function(t,n){e.instance.addBottomScene(t,n)},e.register=function(t,n,i){void 0===i&&(i=null),e.instance.register(t,n,i)},e.show=function(t,n,i,o,a,r,s){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=!1),void 0===s&&(s=null),e.instance.show(t,n,i,o,a,r,s)},e.back=function(t,n,i,o){return void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),e.instance.back(t,n,i,o)},e.addOtherContainer=function(t){t&&e.instance.topLayer.addChild(t)},e.removeOtherContainer=function(t){t&&e.instance.topLayer.removeChild(t)},e.removeDDZContainer=function(){var t=e.instance.middleLayer;t.removeChildren(),e.instance.currentScene=null,e.instance.currentSceneName=null},e.prototype.init=function(e,n){void 0===n&&(n="loading"),this.root=e,this.loadingSceneName=n,this.root.addChild(this.background=new egret.Shape),this.root.addChild(this.bottomLayer=new eui.Group),this.root.addChild(this.middleLayer=new eui.Group),this.root.addChild(this.topLayer=new eui.Group),this.root.addChild(this.popLayer=new eui.Group),this.root.addChild(this.effectLayer=new eui.Group),this.root.addChild(this.mostTopLayer=new eui.Group),this.bottomLayer.touchEnabled=!1,this.middleLayer.touchEnabled=!1,this.topLayer.touchEnabled=!1,this.popLayer.touchEnabled=!1,this.effectLayer.touchEnabled=!1,this.mostTopLayer.touchEnabled=!1,this.backgroundColor=16777215,t.StageProxy.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this)},e.prototype.onStageResize=function(e){void 0===e&&(e=null),t.Utils.enumChildren(this.root,function(e){e.width=t.StageProxy.stage.stageWidth,e.height=t.StageProxy.stage.stageHeight}),this.reDrawBG()},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.reDrawBG()},enumerable:!0,configurable:!0}),e.prototype.reDrawBG=function(){var e=this.background.graphics;e.beginFill(this._backgroundColor),e.drawRect(0,0,t.StageProxy.width,t.StageProxy.height),e.endFill()},e.prototype.onResourceLoadComplete=function(t){console.log("111RES LOAD COMPLETE:"+t.groupName),t.groupName==this.currentLoadGroup&&this.nextShowEntity&&(this.show(this.nextShowEntity.name,this.nextShowEntity.params,this.nextShowEntity.effectDef,this.nextShowEntity.effectParams,this.nextShowEntity.callback,this.nextShowEntity.back),this.currentLoadGroup=null,this.nextShowEntity=null)},e.prototype.onResourceProgress=function(e){e.groupName==this.currentLoadGroup&&t.Dispatcher.dispatch("loadingProgress",{itemsLoaded:e.itemsLoaded,itemsTotal:e.itemsTotal})},e.prototype.onResourceLoadError=function(t){webService.postError(ErrorConfig.RESOURCE_LOAD_ERROR,t.groupName)},e.prototype.addMostTopScene=function(t,e){var n=new e;this.mostTopLayer.addChild(n),n._beforeShow(null)},e.prototype.addTopScene=function(t,e){var n=new e;this.topLayer.addChild(n),n._beforeShow(null)},e.prototype.addEffectScene=function(t,e){var n=new e;this.effectLayer.addChild(n),n._beforeShow(null)},e.prototype.addBottomScene=function(t,e){var n=new e;this.bottomLayer.addChild(n),n._beforeShow(null)},e.prototype.register=function(t,e,i){void 0===i&&(i=null),this.mapSceneDef.put(t,new n(e,i))},e.prototype.show=function(e,n,o,a,r,s,h){if(void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=!1),void 0===h&&(h=null),this.currentSceneName==e)this.currentScene._beforeShow(n,!1),this.currentScene._onShow(n,!1);else{var c=void 0,l=void 0,u=this.mapSceneDef.get(e);if(u.resGroup&&!RES.isGroupLoaded(u.resGroup))this.nextShowEntity=new i(e,n,o,a,r,s),this.currentLoadGroup=u.resGroup,egret.setTimeout(function(){RES.loadGroup(u.resGroup)},this,100),e=this.loadingSceneName,l=this.mapScene.get(e),l.resetDesc(),o=null;else if(this.mapScene.containsKey(e))l=this.mapScene.get(e);else{var p=u.sceneDef;l=new p,l.name=e,this.mapScene.put(e,l)}!c&&this.currentSceneName?(c=o?new o:new t.sceneEffect.None,this.currentScene._beforeHide(n,s)):c=new t.sceneEffect.None,this.currentSceneName!=e&&(this.currentScene&&(egret.Tween.removeTweens(this.currentScene),this.currentScene.touchChildren=!1),egret.Tween.removeTweens(l),c.handover(this.currentScene,l,this.middleLayer,a,function(t,e){t&&t._onHide(n,s),e.touchChildren=!0,e._onShow(n,s),r&&r()}.bind(this,this.currentScene,l)),this.currentScene=l,s?this.lastSceneName=e:e!=this.loadingSceneName&&(this.currentScene.lastSceneName=null!=h?h:this.lastSceneName,this.lastSceneName=e),this.currentSceneName=e,this.currentScene._beforeShow(n,s))}},e.prototype.back=function(t,e,n,i){return void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.currentScene.lastSceneName&&""!=this.currentScene.lastSceneName?(this.show(this.currentScene.lastSceneName,t,e,n,i,!0),!0):!1},e}();t.SceneManager=e,__reflect(e.prototype,"alien.SceneManager");var n=function(){function t(t,e){void 0===e&&(e=null),this.sceneDef=t,this.resGroup=e}return t}();t.SceneConfig=n,__reflect(n.prototype,"alien.SceneConfig");var i=function(){function t(t,e,n,i,o,a){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=!1),this.params=null,this.effectDef=null,this.effectParams=null,this.callback=null,this.back=null,this.name=t,this.params=e,this.effectDef=n,this.callback=o,this.back=a}return t}();t.ShowEntity=i,__reflect(i.prototype,"alien.ShowEntity")}(alien||(alien={}));var alien;!function(t){var e=function(){function e(){this._groups={}}return Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.register=function(e,i,o,a,r,s){void 0===s&&(s=0);var h=new n;t.Utils.injectProp(h,{target:i,eventName:o,callback:a,thisObj:r,priority:s},null,!1);var c=this._groups[e];c||(c=this._groups[e]={enable:!1,items:[]}),c.items.push(h)},e.prototype.registerOnObject=function(t,e,n,i,o,a){void 0===a&&(a=0),this.register(t.__class__,e,n,i,o,a)},e.prototype.enable=function(t){var e=this._groups[t];e&&!e.enable&&(e.enable=!0,e.items.forEach(function(t){t.target.addEventListener(t.eventName,t.callback,t.thisObj,!1,t.priority)}))},e.prototype.enableOnObject=function(t){this.enable(t.__class__)},e.prototype.disable=function(t){var e=this._groups[t];e&&e.enable&&(e.enable=!1,e.items.forEach(function(t){t.target.removeEventListener(t.eventName,t.callback,t.thisObj)}))},e.prototype.disableOnObject=function(t){this.disable(t.__class__)},e.prototype.dump=function(t){void 0===t&&(t=null);for(var e in this._groups){var n=this._groups[e];console.log(e+"["+n.items.length+"]: "+(n.enable?" enable":" disable")),console.log(n.items.map(function(t){return t.eventName}).join(","))}},e}();t.EventManager=e,__reflect(e.prototype,"alien.EventManager");var n=function(){function t(){}return t}();t.RegisterItem=n,__reflect(n.prototype,"alien.RegisterItem")}(alien||(alien={}));var _phoneLen=11,_codeLen=4,_exCodeLen=20,_phonePrompt=""+_phoneLen+"",_codePrompt=""+_codeLen+"",_exCodePrompt="",alien;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isMiniApp=!1,t._dicCall={},t._channelId=null,t._urlParams={},egret.ExternalInterface.addCallback("nativeCall",t.nativeCall.bind(t)),t._initDefaultWX(),t._initData(),t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return void 0==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype._initData=function(){if(this._isAli=!1,this._isWXMP=!1,this.isMiniApp=!1,this._channel="self",this._urlParams=t.Utils.getUrlParams(),this.isAndroidWebView()){var e=this._urlParams.showLog;e&&1==e?this.callAndroidFunc("enableLog",!0):this.callAndroidFunc("enableLog",!1)}},n.prototype.callAndroidFunc=function(t,e){var n=window.javaBridge[t].bind(window.javaBridge);null!=e?(console.log("callAndroidFunc----1",t,e),n(e)):(console.log("callAndroidFunc----2",t,e),n())},n.prototype.getUrlArg=function(){return this._urlParams},n.prototype.setInMiniApp=function(t){this.isMiniApp=t||!1},n.prototype.isInMiniApp=function(){return this.isMiniApp},n.prototype._initDefaultWX=function(){this._wxApi={initBridge:function(t){},config:function(t){},share:function(t,e){},recharge:function(t,e){},getLocation:function(t){}}},n.prototype.initWXFunc=function(){this.isNative||(window.top&&window.top.wxApi?this._wxApi=window.top.wxApi:webService.postError(ErrorConfig.REPORT_ERROR,"Native _initWXFunc=>"+version+"|uuid"+webService.uuid+"wxApi error"))},n.call=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),this.instance.call(t,e,n)},Object.defineProperty(n.prototype,"platform",{get:function(){var t;return t=this.isNative?egret.Capabilities.os:"web"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"platformId",{get:function(){return t.Native.instance.isNative?"iOS"==egret.Capabilities.os?2:3:4},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE||this.isMiniApp},enumerable:!0,configurable:!0}),n.prototype.setChannelName=function(t){console.log("setChannelName===>",t),this._channel=t,this._isWXMP=!1,this._isAli=!1,this._isWxQr=!1,this._isAliQr=!1,"wxmp"==t?this._isWXMP=!0:"ali"==t?this._isAli=!0:"wxqr"==t?this._isWxQr=!0:"aliqr"==t&&(this._isAliQr=!0)},n.prototype.getChannelName=function(){return this._channel},n.prototype.isAli=function(){return this._isAli},n.prototype.isWxQr=function(){return this._isWxQr},n.prototype.isAliQr=function(){return this._isAliQr},Object.defineProperty(n.prototype,"isWXMP",{get:function(){return this._isWXMP},enumerable:!0,configurable:!0}),n.prototype.nativeCall=function(t){console.log("nativeCall:",t);var e=JSON.parse(t),n=e.id,i=e.method;i&&i.length>1&&this.dispatchEventWith(i,!1,e);var o=this._dicCall[n];o&&(delete this._dicCall[n],o(e.args))},n.prototype.call=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),n=n||{};var o={id:t.StringUtils.makeRandomIntString(10),method:e,args:n};i&&(this._dicCall[o.id]=i),egret.ExternalInterface.call("egretCall",JSON.stringify(o))},n.prototype.getDeviceUUID=function(e,n,i){void 0===i&&(i=!1);var o=t.localStorage.getItem("uuid",n);(i||!o)&&(o=t.StringUtils.makeRandomString(32),t.localStorage.setItem("uuid",o,n)),e({uuid:o})},n.prototype.closeStartImg=function(){this.call("closeStartImg")},n.prototype.openUrlByWebview=function(e){this.call("openUrlByWebView",{url:e,left:10,top:10,maxWidth:t.StageProxy.width-20,maxHeight:t.StageProxy.height-20},null)},n.prototype.openUrlBySys=function(t){this.call("openUrlBySys",{url:t},null)},n.prototype.fileExist=function(t,e){var n=this;n.call("fileExist",null,function(t){var e=JSON.parse(t);return e.exist||!1})},n.prototype.checkMd5=function(t,e){var n=this;n.call("getMd5",{path:t},function(t){var n=JSON.parse(t);e(n.md5)})},n.prototype.clearAndroidDown=function(t,e){var n=this;"Android"==n.platform&&(n.setAndroidLocalVercode(0),n.setAndroidDownState(0),n.call("deleteFile",{path:t+"|"+e}))},n.prototype.getAndroidLocalVercode=function(){return Number(t.localStorage.getItem("apkDownVerCode"))},n.prototype.setAndroidLocalVercode=function(e){t.localStorage.setItem("apkDownVerCode",""+e)},n.prototype.getAndroidDownState=function(){return Number(t.localStorage.getItem("apkDownState"))},n.prototype.setAndroidDownState=function(e){t.localStorage.setItem("apkDownState",""+e)},n.prototype.getAndroidExtPath=function(t){var e=this;e.call("getExternalDir",null,function(e){var n=JSON.parse(e);t(n.path)})},n.prototype.downApk=function(t,e,n,i,o,a,r){var s=this,h=n,c=i,l=function(t){var e=JSON.parse(t);a(e)},u=function(t){s.setAndroidDownState(2),r(JSON.parse(t))};egret.ExternalInterface.addCallback("downProgressFunc",l.bind(s)),egret.ExternalInterface.addCallback("downFinishFunc",u.bind(s)),s.call("downLoadApk",{url:e,tmp:h,name:c,cleanTmp:o,progress:"downProgressFunc",finish:"downFinishFunc"},function(){s.setAndroidDownState(1),s.setAndroidLocalVercode(t)})},n.prototype.installApk=function(t){var e=this;e.call("installApk",{path:t,closeSelf:!0})},n.prototype.getAppChannelId=function(t){var e=this;return null!=e._channelId?void t(e._channelId):void this.call("getChannelId",null,function(n){if(n){var i=JSON.parse(n);console.log("getAppChannelId=>",i.channelId),e._channelId=i.channelId,t(i.channelId)}})},n.prototype.getAppVerCode=function(t){this.call("getVerCode",null,function(e){if(e){var n=JSON.parse(e);console.log("getAppVerCode=>",n.versionCode),t(n.versionCode)}})},n.prototype.closeApp=function(){return this.isAndroidWebView()?void this.callAndroidFunc("closeApp",null):void this.call("closeApp")},n.prototype.vibrate=function(){this.isNative&&this.call("vibrate",{seconds:.6})},n.prototype.toClipboard=function(t){this.isNative?this.call("toClipboard",{text:t}):console.log("toClipboard not endable!")},n.prototype.share=function(t,e){void 0===e&&(e=null),this.isNative?(t.shareImagePath=t.shareImagePath||"",t.shareThumbPath=t.shareThumbPath||"",this.call("shareByWechat",t,e)):this._wxApi.share(t,e)},n.prototype.alert=function(t,e,n,i){void 0===i&&(i=null),this.isNative?this.call("alert",{title:t,message:e,buttons:n},i):(alert(e),i({index:0}))},n.prototype.isAndroidWebView=function(){var t=window.javaBridge||!1;return console.log("isAndroidWebView====>",t),t?!0:!1},n.prototype.rechargeWXH5=function(t,e){void 0===e&&(e=null);var n=this.isAndroidWebView(),i=egret.Capabilities.os;if(console.log("rechargeWXH5====>",i,n,t.url),"Android"==i&&n){var o=t.url+"&Referer="+t.Referer;window.open(o)}else{var a=window.top.payWXH5;a?a.call(window.top,t.url):window.top.location.href=t.url}},n.prototype.rechageWXApp=function(t,e){void 0===e&&(e=null),this.call("payByWechat",t,function(t){JSON.parse(t);console.log("rechageWXApp=============>",t.code),0==t.code&&(server.userInfoRequest(server.uid),BagService.instance.refreshBagInfo(!0))})},n.prototype.rechargeInWXMP=function(t,e){void 0===e&&(e=null),this._wxApi.recharge(t,function(t){console.log("rechargeInWXMP=============>",t.code)})},n.prototype.rechargeAliH5=function(t,e){void 0===e&&(e=null);var n=t.alipay;if(n){var i=Base64.decode(n),o=window.top.payAliH5;if(o)o.call(window.top,i);else{var a=window.top.document.getElementById("payDiv");
a||(a=window.top.document.createElement("a"),a.id="payDiv",window.top.document.body.appendChild(a)),a.innerHTML=i,window.top.document.forms.alipaysubmit.submit()}}},n.prototype.rechargeAliApp=function(t,e){void 0===e&&(e=null)},n.prototype.wxConfig=function(){var t=this;webService.getWxConfig(function(e){t._wxApi.config(e)})},n.prototype.loadJs=function(t,e){if(!this.isNative){var n=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,i.async=!1,n.appendChild(i),i.addEventListener("load",function(){i.parentNode.removeChild(i),i.removeEventListener("load",null,!1),e()},!1)}},n.prototype.getWXLocation=function(e){t.Native.instance.isNative||this._wxApi.getLocation(e)},n.prototype.setKeepScreenOn=function(t){var e=this;e.call("setKeepScreenOn",{keepOn:t})},n.prototype.checkAppUpdate=function(e){var n=egret.Capabilities.os,i=this,o=t.Native.instance,a=0,r=3,s="",h="",c="",l=!1;"Android"==n&&(l=!0,o.getAndroidExtPath(function(t){var e="tmp.apk",n="hsqddz.apk";c=t+"/.hsq/",s=c+e,h=c+n})),webService.checkAppUpdate(function(t,n){if(t){if(!l)return void("20000"==i._channelId&&o.openUrlBySys(n.url));var c=function(t){console.log("download progress======>",t.recv,t.recvTot,t.tot);var e=Math.floor(t.recvTot/t.tot*100);SceneLoading.setLoadingText(""+e+"/100")},u=function(t){SceneLoading.setLoadingText(","),o.checkMd5(h,function(t){console.log("downFinish======>",t,n.md5),a>=r&&Alert.show(",",0,function(t){"confirm"==t?(a=0,o.downApk(n.version,n.url,s,h,n.cleanTmp,c,u)):o.closeApp()}),n.md5!=t?(a+=1,o.downApk(n.version,n.url,s,h,n.cleanTmp,c,u)):o.installApk(h)})};n.shouldInstall?u(null):o.downApk(n.version,n.url,s,h,n.cleanTmp,c,u)}else l&&o.clearAndroidDown(s,h),e()})},n}(egret.EventDispatcher);t.Native=e,__reflect(e.prototype,"alien.Native")}(alien||(alien={})),window.onAndroidKeyBack=function(){alien.Native.instance.dispatchEventWith("back",!1,null)},window.onAndroidPause=function(){console.log("onAndroidPause===============>");var t=alien.SoundManager.instance;t.stopMusic(),t.stopEffect()},window.onAndroidResume=function(){console.log("onAndroidResume===============>"),alien.SoundManager.instance.playMusic(ResNames.bgm)};var alien;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.loadMusic=function(){this.musicLoader=new egret.URLLoader,this.musicLoader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.musicLoader.load(new egret.URLRequest("resource/sounds/bgm.mp3")),this.musicLoader.addEventListener(egret.Event.COMPLETE,this.onMusicLoadComplete,this),this.musicLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onMusicLoadError,this)},e.prototype.onMusicLoadComplete=function(){this.isMusicLoaded=!0,this.musicLoader.removeEventListener(egret.Event.COMPLETE,this.onMusicLoadComplete,this),this.musicLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onMusicLoadError,this),this.playMusic(),t.StageProxy.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTap,this)},e.prototype.onStageTap=function(){t.SoundManager.instance.playMusic(ResNames.bgm,!1,!0),t.StageProxy.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTap,this)},e.prototype.onMusicLoadError=function(){webService.postError(ErrorConfig.BMG_LOAD_ERROR,""),t.StageProxy.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTap,this)},e.prototype.playMusic=function(e,n,i){if(void 0===e&&(e=null),void 0===n&&(n=!1),void 0===i&&(i=!1),t.Native.instance.isNative)return void this.playMusicNative(e,n,i);if(!this.isMusicLoaded)return void this.loadMusic();if((this.musicRes!=e||i)&&(n||(this.musicRes=e),this.musicPlaying=!0,!this.musicMute)){this.musicChannel&&this.musicChannel.stop();var o=this.musicLoader.data;o&&(this.musicChannel=o.play(),this.musicChannel.volume=1)}},e.prototype.playMusicNative=function(t,e,n){var i=this;void 0===t&&(t=null),void 0===e&&(e=!1),void 0===n&&(n=!1),console.log("sound res:"+t),this.musicRes!=t&&(e||(this.musicRes=t),this.musicPlaying=!0,this.musicMute||(this.musicChannel&&this.musicChannel.stop(),console.log("sound res:"+t),console.log("sound musicRes:"+this.musicRes),RES.getResAsync(this.musicRes,function(t){t?(i.musicChannel=t.play(),i.musicChannel.volume=1):console.log(">>>>>>>>>>"+i.musicRes+" can't loaded")},this)))},e.prototype.stopMusic=function(t){void 0===t&&(t=!1),t||(this.musicPlaying=!1,this.musicRes=null),this.musicChannel&&(this.musicChannel.stop(),this.musicChannel=null)},e.prototype.switchMusic=function(){this.musicMute=!this.musicMute,OtherGameManager.instance.onMusicEnableChange(),this.musicRes&&(this.musicMute?this.stopMusic(!0):this.musicPlaying&&this.playMusic(null,!0))},Object.defineProperty(e.prototype,"musicMute",{get:function(){var e=t.localStorage.getItem("musicMute");return e?"1"==e:!1},set:function(e){t.localStorage.setItem("musicMute",e?"1":"0")},enumerable:!0,configurable:!0}),e.prototype.playEffect=function(t,e,n){var i=this;void 0===t&&(t=null),void 0===e&&(e=1),void 0===n&&(n=!1),t&&(this.effectRes=t),this.effectMute||RES.getResAsync(this.effectRes,function(n){n?(n.type=egret.Sound.EFFECT,i.effectChannel=n.play(0,e)):console.log(">>>>>>>>>>"+t+" can't loaded")},this)},e.prototype.stopEffect=function(){this.effectChannel&&this.effectChannel.stop()},e.prototype.onSoundComplete=function(t){if(this.musicChannel){egret.Tween.get(this.musicChannel,null,null,!0).to({volume:1},500);var e=t.target;e.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)}},e.prototype.switchEffect=function(){this.effectMute=!this.effectMute,OtherGameManager.instance.onEffectEnableChange()},Object.defineProperty(e.prototype,"effectMute",{get:function(){var e=t.localStorage.getItem("effectMute");return e?"1"==e:!1},set:function(e){t.localStorage.setItem("effectMute",e?"1":"0")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allMute",{get:function(){return this.musicMute},enumerable:!0,configurable:!0}),e.prototype.switchAll=function(){this.switchEffect(),this.switchMusic()},e.prototype.vibrate=function(){this.vibrateMute||t.Native.instance.vibrate()},Object.defineProperty(e.prototype,"vibrateMute",{get:function(){var e=t.localStorage.getItem("vibrateMute");return e?"1"==e:!1},set:function(e){t.localStorage.setItem("vibrateMute",e?"1":"0")},enumerable:!0,configurable:!0}),e.prototype.switchVibrate=function(){this.vibrateMute=!this.vibrateMute,OtherGameManager.instance.onVibrateEnableChange()},e}();t.SoundManager=e,__reflect(e.prototype,"alien.SoundManager")}(alien||(alien={}));var alien;!function(t){var e="ddz",n=function(){function t(){}return t.encryptStr=function(t){for(var n,i,o,a=0,r=t.length,s="",h=0;r>h;++h)a>=e.length&&(a=0),n=t.charCodeAt(h),i=e.charCodeAt(a),o=n^i,s+=String.fromCharCode(o),a++;return s},t.decryptStr=function(t){var e=this.encryptStr(t);return e},t}();t.Encrypt=n,__reflect(n.prototype,"alien.Encrypt")}(alien||(alien={}));var PageChannelBase=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.dataProvider=this._dataProvide=new eui.ArrayCollection},e.prototype.addListeners=function(){this.list.addEventListener(egret.Event.CHANGE,this.selectRoom,this)},e.prototype.removeListeners=function(){this.list.removeEventListener(egret.Event.CHANGE,this.selectRoom,this)},e.prototype.getRoomById=function(t){var e=null;return this._roomList.some(function(n){return n.roomID==t?(e=n,!0):void 0}),e},e.prototype.selectRoom=function(t){var e=this;this.selectedRoom=this.list.selectedItem,egret.callLater(function(){e.list.selectedIndex=-1},this)},e.prototype.setRoomType=function(t){var e=GameConfig.roomList.filter(function(e){return e.roomType==t});e.sort(function(t,e){return t.roomID-e.roomID}),this._roomList=e,this.dealRoomList(),this._dataProvide.source=this._roomList},e.prototype.dealRoomList=function(){},e.prototype.beforeShow=function(t){this.selectedRoom={},this.addListeners()},e.prototype.beforeHide=function(t,e){void 0===e&&(e=null),this.removeListeners()},e}(alien.NavigationPage);__reflect(PageChannelBase.prototype,"PageChannelBase");var ProtoBuf=dcodeIO.ProtoBuf,ByteArray=egret.ByteArray,Endian=egret.Endian,Server=function(t){function e(){var e=t.call(this)||this;e._sid=0,e.frozen=!1,e._clientId=1,e._session=0,e.showLogs=!1,e.logList=[/.*?/],e._callId=1e3,e._callbackMap=[],e.cacheList=[],e._heartCount=0,e._lastHeart=0;var n=alien.Native.instance;if(n.isNative)e._showLogToScreen=!1,e._noConsole();else{var i=n.getUrlArg();e._showLogToScreen="1"==i.showLog,e.showLogs=e._showLogToScreen||!1,e.showLogs||e._noConsole()}return e}return __extends(e,t),e.prototype._noConsole=function(){console.log=function(){},console.warn=function(){},console.error=function(){}},e.prototype.ready=function(){this._protoBuilderMap={user:ProtoBuf.loadProto(RES.getRes("user_proto")),game:ProtoBuf.loadProto(RES.getRes("game_proto"))},this._otherIns=OtherGameManager.instance,this._protoIDs=ProtoIDs.getMap(),this._heartTimer=new egret.Timer(2e3),this._heartTimer.addEventListener(egret.TimerEvent.TIMER,this.onHeartTimer,this),alien.Native.instance.addEventListener("HEART_BEAT",this.onHeartBeat,this)},e.prototype.prepareSocket=function(){var t=this._socket;return this._socket&&this.close(!1),t=this._socket=new egret.WebSocket,t.type=egret.WebSocket.TYPE_BINARY,t},e.prototype.onHeartBeat=function(t){this.showLogs&&console.log("on HEART_BEAT"),this.sendHeartPackage()},e.prototype._removeAllSocketListener=function(){this._socket&&(this._socket.removeEventListener(egret.Event.CONNECT,this.onConnect,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this))},Object.defineProperty(e.prototype,"connected",{get:function(){return this._socket&&this._socket.connected},enumerable:!0,configurable:!0}),e.prototype.tryConnect=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),GameConfig.getServerUrl(t,function(t){0==t.code?egret.setTimeout(i.connect,i,200):Toast.show(lang.loginError[501]),e&&e(t.code)},n)},e.prototype.connect=function(){this.prepareSocket(),this._socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._socket.connectByUrl(GameConfig.SERVER_URL)},e.prototype.close=function(t){void 0===t&&(t=!0),this.connected&&(this._removeAllSocketListener(),this._socket.readBytes(new ByteArray),this._socket.close(),this._socket=null,this._heartTimeout&&(egret.clearTimeout(this._heartTimeout),this._heartTimeout=null),t&&this.afterClose())},e.prototype.onConnect=function(t){var e=t.target;this.showLogs&&console.log("Server onConnect=============>"),this._connected=!0,e.removeEventListener(egret.Event.CONNECT,this.onConnect,this),e.addEventListener(egret.Event.CLOSE,this.onClose,this),e.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this._kickOut=!1,this.dispatchEventWith(EventNames.CONNECT_SERVER)},e.prototype.onError=function(t){t.target;this.showLogs&&console.log("Server onError=============>"),this.dispatchEventWith(EventNames.SERVER_ERROR)},e.prototype.onClose=function(t){var e=t.target;this.showLogs&&console.log("Server onClose=============>"),e.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.afterClose(),alien.Dispatcher.dispatch(EventNames.SERVER_CLOSE)},e.prototype.afterClose=function(){this._connected&&(this._connected=!1,this._heartTimer.stop(),this._kickOut||alien.SceneManager.instance.currentSceneName==SceneNames.LOGIN||alien.Dispatcher.dispatch(EventNames.SHOW_DISCONNECT,{content:lang.disconnect_server}),alien.SceneManager.instance.currentSceneName!=SceneNames.LOGIN&&alien.PopUpManager.instance.removeAllPupUp())},e.prototype.send=function(t,e,n){void 0===n&&(n=null);var i=t.substring(0,t.indexOf(".")),o=this._protoBuilderMap[i].build(t),a=new o(e);this.showLogs&&console.log("send:"+a+" "+JSON.stringify(a));var r=new egret.ByteArray(a.encodeAB());this._showLogToScreen&&alien.Dispatcher.dispatch(EventNames.LOG,"send: "+t+" "+JSON.stringify(e)),this.sendDataByProtoId(this._protoIDs[t],r)},e.prototype.sendDataByProtoId=function(t,e){if(e){this.showLogs&&console.log("sendData:"+t);var n=new egret.ByteArray;n.writeUnsignedShort(e.length+2),n.writeUnsignedShort(t),n.writeBytes(e),this._socket.writeBytes(n),this._socket.flush()}},e.prototype.addCallback=function(t){var e=this._callId++;if(t){var n=this.tsServer;this._callbackMap[e]={id:e,cb:t,time:n},console.log("addCallback:",e,n)}return e},e.prototype.onSocketData=function(t){var e=(t.target,new egret.ByteArray);if(this._socket.readBytes(e),!(e.length<4)){var n=e.readUnsignedShort(),i=e.readUnsignedShort();switch(10>i&&2!=i&&(this.showLogs&&console.log("get:["+n+"] "+i),this._showLogToScreen&&alien.Dispatcher.dispatch(EventNames.LOG,"get: "+i)),i){case 0:this.onHeartTimer(),this._heartTimer.start(),this.dispatchEventWith(EventNames.USER_LOGIN_RESPONSE,!1,{code:0});break;case 1:var o=parseInt(e.readUTFBytes(e.bytesAvailable));this.showLogs&&console.log("login failed. errorId:",o),this.dispatchEventWith(EventNames.USER_LOGIN_RESPONSE,!1,{code:1,errorId:o});break;case 2:this._heartTimeout&&(egret.clearTimeout(this._heartTimeout),this._heartTimeout=null),this._lastHeart=this.tsLocal;var a=e.position,r=e.readInt();e.position=a,this.tsServerOffset=this.tsLocal-r,this._otherIns.onSocketData(i,n,e);break;default:var s=this._protoIDs[i];if(!s){console.log("ID"+i+"!");new egret.ByteArray(e.buffer);return void this._otherIns.onSocketData(i,n,e)}var h=s.indexOf("."),c=s.substring(0,h),l=s.substring(h+1),u=new egret.ByteArray,p=e.position;e.readBytes(u),e.position=p;var d=null;this._otherIns.isRunOtherGame()&&(d=e);var _=this._protoBuilderMap[c].build(s),g=_.decode(u.buffer);this.showLogs&&console.log("recv:"+g+" "+JSON.stringify(g));var f=!0;if("game"==c&&"SetSession"!=l&&(f=this._session==g.session),this._showLogToScreen&&alien.Dispatcher.dispatch(EventNames.LOG,"get: "+s),!this.frozen&&f)if(this.needCache){if(!(this.exception&&this.exception.indexOf(s)>-1))return void this.cacheList.push([s,g]);this.beforeDispatchMessage(s,g),this.dispatchEventWith(s,!1,g),this._otherIns.isRunOtherGame()&&(this._otherIns.isInOtherProtoListen(i)||this._otherIns.isListenAllProto())&&this._otherIns.onSocketData(i,n,d)}else this.beforeDispatchMessage(s,g),this.dispatchEventWith(s,!1,g),this._otherIns.isRunOtherGame()&&(this._otherIns.isInOtherProtoListen(i)||this._otherIns.isListenAllProto())&&this._otherIns.onSocketData(i,n,d)}}},e.prototype.startCache=function(t,e){void 0===t&&(t=null),void 0===e&&(e=-1),console.log(""),t?this.exception=t.concat():this.exception=[],this.needCache=!0,this.cacheTime=e,this.timer||(this.timer=new egret.Timer(1e3)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.start()},e.prototype.stopCache=function(){for(console.log(""),this.needCache=!1,this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this));this.cacheList.length>0;){var t=this.cacheList.shift();if(this.beforeDispatchMessage(t[0],t[1]),this.dispatchEventWith(t[0],!1,t[1]),this.needCache)break}},e.prototype.onTimer=function(t){if(-1!=this.cacheTime)for(var e=0;e<this.cacheList.length;e++)"object"==typeof this.cacheList[e][1]&&(this.cacheList[e][1].hasOwnProperty("time")?(this.cacheList[e][1].time-=this.cacheTime,this.cacheList[e][1].time<0&&(this.cacheList[e][1].time=0)):this.cacheList[e][1].hasOwnProperty("timeout")&&(this.cacheList[e][1].timeout-=this.cacheTime,this.cacheList[e][1].timeout<0&&(this.cacheList[e][1].timeout=0)))},e.prototype.checkCallback=function(t,e){if(t>0){var n=this._callbackMap[t];console.log("checkCallback:",t,!!n),n&&(this._callbackMap.splice(t,1),n.cb(e))}},e.prototype.inShowList=function(t){var e=!1;return this.logList.forEach(function(n){"string"==typeof n?n==t&&(e=!0):t.match(n)&&(e=!0)}),e},e.prototype.beforeDispatchMessage=function(t,e){switch(t){case EventNames.GAME_SET_SESSION:this._session=e.session;break;case EventNames.USER_CHECK_RECONNECT_REP:e.roomid>0&&(this._session=e.session,this.roomInfo=GameConfig.getRoomConfig(e.roomid));break;case EventNames.GAME_USER_ONLINE:this._uid==e.uid&&(this.seatid=e.seatid);break;case EventNames.USER_NOTIFY_KICK_OUT:if(this._kickOut=!0,alien.SceneManager.instance.currentSceneName!=SceneNames.LOGIN){var n={content:lang.disconnect_kick_out[e.reason]};4==e.reason||1==e.reason?(n.button=lang.confirm,4==e.reason?alien.Dispatcher.dispatch(EventNames.ACCOUNT_ERROR,n):alien.Dispatcher.dispatch(EventNames.SHOW_DISCONNECT,n)):5==e.reason?alien.Dispatcher.dispatch(EventNames.SERVER_HASUPDATE):alien.Dispatcher.dispatch(EventNames.SHOW_DISCONNECT,n)}break;case EventNames.GAME_GAME_END:break;case EventNames.USER_OPERATE_REP:ShareImageManager.instance.onUserOperateRep(e)}},e.prototype.onServerTimer=function(t){void 0===t&&(t=null),this.checkDate()},e.prototype.checkDate=function(t){void 0===t&&(t=!0);var e=alien.TimeUtils.tsToDate(this.tsServer),n=e.getDate();this._today!=n&&(this._today=n,t&&alien.Dispatcher.dispatch(EventNames.CLOCK_0))},Object.defineProperty(e.prototype,"tsLocal",{get:function(){return Math.floor((new Date).valueOf()/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tsServer",{get:function(){return this.tsLocal-this.tsServerOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverDate",{get:function(){return alien.TimeUtils.tsToDate(this.tsServer)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tsToday",{get:function(){var t=this.serverDate;return new Date(t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()).valueOf()/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tsNow",{get:function(){return this.tsServer-this.tsToday},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),e.prototype.onHeartTimer=function(t){void 0===t&&(t=null),this.sendHeartPackage()},e.prototype.sendHeartPackage=function(){if(this.connected){var t=new egret.ByteArray;t.writeShort(2),t.writeShort(2),this._socket.writeBytes(t),this._socket.flush(),this._heartCount++,this._heartTimeout||(this._heartTimeout=egret.setTimeout(this.onHeartTimerEnd,this,5e3))}},e.prototype.onHeartTimerEnd=function(){this.showLogs&&console.log(",."),this.close(),MainLogic.instance.stop()},e.prototype.checkEnterForegroundTimeOut=function(){return this._lastHeart>0&&this.tsLocal-this._lastHeart>5?(this.onHeartTimerEnd(),!0):!1},e.prototype.login=function(t,e){this._token=e;var n=1,i=egret.Capabilities.os;_nativeBridge.isNative?"Android"==i?n=2:"iOS"==i&&(n=3):"iOS"!=i||_nativeBridge.isAli()||_nativeBridge.isWXMP||(n=3),this._uid=parseInt(t);var o=[this._uid,1,e,webService.uuid,Environment.channel_id,n].join(":"),a=new egret.ByteArray;a.writeUnsignedShort(0),a.writeUTFBytes(o),this._socket.writeBytes(a),this._socket.flush(),this.showLogs&&console.log("Server login===============>",o)},e.prototype.checkReconnect=function(){this.send(EventNames.USER_CHECK_RECONNECT_REQ,{})},e.prototype.reconnect=function(t){this.showLogs&&console.log("Server: reconnect===============>",t),this.send(EventNames.USER_RECONNECT_TABLE_REQ,{result:t,index:0,session:this._session})},e.prototype.resetSession=function(){this._session=0},e.prototype.getRoomId=function(){return this.roomInfo&&this.roomInfo.roomID?this.roomInfo.roomID:null},e.prototype.getTableId=function(){return this.roomInfo&&this.roomInfo.tableId?this.roomInfo.tableId:null},e}(egret.EventDispatcher);__reflect(Server.prototype,"Server");var Service=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.initData=function(){},e.prototype.start=function(t){t()},e.prototype.stop=function(){},e}(egret.EventDispatcher);__reflect(Service.prototype,"Service");var alien;!function(t){var e=function(e){function n(n,i,o,a,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=!1);var s=e.call(this)||this;return s._excludeActionsClose=[],s.showEffect=n||t.popupEffect.None,s.showEffectParams=i,s.closeEffect=o||t.popupEffect.None,s.closeEffectParams=a,s.popupShowBanner=r,s._excludeActionsClose=[],s.init(),s}return __extends(n,e),n.prototype.init=function(){},n.prototype.addExcludeForClose=function(t){this._excludeActionsClose=this._excludeActionsClose.concat(t)},n.prototype.dealAction=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._callback&&this._callback(t||"close",e),this._excludeActionsClose.indexOf(t)<0&&this.close()},n.prototype.popup=function(e,n,i){void 0===e&&(e=null),void 0===n&&(n=!0),void 0===i&&(i=null),t.PopUpManager.addPopUp(this,this.showEffect,this.showEffectParams,e,n,i)},n.prototype.close=function(){t.PopUpManager.removePopUp(this,this.closeEffect,this.closeEffectParams)},n}(eui.Component);t.PanelBase=e,__reflect(e.prototype,"alien.PanelBase")}(alien||(alien={}));var SideSeat=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.addCards=function(e,n){if(void 0===n&&(n=!0),t.prototype.addCards.call(this,e),0==e.length){e=[],this.setCardCount(0);for(var i=0;17>i;i++)e.push(0)}this.handCardGroup.addCards(e,n)},e.prototype.reset=function(e){return this.cardCount=0,t.prototype.reset.call(this,e)},e.prototype.onCardAdded=function(e){t.prototype.onCardAdded.call(this,e),this.cardCount++,this.updateCardCount(this.cardCount),e.parent==this.handCardGroup&&this.handCardGroup.removeChild(e)},e.prototype.setCardCount=function(t){this.cardCount=t,this.ddzHandCardGroup.cardCount=t,this.updateCardCount(t)},e.prototype.updateCardCount=function(e){t.prototype.updateCardCount.call(this,e),this.labCardCount.text=e.toString()},e}(DDZSeat);__reflect(SideSeat.prototype,"SideSeat");var DataStorage=function(){function t(){this.name="save"}return t.prototype.loadData=function(){this.save=alien.localStorage.getItemObj(this.name,{},this.prefix)},t.prototype.clearData=function(t){if(void 0===t&&(t=null),t)for(var e in this.save)t.indexOf(e)<0&&delete this.save[e];else this.save={};this.saveData()},t.prototype.saveData=function(){alien.localStorage.setItemObj(this.name,this.save,this.prefix)},t.prototype.getItem=function(t,e){void 0===e&&(e=null);var n=this.save[t];return null===n&&(n=e),n},t.prototype.setItem=function(t,e,n){void 0===n&&(n=!1);var i=this.save[t];return this.save[t]=e,n&&this.saveData(),i},t.prototype.changeItem=function(t,e,n){void 0===n&&(n=!1);var i=this.save[t];return this.save[t]=i+e,n&&this.saveData(),i},t}();__reflect(DataStorage.prototype,"DataStorage");var LanguagePack=function(){function t(){}return t}();__reflect(LanguagePack.prototype,"LanguagePack");var LanguageIds=function(){function t(){this.loading="loading",this.config_url="config_url",this.config_url_1="config_url_1",this.first_alert_title="first_alert_title",this.first_alert_buttons="first_alert_buttons",this.service_provision_url="service_provision_url",this.service_provision="service_provision",this.health_game_advise="health_game_advise",this.loginError="loginError",this.login_waiting="login_waiting",this.disconnect_kick_out="disconnect_kick_out",this.disconnect_server="disconnect_server",this.auto_reconnect="auto_reconnect",this.waiting_for_getting_information="waiting_for_getting_information",this.backAlert="backAlert",this.roomLimit1="roomLimit1",this.roomLimit2="roomLimit2",this.roomAmount="roomAmount",this.quick_join_error="quick_join_error",this.upload_avatar="upload_avatar",this.no_more_desk="no_more_desk",this.noMoreGold="noMoreGold",this.noMoreGold2="noMoreGold2",this.noMoreGold3="noMoreGold3",this.browNoGold="browNoGold",this.reportSucc="reportSucc",this.repeatReport="repeatReport",this.gameResult="gameResult",this.sex="sex",this.sexVoice="sexVoice",this.people="people",this.second="second",this.gold="gold",this.score="score",this.year="year",this.month="month",this.day="day",this.sky="sky",this.format_y_m_d="format_y_m_d",this.format_m_d="format_m_d",this.currency="currency",this.play_turn="play_turn",this.no_ranking="no_ranking",this.confirm="confirm",this.reconnect="reconnect",this.history="history",this.chatList="chatList",this.free_pay="free_pay",this.match_sign_up_result="match_sign_up_result",this.match_jikai_limit="match_jikai_limit",this.match_jikai_reward="match_jikai_reward",this.match_title_reward_intro="match_title_reward_intro",this.match_title_match_intro="match_title_match_intro",this.match_play_info="match_play_info",this.match_result_match_name="match_result_match_name",this.match_waiting_other_desk_1="match_waiting_other_desk_1",this.match_waiting_other_desk_2="match_waiting_other_desk_2",this.match_get_in="match_get_in",this.match_result_praise="match_result_praise",this.match_cancel_alert="match_cancel_alert",this.match_turn_name="match_turn_name",this.match_top_info_1="match_top_info_1",this.match_top_info_2="match_top_info_2",this.match_top_info_3="match_top_info_3",this.match_top_notify="match_top_notify",this.match_notice_alert="match_notice_alert",this.modify_profile_success="modify_profile_success",this.modify_profile_failed="modify_profile_failed",this.modify_profile_err="modify_profile_err",this.set_password_error="set_password_error",this.bank_operate="bank_operate",this.bank_operate_error="bank_operate_error",this.bind_phone_notice="bind_phone_notice",this.download_client_notice="download_client_notice",this.alms_success="alms_success",this.alms_success_continue="alms_success_continue",this.alms_success_exit="alms_success_exit",this.version_content="version_content",this.version_content_notice="version_content_notice",this.recharge_scale="recharge_scale",this.recharge_addition="recharge_addition",this.recharge_waiting="recharge_waiting",this.recharge_failed="recharge_failed",this.recharge_cancel="recharge_cancel",this.recharge_success_simple="recharge_success_simple",this.recharge_success="recharge_success",this.get_code_error="get_code_error",this.bind_phone_error="bind_phone_error",this.bind_third_part="bind_third_part",this.exchange_redcoin="exchange_redcoin",this.exchange_roomid="exchange_roomid",this.kickback_str="kickback_str",this.dayTaskOne="dayTaskOne",this.dayTaskTwo="dayTaskTwo",this.recordCardHour="recordCardHour",this.recordCardDay="recordCardDay",this.redCoin="redCoin",this.taskNotExist="taskNotExist",this.taskNotOver="taskNotOver",this.taskHasGetRew="taskHasGetRew"}return t}();__reflect(LanguageIds.prototype,"LanguageIds");var DragonBase=function(t){function e(e){var n=t.call(this)||this;n.addEventListener(egret.Event.ADDED_TO_STAGE,n.addToStage,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.removeFromStage,n);var i=RES.getRes(e),o=RES.getRes(e+"_texture_json"),a=RES.getRes(e+"_texture_png");return DragonManager.getInstance().addDragon(i,a,o),n}return __extends(e,t),e.prototype.addToStage=function(t){alien.StageProxy.stage.addEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.removeFromStage=function(t){alien.StageProxy.stage.removeEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.onResize=function(t){},e.prototype.addArmature=function(t){var e=DragonManager.getInstance().getDragon(t);return this.addChild(e.display),dragonBones.WorldClock.clock.add(e),e},e}(egret.Sprite);__reflect(DragonBase.prototype,"DragonBase");var GoldRainEffectLayer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.play=function(){var t=this;if(!this._goldItems){this._goldItems=[];for(var e=new egret.MovieClipDataFactory(RES.getRes(ResNames.ani_coin_json),RES.getRes(ResNames.ani_coin_png)),n=0;35>n;n++){var i=new GoldItem(e);this._goldItems.push(i)}}this._goldItems.forEach(function(e){t.addChild(e),e.playFall()}),alien.SoundManager.instance.playEffect(ResNames.effect_gold_rain)},e}(eui.Group);__reflect(GoldRainEffectLayer.prototype,"GoldRainEffectLayer");var GoldItem=function(t){function e(e){var n=t.call(this)||this;return n._mc=new egret.MovieClip(e.generateMovieClipData("coin")),n.addChild(n._mc),n._mc.scaleX=n._mc.scaleY=.8,n}return __extends(e,t),e.prototype.playFall=function(){var t=this;this.x=Math.random()*this.stage.stageWidth,this.y=-70,this.alpha=1,this._mc.play(-1),egret.Tween.get(this,null,null,!0).wait(1e3*Math.random()).to({y:this.stage.stageHeight-53},1500,egret.Ease.bounceOut).to({alpha:0},200).call(function(){t.parent.removeChild(t)})},e}(egret.DisplayObjectContainer);__reflect(GoldItem.prototype,"GoldItem");var alien;!function(t){var e=function(){function t(){}return t.init=function(t,e){this.stage=t,this.root=e,t.addEventListener(egret.TouchEvent.TOUCH_END,function(t){this.lastTouchPos.x=t.stageX,this.lastTouchPos.y=t.stageY},this)},Object.defineProperty(t,"width",{get:function(){return this.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"height",{get:function(){return this.stage.stageHeight},enumerable:!0,configurable:!0}),t.lastTouchPos={},t}();t.StageProxy=e,__reflect(e.prototype,"alien.StageProxy")}(alien||(alien={}));var alien;!function(t){var e=function(){function t(t){void 0===t&&(t=1),this._all=[],this.interval=t}return Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interval",{get:function(){return this._interval},set:function(t){this._interval!=t&&(this._interval=t)},enumerable:!0,configurable:!0}),t.prototype.register=function(t){this._all.indexOf(t)<0&&this._all.push(t)},t.prototype.unregister=function(t){var e=this._all.indexOf(t);e>=0&&this._all.splice(e,1)},t.prototype.activate=function(){this._intervalCount=0,egret.startTick(this.onTicker,this)},t.prototype.sleep=function(){egret.stopTick(this.onTicker,this)},t.prototype.onTicker=function(t){this._intervalCount++,this._intervalCount<this._interval||(this._intervalCount=0,this._all.forEach(function(t){t.update()}))},Object.defineProperty(t,"interval",{get:function(){return this.instance.interval},set:function(t){this.instance.interval=t},enumerable:!0,configurable:!0}),t.register=function(t){this.instance.register(t)},t.unregister=function(t){this.instance.unregister(t)},t.activate=function(){this.instance.activate()},t.sleep=function(){this.instance.sleep()},t}();t.TickerManager=e,__reflect(e.prototype,"alien.TickerManager")}(alien||(alien={}));var alien;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.setXY(t,e)}return t.prototype.setXY=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.zero=function(){return this.x=0,this.y=0,this},Object.defineProperty(t.prototype,"isZero",{get:function(){return 0==this.x&&0==this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var t=this.length;return 0==t?(this.x=1,this):(this.x/=t,this.y/=t,this)},Object.defineProperty(t.prototype,"isNormalized",{get:function(){return 1==this.length},enumerable:!0,configurable:!0}),t.prototype.truncate=function(t){return this.length=Math.min(t,this.length),this},t.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this
},t.prototype.dotProd=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProd=function(t){return this.x*t.y-this.y*t.x},t.prototype.distSQ=function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},t.prototype.distance=function(t){return Math.sqrt(this.distSQ(t))},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.divide=function(t){return this.x/=t,this.y/=t,this},Object.defineProperty(t.prototype,"angle",{get:function(){return 180*this.radian/Math.PI},set:function(t){this.radian=t*Math.PI/180},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radian",{get:function(){return Math.atan2(this.y,this.x)},set:function(t){var e=this.length;this.setXY(Math.cos(t)*e,Math.sin(t)*e)},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSQ)},set:function(t){var e=this.radian;this.setXY(Math.cos(e)*t,Math.sin(e)*t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSQ",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"[Vector2D (x:"+this.x+", y:"+this.y+")]"},t}();t.Vector2D=e,__reflect(e.prototype,"alien.Vector2D")}(alien||(alien={}));var alien;!function(t){var e=function(){function e(){}return e.callNet=function(e,n,i,o,a,r,s,h){void 0===n&&(n=null),void 0===i&&(i=egret.HttpMethod.GET),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===h&&(h=null);var c=s?s():e;console.log("callNet===1==>",c);var l=new egret.HttpRequest;l.responseType=egret.HttpResponseType.TEXT,l.addEventListener(egret.Event.COMPLETE,function(t){a&&a(l.response)},this),l.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){r&&r(l.response)},this),l.open(c,i);for(var u in o)l.setRequestHeader(u,o[u]);var p=null;h?p=h():(l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p=t.Utils.obj2query(n),console.log("callNet===2==>",p)),p?l.send(p):l.send()},e.GET=function(e,n,i,o,a){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.callNet(e,n,egret.HttpMethod.GET,a,i,o,function(){if(n){var i=t.Utils.obj2query(n);e+=(e.indexOf("?")<0?"?":"")+i}return e},function(){return null})},e.POST=function(t,e,n,i,o){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),this.callNet(t,e,egret.HttpMethod.POST,o,n,i)},e.POSTDirectory=function(t,e,n,i,o){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),this.callNet(t,e,egret.HttpMethod.POST,o,n,i,null,function(){return e})},e}();t.Ajax=e,__reflect(e.prototype,"alien.Ajax")}(alien||(alien={}));var _base64key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64=function(){function t(){}return t.encode=function(t){if(!t)return"";var e,n,i,o,a,r,s,h="",c=0;for(t=this._utf8_encode(t);c<t.length;)e=t.charCodeAt(c++),n=t.charCodeAt(c++),i=t.charCodeAt(c++),o=e>>2,a=(3&e)<<4|n>>4,r=(15&n)<<2|i>>6,s=63&i,isNaN(n)?r=s=64:isNaN(i)&&(s=64),h=h+_base64key.charAt(o)+_base64key.charAt(a)+_base64key.charAt(r)+_base64key.charAt(s);return h},t.decode=function(t){if(!t)return"";var e,n,i,o,a,r,s,h="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)o=_base64key.indexOf(t.charAt(c++)),a=_base64key.indexOf(t.charAt(c++)),r=_base64key.indexOf(t.charAt(c++)),s=_base64key.indexOf(t.charAt(c++)),e=o<<2|a>>4,n=(15&a)<<4|r>>2,i=(3&r)<<6|s,h+=String.fromCharCode(e),64!=r&&(h+=String.fromCharCode(n)),64!=s&&(h+=String.fromCharCode(i));return h=this._utf8_decode(h)},t._utf8_encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n);128>i?e+=String.fromCharCode(i):i>127&&2048>i?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},t._utf8_decode=function(t){for(var e="",n=0,i=0,o=0,a=0;n<t.length;)i=t.charCodeAt(n),128>i?(e+=String.fromCharCode(i),n++):i>191&&224>i?(o=t.charCodeAt(n+1),e+=String.fromCharCode((31&i)<<6|63&o),n+=2):(o=t.charCodeAt(n+1),a=t.charCodeAt(n+2),e+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a),n+=3);return e},t}();__reflect(Base64.prototype,"Base64");var alien;!function(t){var e;!function(e){var n=function(){function t(){}return t.centerPopUp=function(t){t.horizontalCenter=t.verticalCenter=0},t.centerHorizontal=function(t){t.horizontalCenter=0},t.centerVertical=function(t){t.verticalCenter=0},t.notCenterPopUp=function(t){t.horizontalCenter=t.verticalCenter=0/0},t.getCenterPos=function(t){var e=0,n=0,i=t.parent;return i&&(e=.5*(i.width-t.width),n=.5*(i.height-t.height)),{x:e,y:n}},t.transDirection=function(t){var e;switch(t){case"up":e=0;break;case"right":e=1;break;case"bottom":e=2;break;case"left":e=3}return e},t}();e.Utils=n,__reflect(n.prototype,"alien.popupEffect.Utils");var i=function(){function t(){}return t.prototype.show=function(t,e,i,o,a){e.addChild(t),n.centerPopUp(t)},t.prototype.hide=function(t,e,n,i,o){e.removeChild(t)},t}();e.None=i,__reflect(i.prototype,"alien.popupEffect.None",["alien.popupEffect.IDialogEffect"]);var o=function(){function t(){}return t.prototype.show=function(e,i,o,a,r){e.alpha=0,i.addChild(e),n.centerPopUp(e);var s=r&&r.duration||t.DEFAULT_DURATION;egret.Tween.get(e).to({alpha:1},s)},t.prototype.hide=function(e,n,i,o,a){var r=a&&a.duration||t.DEFAULT_DURATION;egret.Tween.get(e).to({alpha:0},r).call(function(){n.removeChild(e)},this)},t.DEFAULT_DURATION=200,t}();e.Fade=o,__reflect(o.prototype,"alien.popupEffect.Fade",["alien.popupEffect.IDialogEffect"]);var a=function(){function e(){}return e.prototype.show=function(i,o,a,r,s){e.outPos||(e.outPos=[{x:0,y:-t.StageProxy.height},{x:t.StageProxy.width,y:0},{x:0,y:t.StageProxy.height},{x:-t.StageProxy.width,y:0}]),o.addChild(i),n.notCenterPopUp(i);var h=s.startPos||e.outPos[n.transDirection(s.direction)],c=s.endPos||n.getCenterPos(i);i.x=h.x||c.x,i.y=h.y||c.y;var l=s&&s.duration||e.DEFAULT_DURATION,u={x:c.x,y:c.y};egret.Tween.get(i).to(u,l,s?s.ease:null),s&&s.withFade&&egret.Tween.get(i).to({alpha:1},l)},e.prototype.hide=function(t,i,o,a,r){var s=e.outPos[n.transDirection(r.direction)],h=r.endPos||n.getCenterPos(t),c=r&&r.duration||e.DEFAULT_DURATION,l={x:s.x||h.x,y:s.y||h.y};egret.Tween.get(t).to(l,c,r?r.ease:null).call(function(){i.removeChild(t),n.centerPopUp(t)},this),r&&r.withFade&&egret.Tween.get(t).to({alpha:0},c)},e.DEFAULT_DURATION=300,e}();e.Flew=a,__reflect(a.prototype,"alien.popupEffect.Flew",["alien.popupEffect.IDialogEffect"]);var r=function(){function t(){}return t.prototype.show=function(e,i,o,a,r){var s=r&&r.duration||t.DEFAULT_DURATION;e.scaleX=e.scaleY=0;var h={scaleX:1,scaleY:1};i.addChild(e),n.centerPopUp(e),egret.Tween.get(e).to(h,s,r?r.ease:null),r&&r.withFade&&egret.Tween.get(e).to({alpha:1},s)},t.prototype.hide=function(e,n,i,o,a){var r=a&&a.duration||t.DEFAULT_DURATION;e.scaleX=e.scaleY=1;var s={scaleX:0,scaleY:0};egret.Tween.get(e).to(s,r,a?a.ease:null).call(function(){n.removeChild(e),e.scaleX=e.scaleY=1},this),a&&a.withFade&&egret.Tween.get(e).to({alpha:0},r)},t.DEFAULT_DURATION=200,t}();e.Scale=r,__reflect(r.prototype,"alien.popupEffect.Scale",["alien.popupEffect.IDialogEffect"])}(e=t.popupEffect||(t.popupEffect={}))}(alien||(alien={}));var alien;!function(t){var e=function(){function t(){this.clear()}return t.prototype.containsKey=function(t){return t in this.obj},t.prototype.containsValue=function(t){for(var e in this.obj)if(this.obj[e]==t)return!0;return!1},t.prototype.put=function(t,e){this.containsKey(t)||(this.obj[t]=e,this._length++)},t.prototype.get=function(t){return this.containsKey(t)?this.obj[t]:null},t.prototype.remove=function(t){if(this.containsKey(t)){var e=this.obj;return delete this.obj[t],this._length--,e}return null},t.prototype.foreach=function(t,e){for(var n in this.obj)if(!t.call(e,n,this.obj[n]))break},t.prototype.randomGet=function(){var t=this.valueSet;return t[Math.floor(Math.random()*t.length)]},Object.defineProperty(t.prototype,"keySet",{get:function(){var t=[];for(var e in this.obj)t.push(e);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueSet",{get:function(){var t=[];for(var e in this.obj)t.push(this.obj[e]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._length=0,this.obj={}},t}();t.HashMap=e,__reflect(e.prototype,"alien.HashMap")}(alien||(alien={}));var alien;!function(t){var e=function(){function t(){}return t.distancePoint=function(t,e){return this.distance(t.x,t.y,e.x,e.y)},t.distance=function(t,e,n,i){return Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))},t.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},t.makeRandomInt=function(t,e){return void 0===e&&(e=0),Math.floor(Math.random()*(t-e))+e},t.makeRandomFloat=function(t,e){return void 0===e&&(e=0),Math.random()*(t-e)+e},t.makeRandomByRange=function(t,e){return t+(Math.random()*e*2-e)},t.makeRandomIntArr=function(t,e,n){void 0===n&&(n=0);for(var i=[],o=0;t>o;o++)i.push(this.makeRandomInt(e));return i},t.makeOrderIntArray=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);for(var i=[],o=e;t>=o;o+=n)i.push(o);return i},t.mixArray=function(t){for(var e=0,n=Math.round(t.length/2);n>e;e++){var i=this.makeRandomInt(t.length),o=this.makeRandomInt(t.length),a=t[i];t[i]=t[o],t[o]=a}return t},t.mixArray2=function(t){for(var e,n,i=t[0].length,o=t.length,a=0,r=Math.round(i*o/2);r>a;a++){e=[this.makeRandomInt(i),this.makeRandomInt(o)],n=[this.makeRandomInt(i),this.makeRandomInt(o)];var s=t[e[0]][e[1]];t[e[0]][e[1]]=t[n[0]][n[1]],t[n[0]][n[1]]=s}return t},t.getRandomFromArray=function(t){return t[this.makeRandomInt(t.length)]},t.fixRange=function(t,e,n){return e>t?t=e:t>n&&(t=n),t},t.roundFix=function(t,e,n){return void 0===n&&(n=0),n>t?t+=e-n:t>=e&&(t-=e-n),t},t.radiusToAngle=function(t){return 180*t/Math.PI},t.angleToRadius=function(t){return t*Math.PI/180},t.turnRight=function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push([]);for(var o=0,a=t.length;a>o;o++)for(var r=0,s=t[o].length;s>r;r++)e[o][r]=t[s-r-1][o];return e},t.turnLeft=function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push([]);for(var o=0,a=t.length;a>o;o++)for(var r=0,s=t[o].length;s>r;r++)e[o][r]=t[r][s-o-1];return e},t.calDir=function(t,e,n,i){if(t==n&&e==i)return-1;var o,a=Math.atan2(i-e,n-t);return o=Math.abs(a)<Math.PI/4?0:Math.abs(a)>Math.PI/4*3?2:a>0?1:3},t.sign=function(t){return 0==t?0:t>0?1:-1},t.split=function(t,e){for(var n=[],i=0;e>i;i++)n[i]=0;for(var i=0;t>i;i++)n[this.makeRandomInt(e)]++;return n},t.bezierPoints=function(t,e){function n(t,e,n){return{x:(e.x-t.x)*n+t.x,y:(e.y-t.y)*n+t.y}}for(var i,o=[],a=0,r=1/(e-1),s=0;e>s;s++){for(var h=t.concat(),c=h.length-1;c>0;c--){i=[];for(var l=0,u=h.length;u-1>l;l++)i.push(n(h[l],h[l+1],a));h=i}o.push(h[0]),a+=r}return o},t}();t.MathUtils=e,__reflect(e.prototype,"alien.MathUtils")}(alien||(alien={}));var alien;!function(t){var e=function(){function t(){}return t.registerPool=function(t,e,n){void 0===n&&(n=null),this.createMethods[t]=e,this.initMethods[t]=n,this.pools[t]=[]},t.getObject=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this.pools[t];if(!i)return console.warn(t+""),null;var o;if(i.length>0)o=i.shift();else{var a=this.createMethods[t];o=a.apply(null,e)}var r=this.initMethods[t];return r&&(e.unshift(o),r.apply(null,e)),this.debug(),o},t.recycleObject=function(t,e){if(e){var n=this.pools[t];if(!n)return void console.warn(t+"");n.indexOf(e)<0&&n.length<=this.MAX&&n.push(e),this.debug()}},t.debug=function(){var t="";for(var e in this.pools){var n=this.pools[e];t+=e+":"+n.length+"\n"}},t.MAX=20,t.createMethods={},t.initMethods={},t.pools={},t}();t.ObjectPool=e,__reflect(e.prototype,"alien.ObjectPool")}(alien||(alien={}));var alien;!function(t){var e=function(){function e(){}return e.makeRandomString=function(e){for(var n="",i=this.chars.length,o=0;e>o;o++)n+=this.chars.charAt(t.MathUtils.makeRandomInt(i));return n},e.makeRandomIntString=function(e){for(var n="",i=0;e>i;i++)n+=t.MathUtils.makeRandomInt(10);return n},e.stringCut=function(t,e,n){void 0===n&&(n="...");var i=t;return t.length>e&&(i=t.substr(0,e)+n),i},e.supplement=function(t,e){var n=e-t.toString().length-1;return 0>n?t.toString():this.zeros[n]+t},e.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this.formatApply(t,e)},e.formatApply=function(t,e){for(var n=t,i=0,o=e.length;o>i;i++)n=n.replace("{"+i+"}",e[i]);return n},e.getStrFromObj=function(t,e){void 0===e&&(e="&");var n="";for(var i in t)""!=n&&(n+=e),n+=i+"="+t[i];return n},e.getColor=function(t,e,n){return void 0===n&&(n=0),0==n?"<font color='#"+e.toString(16)+"'>"+t+"</font>":"<font size="+n+" color='#"+e.toString(16)+"'>"+t+"</font>"},e.chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e.zeros=["0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000"],e}();t.StringUtils=e,__reflect(e.prototype,"alien.StringUtils")}(alien||(alien={}));var alien;!function(t){function e(t,e,n,i,o){void 0===n&&(n=-1),void 0===i&&(i=null),void 0===o&&(o=!1);for(var a=[],r=5;r<arguments.length;r++)a[r-5]=arguments[r];var s=0;o&&(s++,t.apply(null,a));var h=egret.setInterval(function(){return n>0&&s>=n?(egret.clearInterval(h),void(i&&i())):(t.apply(null,a),void s++)},this,e);return h}t.repeat=e;var n=function(){function e(){}return e.timeFormat=function(e,n,i,o){var a=this;void 0===n&&(n="{1}:{0}"),void 0===i&&(i=!0),void 0===o&&(o=!1);var r=e%60,s=Math.floor(e/60)%60,h=Math.floor(e/3600)%24,c=Math.floor(e/3600/24);if(i&&(r=t.StringUtils.supplement(r,2),s=t.StringUtils.supplement(s,2),h=t.StringUtils.supplement(h,2),c=t.StringUtils.supplement(c,2)),o){var l="";return[c,h,s,r].forEach(function(t,e){t>0&&(l+=t+lang[a.timeLang[e]])}),l}return t.StringUtils.format(n,r,s,h,c)},e.timeFormatForEx=function(e,n,i,o,a){void 0===n&&(n=""),void 0===i&&(i=""),void 0===o&&(o=""),void 0===a&&(a=!0);var r=e.getFullYear(),s=e.getMonth()+1,h=e.getDate(),c=r+n+s+i+h+o;if(a){var l=t.StringUtils.supplement(e.getHours(),2),u=t.StringUtils.supplement(e.getMinutes(),2);return c+" "+l+":"+u}return c},e.parseFromString=function(t){return new Date(t.replace("T"," ").replace(/-/g,"/"))},e.parseFromStringScope=function(t){var e=this;return t.map(function(t){return e.parseFromString(t)})},e.dateTimeToString=function(t){return this.dateToString(t,lang.format_y_m_d)+" "+this.dateToTimeString(t,"{2}:{1}")},e.tsToDate=function(t){var e=new Date;return e.setTime(1e3*t),e},e.parseTime=function(t){var e=t.split(":");return 3600*parseInt(e[0])+60*parseInt(e[1])+parseInt(e[2])},e.tsToDateString=function(t,e){return void 0===e&&(e="{0}/{1}/{2}"),this.dateToString(this.tsToDate(t))},e.dateToString=function(e,n){return void 0===n&&(n="{0}/{1}/{2}"),t.StringUtils.format(n,e.getFullYear(),t.StringUtils.supplement(e.getMonth()+1,2),t.StringUtils.supplement(e.getDate(),2))},e.dateToTimeString=function(e,n){return void 0===n&&(n="{2}:{1}:{0}"),t.StringUtils.format(n,t.StringUtils.supplement(e.getSeconds(),2),t.StringUtils.supplement(e.getMinutes(),2),t.StringUtils.supplement(e.getHours(),2))},e.dateToTs=function(t){return Math.floor(t.valueOf()/1e3)},e.dateCut=function(t){var e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return this.tsToDate(this.dateToTs(t)-3600*e-60*n-i)},e.tsToMonthDayString=function(e){var n=this.tsToDate(e);return t.StringUtils.format("{0}"+lang.month+"{1}"+lang.day,t.StringUtils.supplement(n.getMonth()+1,2),t.StringUtils.supplement(n.getDate(),2))},e.scopeToDateString=function(t,e){return this.dateToString(t[0],e)+"-"+this.dateToString(t[1],e)},e.scopeToTimeString=function(t,e){var n=this.dateToTimeString(t[0],e),i=this.dateToTimeString(t[1],e);return n+"-"+i},e.scopeToDateTimeString=function(t,e,n,i){void 0===i&&(i=!1);var o=t[0],a=t[1];return i&&o.getDate()==a.getDate()?this.dateToString(o,e)+" "+this.dateToTimeString(o,n)+"-"+this.dateToTimeString(a,n):this.dateTimeToString(o)+" - "+this.dateTimeToString(a)},e.remainDays=function(t,e,n){return void 0===n&&(n=!1),0},e.compareScope=function(t,e){var n=this.dateToTs(t[0]),i=this.dateToTs(t[1]);return n>e?e-n:e>=n&&i>=e?0:e-i},e.getWeekIndex=function(t){var e=this.tsToDate(t),n=this.getFirstWeekBegDay(e.getFullYear());n>e&&(n=this.getFirstWeekBegDay(e.getFullYear()-1));var i=Math.floor((e.valueOf()-n.valueOf())/864e5);return Math.floor(i/7)+1},e.getFirstWeekBegDay=function(t){var e=new Date(t,0,1),n=e.getDay();if(1==n)return e;n=0==n?7:n;var i=e.setDate(e.getDate()+(8-n));return new Date(i)},e.timeLang=["sky","hour","minutes","second"],e}();t.TimeUtils=n,__reflect(n.prototype,"alien.TimeUtils")}(alien||(alien={}));var alien;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.dicTweenCount={},e.dicTweenParams={},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){void 0===e&&(e=null),this.dicTweenCount[t]=0,this.dicTweenParams[t]=e},e.prototype.registerTween=function(t,e){this.setTweenStart(t),e.call(this.onTweenEnd,this,[t])},e.prototype.setTweenStart=function(t){this.dicTweenCount[t]++},e.prototype.setTweenEnd=function(t){this.onTweenEnd(t)},e.prototype.onTweenEnd=function(t){this.dicTweenCount[t]--,this.dicTweenCount[t]<=0&&this.dispatchEventWith(e.ALL_TWEEN_COMPLETE,!1,{name:t,params:this.dicTweenParams[t]})},e.ALL_TWEEN_COMPLETE="allTweenComplete",e}(egret.EventDispatcher);t.TweenWatcher=e,__reflect(e.prototype,"alien.TweenWatcher")}(alien||(alien={}));var alien;!function(t){var e=function(){function t(){}return t.injectProp=function(t,e,n,i,o){if(void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=!0),void 0===o&&(o=!0),!e)return!1;var a=!0;for(var r in e){var s=e[r];i&&"function"==typeof s||o&&null==s||(n?n(t,r,s):t[r]=s)}return a},t.getDirtyData=function(t,e){var n;for(var i in e)t[i]!=e[i]&&(n||(n={}),n[i]=e[i]);return n},t.combineProp=function(t){var e={};return t.forEach(function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},t.enumChildren=function(t,e){for(var n=0,i=t.numChildren;i>n&&!e(t.getChildAt(n),n);n++);},t.removeChildren=function(t,e){for(var n=0;t.numChildren>0;)e(t.removeChildAt(0),n),n++},t.clone=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!0);var i=e?new e:{};return this.injectProp(i,t,null,n),i},t.arrToIntArr=function(t){for(var e=0,n=t.length;n>e;e++)t[e]=parseInt(t[e]);return t},t.getUrlParams=function(){var t={},e=window.location.href,n=e.indexOf("?");if(0>n)return t;for(var i=e.substr(n+1).split("&"),o=0;o<i.length;o++){var a=i[o].split("=");t[a[0]]=a[1]}return t},t.getUrlBase=function(){var t=window.location.href,e=t.indexOf("?");return t.substring(0,0>e?t.length:e)},t.anchorCenter=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this.anchorRate(t,.5,.5,e,n)},t.anchorRate=function(t,e,n,i,o){void 0===i&&(i=0),void 0===o&&(o=0),0==i&&(i=t.width),0==o&&(o=t.height),t.x+=t.anchorOffsetX=i*e,t.y+=t.anchorOffsetY=o*n},t.obj2query=function(t){if(!t)return"";var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")},t.parseColorTextFlow=function(t){for(var e,n=t.split(/\[.*?\]/g),i=t.match(/\[.*?\]/g),o=[],a=0,r=n.length-1;r>a;a++){e=n[a],e&&o.push({text:e});var s=i[a];s=s.substr(1,s.length-2);var h={},c=s.split("|");1==c.length?h.style={textColor:parseInt(c[0],16)}:(h.text=c[0],h.style={textColor:parseInt(c[1],16)}),o.push(h)}return e=n[a],e&&o.push({text:e}),o},t.parseHtmlText=function(t){return this.parser.parser(t)},t.scrollTo=function(t,e,n){return void 0===n&&(n=0),(e+n)*t},t.getByteLen=function(t){return t.replace(/[^\x00-\xff]/g,"__").length},t.parser=new egret.HtmlTextParser,t}();t.Utils=e,__reflect(e.prototype,"alien.Utils")}(alien||(alien={}));var alien;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.grpPanel.visible=!1,this.grpPanel.alpha=0,this.grpPanel.y=0,this._index=-1,this.list.itemRenderer=n,this.list.dataProvider=this._items=new eui.ArrayCollection,this.list.addEventListener(egret.Event.CHANGE,this.onItemSelect,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},i.prototype.onTap=function(t){var e=this;!this.grpPanel.visible&&this._items&&0!=this._items.length&&egret.setTimeout(function(){e.show()},this,1)},i.prototype.onItemSelect=function(t){this.index=this.list.selectedIndex,this.list.selectedIndex=-1},i.prototype.onStageTap=function(t){this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTap,this),this.hide()},i.prototype.show=function(){this._items.length>1&&(t.StageProxy.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTap,this),egret.Tween.get(this.grpPanel,null,null,!0).set({visible:!0}).to({y:this.imgBg.height,alpha:1},100))},i.prototype.hide=function(){this.btn.selected=!1,egret.Tween.get(this.grpPanel,null,null,!0).to({y:0,alpha:0},100).set({visible:!1}).call(this.onResult.bind(this))},i.prototype.onResult=function(){this.dispatchEventWith(egret.Event.CHANGE,!1,{index:this._index})},Object.defineProperty(i.prototype,"items",{get:function(){return this._items?this._items.source:null},set:function(t){this._items.source=t,this.index=0,this.btn.visible=this._items.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t;var e=this._items.getItemAt(this._index);this.lab.text="string"==typeof e?e:e.text,this.lab.textColor=e.disable?13421772:16641454},enumerable:!0,configurable:!0}),i}(eui.Component);t.DropDown=e,__reflect(e.prototype,"alien.DropDown");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.lab.text="string"==typeof e?e:e.text,this.lab.textColor=e.disable?13421772:16641454},e}(eui.ItemRenderer);t.IRDropDownItem=n,__reflect(n.prototype,"alien.IRDropDownItem")}(alien||(alien={}));var alien;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createChildren=function(){var n=this;e.prototype.createChildren.call(this),this.parts=[],t.Utils.enumChildren(this,function(t){n.parts.push(t)}),this.removeChildren(),this.switchTo(0,0)},n.prototype.switchTo=function(t,e,n){var i=this;if(void 0===e&&(e=300),void 0===n&&(n=null),this._index!=t){this._index=t,this._old&&(this.removeChild(this._old),this._old=null);var o=this.parts[t],a=this._old=0==this.numChildren?null:this.getChildAt(0);o&&(o.alpha=0,o.visible=!0,this.addChild(o),egret.Tween.get(o,null,null,!0).to({alpha:1},e).call(function(){n&&n()})),a&&egret.Tween.get(a,null,null,!0).to({alpha:0},e).call(function(){i._old=null,a.alpha=1,i.removeChild(a)})}},n}(eui.Group);t.FadeSwitch=e,__reflect(e.prototype,"alien.FadeSwitch")}(alien||(alien={}));var alien;!function(alien){var Image=function(_super){function Image(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Image,_super),Image.prototype.createChildren=function(){_super.prototype.createChildren.call(this)},Object.defineProperty(Image.prototype,"anchorX",{get:function(){return this._anchorX},set:function(t){this._anchorX!=t&&(this._anchorX=t,this.anchorOffsetX=this.width*this._anchorX)},enumerable:!0,configurable:!0}),Object.defineProperty(Image.prototype,"anchorY",{get:function(){return this._anchorY},set:function(t){this._anchorY!=t&&(this._anchorY=t,this.anchorOffsetY=this.height*this._anchorY)},enumerable:!0,configurable:!0}),Object.defineProperty(Image.prototype,"animation",{get:function(){return this._animation},set:function(t){this._animation!=t&&(this._animation=t,this._animation&&this.playAnimation(this._animation))},enumerable:!0,configurable:!0}),Image.prototype.playAnimation=function(script){if(script){var tween_1=egret.Tween.get(this,null,null,!0),lines=script.split("|");lines.forEach(function(item,index){var tweenProps=item.split(";"),p=tweenProps[0].replace("[","{").replace("]","}"),duration=parseFloat(tweenProps[1])||0;if(p.length>2){var props=eval("("+p+")"),ease=void 0;tweenProps[2]&&(ease=egret.Ease[tweenProps[2]]),tween_1.to(props,duration,ease)}else tween_1.wait(duration)})}},Image}(eui.Image);alien.Image=Image,__reflect(Image.prototype,"alien.Image")}(alien||(alien={}));var alien;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._index=-1;var e=this.grpPoints.removeChildAt(0);this.pointRes=e.source,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.renderPoints(),this.index=0},e.prototype.onTap=function(t){switch(t.target.name){case"reduce":this._setIndex(this._index-1);break;case"increase":this._setIndex(this._index+1)}},e.prototype.renderPoints=function(){this.grpPoints.removeChildren();for(var t=0;t<this.total;t++){var e=new eui.Image(this.pointRes);e.scaleX=e.scaleY=e.alpha=.7,this.grpPoints.addChild(e)}},Object.defineProperty(e.prototype,"total",{get:function(){return this._total},set:function(t){this._total=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(t){this._setIndex(t,!1)},enumerable:!0,configurable:!0}),e.prototype._setIndex=function(t,e){void 0===e&&(e=!0);var n=t;0>n?n=this._total-1:n>this._total-1&&(n=0),this.updateIndex(this._index,this._index=n,e)},e.prototype.updateIndex=function(t,e,n){if(void 0===n&&(n=!0),t>=0){var i=this.grpPoints.getChildAt(t);egret.Tween.get(i,null,null,!0).to({scaleX:.7,scaleY:.7,alpha:.7},200)}var o=this.grpPoints.getChildAt(e);egret.Tween.get(o,null,null,!0).to({scaleX:1,scaleY:1,alpha:1},200),n&&this.dispatchEventWith(egret.Event.CHANGE)},e}(eui.Component);t.PageProgressBar=e,__reflect(e.prototype,"alien.PageProgressBar")}(alien||(alien={}));var alien;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.speedX=-.5,t.speedY=0,t.init(),t}return __extends(n,e),n.prototype.init=function(){this._imgs=[],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedToStage,this)},n.prototype.onAddedToStage=function(e){this._playing&&t.TickerManager.register(this)},n.prototype.onRemovedToStage=function(e){t.TickerManager.unregister(this)},n.prototype.createChildren=function(){var n=this;e.prototype.createChildren.call(this),this._imgs=[],this._widthMax=0,t.Utils.enumChildren(this,function(t){n._imgs.push(t),n._widthMax+=t.width}),this.play()},n.prototype.play=function(){this._playing=!0,t.TickerManager.register(this)},n.prototype.stop=function(){this._playing=!1,t.TickerManager.unregister(this)},n.prototype.update=function(){var t=this;this._imgs.forEach(function(e){e.x+=t.speedX,e.y+=t.speedY,t.speedX<0&&e.x<-e.width&&(e.x=t._widthMax-e.width)})},n}(eui.Component);t.ScrollImage=e,__reflect(e.prototype,"alien.ScrollImage",["alien.ITicker"])}(alien||(alien={}));var alien;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._contentPoint={},t._dragOffset={},t._selectedIndex=-1,t._totalPage=0,t._points=[],t._dragThreshold=10,t}return __extends(n,e),Object.defineProperty(n.prototype,"dragThreshold",{get:function(){return this._dragThreshold},set:function(t){this._dragThreshold=t},enumerable:!0,configurable:!0}),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.callLater(this.setup,this)},n.prototype.setup=function(){var e=this;this.scrollEnabled=!0,t.Utils.enumChildren(this,function(t,n){t.x=n*e.width,t.y=0}),this._totalPage=this.numChildren,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this,!0),t.StageProxy.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this,!0),t.StageProxy.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this,!0)},n.prototype.onTouchBegin=function(t){this._touchBeginPoint={x:t.stageX,y:t.stageY},this._contentPoint.x=this.scrollH,this._contentPoint.y=this.scrollV,this._touchedTarget=t.target,this._touchCancel=!1,this._points.splice(0),egret.Tween.removeTweens(this),this._touchMoved=!1},n.prototype.dispatchCancelEvent=function(t){var e=new egret.TouchEvent(egret.TouchEvent.TOUCH_CANCEL,t.bubbles,t.cancelable),n=this._touchedTarget;n.dispatchEvent(e);for(var i=this.$getPropagationList(n),o=i.length,a=.5*i.length,r=-1,s=0;o>s;s++)if(i[s]===this){r=s;break}i.splice(0,r+1),a-=r+1,this.$dispatchPropagationEvent(e,i,a),egret.Event.release(e)},n.prototype.onTouchMove=function(t){if(this._touchBeginPoint){var e=t.stageX-this._touchBeginPoint.x;Math.abs(e)>this._dragThreshold&&(this.dispatchCancelEvent(t),this._dragOffset.x=e,this._points.push({t:(new Date).valueOf(),x:t.stageX,y:t.stageY}),this.scrollH=this._contentPoint.x-this._dragOffset.x,this._touchCancel=!0,this._touchMoved=!0)}},n.prototype.onTouchEnd=function(e){if(this._touchBeginPoint){var n=-1,i=this._points.length;if(Math.abs(this._dragOffset.x)>this.width/3)n=this.switchPage(t.MathUtils.sign(-this._dragOffset.x));else if(i>0){var o=this._points[1==i?1:i-2];if(o){var a=(o.x-e.stageX)/((new Date).valueOf()-o.t);Math.abs(a)>1&&(n=this.switchPage(t.MathUtils.sign(a)))}}this._touchMoved&&this.showPage(0>n?this._selectedIndex:n)}this._touchBeginPoint=null,this._dragOffset={}},n.prototype.switchPage=function(t){var e=this._selectedIndex+t;return 0>e?e=0:e>this._totalPage-1&&(e=this._totalPage-1),e},n.prototype.onTouchTap=function(t){this._touchCancel&&t.stopPropagation()},n.prototype.removeListeners=function(){},n.prototype.showPage=function(t,e,n){var i=this;void 0===e&&(e=!0),void 0===n&&(n=!0),egret.callLater(function(){i._callPageOut();var o=!1;i._selectedIndex=t;var a=t*i.width;e?(egret.Tween.removeTweens(i),egret.Tween.get(i).to({scrollH:a},Math.abs(i.scrollH-a),egret.Ease.quartOut).call(function(){o||i._callPageIn(t)})):(i.scrollH=a,o||i._callPageIn(t)),n&&!o&&i.dispatchEventWith(egret.Event.CHANGE,!1,{page:t})},this)},n.prototype._callPageOut=function(){if(this._selectedIndex>=0){var t=this.getChildAt(this._selectedIndex);t.sleep&&t.sleep()}},n.prototype._callPageIn=function(t){var e=this.getChildAt(t);e.activate&&e.activate()},n.prototype.toForward=function(){var t=this._selectedIndex-1;return t>-1&&this.showPage(t),this._selectedIndex},n.prototype.toNext=function(){var t=this._selectedIndex+1;return t<this._totalPage&&this.showPage(t),this._selectedIndex},n.prototype.hasForward=function(){return this._selectedIndex>0},n.prototype.hasNext=function(){return this._selectedIndex<this._totalPage-1},Object.defineProperty(n.prototype,"totalPage",{get:function(){return this._totalPage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedChild",{get:function(){return this._selectedIndex>=0?this.getChildAt(this._selectedIndex):null},enumerable:!0,configurable:!0}),n}(eui.Group);t.ScrollNavigator=e,__reflect(e.prototype,"alien.ScrollNavigator")}(alien||(alien={}));var alien;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectedIndex=-1,e.views=[],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setup=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];
this._viewDefs=t,this.selectedIndex=0},Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){var e=this;this._selectedIndex!=t&&this._hideView(this._selectedIndex),this._selectedIndex=t,this._viewDefs&&this._selectedIndex>=0&&this._selectedIndex<this._viewDefs.length&&egret.callLater(function(){e._showView(e._selectedIndex)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedChild",{get:function(){return 0==this.numChildren?null:this.getChildAt(0)},enumerable:!0,configurable:!0}),e.prototype._hideView=function(t){var e=this.views[t];e&&e.sleep&&e.sleep()},e.prototype._showView=function(t){var e=this.views[t];e||(e=this.views[t]=new this._viewDefs[t],e.width=this.width,e.height=this.height),this.removeChildren(),this.addChild(e),e.activate&&e.activate()},e}(eui.Group);t.ViewStack=e,__reflect(e.prototype,"alien.ViewStack")}(alien||(alien={}));var Card=function(t){function e(){var e=t.call(this)||this;return e._select=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.touchEnabled=!0,this.addChild(this._container=new egret.DisplayObjectContainer),this._container.addChild(this._body=new CardBody),this._body.scaleX=this._body.scaleY=GameConfig.CARD_SCALE,alien.Utils.anchorCenter(this._container,GameConfig.CARD_WIDTH,GameConfig.CARD_HEIGHT)},e.prototype.initData=function(t){this._body.y=0,this.scaleX=this.scaleY=this.alpha=1,this.touchEnabled=this.touchChildren=!0,this._select=!1,0==t.pid?this.showBack():(this._body.initData(this._pokerId=t.pid),this.showFront())},Object.defineProperty(e.prototype,"pokerId",{get:function(){return this._pokerId},set:function(t){this._body.initData(this._pokerId=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rollOver",{get:function(){return this._body.rollOver},set:function(t){this._body.rollOver=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(t){if(this._select!=t){this._select=t;var e=this._select?-10:0;egret.Tween.get(this._body,null,null,!0).to({y:e},80)}},enumerable:!0,configurable:!0}),e.prototype.showFront=function(t){var e=this;void 0===t&&(t=!1),t?egret.Tween.get(this._container,null,null,!0).to({scaleX:0},100).call(function(){e._bg&&(e._bg.visible=!1),e._body.visible=!0}).to({scaleX:1},100):(this._body.visible=!0,this._bg&&(this._bg.visible=!1))},e.prototype.showBack=function(t){void 0===t&&(t="blue"),this._bg||(this._container.addChild(this._bg=new egret.Bitmap),this._bg.scaleX=this._bg.scaleY=GameConfig.CARD_SCALE),this._backRes!=t&&(this._backRes=t,this._bg.texture=RES.getRes("poker_"+t+"_back")),this._body.visible=!1,this._bg.visible=!0},e.prototype.animate=function(t,e,n,i,o){return void 0===e&&(e=0),void 0===n&&(n=null),void 0===i&&(i=200),void 0===o&&(o=null),egret.Tween.get(this,null,null,!0).to(n).wait(e).to(t,i,o)},e.create=function(t){return alien.ObjectPool.getObject("Card",t)},e.recycle=function(t){alien.ObjectPool.recycleObject("Card",t)},e.prototype.showMasterFlag=function(t){this._body.showMasterFlag(t)},e}(egret.DisplayObjectContainer);__reflect(Card.prototype,"Card");var CardBody=function(t){function e(){var e=t.call(this)||this;return e._rollOver=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.initData=function(t){if(this._master=!1,this.removeChildren(),t>0){this.addChild(this._bg=new egret.Bitmap(RES.getRes("poker_broad")));var e=this._poker=Utils.pid2poker(t);if(e.num>13){var n=new egret.Bitmap(RES.getRes("poker_"+e.signColor+"_joker"));this.addChild(n);var i=new egret.Bitmap(RES.getRes("poker_"+e.signColor+"_joker_ddz_icon"));i.x=0,i.y=0,this.addChild(i)}else{var o=void 0;switch(e.num){case 1:o="a";break;case 11:o="j";break;case 12:o="q";break;case 13:o="k";break;default:o=e.num.toString()}var a=new egret.Bitmap(RES.getRes("poker_"+e.signColor+"_"+o));this.addChild(a);var r=new egret.Bitmap(RES.getRes("poker_sign_"+e.sign));this.addChild(r),a=new egret.Bitmap(RES.getRes("poker_"+e.signColor+"_"+o)),a.anchorOffsetX=a.x=a.width/2,a.anchorOffsetY=a.y=a.height/2,a.rotation=180,this.addChild(a),r=new egret.Bitmap(RES.getRes("poker_sign_"+e.sign)),r.anchorOffsetX=r.x=r.width/2,r.anchorOffsetY=r.y=r.height/2,r.rotation=180,this.addChild(r)}this._masterFlag=new egret.Bitmap(RES.getRes("icon_master_card")),this._masterFlag.scaleX=1.7,this._masterFlag.scaleY=1.7,this._masterFlag.x=50,this._masterFlag.y=2,this.addChild(this._masterFlag)}this.showMasterFlag(!1)},Object.defineProperty(e.prototype,"rollOver",{get:function(){return this._rollOver},set:function(t){this._rollOver!=t&&(this._rollOver=t,this._bg.texture=RES.getRes("poker_broad"+(this._rollOver?"_h":"")))},enumerable:!0,configurable:!0}),e.prototype.showMasterFlag=function(t){this._master=t,this._masterFlag&&(this._masterFlag.visible=t)},e}(egret.DisplayObjectContainer);__reflect(CardBody.prototype,"CardBody");var alien;!function(t){var e=function(){function e(){this._pupUpStack=[],this._popLayer=t.SceneManager.instance.popLayer,this._popLayer.width=t.StageProxy.width,this._popLayer.height=t.StageProxy.height,t.StageProxy.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this)}return Object.defineProperty(e,"instance",{get:function(){return void 0==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.addPopUp=function(t,n,i,o,a,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=!0),void 0===r&&(r=null),e.instance.addPopUp(t,n,i,o,a,r)},e.removePopUp=function(t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),e.instance.removePopUp(t,n,i)},e.removeTopPupUp=function(){return e.instance.removeTopPupUp()},e.removeAllPupUp=function(){e.instance.removeAllPupUp()},e.prototype.onStageResize=function(e){void 0===e&&(e=null),this._modalMask&&(this._modalMask.width=t.StageProxy.stage.stageWidth,this._modalMask.height=t.StageProxy.stage.stageHeight)},e.prototype.addPopUp=function(n,i,o,a,r,s){if(void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=!0),void 0===s&&(s=null),!n.parent){this.modalConfig=t.Utils.combineProp([s,e.defaultModalConfig]),this._pupUpStack.unshift({target:n,modalTouchFun:a,modal:r}),this.updateModalMask(this._pupUpStack[0]);var h=this.createEffectInstance(i);h.show(n,this._popLayer,function(){},this,o)}},e.prototype.removePopUp=function(t,e,n){if(void 0===e&&(e=null),void 0===n&&(n=null),t.parent&&this.getInStack(t,!0)){var i;this._pupUpStack.some(function(t){return t.modal?(i=t,!0):void 0}),i?this.updateModalMask(i):this.setModalMaskVisible(!1);var o=this.createEffectInstance(e);o.hide(t,this._popLayer,function(){},this,n)}},e.prototype.removeTopPupUp=function(){if(this._popLayer.numChildren>0){var t=this._popLayer.getChildAt(this._popLayer.numChildren-1);return t.close(),!0}return!1},e.prototype.removeAllPupUp=function(){var e=this;t.Utils.enumChildren(this._popLayer,function(t){t!=e._modalMask&&t.close()})},e.prototype.getInStack=function(t,e){void 0===e&&(e=!1);var n;return this._pupUpStack.some(function(e,i){return e.target==t?(n={item:e,index:i},!0):void 0}),n&&e&&this._pupUpStack.splice(n.index,1),n},e.prototype.createEffectInstance=function(e){void 0===e&&(e=null);var n;return n=e?new e:new t.popupEffect.None},e.prototype.onModalMaskTap=function(t){var e=this._pupUpStack[0];e&&e.modal&&e.modalTouchFun&&e.modalTouchFun()},e.prototype.updateModalMask=function(t){var e=this._popLayer.getChildIndex(this._modalMask),n=this._popLayer.getChildIndex(t.target);e!=n-1&&this.setModalMaskVisible(t.modal,n)},e.prototype.setModalMaskVisible=function(t,e){void 0===e&&(e=-1),t?(this.modalMask.fillColor=this.modalConfig.color,this.modalMask.fillAlpha=this.modalConfig.alpha,e>=0?(this.setModalMaskVisible(!0),this._popLayer.addChildAt(this.modalMask,e)):this._popLayer.addChild(this.modalMask),egret.Tween.get(this.modalMask,null,null,!0).to({alpha:1},this.modalConfig.duration)):this.modalMask.parent&&egret.Tween.get(this.modalMask,null,null,!0).to({alpha:0},this.modalConfig.duration).call(function(t){this._popLayer.removeChild(t)},this,[this.modalMask])},Object.defineProperty(e.prototype,"modalMask",{get:function(){return this._modalMask||(this._modalMask=new eui.Rect,this._modalMask.width=t.StageProxy.width,this._modalMask.height=t.StageProxy.height,this._modalMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onModalMaskTap,this)),this._modalMask},enumerable:!0,configurable:!0}),e.defaultModalConfig={color:0,alpha:.5,duration:200},e}();t.PopUpManager=e,__reflect(e.prototype,"alien.PopUpManager")}(alien||(alien={}));var Environment=function(){function t(){}return t.channel_id=1,t}();__reflect(Environment.prototype,"Environment");var LogUtil=function(){function t(){}return t.argsToString=function(t){var e=function(t){for(var e="",n=0;t>n;++n)e+=" ";return e},n="",i=function(t,n,o){var a=t;if(Utils.isArray(o)){a+="[";for(var r=0;r<o.length;++r)a+=i("",n,o[r])+",";a+="]"}else if(Utils.isObject(o)){a+="{\n",n+=1;for(var s in o)a+=i(e(n)+s.toString()+":",n,o[s])+",\n";a+=e(n-1)+"}"}else a+=""+o;return a};return n=i(n,0,t)},t.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return},t.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return},t.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return},t}();__reflect(LogUtil.prototype,"LogUtil");var MainLogic=function(){function t(){this._almsCount=0,this._almsUsageCount=0,this.init()}return Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){alien.Native.instance.addEventListener("back",this.back,this),alien.Native.instance.addEventListener("enterBackground",this.enterBackground,this),alien.Native.instance.addEventListener("enterForeground",this.enterForeground,this),server.addEventListener(EventNames.USER_USER_INFO_RESPONSE,this.onUserInfoResponse,this),server.addEventListener(EventNames.USER_ALMS_REP,this.onAlmsResponse,this),alien.Dispatcher.addEventListener(EventNames.CLOCK_0,this.onClock0,this),alien.Dispatcher.addEventListener(EventNames.SERVER_CLOSE,this.onServerClose,this),server.addEventListener(EventNames.USER_GET_FRREWARD_REP,this._onRecvGetFRechargeRewRep,this),server.addEventListener(EventNames.USER_PAY_TO_CHAT_REP,this._onRecvHornRep,this),server.addEventListener(EventNames.USER_CHECK_RECONNECT_REP,this._onCheckReconnectRep,this),alien.Dispatcher.addEventListener(EventNames.SERVER_HASUPDATE,this._onServerHasUpdate,this),this.selfData=new UserInfoData},t.prototype.initData=function(){GameConfig.roomList.forEach(function(t){t.hasOwnProperty("cycleTime")&&!t.hasOwnProperty("cycleTimeStamp")&&(t.cycleTimeStamp=[],t.cycleTime.some(function(e){t.cycleTimeStamp.push(alien.TimeUtils.parseTime(e))})),2==t.roomType&&(t.masterReward=MatchService.getRewardStringByRank(t),t.rewardText=alien.StringUtils.format(lang.match_jikai_reward,t.masterReward),205==t.matchId&&(t.masterReward=MatchService.getRewardStringBy205(t),t.rewardText=alien.StringUtils.format(lang.match_jikai_reward,t.masterReward)),t.limitText=alien.StringUtils.format(lang.match_jikai_limit,t.maxPlayer),t.entryMoneyText=t.entryMoney>0?Utils.currencyRatio(t.entryMoney)+lang.gold:lang.free_pay)}),GoodsManager.instance,MatchService.instance.initData()},t.prototype.back=function(t){if(!alien.PopUpManager.removeTopPupUp()){var e=alien.SceneManager.instance.currentScene;if(e.name==SceneNames.ROOM){var n=e;n.doBack()}else alien.SceneManager.back(null,alien.sceneEffect.Fade)||alien.Native.instance.closeApp()}},t.prototype.enterForeground=function(t){console.log("app enter foreground."),this.onAppEnterForeground()},t.prototype.enterBackground=function(t){console.log("app enter background."),this._ready&&alien.SceneManager.instance.currentSceneName==SceneNames.LOADING?this.tryStart():(alien.Dispatcher.dispatch(EventNames.ENTER_BACKGROUND),this.onAppEnterBackground())},t.prototype.delayStart=function(){console.log("delayStart----------->"),this._ready=!0,GameData.instance.loadData(),UserData.instance.init(GameConfig.platform),UserData.instance.loadData(),this.initData(),this.tryStart()},t.prototype.tryStart=function(){console.log("tryStart"),server.ready();var t=alien.Native.instance;t.isWXMP?LoginService.instance.doWebWXLogin():t.isAli()?LoginService.instance.doWebAliLogin():t.isWxQr()?LoginService.instance.doWebWXLogin():t.isAliQr()?LoginService.instance.doWebAliLogin():this.showLogin()},t.prototype.showLogin=function(){alien.SceneManager.show(SceneNames.LOGIN,{autoLogin:!0,isFirstIn:!0},alien.sceneEffect.Fade)},t.prototype.getLocation=function(){var e=this;alien.Native.instance.getWXLocation(function(n){if("success"==n.result){t.instance.latitude=n.latitude,t.instance.longitude=n.longitude,console.log("!!!!!!!!");var i={latitude:n.latitude,longitude:n.longitude};server.modifyUserInfo(i),e._getLocationTimer.stop()}else console.log(": "+n.result)})},t.prototype.start=function(t){var e=this;if(!this.running){console.log("MainLogic start."),this.refreshSelfInfo();var n=GameData.instance,i=n.getItem("lastLaunchTime",0),o=alien.TimeUtils.tsToDate(i),a=alien.TimeUtils.tsToDate(server.tsLocal);o.getDate()==a.getDate()&&o.getMonth()==a.getMonth()&&o.getFullYear()==a.getFullYear()?n.changeItem("todayLaunchCount",1):n.setItem("todayLaunchCount",1),alien.TimeUtils.getWeekIndex(i)==alien.TimeUtils.getWeekIndex(server.tsLocal)?n.changeItem("weekLaunchCount",1):n.setItem("weekLaunchCount",1),n.setItem("lastLaunchTime",server.tsLocal,!0),async.parallel([function(t){MatchService.instance.start(t)},function(t){BagService.instance.start(t)},function(t){CountDownService.instance.start(t)},function(t){RechargeService.instance.start(t)},function(t){MailService.instance.start(t)}],function(){e.running=!0,t()}),this.checkNicknameCount=0}},t.prototype.stop=function(){alien.PopUpManager.removeAllPupUp(),this.running&&(console.log("MainLogic stop."),this.selfData.clean(),MatchService.instance.stop(),BagService.instance.stop(),CountDownService.instance.stop(),RechargeService.instance.stop(),MailService.instance.stop(),server.close(!1),this.running=!1)},t.prototype.restart=function(t){this._restartFlag=!0,this._restartCallback=t,server.connected?this.stop():(t(),this._restartFlag=!1,this._restartCallback=null),egret.setTimeout(t.bind(this),this,500)},t.prototype.onAppEnterForeground=function(){server.frozen=!1,server.checkEnterForegroundTimeOut()||server.checkReconnect(),alien.Native.instance.isNative&&(server.userInfoRequest(server.uid),BagService.instance.refreshBagInfo(!0))},t.prototype.onAppEnterBackground=function(){server.frozen=!0},t.prototype.onServerClose=function(t){this.stop()},t.prototype.onClock0=function(t){},t.prototype.refreshSelfInfo=function(){server.userInfoRequest(server.uid)},t.prototype.onUserInfoResponse=function(t){var e=t.data;e.uid==server.uid&&(this.selfData.initData(e),alien.Dispatcher.dispatch(EventNames.MY_USER_INFO_UPDATE,{userInfoData:this.selfData}),alien.Dispatcher.dispatch(EventNames.GOLD_UPDATE,{gold:this.selfData.gold}),OtherGameManager.instance.onMyInfoUpdate())},t.prototype.updateRecorderExpireTime=function(){var t=new Date;t.setFullYear(this.selfData.cardsRecorder[0],this.selfData.cardsRecorder[1]-1,this.selfData.cardsRecorder[2]),t.setHours(this.selfData.cardsRecorder[3]),t.setMinutes(this.selfData.cardsRecorder[4]),t.setSeconds(this.selfData.cardsRecorder[5]);var e=new Date,n=t.getTime()-e.getTime();this.selfData.cardsRecorder[6]=Math.floor(n/1e3)},t.prototype.alms=function(t){return void 0===t&&(t=0),t=t||this.selfData.gold,t<GameConfig.almsConfig.condition?(server.alms(),!0):(this._almsCount++,!1)},t.prototype.rechareErrByServerUpdate=function(){if(server.reqServerUpdateRechareErr(),server.playing){var t="!";alien.Native.instance.isNative&&(t="!"),Alert.show(t)}else this._onServerHasUpdate()},t.prototype.onAlmsResponse=function(t){var e=t.data;switch(e.result){case 0:0==this._almsCount&&(Alert.show(lang.format(lang.id.alms_success,Utils.currencyRatio(GameConfig.almsConfig.gold),GameConfig.almsConfig.count-e.usagecnt)),this._almsUsageCount=e.usagecnt);break;case 1:break;case 2:}this._almsCount++},t.backToRoomScene=function(e){void 0===e&&(e=null),alien.SceneManager.show(SceneNames.ROOM,e,alien.sceneEffect.Fade,null,null,!1,SceneNames.LOADING),t.instance.alms()},t.getTodayLaunchCount=function(){return GameData.instance.getItem("todayLaunchCount",0)},t.getWeekLaunchCount=function(){return GameData.instance.getItem("weekLaunchCount",0)},t.prototype._getRewSuccTextByCfg=function(t){var e="";t.sort(function(t,e){return t.id>e.id});for(var n=0;n<t.length;++n)0==t[n].id?e+=":"+t[n].num+"\n":101==t[n].id?e+="*"+t[n].num+" ":2==t[n].id&&(e+="*"+t[n].num/24/7+" ");return e},t.prototype._onRecvGetFRechargeRewRep=function(t){var e=t.data,n="";if(0==e.result){var i=GameConfig.getFRechargeRewByDay(e.day);if(!i)return void LogUtil.error("_onRecvGetFRechargeRewRep==========error===",e.day,i);n=this._getRewSuccTextByCfg(i),n+="\n\n"+(7-e.day)+"",BagService.instance.refreshBagInfo(),this.selfData.setFRechargeTodayHasGet(),PanelFirstRecharge.setDisableGet()}else{var o=(a={},a[1]="",a[2]="",a[3]="",a);o[e.result]?n=o[e.result]:(n="",LogUtil.error("_onRecvGetRewRep==========error===",e.result))}Alert.show(n);var a},t.prototype.onGoGetRewardReq=function(){var t=this.selfData,e=t.getFRechargeRewGetDay();e&&e>=1&&7>=e?server.send(EventNames.USER_GET_FRREWARD_REQ,{day:e}):LogUtil.info("_onGoRecharge------------ERROR-->",e)},t.prototype._onRecvHornRep=function(e){var n=e.data,i=(c={},c[1]="",c[2]="",c[3]="",c),o="";if(null==n.result)for(var a=n.chatinfo,r=t.instance.selfData.nickname,s={time:0,msg:null,nickname:null},h=0;h<a.length;++h)Base64.decode(a[h].nickname)!=r&&(s.time=1e3*a[h].time,s.nickname=a[h].nickname,s.msg=a[h].msg,this.selfData.addHornTalkRec(s));else i[n.result]&&(o=i[n.result],Toast.show(o));var c},t.prototype.ifBuyReviveMaxTipShop=function(e){if(this.selfData.isMaxBuyDiamondRevive()){var n=this.selfData.getDiamondReviveMaxBuy();Alert.show(""+n+",!",0,function(e){"confirm"==e?PanelExchange2.instance.show(1):t.backToRoomScene()})}else PanelReviveBag.getInstance().show(e)},t.prototype.noDiamondGetNewDiamondRewOrBuyRevive=function(t){var e=this.selfData.hasGetNewDiamond();return e?void this.ifBuyReviveMaxTipShop(t):void server.reqNewPlayerGetDiamond()},t.prototype.hideIndexDownAndRefresh=function(){alien.Native.instance.isWXMP&&(window.top.hideDownApp&&window.top.hideDownApp(),window.top.hideRefresh&&window.top.hideRefresh())},t.prototype.loadFntFont=function(){RES.isGroupLoaded("font")||RES.loadGroup("font")},t.prototype.loadRecharge=function(){RES.isGroupLoaded("recharge")||RES.loadGroup("recharge")},t.prototype._loadResGroups=function(){this.loadFntFont(),this.loadRecharge()},t.prototype._reconnectRetCheckStatusByData=function(t){alien.Dispatcher.dispatch(EventNames.HIDE_WAITING);var e=!1,n=null;t.roomid&&(n=GameConfig.getRid2gt(t.roomid),n&&(e=!0));var i=SceneManager.instance.currentSceneName,o=SceneManager.instance.currentScene;if(alien.Native.instance.isNative&&BagService.instance.refreshBagInfo(!0),t.roomid>999&&t.roomid<1e4&&2==t.gametype)if(this._loadResGroups(),i==SceneNames.PLAY){var a=o;a.doReconnectToGame({personalgame:!0,action:"reconnect",roomID:t.roomid})}else SceneManager.show(SceneNames.PLAY,{personalgame:!0,action:"reconnect",roomID:t.roomid},alien.sceneEffect.Fade);else if(e){if(n!=GameConfig.gameName)return t.action="reconnect",void OtherGameManager.instance.runOtherGameByName(n,t);if(this._loadResGroups(),i==SceneNames.PLAY){var a=o;a.doReconnectToGame({personalgame:!1,action:"reconnect",roomID:t.roomid})}else SceneManager.show(SceneNames.PLAY,{action:"reconnect",roomID:t.roomid},alien.sceneEffect.Fade)}else{if(OtherGameManager.instance.isRunOtherGame())return;if(webService.loadLog(2,1),i==SceneNames.ROOM){var a=o;a.doReconnectToLobby()}else SceneManager.show(SceneNames.ROOM,{fromLogin:!0},alien.sceneEffect.Fade),this._loadResGroups()}},t.prototype._onCheckReconnectRep=function(t){var e=t.data;this.hideIndexDownAndRefresh(),this.running?this._reconnectRetCheckStatusByData(e):this.start(this._reconnectRetCheckStatusByData.bind(this,e))},t.prototype.doRestartGame=function(){var e=alien.Native.instance;this.stop(),e.isNative?e.checkAppUpdate(function(){t.instance.showLogin()}):window.top.location.reload()},t.prototype._onServerHasUpdate=function(){var t=this;egret.setTimeout(function(){var e=alien.Native.instance,n=t.doRestartGame.bind(t),i="";e.isNative&&(i="",n=e.closeApp.bind(e)),PanelAlert3.instance.show(i,0,function(t){"confirm"==t&&n()}.bind(t),!1)},this,100)},t.prototype.closeSelf=function(){var t=alien.Native.instance;t.isNative&&t.closeApp()},t}();__reflect(MainLogic.prototype,"MainLogic");var ProtoIDs=function(){function t(){}return t.getMap=function(){var t={};return t[2001]="game.GameStartNtf",t["game.GameStartNtf"]=2001,t[2002]="game.SetSession",t["game.SetSession"]=2002,t[2003]="game.TableInfo",t["game.TableInfo"]=2003,t[2004]="game.EnterTable",t["game.EnterTable"]=2004,t[2005]="game.AskReady",t["game.AskReady"]=2005,t[2006]="game.LeaveTable",t["game.LeaveTable"]=2006,t[2007]="game.GetReadyReq",t["game.GetReadyReq"]=2007,t[2008]="game.GetReadyRep",t["game.GetReadyRep"]=2008,t[2009]="game.AskCashOn",t["game.AskCashOn"]=2009,t[2010]="game.AnswerCashOn",t["game.AnswerCashOn"]=2010,t[2011]="game.UseCardNtf",t["game.UseCardNtf"]=2011,t[2012]="game.AskMaster",t["game.AskMaster"]=2012,t[2013]="game.AnswerMaster",t["game.AnswerMaster"]=2013,t[2014]="game.SetScore",t["game.SetScore"]=2014,t[2015]="game.AskPlayCard",t["game.AskPlayCard"]=2015,t[2016]="game.AddCard",t["game.AddCard"]=2016,t[2017]="game.ShowCard",t["game.ShowCard"]=2017,t[2018]="game.GameEnd",t["game.GameEnd"]=2018,t[2019]="game.TalkNtf",t["game.TalkNtf"]=2019,t[2020]="game.RobotSetInfos",t["game.RobotSetInfos"]=2020,t[2021]="game.SetCards",t["game.SetCards"]=2021,t[2022]="game.ReconnectReq",t["game.ReconnectReq"]=2022,t[2023]="game.ReconnectRep",t["game.ReconnectRep"]=2023,t[2024]="game.GiveUpGameReq",t["game.GiveUpGameReq"]=2024,t[2025]="game.GiveUpGameRep",t["game.GiveUpGameRep"]=2025,t[2026]="game.UserOffline",t["game.UserOffline"]=2026,t[2027]="game.UserOnline",t["game.UserOnline"]=2027,t[2028]="game.GameActionReq",t["game.GameActionReq"]=2028,t[2029]="game.GameActionRep",t["game.GameActionRep"]=2029,t[2030]="game.UpdateMasterInfo",t["game.UpdateMasterInfo"]=2030,t[2031]="game.UpdateBetInfo",t["game.UpdateBetInfo"]=2031,t[2032]="game.GameStatusNtf",t["game.GameStatusNtf"]=2032,t[2033]="game.UpdateGameInfo",t["game.UpdateGameInfo"]=2033,t[2034]="game.OperateReq",t["game.OperateReq"]=2034,t[2035]="game.OperateRep",t["game.OperateRep"]=2035,t[2036]="game.UserInfoInGameReq",t["game.UserInfoInGameReq"]=2036,t[2037]="game.UserInfoInGameRep",t["game.UserInfoInGameRep"]=2037,t[2038]="game.AiInfo",t["game.AiInfo"]=2038,t[2039]="game.ServerInfoNtf",t["game.ServerInfoNtf"]=2039,t[2040]="game.SidePotInfo",t["game.SidePotInfo"]=2040,t[2041]="game.OperateRepEX",t["game.OperateRepEX"]=2041,t[2042]="game.ReplenishFreezeGoldReq",t["game.ReplenishFreezeGoldReq"]=2042,t[2043]="game.ReplenishFreezeGoldRep",t["game.ReplenishFreezeGoldRep"]=2043,t[1001]="user.UserInfoRequest",t["user.UserInfoRequest"]=1001,t[1002]="user.UserInfoResonpse",t["user.UserInfoResonpse"]=1002,t[1003]="user.ModifyUserInfoReq",t["user.ModifyUserInfoReq"]=1003,t[1004]="user.ModifyUserInfoRep",t["user.ModifyUserInfoRep"]=1004,t[1005]="user.CheckReconnectReq",t["user.CheckReconnectReq"]=1005,t[1006]="user.CheckReconnectRep",t["user.CheckReconnectRep"]=1006,t[1007]="user.ReconnectTableReq",t["user.ReconnectTableReq"]=1007,t[1008]="user.ReconnectTableRep",t["user.ReconnectTableRep"]=1008,t[1009]="user.QuickJoinRequest",t["user.QuickJoinRequest"]=1009,t[1010]="user.QuickJoinResonpse",t["user.QuickJoinResonpse"]=1010,t[1011]="user.PlayersAmountReq",t["user.PlayersAmountReq"]=1011,t[1012]="user.PlayersAmountRep",t["user.PlayersAmountRep"]=1012,t[1013]="user.MatchOperateReq",t["user.MatchOperateReq"]=1013,t[1014]="user.MatchOperateRep",t["user.MatchOperateRep"]=1014,t[1021]="user.MatchSignupReq",t["user.MatchSignupReq"]=1021,t[1022]="user.MatchSignupRep",t["user.MatchSignupRep"]=1022,t[1023]="user.MatchStartNtf",t["user.MatchStartNtf"]=1023,t[1024]="user.EnterMatchReq",t["user.EnterMatchReq"]=1024,t[1025]="user.EnterMatchRep",t["user.EnterMatchRep"]=1025,t[1026]="user.MatchInfoNtf",t["user.MatchInfoNtf"]=1026,t[1027]="user.QueryFreezeGoldReq",t["user.QueryFreezeGoldReq"]=1027,t[1028]="user.QueryFreezeGoldRep",t["user.QueryFreezeGoldRep"]=1028,t[1038]="user.DaySigninOptReq",t["user.DaySigninOptReq"]=1038,t[1039]="user.DaySigninOptRep",t["user.DaySigninOptRep"]=1039,t[1040]="user.MatchSignupInfoReq",t["user.MatchSignupInfoReq"]=1040,t[1041]="user.MatchSignupInfoRep",t["user.MatchSignupInfoRep"]=1041,t[1042]="user.NotifyKickout",t["user.NotifyKickout"]=1042,t[1046]="user.BagInfoReq",t["user.BagInfoReq"]=1046,t[1047]="user.BagInfoRep",t["user.BagInfoRep"]=1047,t[1048]="user.GiveupMatchReq",t["user.GiveupMatchReq"]=1048,t[1049]="user.GiveupMatchRep",t["user.GiveupMatchRep"]=1049,t[1050]="user.AlmsReq",t["user.AlmsReq"]=1050,t[1051]="user.AlmsRep",t["user.AlmsRep"]=1051,t[1052]="user.RechargeResultNotify",t["user.RechargeResultNotify"]=1052,t[1055]="user.Pay2chatReq",t["user.Pay2chatReq"]=1055,t[1056]="user.Pay2chatRep",t["user.Pay2chatRep"]=1056,t[1061]="user.MailReq",t["user.MailReq"]=1061,t[1062]="user.MailDetail",t["user.MailDetail"]=1062,t[1063]="user.MailListRep",t["user.MailListRep"]=1063,t[1064]="user.MailModifyRep",t["user.MailModifyRep"]=1064,t[1065]="user.MailGetRewardRep",t["user.MailGetRewardRep"]=1065,t[1066]="user.MailUnreadRep",t["user.MailUnreadRep"]=1066,t[1073]="user.CreatePersonalGameReq",t["user.CreatePersonalGameReq"]=1073,t[1074]="user.CreatePersonalGameRep",t["user.CreatePersonalGameRep"]=1074,t[1075]="user.JoinPGameReq",t["user.JoinPGameReq"]=1075,t[1076]="user.JoinPGameRep",t["user.JoinPGameRep"]=1076,t[1077]="user.StartPGameReq",t["user.StartPGameReq"]=1077,t[1078]="user.StartPGameRep",t["user.StartPGameRep"]=1078,t[1079]="user.QueryRoomInfoReq",t["user.QueryRoomInfoReq"]=1079,t[1080]="user.QueryRoomInfoRep",t["user.QueryRoomInfoRep"]=1080,t[1081]="user.QuitPGameReq",t["user.QuitPGameReq"]=1081,t[1082]="user.QuitRoomRep",t["user.QuitRoomRep"]=1082,t[1083]="user.GameDissolve",t["user.GameDissolve"]=1083,t[1084]="user.ReconnectPGameReq",t["user.ReconnectPGameReq"]=1084,t[1085]="user.ReconnectPGameRep",t["user.ReconnectPGameRep"]=1085,t[1090]="user.RedcoinExchangeGoodsReq",t["user.RedcoinExchangeGoodsReq"]=1090,t[1091]="user.RedcoinExchangeGoodsRep",t["user.RedcoinExchangeGoodsRep"]=1091,t[1092]="user.LotteryRedcoinReq",t["user.LotteryRedcoinReq"]=1092,t[1093]="user.LotteryRedcoinRep",t["user.LotteryRedcoinRep"]=1093,t[1094]="user.RedcoinRankingListReq",t["user.RedcoinRankingListReq"]=1094,t[1095]="user.RedcoinRankingListRep",t["user.RedcoinRankingListRep"]=1095,t[1096]="user.FreshManRedcoinLotteryChanceGot",t["user.FreshManRedcoinLotteryChanceGot"]=1096,t[1099]="user.DissolveGameReq",t["user.DissolveGameReq"]=1099,t[1100]="user.DissolveGameRep",t["user.DissolveGameRep"]=1100,t[1101]="user.QueryRoomPlayingReq",t["user.QueryRoomPlayingReq"]=1101,t[1102]="user.QueryRoomPlayingRep",t["user.QueryRoomPlayingRep"]=1102,t[1107]="user.GetFreshManRewardReq",t["user.GetFreshManRewardReq"]=1107,t[1108]="user.GetFreshManRewardRep",t["user.GetFreshManRewardRep"]=1108,t[1109]="user.GetCardsRecorderRewardReq",t["user.GetCardsRecorderRewardReq"]=1109,t[1110]="user.GetDayTaskRewardReq",t["user.GetDayTaskRewardReq"]=1110,t[1111]="user.GetDayTaskRewardRep",t["user.GetDayTaskRewardRep"]=1111,t[1112]="user.GetFirstRechargeRewardReq",t["user.GetFirstRechargeRewardReq"]=1112,t[1113]="user.GetFirstRechargeRewardRep",t["user.GetFirstRechargeRewardRep"]=1113,t[1114]="user.GetRewardReq",t["user.GetRewardReq"]=1114,t[1115]="user.GetRewardRep",t["user.GetRewardRep"]=1115,t[1116]="user.GetActivityInfoReq",t["user.GetActivityInfoReq"]=1116,t[1117]="user.GetActivityInfoRep",t["user.GetActivityInfoRep"]=1117,t[1118]="user.OperateReq",t["user.OperateReq"]=1118,t[1119]="user.OperateRep",t["user.OperateRep"]=1119,t[1120]="user.DiamondGameReq",t["user.DiamondGameReq"]=1120,t[1121]="user.DiamondGameRep",t["user.DiamondGameRep"]=1121,t[1122]="user.QuitWaitingQueueReq",t["user.QuitWaitingQueueReq"]=1122,t},t}();__reflect(ProtoIDs.prototype,"ProtoIDs");var Reportor=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.start=function(){window.onerror=this.onWindowError},t.prototype.stop=function(){window.onerror=null},t.prototype.onWindowError=function(t,e,n,i,o){var a=!0;if(t.indexOf("gif")>=0)return a;var r=egret.Capabilities.os,s={PF:alien.Native.instance.platformId,OS:r,PID:1,MSG:e+"["+n+","+i+"]\n"+t};return o&&(s.MSG+=" stack:"+o.stack),GameConfig.gameId&&(s.RID=GameConfig.gameId),webService.postError(ErrorConfig.REPORT_ERROR,JSON.stringify(s)),a},t.prototype.reportCodeError=function(t){var e=egret.Capabilities.os,n={PF:alien.Native.instance.platformId,OS:e,PID:1,MSG:t};GameConfig.gameId&&(n.RID=GameConfig.gameId),webService.postError(ErrorConfig.REPORT_ERROR,JSON.stringify(n))},t}();__reflect(Reportor.prototype,"Reportor");var version="01101000";alien.Native.instance.isNative&&(version+="iOS"==egret.Capabilities.os?"i":"Android"==egret.Capabilities.os?"a":"n");var alien;!function(t){var e;!function(e){var n=function(){function t(){}return t.prototype.handover=function(t,e,n,i,o){void 0===o&&(o=null),t&&(t.visible=!1,n.removeChild(t)),e.visible=!0,e.alpha=1,n.addChild(e),o&&o()},t}();e.None=n,__reflect(n.prototype,"alien.sceneEffect.None",["alien.sceneEffect.ISceneEffect"]);var i=function(){function t(){}return t.prototype.handover=function(t,e,n,i,o){void 0===o&&(o=null),egret.Tween.get(t).to({alpha:0},500),e.alpha=0,e.visible=!0,n.addChild(e),egret.Tween.get(e).to({alpha:1},500).call(function(){n.removeChild(t),o&&o()})},t}();e.Fade=i,__reflect(i.prototype,"alien.sceneEffect.Fade",["alien.sceneEffect.ISceneEffect"]);var o=function(){function t(){}return t.prototype.handover=function(t,e,n,i,o){function a(){egret.Tween.get(e).to({alpha:1},500).call(function(){o&&o()},this)}void 0===o&&(o=null),e.alpha=0,e.visible=!0,n.addChild(e),t?egret.Tween.get(t).to({alpha:0},500).call(function(){n.removeChild(t),a()},this):a()},t}();e.FadeBlack=o,__reflect(o.prototype,"alien.sceneEffect.FadeBlack",["alien.sceneEffect.ISceneEffect"]);var a=function(){function e(){}return e.prototype.handover=function(n,i,o,a,r){void 0===r&&(r=null);var s=a.duration||500,h=[[0/0,-t.StageProxy.height],[t.StageProxy.width,0/0],[0/0,t.StageProxy.height],[-t.StageProxy.width,0/0]],c=h[e.transDirection(a.direction)],l={x:isNaN(c[0])?n.x:c[0],y:0==c[1]?n.y:c[1]};egret.Tween.get(n).to(l,s,egret.Ease.cubicOut),h=[[0/0,t.StageProxy.height],[-t.StageProxy.width,0/0],[0/0,-t.StageProxy.height],[t.StageProxy.width,0/0]],c=h[e.transDirection(a.direction)],l={x:0,y:0},i.x=c[0],i.y=c[1],i.alpha=1,i.visible=!0,o.addChild(i),egret.Tween.get(i).to(l,s,egret.Ease.cubicOut).call(function(){o.removeChild(n),r&&r()})},e.transDirection=function(t){var e;switch(t){case"up":e=0;break;case"right":e=1;break;case"bottom":e=2;break;case"left":e=3}return e},e}();e.Flew=a,__reflect(a.prototype,"alien.sceneEffect.Flew",["alien.sceneEffect.ISceneEffect"]);var r=function(){function e(){}return e.prototype.handover=function(e,n,i,o,a){e.cacheAsBitmap=n.cacheAsBitmap=!0,n.alpha=1,n.visible=!0,i.addChild(n);var r=t.StageProxy;o=o||{};var s=this._pos=o.pos||{x:r.width/2,y:r.height/2},h=n.mask=this._mask=new egret.Shape;
h.x=s.x,h.y=s.y,t.StageProxy.root.addChild(h);var c=s.x/r.width<.5?r.width-s.x:s.x,l=s.y/r.height<.5?r.height-s.y:s.y,u=Math.sqrt(c*c+l*l)+20;this.r=0,egret.Tween.get(this).to({r:u},o.duration||1e3,egret.Ease.quartOut).call(function(){e.cacheAsBitmap=n.cacheAsBitmap=!1,i.removeChild(e),n.mask=null,t.StageProxy.root.removeChild(h),a&&a()})},Object.defineProperty(e.prototype,"r",{get:function(){return this._r},set:function(t){this._r=t;var e=this._mask.graphics;e.beginFill(16711680,.5),e.drawCircle(0,0,this._r),e.endFill()},enumerable:!0,configurable:!0}),e}();e.Material=r,__reflect(r.prototype,"alien.sceneEffect.Material",["alien.sceneEffect.ISceneEffect"])}(e=t.sceneEffect||(t.sceneEffect={}))}(alien||(alien={}));var alien;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._autoPlay=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},Object.defineProperty(e.prototype,"resName",{get:function(){return this._resName},set:function(t){this._resName!=t&&this.setResName(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aniName",{get:function(){return this._aniName},set:function(t){this._aniName!=t&&this.setAniName(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoPlay",{get:function(){return this._autoPlay},set:function(t){this._autoPlay=t},enumerable:!0,configurable:!0}),e.prototype.setResName=function(t){this._resName=t,this._resName?this._mcDataFactory=new egret.MovieClipDataFactory(RES.getRes(this._resName+"_json"),RES.getRes(this._resName+"_png")):this._mcDataFactory&&(this._mcDataFactory.clearCache(),this._mcDataFactory=null),this.setAniName(this._aniName)},e.prototype.setAniName=function(t){this._aniName=t,this._aniName&&this._mcDataFactory&&(this.movieClip=new egret.MovieClip(this._mcDataFactory.generateMovieClipData(this._aniName)),this.removeChildren(),this.addChild(this.movieClip),this._autoPlay&&this.movieClip.play())},e}(eui.Group);t.MovieClip=e,__reflect(e.prototype,"alien.MovieClip")}(alien||(alien={}));var Utils=function(){function t(){}return t.pid2poker=function(t){var e=Math.floor(t/10);11>=e?e+=2:e=this.mapping[e-12];var n,i=t%10;return n=14==e?"black":15==e?"red":t%2==0?"red":"black",{num:e,sign:i,signColor:n}},t.recycleCards=function(t,e){void 0===e&&(e=null);var n;if(e)for(var i=0,o=t.numChildren;o>i;i++)n=t.getChildAt(i),e(n);else for(;t.numChildren>0;)n=t.removeChildAt(0),Card.recycle(n)},t.order=function(t){t.sort(function(t,e){return e-t})},t.currencyRatio=function(t,e){if(void 0===e&&(e=!1),null===t)return"";var n="string"==typeof t?parseInt(t):t;n/=GameConfig.currencyRatio;var i=n.toString(),o=i.indexOf(".");return e&&(0>o?i+=".00":i.length-i.indexOf(".")==2&&(i+="0")),i},t.exchangeRatio=function(t,e){if(void 0===e&&(e=!1),null===t)return"";var n="string"==typeof t?parseInt(t):t;n/=GameConfig.exchangeRatio;var i=n.toString(),o=i.indexOf(".");return e&&(0>o?i+=".00":i.length-i.indexOf(".")==2&&(i+="0")),i},t.roomScoreFormat=function(t){var e=Number(t);if(e>9999){e=Math.floor(e/1e4);var n=Math.floor((t-1e4*e)/1e3);return n>0?e+""+n:e+""}return e.toString()},t.countDown=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=1e3);var o=t,a=Math.floor(t/i);return alien.repeat(function(){o-=i,e(o/i)},i,a,n,!0)},t.goodsListToString=function(t,e){void 0===e&&(e=0);for(var n=[],i=0==e?t.length:Math.min(t.length,e),o=0;i>o;o++){var a=t[o];n.push(GoodsManager.instance.getGoodsById(a.id).name+"x"+a.count)}return n.join(" ")},t.parseGoodsString=function(t){var e=[];if(t){var n=t.split("|");n.forEach(function(t){var n=t.split(":"),i=parseInt(n[0]),o=parseInt(n[1]);1==i&&(o/=100),e.push({id:i,count:o})})}return e},t.regNickname=function(t){return!t.match(/^[0-9a-zA-Z\u4e00-\u9fa5_]*$/)},t.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},t.getTimeStampDiff=function(t,e,n){var i=t,o=e;n=n.toLowerCase();var a=new Date(i),r=new Date(o),s=1;switch(n){case"second":s=1e3;break;case"minute":s=6e4;break;case"hour":s=36e5;break;case"day":s=864e5}return(r.getTime()-a.getTime())/s},t.isInTimeSection=function(t,e,n){var i=new Date(Date.parse(t.replace(/-/g,"/"))).getTime(),o=new Date(Date.parse(e.replace(/-/g,"/"))).getTime();return n>=i&&o>=n?!0:!1},t.isTwoStampSameDay=function(t,e){var n=new Date(t),i=new Date(e);return n.getFullYear()==i.getFullYear()&&n.getMonth()==i.getMonth()&&n.getDay()==i.getDay()?!0:!1},t.setSensitiveWord=function(e){t._sensitive=e},t.getSensitiveWord=function(){return t._sensitive},t.mapping=[1,2,14,15],t}();__reflect(Utils.prototype,"Utils");var CardsHint=function(){function t(){}return t.getCardLogicValue=function(t){return Math.floor(t/10)},t.getCardsHash=function(e){for(var n,i={},o=0;o<e.length;++o)n=t.getCardLogicValue(e[o]),i[n]?i[n].push(e[o]):i[n]=[e[o]];return i},t.getMinSingle=function(t,e,n){t.sort(function(t,e){return t-e});for(var i,o=[],a=0;a<t.length;++a){i=!0;for(var r=0;r<n.length;++r)if(n[r]==t[a]){i=!1;break}if(i&&o.length<e&&(o.push(t[a]),o.length>=e))return o}},t.getMinDouble=function(t,e,n){var i,o=this.getCardsHash(t),a=[];for(var r in o)if(!(o[r].length<2)){i=!0;for(var s=0;s<o[r].length;++s){for(var h=0;h<n.length;++h)if(n[h]==o[r][s]){i=!1;break}if(!i)break}if(i&&a.length<e&&(a=a.concat(o[r]),a.length>=e))return a}},t.getAllFourCard=function(t,e){void 0===e&&(e=0);var n,i=this.getCardsHash(t);for(var o in i)if(4==i[o].length){if(8>e){var a=this.getMinDouble(t,4,i[o]);if(a&&4==a.length){var r=i[o].concat(a);n={node:CardsType.GetType(r),cards:r},e=r.length}}if(6>e){var a=this.getMinSingle(t,2,i[o]);if(a&&2==a.length){var r=i[o].concat(a);n={node:CardsType.GetType(r),cards:r},e=r.length}}4>e&&(n={node:CardsType.GetType(i[o]),cards:i[o]},e=4)}return n},t.getAllLineCard=function(t,e){if(void 0===e&&(e=0),!(t.length<5)){for(var n,i,o=this.getCardsHash(t),a=1;9>a;++a)if(o[a]){i=[o[a][0]];for(var r=a+1;13>r;++r){if(!o[r]){i.length>4&&i.length>e&&(n={node:CardsType.GetType(i),cards:i},e=i.length);break}i.push(o[r][0]),12==r&&i.length>4&&i.length>e&&(n={node:CardsType.GetType(i),cards:i},e=i.length)}}return n}},t.getAllDoubleLineCard=function(t,e){if(void 0===e&&(e=0),!(t.length<6)){for(var n,i,o=this.getCardsHash(t),a=1;11>a;++a)if(o[a]&&!(o[a].length<2)){i=[o[a][0],o[a][1]];for(var r=a+1;13>r;++r){if(!(o[r]&&o[r].length>1)){i.length>5&&i.length>e&&(n={node:CardsType.GetType(i),cards:i},e=i.length);break}i.push(o[r][0]),i.push(o[r][1]),12==r&&i.length>5&&i.length>e&&(n={node:CardsType.GetType(i),cards:i},e=i.length)}}return n}},t.getAllCardsPossible=function(e){for(var n,i={},o={},a=0;a<e.length;++a)n=t.getCardLogicValue(e[a]),i[n]?i[n]=i[n]+1:i[n]=1;for(var r in i)o[i[r]]=(o[i[r]]||0)+1;var s,h=0;if(o[3]>0||o[4]>0){var c=this.getAllPlaneCard(e,h);if(c&&(s=c,h=c.cards.length),o[4]>0){var l=this.getAllFourCard(e,h);l&&(s=l,h=l.cards.length)}}var u=this.getAllLineCard(e,h);u&&(s=u,h=u.cards.length);var p=this.getAllDoubleLineCard(e,h);return p&&(s=p,h=p.cards.length),s},t.getAllPlaneCard=function(t,e){if(void 0===e&&(e=0),!(t.length<3)){var n,i,o,a,r=this.getCardsHash(t);for(var s in r)if(o=parseInt(s),i=r[s],i.length>=3){n=[i[0],i[1],i[2]];for(var h=o+1;12>h&&(r[h]&&r[h].length>=3);++h){for(var c=0;3>c;++c)n.push(r[h][c]);if(n.length>=6){if(e<n.length+n.length/3*2){var l=this.getMinDouble(t,n.length/3*2,n);if(l&&l.length==n.length/3*2){var u=n.concat(l);a={node:CardsType.GetType(u),cards:u},e=u.length}}if(e<n.length+n.length/3){var l=this.getMinSingle(t,n.length/3,n);if(l&&l.length==n.length/3){var u=n.concat(l);a={node:CardsType.GetType(u),cards:u},e=u.length}}e<n.length&&(a={node:CardsType.GetType(n),cards:n},e=n.length)}}if(e<n.length+n.length/3*2){var l=this.getMinDouble(t,n.length/3*2,n);if(l&&l.length==n.length/3*2){var u=n.concat(l);a={node:CardsType.GetType(u),cards:u},e=u.length}}if(e<n.length+n.length/3){var l=this.getMinSingle(t,n.length/3,n);if(l&&l.length==n.length/3){var u=n.concat(l);a={node:CardsType.GetType(u),cards:u},e=u.length}}e<n.length&&(a={node:CardsType.GetType(n),cards:n},e=n.length)}return a}},t.getMaxAmountCards=function(e){if(e&&!(e.length<1)){var n=CardsType.GetType(e);return n.ct>0?e:(n=t.getAllCardsPossible(e),n?n.cards:e)}},t.getFitCards=function(t,e,n){if(void 0===n&&(n=[]),!(!t||t.length<1||e>=t.length||t.length<n.length)){var i={ct:0,kv:0};if(!(n.length>0)||(i=CardsType.GetType(n),i&&i.ct)){var o=(this.getCardsHash(t),CardsType.GetType(t));if(n.length>0&&2!=i.ct&&4!=i.ct&&5!=i.ct&&6!=i.ct||i.kv>o.kv)return 2==o.ct||1==o.ct?t:void 0;if(!(1==i.ct||2==i.ct&&o.kv<=i.kv||o.kv<=i.kv&&2!=o.ct&&1!=o.ct)){var a=[];if(0==n.length)for(var r=0;e>=r;++r)a.push(t[r]);else if(e+1>n.length&&(2==o.ct||1==o.ct))a=t;else for(var r=0;r<n.length;++r)a.push(t[r]);return a}}}},t.getHumanVisible=function(t){var e=this.getCardLogicValue(t);e+=2;var n;t%10==0?n="":t%10==1?n="":t%10==2?n="":t%10==3&&(n="");var i="";return 11>e?i=e+n:11==e?i="J"+n:12==e?i="Q"+n:13==e?i="K"+n:14==e?i="A"+n:15==e?i="2"+n:16==e?i="JokerS":17==e&&(i="JokerB"),i},t.printCards=function(t,e){if(void 0===e&&(e=""),t){for(var n="",i=0;i<t.length;++i)n=n+this.getHumanVisible(t[i])+" ";console.log(e),console.log(n)}},t}();__reflect(CardsHint.prototype,"CardsHint");var BUYAO=0,SHUANGWANG=1,ZHADAN=2,DAN=4,DUIZI=5,SANZHANG=6,SANDAIYI=7,SANDAIYIDUI=13,SIDAIER=8,SIDAIERDUI=14,FEIJI=9,DANSHUN=10,SHUANGSHUN=11,SANSHUN=12,CardsType=function(){function t(){}return t.CheckType=function(t,e){var n=this.GetType(t);if(n.ct==SHUANGWANG)return!0;if(null==e||e.length<1)return 0!=n.ct;var i=this.GetType(e);if(n.ct==i.ct){if(t.length==e.length)return n.kv>i.kv}else if(i.ct!=SHUANGWANG&&i.ct!=ZHADAN&&n.ct==ZHADAN)return!0;return!1},t.GetCards2=function(t,e){var n=[],i=[],o=[],a=[],r=this.GetType(t,n,i,o,a),s=r.ct,h=s;if(0==s)return null;for(var c,l=[s,n,i,o],u=this.m_getCards(t,s,n,i,o,a,e,h),p=[],d=[],_=[];null!=u&&u.hasOwnProperty("chai")&&u.hasOwnProperty("cards")&&u.hasOwnProperty("nums");){c=u.cards,0==u.chai?p.push(c):d.push(c),_.push(u.nums),n=[],i=[],o=[],a=[];var r=this.GetType(c,n,i,o,a);s=r.ct,u=this.m_getCards(c,s,n,i,o,a,e,h)}var g=p.concat(d);return g.length>0?(l.push(g),l.push(_),l):null},t.m_getCards=function(t,e,n,i,o,a,r,s){if(null==r||r.length<1)return null;if(e==SHUANGWANG||0==e)return null;var h,c,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;h<r.length;++h){var u=Math.floor(r[h]/10);l[u]++}var p=[],d=[],_=[],g=[];for(h=0;h<l.length;++h)1==l[h]?p.push(h):2==l[h]?d.push(h):3==l[h]?_.push(h):4==l[h]&&g.push(h);if(e==DAN)for(h=n[0]+1;h<l.length;++h){if(1==l[h])return(14==h||15==h)&&l[14]>0&&l[15]>0?{chai:!0,cards:this.GetCardsByNum([h],r),nums:[h]}:{chai:!1,cards:this.GetCardsByNum([h],r),nums:[h]};if(l[h]>1)return{chai:!0,cards:this.GetCardsByNum([h],r),nums:[h]}}if(e==DUIZI)for(h=i[0]+1;h<l.length;++h){if(2==l[h])return{chai:!1,cards:this.GetCardsByNum([h,h],r),nums:[h,h]};if(l[h]>2)return{chai:!0,cards:this.GetCardsByNum([h,h],r),nums:[h,h]}}if(e==SANZHANG)for(h=o[0]+1;h<l.length;++h){if(3==l[h])return{chai:!1,cards:this.GetCardsByNum([h,h,h],r),nums:[h,h,h]};if(l[h]>3)return{chai:!0,cards:this.GetCardsByNum([h,h,h],r),nums:[h,h,h]}}var f;if(e==SANDAIYI)for(h=o[0]+1;h<l.length;++h)if(l[h]>2){if(f=[h,h,h],p.length>0)f.push(p[0]);else for(c=1;c<l.length;++c)if(l[c]>0&&c!=h){f.push(c);break}if(4==f.length)return 3==l[h]?{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}:{chai:!0,cards:this.GetCardsByNum(f,r),nums:f};break}if(e==SANDAIYIDUI)for(h=o[0]+1;h<l.length;++h)if(l[h]>2){if(f=[h,h,h],d.length>0)f.push(d[0],d[0]);else for(c=1;c<l.length;++c)if(l[c]>1&&c!=h){f.push(c,c);break}if(5==f.length)return 3==l[h]?{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}:{chai:!0,cards:this.GetCardsByNum(f,r),nums:f};break}if(e==SIDAIER&&g.length>0)for(h=0;h<g.length;++h)if(g[h]>a[0]){for(f=[g[h],g[h],g[h],g[h]],c=0;c<p.length&&f.length<6;++c)f.push(p[c]);if(f.length<6)for(c=1;c<l.length&&f.length<6;++c)l[c]>0&&f.indexOf(c)<0&&f.push(c);if(6==f.length)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f};break}if(e==SIDAIERDUI&&g.length>0)for(h=0;h<g.length;++h)if(g[h]>a[0]){for(f=[g[h],g[h],g[h],g[h]],c=0;c<d.length&&f.length<8;++c)f.push(d[c],d[c]);if(f.length<8)for(c=1;c<l.length&&f.length<8;++c)l[c]>1&&f.indexOf(c)<0&&f.push(c,c);if(8==f.length)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f};break}var m,v;if(e==FEIJI)for(m=o.length,h=o[0]+1;h<l.length-m+1;++h){for(v=!0,f=[],c=0;m>c;++c)if(f.push(h+c,h+c,h+c),l[h+c]<3||h+c==13||h+c==14||h+c==15){v=!1;break}if(v){if(n.length>0){for(c=0;c<p.length&&f.length<t.length;++c)f.push(p[c]);if(f.length<t.length)for(c=1;c<l.length&&f.length<t.length;++c)if(l[c]>0&&f.indexOf(c)<0)for(var y=0;y<l[c]&&f.length<t.length;++y)f.push(c);if(f.length==t.length)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}}else if(i.length>0){for(c=0;c<d.length&&f.length<t.length;++c)f.push(d[c],d[c]);if(f.length<t.length)for(c=0;c<l.length&&f.length<t.length;++c)l[c]>1&&f.indexOf(c)<0&&f.push(c,c);if(f.length==t.length)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}}break}}if(e==DANSHUN)for(m=n.length,h=n[0]+1;h<l.length-m+1;++h){for(v=!0,f=[],c=0;m>c;++c)if(f.push(h+c),l[h+c]<1||h+c==13||h+c==14||h+c==15){v=!1;break}if(v)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}}if(e==SHUANGSHUN)for(m=i.length,h=i[0]+1;h<l.length-m+1;++h){for(v=!0,f=[],c=0;m>c;++c)if(f.push(h+c,h+c),l[h+c]<2||h+c==13||h+c==14||h+c==15){v=!1;break}if(v)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}}if(e==SANSHUN)for(m=o.length,h=o[0]+1;h<l.length-m+1;++h){for(v=!0,f=[],c=0;m>c;++c)if(f.push(h+c,h+c,h+c),l[h+c]<3||h+c==13||h+c==14||h+c==15){v=!1;break}if(v)return{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}}if(e==ZHADAN){if(g.length>0)for(h=0;h<g.length;++h)if(g[h]>a[0])return f=[g[h],g[h],g[h],g[h]],e==s?{chai:!1,cards:this.GetCardsByNum(f,r),nums:f}:{chai:!0,cards:this.GetCardsByNum(f,r),nums:f}}else if(g.length>0)return f=[g[0],g[0],g[0],g[0]],{chai:!0,cards:this.GetCardsByNum(f,r),nums:f};return l[14]>0&&l[15]>0?{chai:!0,cards:this.GetCardsByNum([14,15],r),nums:[14,15]}:null},t.GetCardsByNum=function(t,e){for(var n=[],i=e.concat(),o=0;o<t.length;++o)for(var a=0;a<i.length;++a){var r=Math.floor(i[a]/10);if(r==t[o]){n.push(i[a]),i.splice(a,1);break}}return n},t.CheckShun=function(t){var e,n,i=[0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;++e){var o=Math.floor(t[e]/10);o<i.length&&i[o]++}var a;e=0;for(var r=[];e<i.length;){if(a=[],i[e]>2)for(a.push(e,e,e),n=e+1;n<i.length;++n){if(e=n,!(i[n]>2)){a.length>r.length&&(r=a);break}a.push(n,n,n)}++e}a&&a.length>r.length&&(r=a),(!r||r.length<6)&&(r=null),e=0;for(var s=[];e<i.length;){if(a=[],i[e]>1)for(a.push(e,e),n=e+1;n<i.length;++n){if(e=n,!(i[n]>1)){a.length>s.length&&(s=a);break}a.push(n,n)}++e}a&&a.length>s.length&&(s=a),(!s||s.length<6)&&(s=null),e=0;for(var h=[];e<i.length;){if(a=[],i[e]>0)for(a.push(e),n=e+1;n<i.length;++n){if(e=n,!(i[n]>0)){a.length>h.length&&(h=a);break}a.push(n)}++e}a&&a.length>h.length&&(h=a),(!h||h.length<5)&&(h=null);var c=r;return s&&(!c||s[0]<c[0])&&(c=s),h&&(!c||h[0]<c[0])&&(c=h),c&&c.length>0?this.GetCardsByNum(c,t):null},t.CheckShun2=function(t){var e,n=[0,0,0,0,0,0,0,0,0,0,0,0,0],i=Math.floor(t[0]/10),o=Math.floor(t[t.length-1]/10);for(e=0;e<t.length;++e){var a=Math.floor(t[e]/10);a<n.length&&n[a]++}var r=[];if(n[o]>2&&n[i]>2){for(r.push(o,o,o),e=o+1;i>e;++e){if(!(n[e]>2)){r=[];break}r.push(e,e,e)}r.length&&r.push(i,i,i)}if(!r.length&&n[o]>1&&n[i]>1&&i-o>1){for(r.push(o,o),e=o+1;i>e;++e){if(!(n[e]>1)){r=[];break}r.push(e,e)}r.length&&r.push(i,i)}if(!r.length&&n[o]>0&&n[i]>0&&i-o>3){for(r.push(o),e=o+1;i>e;++e){if(!(n[e]>0)){r=[];break}r.push(e)}r.length&&r.push(i)}return r.length?this.GetCardsByNum(r,t):null},t.is_shun=function(t,e){if(void 0===e&&(e=!0),!t||t.length<1)return{result:!1};for(var n=!1,i=!1,o=0;o<t.length-1;++o)if(t[o]+1!=t[o+1]||13==t[o+1]||14==t[o+1]||15==t[o+1]){if(e)return{result:!1};if(!(t.length>2))return{result:!1};if(0==o)i=!0;else if(o==t.length-2){if(i)return{result:!1};n=!0}}return!e&&n?{result:!0,kv:t[t.length-2]}:{result:!0,kv:t[t.length-1]}},t.GetType=function(t,e,n,i,o){if(void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),null==t||t.length<1)return{ct:0,kv:0};var a,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=0;a<t.length;++a){var s=Math.floor(t[a]/10);r[s]++}var h=[],c=[],l=[],u=[],p=[];for(a=0;a<r.length;++a)1==r[a]?(h.push(a),e&&e.push(a)):2==r[a]?(c.push(a),n&&n.push(a)):3==r[a]?(l.push(a),u.push(a),i&&i.push(a)):4==r[a]&&(p.push(a),u.push(a),o&&o.push(a));if(1==t.length)return{ct:DAN,kv:h[0]};if(2==t.length&&t.indexOf(140)>=0&&t.indexOf(150)>=0)return{ct:SHUANGWANG,kv:15};if(1==p.length&&4==t.length)return{ct:ZHADAN,kv:p[0]};if(1==c.length&&2==t.length)return{ct:DUIZI,kv:c[0]};if(1==l.length&&3==t.length)return{ct:SANZHANG,kv:l[0]};if(1==l.length&&4==t.length)return{ct:SANDAIYI,kv:l[0]};if(1==l.length&&1==c.length&&5==t.length)return{ct:SANDAIYIDUI,kv:l[0]};if(1==p.length&&6==t.length)return{ct:SIDAIER,kv:p[0]};if(8==t.length){if(1==p.length&&2==c.length)return{ct:SIDAIERDUI,kv:p[0]};if(2==p.length)return{ct:SIDAIERDUI,kv:p[1]}}if(u.length>1){var d=this.is_shun(u,!1);if(d.result&&t.length==4*(u.length-1))return{ct:FEIJI,kv:d.kv};if(d=this.is_shun(u),d.result&&t.length==4*u.length)return{ct:FEIJI,kv:d.kv}}if(l.length>1){var d=this.is_shun(l);if(d.result){if(t.length==5*l.length&&l.length==c.length+2*p.length)return{ct:FEIJI,kv:d.kv};if(3*l.length==t.length)return{ct:SANSHUN,kv:d.kv}}}if(h.length>4&&t.length==h.length){var d=this.is_shun(h);if(d.result)return{ct:DANSHUN,kv:d.kv}}if(c.length>2&&2*c.length==t.length){var d=this.is_shun(c);if(d.result)return{ct:SHUANGSHUN,kv:d.kv}}return{ct:0,kv:0}},t.getMaxNumType=function(t){var e=[];return e},t.prototype.CardsType=function(){},t}();__reflect(CardsType.prototype,"CardsType");var DDZCardGroup=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.interact=!1,e._cardsSelect=[],e._pokerIds=[],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.touchEnabled=!1,this.interact&&(this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),alien.StageProxy.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this))},e.prototype.onTouchTap=function(t){},e.prototype.onTouchBegin=function(t){this._touchBeginIndex=this.getChildIndex(t.target),this._touchBegin=!0,this.rollOverCardIds(this.getChildIndex(t.target),this._touchBeginIndex)},e.prototype.onTouchMove=function(t){this._touchBegin&&this.rollOverCardIds(this.getChildIndex(t.target),this._touchBeginIndex)},e.prototype.onTouchEnd=function(t){if(this._touchBegin){for(var e=[],n=this._selectFrom;n<=this._selectTo;n++){var i=this.getChildAt(n);i&&(i.rollOver=!1,e.push(i))}this.selectCards(e)}this._touchBegin=!1},e.prototype.initData=function(){this._cardsSelect.splice(0)},e.prototype.sendCardsToGroup=function(e,n,i){void 0===i&&(i=!0),t.prototype.sendCardsToGroup.call(this,e,n,i),this._touchBegin=!1},e.prototype.selectCards=function(t){for(var e,n=this,i=t.map(function(t){return t.pokerId}),o=!0,a=0;a<t.length;++a)t[a].select||(o=!1);if(o)return alien.Utils.enumChildren(this,function(t,e){i.indexOf(t.pokerId)>=0&&n.selectCard(t,!t.select)}),void this.checkCanUse();var r=[],s=[];if(alien.Utils.enumChildren(this,function(t,e){t.select&&s.indexOf(t.pokerId)<0&&(s.push(t.pokerId),r.push(t.pokerId))}),i.forEach(function(t){s.indexOf(t)<0&&s.push(t)}),s.sort(function(t,e){return e-t}),this._targetCards&&0!=this._targetCards.length)1==t.length||(e=CardsType.CheckShun(i));else if(2==s.length){var h=Math.floor(s[0]/10),c=Math.floor(s[1]/10);if(h!=c){var l=[];alien.Utils.enumChildren(this,function(t,e){var n=Math.floor(t.pokerId/10);(n==h||n==c||t.pokerId<s[0]&&t.pokerId>s[1])&&l.push(t.pokerId)}),e=CardsType.CheckShun2(l)}}else r.length<1&&(e=CardsHint.getMaxAmountCards(i));e?alien.Utils.enumChildren(this,function(t,i){n.selectCard(t,e.indexOf(t.pokerId)>=0)}):alien.Utils.enumChildren(this,function(t,e){i.indexOf(t.pokerId)>=0&&n.selectCard(t,!t.select)}),this.checkCanUse()},e.prototype.selectCard=function(t,e){if(!t.select&&e)this._cardsSelect.push(t.pokerId);else if(t.select&&!e){var n=this._cardsSelect.indexOf(t.pokerId);n>=0&&this._cardsSelect.splice(n,1)}t.select=e},e.prototype.getSelectedCards=function(){return this._cardsSelect},e.prototype.cancelSelect=function(){alien.Utils.enumChildren(this,function(t,e){t.sending||(t.select=t.rollOver=!1)}),this._cardsSelect.splice(0),this.checkCanUse()},e.prototype._debugCardValues=function(t){for(var e=["3","4","5","6","7","8","9","10","J","Q","k","A","2","X","D"],n=0,i=[],o=0;o<t.length;++o)n=t[o]<100?parseInt((""+t[o]).substr(0,1)):parseInt((""+t[o]).substr(0,2)),i.push(e[n-1]);return i},e.prototype.checkType=function(t){this._targetCards=t;var e=CardsType.GetCards2(t,this._pokerIds.concat());return e?(this._arrUseHelp=e[4],this._helpIndex=0,!0):(this._arrUseHelp=null,!1)},e.prototype.checkCanUse=function(t){void 0===t&&(t=!1);var e=t||CardsType.CheckType(this._cardsSelect,this._targetCards);alien.Dispatcher.dispatch(EventNames.SELECT_CARDS,{canUse:e,count:this._cardsSelect.length})},e.prototype.help=function(){var t,e=this;return this._arrUseHelp&&(this._helpIndex>=this._arrUseHelp.length&&(this._helpIndex=0),t=this._arrUseHelp[this._helpIndex]),this._helpIndex++,t?(alien.Utils.enumChildren(this,function(n,i){e.selectCard(n,t.indexOf(n.pokerId)>=0)}),this.checkCanUse(!0),!0):!1},e.prototype.rollOverCardIds=function(t,e){if(!(0>t||0>e)){var n=this._selectFrom=Math.min(t,e),i=this._selectTo=Math.max(t,e);alien.Utils.enumChildren(this,function(t,e){t.rollOver=e>=n&&i>=e})}},e.prototype.cleancards=function(){t.prototype.clean.call(this)},e.prototype.addCards=function(e,n){void 0===n&&(n=!0);var i=t.prototype.addCards.call(this,e,n);return this.updatePokersIds(),i},e.prototype.useCards=function(t,e,n){var i=this;void 0===n&&(n=!0);var o=[];return.24==this.scale?t.forEach(function(t){var e=Card.create({pid:t});i.addChild(e),alien.Utils.injectProp(e,{x:0,y:0,alpha:1,scaleX:.24,scaleY:.24}),o.push(e)}):alien.Utils.enumChildren(this,function(e,n){t.indexOf(e.pokerId)>=0&&o.push(e)}),this.sendCardsToGroup(e,o,n),this.updatePokersIds(),this.cardCount},e.prototype.updatePokersIds=function(){var t=this;this._pokerIds.splice(0),alien.Utils.enumChildren(this,function(e){e.sending||t._pokerIds.push(e.pokerId)})},e.prototype.adjustCardsEnd=function(){t.prototype.adjustCardsEnd.call(this),this.updateMasterFlag()},Object.defineProperty(e.prototype,"isMaster",{set:function(t){this._isMaster!=t&&(this._isMaster=t,this.updateMasterFlag())},enumerable:!0,configurable:!0}),e.prototype.updateMasterFlag=function(){for(var t,e=this.numChildren-1,n=e;n>=0;n--){var i=this.getChildAt(n);i.sending||(t||(t=i,t.showMasterFlag(this._isMaster)),i!=t&&i.showMasterFlag(!1))}},e}(CardGroup);__reflect(DDZCardGroup.prototype,"DDZCardGroup");var DDZServer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeDispatchMessage=function(e,n){switch(e){case EventNames.GAME_SET_SESSION:this._session>0&&this._session!=n.session&&this.giveUpGame(),this.resetSession();break;case EventNames.GAME_GAME_START_NTF:}t.prototype.beforeDispatchMessage.call(this,e,n)},e.prototype.send=function(e,n){!n.session&&e.indexOf("game")>=0&&(n.session=this._session),t.prototype.send.call(this,e,n)},e.prototype.setCards=function(t){this.send(EventNames.GAME_SET_CARDS,{seatid:0,cardids:t})},e.prototype.quickJoin=function(){this.send(EventNames.USER_QUICK_JOIN_REQUEST,{roomid:this.roomInfo.roomID,clientid:this._clientId})},e.prototype.userInfoRequest=function(t){this.send(EventNames.USER_USER_INFO_REQUEST,{uid:t})},e.prototype.getUserInfoInGame=function(t){this.send(EventNames.GAME_USER_INFO_IN_GAME_REQ,{uid:t})},e.prototype.CreatePersonalGameReq=function(t,e,n,i,o,a){void 0===a&&(a=0),this.send(EventNames.CREATE_PERSONAL_GAME_REQ,{gameid:t,bscore:e,maxround:n,maxodd:i,minscore:o,cost:a})},e.prototype.JoinPGameReq=function(t){this.send(EventNames.JOIN_PGAME_REQ,{roomid:t})},e.prototype.StartPGameReq=function(t){this.send(EventNames.START_PGAME_REQ,{roomid:t})},e.prototype.QueryRoomInfoReq=function(t){this.send(EventNames.QUERY_ROOMINFO_REQ,{roomid:t})},e.prototype.QuitPGameReq=function(t){this.send(EventNames.QUIT_PGAME_REQ,{roomid:t})},e.prototype.GameDissolve=function(t){this.send(EventNames.GAME_DISSOLVE,{roomid:t})},e.prototype.ReconnectPGameReq=function(){this.send(EventNames.RECONNECT_PGAME_REQ,{})},e.prototype.answerMaster=function(t){this.send(EventNames.GAME_ANSWER_MASTER,{score:t})},e.prototype.useCardNtf=function(t){this.send(EventNames.GAME_USE_CARD_NTF,{seatid:this.seatid,cardids:t,index:0})},e.prototype.talk=function(t){this.send(EventNames.GAME_TALK_NTF,{seatid:0,msg:t})},e.prototype.hang=function(t){this.send(EventNames.GAME_OPERATE_REQ,{optype:t?1:0})},e.prototype.gameOperate=function(t,e){void 0===e&&(e=null),this.send(EventNames.GAME_OPERATE_REQ,{optype:t,params:e})},e.prototype.getPlayersAmount=function(){this.send(EventNames.USER_PLAYERS_AMOUNT_REQ,{game_id:GameConfig.gameId})},e.prototype.modifyUserInfo=function(t){this.send(EventNames.USER_MODIFY_USER_INFO_REQ,t)},e.prototype.giveUpGame=function(){this.send(EventNames.GAME_GIVE_UP_GAME_REQ,{status:0})},e.prototype.QuitWaitingQueueReq=function(){this.send(EventNames.QUIT_WAITING_QUEUE_REQ,{})},e.prototype.getMatchSignUpInfo=function(t){this.send(EventNames.USER_MATCH_SING_UP_INFO_REQ,{matchid:t})},e.prototype.matchSignUp=function(t,e,n){void 0===n&&(n=0),this.send(EventNames.USER_MATCH_SING_UP_REQ,{matchid:t,optype:e,itemid:n})},e.prototype.enterMatch=function(t){this.send(EventNames.USER_ENTER_MATCH_REQ,{matchid:t,clientid:this._clientId})},e.prototype.giveUpMatch=function(t){this.send(EventNames.USER_GIVE_UP_MATCH_REQ,{matchid:t,clientid:this._clientId})},e.prototype.getBagInfo=function(){this.send(EventNames.USER_BAG_INFO_REQ,{})},e.prototype.GetFreshManReward=function(){this.send(EventNames.GET_FRESHMAN_REWARD_REQ,{})},e.prototype.alms=function(){this.send(EventNames.USER_ALMS_REQ,{})},e.prototype.getReady=function(){this.send(EventNames.GAME_GET_READY_REQ,{})},e.prototype.redcoinExchangeGoodsReq=function(t){this.send(EventNames.USER_REDCOIN_EXCHANGE_GOODS_REQ,{index:t})},e.prototype.diamondExchangeGoodsReq=function(t){this.reqUserOperate(1,[t])},e.prototype.lotteryRedCoinReq=function(t){this.send(EventNames.USER_LOTTERY_RED_COIN_REQ,{roomid:t})},e.prototype.getSignReward=function(){this.send(EventNames.USER_DAY_SIGN_IN_REQ,{optype:2})},e.prototype.getSignInInfo=function(){this.send(EventNames.USER_DAY_SIGN_IN_REQ,{optype:1})},e.prototype.getRedcoinRankingListReq=function(){this.send(EventNames.USER_REDCOIN_RANKING_LIST_REQ,{})},e.prototype.getCardsRecorderReward=function(){this.send(EventNames.GET_CARDS_RECORDER_REWARD_REQ,{})},e.prototype.sendHornMsg=function(t,e){var n=t,i=e,o={type:n,msg:i};this.send(EventNames.USER_PAY_TO_CHAT_REQ,o)},e.prototype.reqGetDownAppRew=function(){var t={optype:1};server.send(EventNames.USER_GET_REWARD_REQ,t)},e.prototype.reqNationalLoginRew=function(){var t={optype:2};server.send(EventNames.USER_GET_REWARD_REQ,t)},e.prototype.reqNationalInviteRew=function(){var t={optype:3};server.send(EventNames.USER_GET_REWARD_REQ,t)},e.prototype.reqNationalActInfo=function(){var t={optype:2};this.send(EventNames.USER_GET_ACTInfo_REQ,t)},e.prototype.reqDownAppRewInfo=function(){var t={optype:1};server.send(EventNames.USER_GET_ACTInfo_REQ,t)},e.prototype.reqDouble=function(){var t={optype:7,params:[2]};server.send(EventNames.GAME_OPERATE_REQ,t)},e.prototype.reqNoDouble=function(){var t={optype:7,params:[1]};server.send(EventNames.GAME_OPERATE_REQ,t)},e.prototype.reqUserOperate=function(t,e){var n={optype:t,params:e};server.send(EventNames.USER_OPERATE_REQ,n)},e.prototype.reqUserGuessNextCard=function(t,e){this.reqUserOperate(3,[e,t])},e.prototype.reqShareSuccRew=function(){this.reqUserOperate(2,null)},e.prototype.reqRedNormalTime=function(){var t={optype:2};server.send(EventNames.USER_DiamondGame_REQ,t)},e.prototype.reqRedNormalMoney=function(){var t={optype:1};server.send(EventNames.USER_DiamondGame_REQ,t)},e.prototype.reqNewPlayerGetDiamond=function(){var t={optype:3};server.send(EventNames.USER_DiamondGame_REQ,t)},e.prototype.reqMailOperate=function(t,e){var n={optype:t,id:e};server.send(EventNames.USER_MailOperate_REQ,n)},e.prototype.reqMailGetRew=function(t){this.reqMailOperate(1,t)},e.prototype.reqTanksQualifications=function(){this.reqUserOperate(4,null)},e.prototype.reqMatchOperate=function(t,e){var n={optype:t,matchid:e};this.send(EventNames.USER_MatchOperate_REQ,n)},e.prototype.reqMatchRevive=function(){this.reqMatchOperate(1,server.roomInfo.matchId)},e.prototype.reqNewPlayerClickTask=function(){this.reqUserOperate(5,[1])},e.prototype.reqClickDownApp=function(){this.reqUserOperate(5,3)},e.prototype.reqClickFirstRecharge=function(){this.reqUserOperate(5,2)},e.prototype.reqClickThanksgiving=function(){this.reqUserOperate(5,4)},e.prototype.reqThanksBuyCounts=function(){this.reqUserOperate(4,null)},e.prototype.reqThanksSign=function(){this.reqUserOperate(6,null)},e.prototype.reqGetDayFuDai=function(){this.reqUserOperate(7,null)},e.prototype.reqServerUpdateRechareErr=function(){this.reqUserOperate(8,null)},e}(Server);__reflect(DDZServer.prototype,"DDZServer");var server=new DDZServer,GameSoundManager=function(){function t(){}return t.playCardType=function(t,e,n){void 0===n&&(n=0);var i,o=!1;switch(e){case BUYAO:i="buyao"+alien.MathUtils.makeRandomInt(5,1);break;case SHUANGWANG:i="wangzha",o=!0;break;case ZHADAN:i="zhadan",o=!0;break;case DAN:i=""+n;break;case DUIZI:i="dui"+n;break;case SANZHANG:i="tuple"+n;break;case SANDAIYI:i="sandaiyi";break;case SANDAIYIDUI:i="sandaiyidui";break;case SIDAIER:i="sidaier";break;case SIDAIERDUI:i="sidailiangdui";break;case FEIJI:i="feiji";break;case DANSHUN:i="shunzi";break;case SHUANGSHUN:i="liandui";break;case SANSHUN:i="shunzi"}var a=t+"_"+i;alien.SoundManager.instance.playEffect(a),o&&SoundManager.instance.vibrate()},t.playScore=function(t,e){var n=t+"_";if(0==e)n+="NoOrder";else{if(0>e)return;n+="Order"}alien.SoundManager.instance.playEffect(n)},t.playDouble=function(t,e){var n=t+"_";n+=e?"jiabei":"bujiabei",alien.SoundManager.instance.playEffect(n)},t}();__reflect(GameSoundManager.prototype,"GameSoundManager");var GoodsManager=function(){function t(){this.init()}return Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this;this.goodsMap={},this.goodsArray=GameConfig.goodsConfig.map(function(e){var n=GoodsConfig.create(e);return t.goodsMap[n.id]=n,n})},t.prototype.getGoodsById=function(t){if(null!=t){var e=this.goodsMap[t];return e?e:void console.warn("(id: %d)",t)}},t}();__reflect(GoodsManager.prototype,"GoodsManager");var GoodsConfig=function(){function t(){}return t.create=function(e){var n=new t;return alien.Utils.injectProp(n,e),n},t}();__reflect(GoodsConfig.prototype,"GoodsConfig");var ObjectPoolInit=function(){function t(){this.init()}return t.prototype.init=function(){alien.ObjectPool.registerPool("Card",function(t){return new Card},function(t,e){t.initData(e)})},t}();__reflect(ObjectPoolInit.prototype,"ObjectPoolInit");var OtherGameManager=function(){function t(){this._dispatcher=new OtherGameBridge,this._otherCfg=otherGameCfg,this._resetRunGame(),this._initTypeFunc()}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.isListenAllProto=function(){return this._curGameCfg&&this._curGameCfg.listenAllProto?!0:!1
},t.prototype.isInOtherProtoListen=function(t){return this._protoIDS[t]?!0:!1},t.prototype.dispatch=function(t,e){this._dispatcher.dispatchEventWith(t,!1,e)},t.prototype.onSocketData=function(t,e,n){this.isRunOtherGame()&&this.dispatch(EventNames.RECV_SOCKET_DATA,{nameId:t,len:e,byteArray:n})},t.prototype.onMyInfoUpdate=function(){var t=MainLogic.instance.selfData;t=JSON.parse(JSON.stringify(t)),this.dispatch("MY_USER_INFO_UPDATE",t)},t.prototype.runOtherGameByName=function(t,e){void 0===e&&(e=null);var n=this._getGameConfigByGameName(t);n&&this._startOtherGame(n,e)},t.prototype.runOtherGameByID=function(t,e){void 0===e&&(e=null);var n=this._getGameConfigByGameId(name);n&&this._startOtherGame(n,e)},t.prototype.getCurGameCfg=function(){return this._curGameCfg},t.prototype.getCurGameUrlRoot=function(){return this.isRunOtherGame()&&this._curGameCfg.urlRoot?this._curGameCfg.urlRoot:null},t.prototype.isRunOtherGame=function(){return this._curGameCfg?!0:!1},t.prototype.onMusicEnableChange=function(){var t=alien.SoundManager.instance.musicMute;this.dispatch("MUSCI_ENABEL_CHANGE",{enable:t})},t.prototype.onEffectEnableChange=function(){var t=alien.SoundManager.instance.effectMute;this.dispatch("EFFECT_ENABEL_CHANGE",{enable:t})},t.prototype.onVibrateEnableChange=function(){var t=alien.SoundManager.instance.vibrateMute;this.dispatch("VIBRATE_ENABEL_CHANGE",{enable:t})},t.prototype._getGameConfigByGameName=function(t){var e=null;if(this._otherCfg)for(var n in this._otherCfg)if(this._otherCfg[n].name==t)return this._otherCfg[n];return e},t.prototype._getGameConfigByGameId=function(t){var e=null;return this._otherCfg&&this._otherCfg[t]?this._otherCfg[t]:e},t.prototype._startOtherGame=function(e,n){if(this._curGameCfg=e,e.mainJs&&e.urlRoot&&e.entryClassName){var i=e.urlRoot+e.mainJs;alien.Native.instance.loadJs(i,function(){var i=egret.getDefinitionByName(e.entryClassName);if(i){this._dispatcher.addEventListener(e.entryClassName,this._onOtherGameEvent.bind(this),this),console.log("startOtherGam======entryClassName=======>",e.entryClassName);var o=new i({dispatcher:this._dispatcher,serverUid:server.uid,data:n});this._curGameContainer=o,alien.SoundManager.instance.stopMusic(),alien.SoundManager.instance.stopEffect(),alien.SceneManager.addOtherContainer(o),alien.SceneManager.removeDDZContainer(),t.instance.onMyInfoUpdate()}}.bind(this))}},t.prototype._onSendData=function(t){t.protoID&&t.byteArray&&server.sendDataByProtoId(t.protoID,t.byteArray)},t.prototype._onOtherBack=function(t){alien.SceneManager.removeOtherContainer(this._curGameContainer),this._resetRunGame(),alien.SoundManager.instance.playMusic(ResNames.bgm);var e=alien.SceneManager.instance;e.currentSceneName!=SceneNames.ROOM&&e.show(SceneNames.ROOM,null,alien.sceneEffect.Fade)},t.prototype._onShowShop=function(t){PanelExchange2.instance.show(t.shopFlag)},t.prototype._onShowSetting=function(t){PanelSetting.instance.show()},t.prototype._onPlaySound=function(t){1==t.soundType?alien.SoundManager.instance.playMusic(t.soundRes,t.loop):2==t.soundType&&alien.SoundManager.instance.playEffect(t.soundRes,t.loop)},t.prototype._onRecharge=function(t){t.productID&&RechargeService.instance.doRecharge(t.productID)},t.prototype._onSetListerenProtoID=function(t){this._protoIDS=t.protoIDS},t.prototype._initTypeFunc=function(){this._tTypeFunc={},this._tTypeFunc[0]=this._onSendData.bind(this),this._tTypeFunc[1]=this._onOtherBack.bind(this),this._tTypeFunc[2]=this._onShowShop.bind(this),this._tTypeFunc[3]=this._onShowSetting.bind(this),this._tTypeFunc[4]=this._onPlaySound.bind(this),this._tTypeFunc[5]=this._onRecharge.bind(this),this._tTypeFunc[6]=this._onSetListerenProtoID.bind(this)},t.prototype._onOtherGameEvent=function(t){var e=t.data;console.log("_onOtherGameEvent===>",e),e&&this._tTypeFunc[e.type]&&this._tTypeFunc[e.type](e)},t.prototype._removeListeners=function(){var t=this._dispatcher.$getEventMap(),e=[];for(var n in t){e=t[n];var i=e.length;if(0==i)return;for(var o=0;i>o;++o){var a=e.pop();this._dispatcher.removeEventListener(a.type,a.listener,a.thisObject,a.useCapture)}}},t.prototype._resetRunGame=function(){this._curGameContainer=null,this._curGameCfg=null,this._removeListeners()},t}();__reflect(OtherGameManager.prototype,"OtherGameManager");var OtherGameBridge=function(t){function e(){var e=t.call(this)||this;return e._soundIns=alien.SoundManager.instance,e}return __extends(e,t),e.prototype.isEnableMusic=function(){return this._soundIns.musicMute},e.prototype.isEnableEffect=function(){return this._soundIns.effectMute},e}(egret.EventDispatcher);__reflect(OtherGameBridge.prototype,"OtherGameBridge");var ShareImageManager=function(){function t(){this._isWaitTipShowing=!1}return Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.start=function(t,e){this.showWait(),this.getImageUrl(t,e,this.onImageUrlResult.bind(this))},t.prototype.shareImgByType=function(t,e,n){var i=this;this.showWait(),this.getImageUrl(t,e,function(t){var e=JSON.parse(t);0==Number(e.code)&&i.shareImage(e.url,n)})},t.prototype.checkShareResult=function(){var e=+egret.localStorage.getItem(t.SHARE_RESULT_TAG);console.log("share result:"+e),e&&(e==WxHelper.NATIVE_SHARE_SUCC?this.onShareSucc():e>WxHelper.NATIVE_SHARE_SUCC&&this.onShareFailed())},t.prototype.getShareScene=function(e,n){var i=t.SCENE_NORMAL;if(e==t.GAME_TYPE_RED)switch(n){case 48:i=t.SCENE_RED_48;break;case 96:i=t.SCENE_RED_96;break;case 192:i=t.SCENE_RED_192;break;default:i=t.SCENE_NORMAL}else if(e==t.GAME_TYPE_MATCH)switch(n){case 201:i=t.SCENE_MATCH_200_RANK_1;break;case 202:i=t.SCENE_MATCH_200_RANK_2;break;case 203:i=t.SCENE_MATCH_200_RANK_3;break;case 501:i=t.SCENE_MATCH_500_RANK_1;break;case 502:i=t.SCENE_MATCH_500_RANK_2;break;case 503:i=t.SCENE_MATCH_500_RANK_3;break;default:i=t.SCENE_NORMAL}else if(e==t.GAME_TYPE_FAST)switch(n){case 200:i=t.SCENE_FAST_2;break;case 500:i=t.SCENE_FAST_5;break;case 1e3:i=t.SCENE_FAST_10;break;default:i=t.SCENE_NORMAL}return i},t.prototype.showWait=function(){this._isWaitTipShowing=!0,egret.localStorage.setItem(t.SHARE_RESULT_TAG,"1"),alien.Dispatcher.dispatch(EventNames.SHOW_WAITING,{content:"..."}),egret.setTimeout(this.hideWait,this,t.WAIT_TIMEOUT)},t.prototype.hideWait=function(t){void 0===t&&(t=!1),alien.Dispatcher.dispatch(EventNames.HIDE_WAITING),this._isWaitTipShowing=!1},t.prototype.getImageUrl=function(e,n,i){alien.Ajax.GET(t.REQ_IMAGE_URL,{uid:e,scene:n},i,this.onImageUrlError.bind(this))},t.prototype.onImageUrlResult=function(t){var e=JSON.parse(t);console.log(">>>>>>>>>>"+t),0==+e.code?this.shareImage(e.url):(console.log("onImageUrlResult:"+e.code),this.stop(!1))},t.prototype.onImageUrlError=function(t){console.log("onImageUrlError"),this.stop(!1)},t.prototype.shareImage=function(t,e){void 0===e&&(e=WxHelper.SHARE_IMAGE_TO_TIMELINE),WxHelper.shareImageNative(e,this.onShareResult.bind(this),[t])},t.prototype.saveShareResult=function(e){egret.localStorage.setItem(t.SHARE_RESULT_TAG,""+e)},t.prototype.onShareResult=function(t){var e=t.code;this.saveShareResult(e),+e==WxHelper.NATIVE_SHARE_SUCC?this.onShareSucc():this.onShareFailed()},t.prototype.onShareSucc=function(){server.reqShareSuccRew()},t.prototype.onShareFailed=function(){this.stop(!1)},t.prototype.onUserOperateRep=function(t){if(2==t.optype)if(1==t.result)this.stop(!0);else{var e=GameConfig,n=e.getShareRewCfg();if(!n)return;var i=null,o=1,a=":\n";for(var r in n)i=e.getItemNameById(parseInt(r)),i&&(a+=o+"."+i+"x"+n[r]+"\n");this.stop(!0,a)}},t.prototype.resetShareResult=function(){egret.localStorage.setItem(t.SHARE_RESULT_TAG,"0")},t.prototype.onAlertButton=function(t,e){this.resetShareResult()},t.prototype.stop=function(e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.hideWait();var i="center";e?null==n?n="":i="left":null==n&&(n=""),egret.setTimeout(Alert.show,this,t.ALERT_DELAY,n,0,this.onAlertButton.bind(this),i)},t.GAME_TYPE_RED=1,t.GAME_TYPE_MATCH=2,t.GAME_TYPE_FAST=3,t.REQ_IMAGE_URL="https://ddz.yiyuc.com/wxunion/friendshare.php",t.SHARE_RESULT_TAG="shareResultTag",t.SCENE_NORMAL=1,t.SCENE_SPRING=2,t.SCENE_RED_NORMAL=t.SCENE_NORMAL,t.SCENE_RED_BASE=10,t.SCENE_RED_48=t.SCENE_RED_BASE+1,t.SCENE_RED_96=t.SCENE_RED_BASE+2,t.SCENE_RED_192=t.SCENE_RED_BASE+3,t.SCENE_MATCH_NORMAL=t.SCENE_NORMAL,t.SCENE_MATCH_BASE=30,t.SCENE_MATCH_500_RANK_1=t.SCENE_MATCH_BASE+1,t.SCENE_MATCH_500_RANK_2=t.SCENE_MATCH_BASE+2,t.SCENE_MATCH_500_RANK_3=t.SCENE_MATCH_BASE+3,t.SCENE_MATCH_200_RANK_1=t.SCENE_MATCH_BASE+6,t.SCENE_MATCH_200_RANK_2=t.SCENE_MATCH_BASE+7,t.SCENE_MATCH_200_RANK_3=t.SCENE_MATCH_BASE+8,t.SCENE_FAST_NORMAL=t.SCENE_NORMAL,t.SCENE_FAST_BASE=50,t.SCENE_FAST_2=t.SCENE_FAST_BASE+1,t.SCENE_FAST_5=t.SCENE_FAST_BASE+2,t.SCENE_FAST_10=t.SCENE_FAST_BASE+3,t.WAIT_TIMEOUT=15e3,t.ALERT_DELAY=500,t}();__reflect(ShareImageManager.prototype,"ShareImageManager");var AdvanceMethod=function(){function t(){}return t.start=function(){if("iOS"==egret.Capabilities.os){console.log("replace Array.sort");var t=Array.prototype.sort;Array.prototype.sort=function(e){if(e&&"function"==typeof e){if(this.length<2)return this;for(var n=0,i=n+1,o=this.length,a=void 0,r=!1,s=0;o>n;n++)for(i=n+1;o>i;i++)s=e.call(this,this[n],this[i]),r=("number"==typeof s?s:s?1:0)>0,r&&(a=this[n],this[n]=this[i],this[i]=a);return this}return t.call(this)}}},t}();__reflect(AdvanceMethod.prototype,"AdvanceMethod");var LeftSeat=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(SideSeat);__reflect(LeftSeat.prototype,"LeftSeat");var MySeat=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setRedcoin=function(t,e){this.lbRedCoin&&(this.lbRedCoin.text=t,this.redBgImg.touchEnabled=e)},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.clean=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!0),this.imgNoMatchCards.visible=!1,t.prototype.clean.call(this,e,!1)},e.prototype.addCards=function(e,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1),i&&this.handCardGroup.clean(),t.prototype.addCards.call(this,e),this.handCardGroup.addCards(e,n)},e.prototype.cancelSelect=function(){this.ddzHandCardGroup.cancelSelect()},e.prototype.getSelectPokerIds=function(){return this.ddzHandCardGroup.getSelectedCards()},e.prototype.help=function(){var t=this.ddzHandCardGroup.help();return t},e.prototype.checkType=function(t){return this.ddzHandCardGroup.checkType(t)},e.prototype.showNoMatchCards=function(t){void 0===t&&(t=2e3),this.imgNoMatchCards.visible=!0,this.setShowCardShadow(!0),this._tweenNoMathCards=egret.Tween.get(this.imgNoMatchCards,null,null,!0).to({alpha:1},100).wait(t).call(this.hideNoMathCards,this)},e.prototype.hideNoMathCards=function(){var t=this;this._tweenNoMathCards&&(this._tweenNoMathCards=null,egret.Tween.get(this.imgNoMatchCards,null,null,!0).to({alpha:0},100).call(function(){t.imgNoMatchCards.visible=!1,t.setShowCardShadow(!1)}))},e.prototype.checkCanUse=function(){this.ddzHandCardGroup.checkCanUse()},e}(DDZSeat);__reflect(MySeat.prototype,"MySeat");var RightSeat=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(SideSeat);__reflect(RightSeat.prototype,"RightSeat");var alien;!function(t){var e=function(){function t(){}return t.init=function(){t.instance=new egret.EventDispatcher},t.dispatch=function(e,n){void 0===n&&(n=null),n?t.instance.dispatchEventWith(e,!1,n):t.instance.dispatchEvent(new egret.Event(e))},t.addEventListener=function(e,n,i){t.instance.addEventListener(e,n,i)},t.removeEventListener=function(e,n,i){t.instance.removeEventListener(e,n,i)},t}();t.Dispatcher=e,__reflect(e.prototype,"alien.Dispatcher")}(alien||(alien={}));var BagService=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.bagItemMap={},this.bagItemArray=[]},e.prototype.start=function(e){server.addEventListener(EventNames.USER_BAG_INFO_REP,this.onBagInfoRep,this),this.refreshBagInfo(),t.prototype.start.call(this,e)},e.prototype.stop=function(){t.prototype.stop.call(this),server.removeEventListener(EventNames.USER_BAG_INFO_REP,this.onBagInfoRep,this)},e.prototype.refreshBagInfo=function(t){void 0===t&&(t=!1),(t||!this._refreshing)&&(this._refreshing=!0,server.getBagInfo())},e.prototype.onBagInfoRep=function(t){var e=this,n=t.data;this._refreshing=!1,this.bagItemArray.forEach(function(t){t.count=0}),n.items.forEach(function(t){e.updateItemByData(t)}),alien.Dispatcher.dispatch(EventNames.BAG_INFO_REFRESH,!1)},e.prototype.getItemById=function(t){return this.bagItemMap[t]},e.prototype.getItemCountById=function(t){var e=this.getItemById(t);return e?e.count:0},e.prototype.updateItemByData=function(t){var e;return GoodsManager.instance.getGoodsById(t.id)&&(e=this.getItemById(t.id),e||(e=new BagItemData,this.bagItemMap[t.id]=e,this.bagItemArray.push(e)),alien.Utils.injectProp(e,t)),e},e.prototype.updateItemCount=function(t,e){var n=this.getItemById(t);if(n){var i=Math.max(n.count+e,0);return n.count=i,alien.Dispatcher.dispatch(EventNames.BAG_INFO_REFRESH,!1),i}return 0},e}(Service);__reflect(BagService.prototype,"BagService");var BagItemData=function(){function t(){}return t}();__reflect(BagItemData.prototype,"BagItemData");var CountDownService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._items=[],e._ids=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this._items.splice(0),this._timer>0&&egret.clearInterval(this._timer),this._timer=egret.setInterval(this.onTimer.bind(this),this,1e3),t.prototype.start.call(this,e)},e.prototype.stop=function(){t.prototype.stop.call(this),this._timer>0&&(egret.clearInterval(this._timer),this._timer=0)},e.prototype.register=function(t,e,n){void 0===n&&(n=null);var i=++this._ids;return this._items.push({id:i,second:t,end:server.tsServer+t,onSecond:e,onComplete:n}),e&&e(t),i},e.prototype.unregister=function(t){var e=this;this._items.some(function(n,i){return n.id==t?(e._items.splice(i,1),!0):void 0})},e.prototype.onTimer=function(){var t=this;if(0!=this._items.length){var e=[];this._items.forEach(function(t,n){var i=t.end-server.tsServer,o=t.onSecond;if(o&&o(Math.max(0,i)),0>=i){e.push(n);var a=t.onComplete;a&&a()}}),e.forEach(function(e){t._items.splice(e,1)})}},e.register=function(t,n,i){return void 0===i&&(i=null),e.instance.register(t,n,i)},e.unregister=function(t){e.instance.unregister(t)},e}(Service);__reflect(CountDownService.prototype,"CountDownService");var ExchangeService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selfData=MainLogic.instance.selfData,e._showInfoQueen=[],e.matchChampionMsg=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){server.addEventListener(EventNames.USER_REDCOIN_EXCHANGE_GOODS_REP,this.onExchangeNotify,this),server.addEventListener(EventNames.USER_LOTTERY_RED_COIN_REP,this.onLotteryRedCoinRep,this,!1,1),server.addEventListener(EventNames.USER_OPERATE_REP,this._onDiamondExchangeRep,this),this._matchMsgReqTimer||(this._matchMsgReqTimer=new egret.Timer(3e4),this._matchMsgReqTimer.addEventListener(egret.TimerEvent.TIMER,this.getMatchChampion,this),this._matchMsgReqTimer.start()),this._redcoinReqTimer||(this._redcoinReqTimer=new egret.Timer(3e4),this._redcoinReqTimer.addEventListener(egret.TimerEvent.TIMER,this.getRedCoinData,this),this._redcoinReqTimer.start()),this._announceReqTimer||(this._announceReqTimer=new egret.Timer(12e4),this._announceReqTimer.addEventListener(egret.TimerEvent.TIMER,this.getAnnouce,this),this._announceReqTimer.start()),this.getAnnouce(),this.getRedCoinData(),this.getMatchChampion()},e.prototype.deleteAnnounce=function(){this.announce=null},e.prototype.getData=function(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n="/notify/redPackets"),e||(e={});var i=GameConfig.WEB_SERVICE_URL+n,o=alien.Ajax.GET;o.call(alien.Ajax,i,e,function(e){if(GameConfig.DEBUG&&console.log("get:"+e),t){var n=JSON.parse(e);n.code>0&&GameConfig.DEBUG&&console.log(i,n.code,n.message),t(n)}})},e.prototype.getRedCoinData=function(){if(!(this._showInfoQueen&&this._showInfoQueen.length>0)){var t={};this.redcoinhttpMsgId&&(t.id=this.redcoinhttpMsgId),this.getData(function(t){if(0==t.code){var n=t.data||[];n&&(e.instance.redcoinhttpMsgId=n.next_id,e.instance._showInfoQueen=e.instance._showInfoQueen.concat(n.items),alien.Dispatcher.dispatch(EventNames.SHOW_PAYCHAT))}},t)}},e.prototype.getMatchChampion=function(){if(!(this.matchChampionMsg&&this.matchChampionMsg.length>0)){var t={};this.matchhttpMsgId&&(t.id=this.matchhttpMsgId),this.getData(function(t){if(0==t.code){var n=t.data||[];n&&(e.instance.matchhttpMsgId=n.next_id||0,e.instance.matchChampionMsg=e.instance.matchChampionMsg.concat(n.items),alien.Dispatcher.dispatch(EventNames.SHOW_PAYCHAT))}},t,"/notify/matchChampionMsg")}},e.prototype.getAnnouce=function(){var t={};this.getData(function(t){0==t.code&&(e.instance.announce=t.data,e.instance.announce&&e.instance.announce.length>0&&(MainLogic.instance.selfData.addSysTalkRec(e.instance.announce),alien.Dispatcher.dispatch(EventNames.SHOW_ANNOUNCE)))},t,"/msg/notice")},e.prototype._alertWithFollowCourse=function(t,e){void 0===e&&(e=!1);var n=PanelAlert3.instance;(new egret.HtmlTextParser).parser(t);n.show(t,0,function(t){e&&PanelExchange2.instance.show(5)})},e.prototype.onExchangeRedSucc=function(){var t=""+this._exchangeInfo.amount+"()";this._alertWithFollowCourse(t)},e.prototype.onExchangeHuaFeiSucc=function(){var t=""+this._exchangeInfo.amount+", <font color='#FF0000'> </font>";this._alertWithFollowCourse(t,!0)},e.prototype.onExchangeHFKSucc=function(){var t=""+this._exchangeInfo.amount+", <font color='#FF0000'> </font>";this._alertWithFollowCourse(t,!0)},e.prototype.onExchangeJDKSucc=function(){var t=""+this._exchangeInfo.amount+", <font color='#FF0000'> </font>";this._alertWithFollowCourse(t,!0)},e.prototype.onExchangeAliSucc=function(){var t=""+this._exchangeInfo.amount+", <font color='#FF0000'> </font>";this._alertWithFollowCourse(t,!0)},e.prototype.onExchangeNotify=function(t){var e=t.data;switch(e.result){case 0:this._exchangeInfo?(1==this._exchangeInfo.goodsid?this.onExchangeRedSucc():4==this._exchangeInfo.goodsid?this.onExchangeHuaFeiSucc():6==this._exchangeInfo.goodsid?this.onExchangeHFKSucc():5==this._exchangeInfo.goodsid?this.onExchangeJDKSucc():7==this._exchangeInfo.goodsid?this.onExchangeAliSucc():3==this._exchangeInfo.item_type?Alert3.show(""+this._exchangeInfo.num+"",null,"common_btn_lab_confirm"):1==this._exchangeInfo.item_type&&Alert3.show(""+this._exchangeInfo.num+"",this.onConfirm,"common_btn_lab_confirm"),this._exchangeInfo.first?(MainLogic.instance.selfData.rcminexcchanceused=1,PanelExchange2.instance.flashData(!0)):PanelExchange2.instance.flashData()):Alert3.show(lang.exchange_redcoin[e.result],this.onConfirm,"common_btn_lab_confirm");break;case 1:Alert3.show(lang.exchange_redcoin[e.result],this.onConfirm,"common_btn_lab_confirm");break;case 2:Alert3.show(lang.exchange_redcoin[e.result],this.onConfirm,"common_btn_lab_confirm");break;case 3:Alert3.show(lang.exchange_redcoin[e.result],this.onConfirm,"common_btn_lab_confirm");break;case 4:Alert3.show(lang.exchange_redcoin[e.result],null,"common_btn_lab_confirm")}this._exchangeInfo=null},e.prototype.onConfirm=function(){},e.prototype.onLotteryRedCoinRep=function(t){var e=this,n=t.data;switch(n.result){case 0:server.getRedcoinRankingListReq(),Alert.show(""+Utils.exchangeRatio(n.coin/100,!0)+"!"),this._selfData.wincnt.forEach(function(t,n){null!=e.lotteryIndex&&e.lotteryIndex==t.roomid&&(t.chance-=1,alien.Dispatcher.dispatch(EventNames.USER_RED_COUNT_CHANGE,{count:t.chance}))});break;case 1:Alert.show("");break;case 2:Alert.show("")}this.lotteryIndex=null},e.prototype.onPay2ChatRep=function(t){var e=t.data;3==e.type&&(this._showInfoQueen.push(e),alien.Dispatcher.dispatch(EventNames.SHOW_PAYCHAT))},e.prototype.doRedExchange=function(t){this._exchangeInfo=t,server.redcoinExchangeGoodsReq(t.id)},e.prototype.doChou=function(t){null==this.lotteryIndex&&(this.lotteryIndex=t,server.lotteryRedCoinReq(t))},e.prototype._onDiamondExchangeRep=function(t){var e=t.data;e&&1==e.optype&&null==e.result&&Alert.show("")},e}(Service);__reflect(ExchangeService.prototype,"ExchangeService");var InviteService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._loadCount=8,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._source=[],this._reqAmount=0,this._total_page=0,this._complete_amount=0},e.prototype.getData=function(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n="get"),e||(e={}),e.uid=server.uid,e.token=UserData.instance.getToken(),e.limit=this._loadCount;var i=GameConfig.WEB_SERVICE_URL+"/user/sharelist",o="post"==n?alien.Ajax.POST:alien.Ajax.GET;o.call(alien.Ajax,i,e,function(e){if(GameConfig.DEBUG&&console.log("get:"+e),t){var n=JSON.parse(e);n.code>0&&GameConfig.DEBUG&&console.log(i,n.code,n.message),t(n)}})},e.prototype.clearInvitePlayersList=function(){this._source=[],this._reqAmount=0,this._total_page=0},e.prototype.getInvitePlayersList=function(t){var n=this;if(void 0===t&&(t=0),0==t&&(t=this._reqAmount+1),!(this._reqAmount>=t||this._reqAmount>this._total_page)){var i={page:t};this.getData(function(i){if(0==i.code){n._reqAmount=t>n._reqAmount?t:n._reqAmount;var o=i.data||[];o&&(n._complete_amount=o.total_items_finished,e.instance.source=n._source.concat(o.current_items),e.instance.total_page=o.total_page),n.dispatchEventWith(EventNames.INVITE_DATA_REFRESH,!1,n._source)}},i)}},Object.defineProperty(e.prototype,"total_page",{set:function(t){this._total_page=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"complete_amount",{get:function(){return this._complete_amount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"haveMore",{get:function(){return this._haveMore},enumerable:!0,configurable:!0}),e}(Service);__reflect(InviteService.prototype,"InviteService");var LoginService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._loginData={uid:0,token:""},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e,this._instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){server.addEventListener(EventNames.USER_LOGIN_RESPONSE,this._onLoginResponse,this),server.addEventListener(EventNames.CONNECT_SERVER,this._onConnectToServer,this),alien.Dispatcher.addEventListener(EventNames.ACCOUNT_ERROR,this._onAccountError,this)},e.prototype._openNewWindow=function(t,e,n,i){var o=null,a=(window.screen.availHeight-30-i)/2,r=(window.screen.availWidth-10-n)/2;o=window.open(t,e,"height="+i+",innerHeight="+i+",width="+n+",innerWidth="+n+",top="+a+",left="+r+",status=no,toolbar=no,menubar=no,location=no,resizable=no,scrollbars=0,titlebar=no")},e.prototype._onConnectToServer=function(t){server.login(this._loginData.uid,this._loginData.token)},e.prototype._onLoginResponse=function(t){var e=t.data;switch(e.code){case 0:this._setCanReconnect(!0),alien.Dispatcher.dispatch(EventNames.LOGIN_SUCCESS),server.checkReconnect();break;default:alien.Dispatcher.dispatch(EventNames.HIDE_WAITING),105==e.errorId?Toast.show(alien.StringUtils.format(lang.loginError[1100],lang.loginError[e.errorId]+" uid  "+this._loginData.uid)):Toast.show(alien.StringUtils.format(lang.loginError[1100],lang.loginError[e.errorId])),this._onAccountError(),103==e.errorId?this.doRelogin():SceneLoading.setLoadingText(":"+e.errorId)}},e.prototype._doRedirectH5WX=function(t,e){window.top.redirectWX(t)},e.prototype.onVerifyResponse=function(t){if(t)if(console.log("onVerifyResponse====>",t.code),t.hasOwnProperty("code")){var e=t.code;if(6666==t.code){var n=t.data.unionid,i=t.data.url;return void(alien.Native.instance.isNative||this._doRedirectH5WX(n,i))}if(2020==t.code){var o=t.data;return o.showClose=!1,void PanelBindPhone.getInstance().show(1,o,function(){MainLogic.instance.doRestartGame()})}0==e?this.tryLogin(t.data):(alien.Dispatcher.dispatch(EventNames.HIDE_WAITING),e>10&&Toast.show(lang.loginError[e]+" "+JSON.stringify(t.data)),SceneLoading.setLoadingText(":"+e))}else this.tryLogin(t);else Toast.show(lang.loginError[2013]),SceneLoading.setLoadingText(""),alien.Dispatcher.dispatch(EventNames.HIDE_WAITING)},e.prototype.tryLogin=function(t){this._loginData=t;var e=UserData.instance;e.setUid(this._loginData.uid),e.setSk(this._loginData.sk),e.setItem("username",this._loginData.username),e.setItem("type",this._loginData.type),e.setBindPhone(this._loginData.bindinfo),e.saveLocalPhone(t.phone),e.setToken(this._loginData.token,!0),this._loginData.sk||Reportor.instance.reportCodeError("sk error tryLogin"),WxHelper.doWebH5ShareCfg(),GameConfig.initServer(t.server),SceneLoading.setLoadingText(""),server.connect()},e.prototype.doWebWXLogin=function(){var t=alien.Native.instance,e=t.getUrlArg(),n=e.wx_code;if(n&&"null"!=n){var i=e.share_sk;i||(i=""),SceneLoading.setLoadingText("");var o=alien.Native.instance,a=o.getUrlArg(),r="cn.htgames.doudizhu.wechat",s=null;a.unionid&&0!=a.unionid&&(s=a.unionid,r="cn.htgames.doudizhu.wechat.new"),webService.loginByWxFromWechat(n,i,s,r,this.onVerifyResponse.bind(this))}},e.prototype.doWebAliLogin=function(){var t=alien.Native.instance,e=t.getUrlArg(),n=e.ali_code;if(n&&"null"!=n){var i=e.share_sk;i||(i="");var o=alien.Native.instance,a=o.getUrlArg(),r=null;a.unionid&&0!=a.unionid&&(r=a.unionid),webService.loginByAliH5(n,i,r,this.onVerifyResponse.bind(this))}},e.prototype.doAppWxLogin=function(){var t=this;webService.loginWXApp(function(e){t.onVerifyResponse(e)})},e.prototype._onTryConnectError=function(){alien.Dispatcher.dispatch(EventNames.HIDE_WAITING)},e.prototype.checkLocalToken=function(){var t=UserData.instance,e=t.getUid(),n=t.getToken();return console.log("uid:",e,"|token:",n),n&&"null"!=n&&e?(this._loginData.uid=e,this._loginData.token=n,webService.getServer(e,function(e){0==e.code?(t.getToken()||Reportor.instance.reportCodeError("sk error checkLocalToken"),GameConfig.initServer(e.data),server.connect()):SceneLoading.setLoadingText("")}),!0):!1},e.prototype._clearToken=function(){this._loginData.token=null;var t=UserData.instance;t.setToken("null",!0)},e.prototype._setCanReconnect=function(t){this._bCanReconnect=t},e.prototype._onAccountError=function(){this._clearToken(),MainLogic.instance.stop()},e.prototype.doRelogin=function(){this._setCanReconnect(!1),this._clearToken(),alien.Dispatcher.dispatch(EventNames.HIDE_MOSTTOP_TIP),_nativeBridge.isWXMP?window.top.reqWXCode():_nativeBridge.isAli()?window.top.reqAliCode():MainLogic.instance.showLogin()},e.prototype.doReconnect=function(){this._bCanReconnect&&(this.checkLocalToken()||console.error("doReconnect===>",this._loginData))},e}(Service);__reflect(LoginService.prototype,"LoginService");var MailService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._loadCount=10,e._firstId=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._source=[],this._timer=new egret.Timer(6e5);var t=alien.EventManager.instance,e=egret.getQualifiedClassName(this);t.register(e,server,EventNames.USER_MailGetReward_REP,this.onMailGetRewardResponse,this),t.register(e,this._timer,egret.TimerEvent.TIMER,this.onCheckTimer,this)},e.prototype.start=function(e){var n=this;this._source.splice(0),this._unreadCount=0,this._unreadEndPos=0,this._haveMore=!0,this.getMailList(),alien.EventManager.instance.enable(egret.getQualifiedClassName(this)),this._timer.reset(),this._timer.start(),egret.setTimeout(function(){n.getUnreadCount(),n.checkMail()},this,3e3),t.prototype.start.call(this,e)},e.prototype.stop=function(){alien.EventManager.instance.disable(egret.getQualifiedClassName(this)),this._timer.stop()},e.prototype.onCheckTimer=function(t){void 0===t&&(t=null),this.checkMail()},e.prototype.callMailApi=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i="get"),n=n||{},n.uid=server.uid,webService.callApi("msg",t,e,n,i)},e.prototype.checkMail=function(){var t=this;this.callMailApi("checkmail",function(e){0==e.code&&(t._unreadCount=parseInt(e.data.unread_count),t.updateUnreadCount(),t.getMailList(1))})},e.prototype.getUnreadCount=function(){var t=this;this.callMailApi("count",function(e){0==e.code&&(t._unreadCount=parseInt(e.data.count),t.updateUnreadCount())},{})},e.prototype.getMailList=function(t){var e=this;void 0===t&&(t=0);var n={limit:this._loadCount,type:t};this.callMailApi("index",function(t){if(0==t.code){var n=t.data||[],i=n.length;i>0&&(e._lastId=n[i-1].id,n.forEach(function(t){t.id>e._firstId&&(e._firstId=t.id),e.addItem(t)})),e._haveMore=i>=e._loadCount,e.dispatchEventWith(EventNames.MAIL_LIST_REFRESH,!1,{list:e._source})}},n)},e.prototype.checkUserBack=function(){for(var t=0;t<this._source.length;++t)if(4==this._source[t].type){0==this._source[t].status&&PanelMail.getInstance().tipOpenMailItem(this._source[t]);break}},e.prototype.openMail=function(t){var e=this;this.callMailApi("update",function(n){if(0==n.code){e.updateUnreadCount(-1);var i,o=-1;e._source.some(function(e,n){return e.id==t?(i=e,o=n,!0):void 0}),i&&(e._unreadEndPos--,e._source.splice(o,1),i.status=1,e.addItem(i,!0),e.dispatchEventWith(EventNames.MAIL_LIST_REFRESH,!1))}},{id:t,status:1},"post")},e.prototype.getReward=function(t){server.reqMailGetRew(t)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.addItem=function(t,e){void 0===e&&(e=!1),t.sendtime=parseInt(t.sendtime),t.id=parseInt(t.id),t.type=parseInt(t.type),t.status=parseInt(t.status),"string"==typeof t.attachment&&(t.attachment=Utils.parseGoodsString(t.attachment)),0==t.status?(this._source.splice(this._unreadEndPos,0,t),this._unreadEndPos++):e?this._source.splice(this._unreadEndPos,0,t):this._source.push(t)},e.prototype.onMailGetRewardResponse=function(t){var e=t.data;if(0==e.result){Toast.show("");var n,i=-1;this._source.some(function(t,o){return t.id==e.id?(n=t,i=o,!0):void 0}),n&&(this._source.splice(i,1),n.status=2,this.addItem(n,!0),this.dispatchEventWith(EventNames.MAIL_LIST_REFRESH,!1),BagService.instance.refreshBagInfo(),PanelMailDetails.getInstance().close())}else Toast.show("")},e.prototype.updateUnreadCount=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!0),this._unreadCount+=t,e&&(this.dispatchEventWith(EventNames.MAIL_UNREAD_UPDATE,!1,{count:this._unreadCount}),this._unreadCount>0&&this.checkUserBack())},Object.defineProperty(e.prototype,"unreadCount",{get:function(){return this._unreadCount
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"haveMore",{get:function(){return this._haveMore},enumerable:!0,configurable:!0}),e}(Service);__reflect(MailService.prototype,"MailService");var SoundManager=alien.SoundManager,MatchService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._checkCount=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPlayerCount",{get:function(){return this._nextPlayerCount},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.myUserInfoData=MainLogic.instance.selfData,this._watchedRooms=[],this._matchTopNotify=alien.Utils.parseColorTextFlow(lang.match_top_notify),server.addEventListener(EventNames.USER_MATCH_SING_UP_REP,this.onMatchSignUpRep,this),server.addEventListener(EventNames.USER_MATCH_START_NTF,this.onMatchStartNtf,this),server.addEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this),server.addEventListener(EventNames.USER_GIVE_UP_MATCH_REP,this.onGiveUpMatchRep,this),server.addEventListener(EventNames.GAME_GAME_START_NTF,this.onGameStart,this,!1,1e3),server.addEventListener(EventNames.GAME_GAME_END,this.onGameEnd,this),server.addEventListener(EventNames.GAME_LEAVE_TABLE,this.onLeaveTable,this),server.addEventListener(EventNames.GAME_RECONNECT_REP,this.onReconnectRep,this)},e.prototype.start=function(e){this._playerInMatch=1e6,this._checkCount=0,this._watchedRooms.splice(0),this._timer>0&&egret.clearInterval(this._timer),this._initDefaultInfo(),this._timer=egret.setInterval(this.onTimer.bind(this),this,1e3),server.addEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),this.checkMatchStatus(),t.prototype.start.call(this,e)},e.prototype.stop=function(){t.prototype.stop.call(this),this._timer>0&&egret.clearInterval(this._timer),this._idTopNotify>0&&(egret.clearInterval(this._idTopNotify),alien.Dispatcher.dispatch(EventNames.HIDE_TOP_NOTIFY))},Object.defineProperty(e.prototype,"scoreGetOut",{get:function(){return this._scoreGetOut},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTurn",{get:function(){return this._currentTurn},set:function(t){this._currentTurn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPlay",{get:function(){return this._currentPlay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentMatchMode",{get:function(){return this._currentMatchMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"countPromote",{get:function(){return this._countPromote},enumerable:!0,configurable:!0}),e.prototype._showSignMatchSucc=function(t,e){var n="   "+t.name+"\n{2}{1}",i=server.tsNow,o=e.nextTs;n=alien.TimeUtils.timeFormat(o-i,n),Alert.show(n)},e.prototype.onMatchSignUpRep=function(t){var e=t.data;if(e.result>0)if(8==e.result)PanelMatchSignUp.instance.close(),PanelRechargeTips.instance.show();else if(16==e.result){var n=GameConfig.getRoomConfigByMatchId(e.matchid);Alert.show(alien.StringUtils.formatApply(lang.match_sign_up_result[16],[n.maxOwnGoldLimit,n.name]))}else 5==e.result||Alert.show(lang.match_sign_up_result[e.result]);else{BagService.instance.refreshBagInfo();var n=GameConfig.getRoomConfigByMatchId(e.matchid);switch(e.optype){case 1:if(n.is_signup=1,server.addEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this),PanelMatchSignUp.instance.close(),n.hasOwnProperty("startDate")){var i=this.addWatchRoom(n);this._showSignMatchSucc(n,i)}else PanelMatchWaiting.instance.show(n);break;case 2:n.is_signup=0,n.hasOwnProperty("startDate")?(this._idTopNotify>0&&(egret.clearInterval(this._idTopNotify),alien.Dispatcher.dispatch(EventNames.HIDE_TOP_NOTIFY)),this.removeWatchRoom(n),PanelMatchCountDown.instance.close(),PanelMatchNotice.instance.close()):PanelMatchWaiting.instance.close()}alien.Dispatcher.dispatch(EventNames.REFRESH_MATCH_LIST)}},e.prototype._initDefaultInfo=function(){this._currentMatchMode=0,this._currentTurn=0,this._currentPlay=0,this._countPromote=0,this._playerInMatch=1e6,this._nextPlayerCount=0},e.prototype.onMatchStartNtf=function(t){var e=t.data;this._initDefaultInfo();var n=GameConfig.getRoomConfigByMatchId(e.matchid);n.stage.length>1&&this.updateScoreGetOut(e.matchid),SceneManager.instance.currentSceneName==SceneNames.PLAY&&MainLogic.backToRoomScene(),server.resetSession(),n.hasOwnProperty("startDate")&&(alien.Dispatcher.dispatch(EventNames.HIDE_TOP_NOTIFY),GameConfig.roomList.forEach(function(t){!t.hasOwnProperty("startDate")&&t.is_signup>=1&&server.giveUpMatch(t.matchId)})),alien.SceneManager.show(SceneNames.PLAY,{roomID:e.matchid},alien.sceneEffect.Fade)},e.prototype.onMatchEndCheckRemoveMatchInfoNtf=function(t){GameConfig.setMatchSignupFlag(t.matchid,0);GameConfig.anyMatchSignuped()||server.removeEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this)},e.prototype.onMatchInfoNtf=function(t){var n=t.data,i=GameConfig.getRoomConfigByMatchId(n.matchid),o=i.stage;switch(n.optype){case-1:var a=GameConfig.getRoomConfigByMatchId(n.matchid);n.params&&n.params[0]&&n.params[0]>0&&Alert.show(""+a.name+"\n"+n.params[0]+"");break;case-2:var a=GameConfig.getRoomConfigByMatchId(n.matchid);a&&Alert.show(""+a.name+"\n ");break;case 100:if(this._currentMatchMode=n.params[0],!n.params[1]){var r=1;2==this._currentMatchMode&&(r=o[1==o.length?0:1].handCount),PanelBeforeMatch.instance.show(o.length,this._currentMatchMode,r),PanelMatchWaitingInner.instance.close()}break;case 101:!this._matchover&&server.isMatch&&egret.setTimeout(function(){var t=(GameConfig.getRoomConfigByMatchId(n.matchid),e.instance._currentTurn+1+2);n.params.length>t&&e.instance.checkMatchWaiting(n.params[t])},this,6e3);break;case 102:this._matchover=!0,this._timerWaiting>0&&(egret.clearTimeout(this._timerWaiting),this._timerWaiting=0),PanelMatchWaitingInner.instance.close();break;case 103:this._countPromote=n.params[0],this._currentTurn=n.params[1],this._currentPlay=0;break;case 104:this._playerInMatch=n.params[1],this._nextPlayerCount=n.params[2],1==this._currentMatchMode&&this.checkMatchWaiting(this._playerInMatch);break;case 105:this.updateScoreGetOut(n.matchid,n.params[0]);break;case 106:this._currentTurn=n.params[0],this._currentPlay=n.params[1],this._countPromote=n.params[2],console.log("currentTurn",this._currentTurn,"currentPlay",this._currentPlay)}this.dispatchEvent(t)},e.prototype.updateScoreGetOut=function(t,e){void 0===e&&(e=-1);var n=GameConfig.getRoomConfigByMatchId(t);-1==e&&(e=n.stage[0].baseScore[0][1]);var i=n.stage[0].kickOutOdds;this._scoreGetOut=e*i,console.log("scoreGetOut :"+this._scoreGetOut)},e.prototype.onGameStart=function(t){server.isMatch&&(this._matchover=!1,this._currentPlay++)},e.prototype.onGameEnd=function(t){server.isMatch&&this.checkMatchWaiting(this._nextPlayerCount,!0)},e.prototype.onLeaveTable=function(t){server.isMatch},e.prototype.onReconnectRep=function(t){server.isMatch&&this.checkMatchWaiting()},e.prototype.checkMatchWaiting=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=!1),!server.playing&&alien.SceneManager.instance.currentSceneName==SceneNames.PLAY&&!this._matchover)if(console.log("checkMatchWaiting currentMatchMode:",this._currentMatchMode,e),2==this._currentMatchMode)e||PanelMatchWaitingInner.instance.show(t);else if(server.roomInfo&&server.roomInfo.stage&&2==server.roomInfo.stage.length){var n=server.roomInfo.stage[1].playerIn;this._playerInMatch<=n?PanelMatchWaitingInner.instance.show(n):e&&PanelMatchWaitingInner.instance.show()}},e.prototype.onMatchSignUpInfoRep=function(t){var e=t.data;if(e.is_signup)this.onCheckMatchStatus(e.matchid,e.is_signup);else if(this._checkCount--,this._checkCount<=0)return this.onCheckMatchStatus(0),void server.removeEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this)},e.prototype.onPanelMatchResultClose=function(){alien.SceneManager.instance.currentSceneName!=SceneNames.ROOM&&alien.SceneManager.show(SceneNames.ROOM,null,alien.sceneEffect.Fade,null,null,!1,SceneNames.LOADING)},e.prototype.onGiveUpMatchRep=function(t){var e=t.data;0==e.result},e.prototype.checkMatchStatus=function(){var t=this;GameConfig.roomList.forEach(function(e){2!=e.roomType||e.ads||(t._checkCount++,server.getMatchSignUpInfo(e.matchId))})},e.prototype.onCheckMatchStatus=function(t,e){if(void 0===e&&(e=0),t>0){var n=GameConfig.getRoomConfigByMatchId(t);switch(e){case 1:if(n.hasOwnProperty("startDate"))this.addWatchRoom(n);else{var i=PanelMatchWaiting.instance;i.isWaitingShow()||i.show(n)}break;case 2:this.setInMatch(),alien.SceneManager.show(SceneNames.PLAY,{roomID:t,action:"reconnect"},alien.sceneEffect.Fade)}}alien.Dispatcher.dispatch(EventNames.HIDE_WAITING)},e.prototype.addWatchRoom=function(t){var n=e.getNextTurn(t);return this._watchedRooms.push({roomInfo:t,nextTurn:n}),n},e.prototype.removeWatchRoom=function(t){var e=this;this._watchedRooms.some(function(n,i){return n.roomInfo==t?(e._watchedRooms.splice(i,1),!0):void 0})},e.prototype.onTimer=function(){var t=this,e=[];this._watchedRooms.forEach(function(n,i){var o=n.nextTurn.nextTs-server.tsNow;0>=o&&e.push(i),30>=o&&(n.notifyWhen30||(n.notifyWhen30=!0,PanelMatchNotice.instance.show(n.roomInfo,o),SoundManager.instance.vibrate())),300>=o&&(n.notifyWhen300||(n.notifyWhen300=!0,t._matchTopNotify[1].text=n.roomInfo.name,CountDownService.unregister(t._idTopNotify),alien.Dispatcher.dispatch(EventNames.SHOW_TOP_NOTIFY,{content:function(e){t._idTopNotify=CountDownService.register(o,function(n){t._matchTopNotify[3].text=alien.TimeUtils.timeFormat(n),e.textFlow=t._matchTopNotify})},onTap:function(){CountDownService.unregister(t._idTopNotify)},showButton:!0})))}),e.forEach(function(e){t._watchedRooms.splice(e,1)})},e.prototype.signUp=function(t,e){server.matchSignUp(t.matchId,1,e)},e.prototype.cancelMatch=function(t){server.matchSignUp(t.matchId,2)},e.prototype.setInMatch=function(){server.addEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this)},e.prototype.isMatchOver=function(){return this._matchover},e.getRewardStringByRank=function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=" "),this.rewardToString(this.makeRewardTextFlow(this.getRewardByRank(t,e)),n)},e.getRewardStringBy205=function(t){var e=this.getRewardByRank(t,1),n=t.rewardredcoinpool,i=0;for(var o in n)n[o][1]>=i&&(i=n[o][1]);return i/=100,""+(e[0].count+i)+""},e.makeRewardTextFlow=function(t){var e=[];return t&&t.forEach(function(t){var n=t.count;0==t.id&&(n=Utils.currencyRatio(n)),1==t.id?e.push(n+""):e.push(GoodsManager.instance.getGoodsById(t.id).name+"x"+n)}),e},e.rewardToString=function(t,e){return void 0===e&&(e=" "),t.join(e)},e.getNextTurn=function(t){var e=server.tsNow,n=-1;t.cycleTimeStamp.some(function(t,i){return t>e?(n=i,!0):void 0});var i,o,a=0,r="";if(0>n){n=0;var s=server.tsToday+86400;r=alien.TimeUtils.tsToMonthDayString(s),a=86400}return i=r+" "+t.cycleTime[n],o=t.cycleTimeStamp[n]+a,t.nextIndex=n,{nextTime:i,nextIndex:n,nextTs:o}},e.getRewardByRank=function(t,e){void 0===e&&(e=1);var n;return t.reward.some(function(t){return t.rankend>=e&&t.rankstart<=e?(n=Utils.parseGoodsString(t.reward),!0):void 0}),n},e}(Service);__reflect(MatchService.prototype,"MatchService");var PersonalGameHistory=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._loadCount=8,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._source=[],this._reqAmount=0,this._total_page=0},e.prototype.getData=function(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n="get"),e||(e={}),e.uid=server.uid,e.token=UserData.instance.getToken(),e.limit=this._loadCount;var i=GameConfig.WEB_SERVICE_URL+"/user/gamelist",o="post"==n?alien.Ajax.POST:alien.Ajax.GET;o.call(alien.Ajax,i,e,function(e){if(GameConfig.DEBUG&&console.log("get:"+e),t&&e){var n=JSON.parse(e);n.code>0&&GameConfig.DEBUG&&console.log(i,n.code,n.message),t(n)}})},e.prototype.clearDataList=function(){this._source=[],this._reqAmount=0,this._total_page=0},e.prototype.getDataList=function(t){var n=this;if(void 0===t&&(t=0),0==t&&(t=this._reqAmount+1),!(this._reqAmount>=t||this._reqAmount>this._total_page)){var i={page:t};this.getData(function(i){if(0==i.code){e.instance.reqAmount=t>e.instance.reqAmount?t:e.instance.reqAmount;var o=i.data||[];o&&o.items&&o.items.length>0&&(e.instance.source=n._source.concat(o.items),e.instance.total_page=o.total_page),n.dispatchEventWith(EventNames.PGAME_RECORD_DATA_REFRESH,!1,n._source)}},i)}},Object.defineProperty(e.prototype,"reqAmount",{get:function(){return this._reqAmount},set:function(t){this._reqAmount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total_page",{set:function(t){this._total_page=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),e}(Service);__reflect(PersonalGameHistory.prototype,"PersonalGameHistory");var RechargeService=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isWaitTipShowing=!1,e._rechargeTit=(n={},n[10011]="60",n[10012]="180",n[10013]="300",n[10014]="550",n[10015]="1200",n[10001]="10000",n[10002]="30000",n[10003]="100000",n[10004]="200000",n[10005]="500000",n[10006]="1100000",n[10007]="",n[80001]="1",n[80002]="3",n[80003]="7",n[10009]="",n[10016]="",n[10017]="11",n[10018]="",n[10019]="",n[10020]="",n[10021]="",n),e;var n}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){server.addEventListener(EventNames.USER_RECHARGE_RESULT_NOTIFY,this.onRechargeResultNotify,this)},e.prototype.onRechargeResultNotify=function(t){var e=t.data;if(0==e.result){var n=e.productid;this._rechargeTit[n]&&Alert.show(""+this._rechargeTit[n]+"!")}},e.prototype.doRecharge=function(t){webService.rechagre(t)},e}(Service);__reflect(RechargeService.prototype,"RechargeService");var WebService=function(){function t(){this.loadLogStartId="",this.reportUser=function(t,e,n,i,o,a,r,s){void 0===s&&(s=null),this.callApi("game","impeach",r,{token:t,uid:e,type:n,roomid:i,tableid:o,touid:a,content:s})}}return t.prototype.login=function(t,e,n){this.callApi("index","login",function(t){n(t.data)},{username:t,password:e})},t.prototype.fastLogin=function(t){this.callApi("index","guest",function(e){t(e.data)},{device:this.uuid})},t.prototype.doLoginWebCheck=function(t,e,n,i,o){var a=0;alien.Native.instance.isNative&&(a=1),this.callApi("index","login",function(t){o(t)},{type:1,"package":i,unionid:n,code:t,sk:e,os:a},"post")},t.prototype.loginWXApp=function(t){var e=alien.Native.instance,n=this;e.call("loginByWechat",null,function(e){var i=JSON.parse(e);console.log("doAppWxLogin==cb=",i.code,i.wxCode),i&&0==i.code&&i.wxCode&&n.doLoginWebCheck(i.wxCode,null,null,"cn.htgames.doudizhu",t)})},t.prototype.loginByPhone=function(t,e,n,i,o){var a=this;a.callApi("index","login",function(t){o(t)},{type:2,unid:n,sk:i,phone:t,code:e},"post")},t.prototype.loginByWxFromWechat=function(t,e,n,i,o){this.doLoginWebCheck(t,e,n,i,o)},t.prototype.loginByAliH5=function(t,e,n,i){this.callApi("index","login",function(t){i(t)},{type:3,unionid:n,code:t,sk:e},"post")},t.prototype.bindByWx=function(t,e){this.callApi("user","bindByUid",function(t){e(t)},{type:1,"package":"cn.htgames.doudizhu.web",wxcode:t,uid:MainLogic.instance.selfData.uid},"post")},t.prototype.checkAppUpdate=function(t){var e=GameConfig.RESOURCE_URL+"appVerCheck.php",n=egret.Capabilities.os,i=null,o=null,a=alien.Native.instance;a.getAppChannelId(function(r){i=r,a.getAppVerCode(function(r){o=r,console.log("checkAppUpdate=====>",i,o),alien.Ajax.POST(e,{platform:n,channel:""+i,id:"com.tangyou.doudizhu"},function(e){if(console.log("appVerCheck=1=>",e),e){var i=JSON.parse(e),r=i.data;if(r.cleanTmp=!0,r.shouldInstall=!1,console.log("appVerCheck=2=>code:",i.code,"version:",r.version),0==i.code&&r.version>o){if("Android"==n){var s=a.getAndroidLocalVercode(),h=a.getAndroidDownState();console.log("_downVerCode",s,"_downState======",h),s&&0!=s&&s==r.version&&(r.cleanTmp=!1,2==h&&(r.shouldInstall=!0))}return void t(!0,r)}}t(!1,null,null)})})})},t.prototype._callWXPay=function(t){var e=alien.Native.instance;e.isWXMP?e.rechargeInWXMP(t.data):e.isNative?e.rechageWXApp(t.data):e.rechargeWXH5(t.data)},t.prototype._callAliPay=function(t){var e=alien.Native.instance;e.isAli()?e.rechargeAliH5(t.data):e.isNative?e.rechargeAliApp(t.data):e.rechargeAliH5(t.data)},t.prototype._onWebPayOrderCallBack=function(t,e){alien.Native.instance;0==e.code?"wx"==t?this._callWXPay(e):"ali"==t&&this._callAliPay(e):7005==e.code?Alert.show(",!"):7006==e.code?MainLogic.instance.rechareErrByServerUpdate():50003==e.code?Alert.show("!"):Alert.show(",:"+e.code)},t.prototype.getRechargeCfgByAli=function(t){var e="PAGEAPI",n=this,i=alien.Native.instance;i.isNative&&(e="APP"),this.callApi("shop","alipayOrder",function(t){n._onWebPayOrderCallBack("ali",t)},{product_id:t,os:1,uid:MainLogic.instance.selfData.uid,type:GameConfig.SERVER_URL_TAIL,trade_type:e},"post")},t.prototype.getRechargeCfgByWX=function(t){var e="h5",n=this,i=alien.Native.instance;i.isNative?e="APP":i.isWXMP||i.isAli()||(e="MWEB"),this.callApi("shop","wechatpayOrder",function(t){n._onWebPayOrderCallBack("wx",t)},{product_id:t,os:1,uid:MainLogic.instance.selfData.uid,type:GameConfig.SERVER_URL_TAIL,trade_type:e},"post")},t.prototype.rechagre=function(t){var e=alien.Native.instance;e.isWXMP?this.getRechargeCfgByWX(t):e.isAli()?this.getRechargeCfgByAli(t):(e.isInMiniApp()?this.getRechargeCfgByWX(t):e.isNative||PanelChoosePay.getInstance().show(t),console.log(",:",e.getChannelName(),"|APP:",e.isNative))},t.prototype.buyCardsRecorder=function(t){this.rechagre(t)},t.prototype.getShareImgUrlByScene=function(t,e){void 0===e&&(e=1);var n="https://ddz.yiyuc.com/wxunion/friendshare.php";alien.Ajax.GET(n,{uid:MainLogic.instance.selfData.uid,scene:e},t)},t.prototype.getWxConfig=function(t){this.callApi("wechat","jsConfig",function(e){0==e.code&&t(e.data)},{url:encodeURIComponent(window.top.location.href)},"post")},t.prototype.loadLog=function(t,e){var n=this;if(!alien.Native.instance.isNative){if(1==t&&this.isLogType1Send)return;if(2==t&&this.isLogType2Send)return;var i=(new Date).valueOf(),o=alien.localStorage.getItem("is_first",GameConfig.platform);o=null==o?"1":o;var a=Number(o);1==e&&(this.loadLogStartId="");var r=md5(webService.uuid+t+e+i+"!@#HTGames$%^");this.callApi("load","index",function(t){t&&0==t.code&&(n.loadLogStartId=t.data)},{uuid:webService.uuid,load_type:t,load_tag:e,load_time_stamp:i,is_first:a,start_id:this.loadLogStartId,sign:r},"post"),1==a&&2==t&&0==e&&alien.localStorage.setItem("is_first","0",GameConfig.platform),1==t&&0==e&&(this.isLogType1Send=!0),2==t&&0==e&&(this.isLogType2Send=!0)}},t.prototype.bindPhoneByLogin=function(t,e,n,i,o){this.callApi("index","login",function(t){o(t)},{phone:t,code:e,sk:i,unid:n,type:2})},t.prototype.bindPhoneByExchange=function(t,e,n){var i=UserData.instance,o=i.getUid(),a=i.getToken(),r="ddz";_nativeBridge.isAli()?r="alipay":_nativeBridge.isWXMP?r="wechat":_nativeBridge.isNative&&(r="wechat"),this.callApi("index","bindMobile",function(t){n(t)},{phone:t,code:e,token:a,uid:o,source:r})},t.prototype.getCode=function(t,e){this.callApi("user","getYunCode",function(t){e(t)},{phone:t},"get")},t.prototype.getExChangeHistory=function(t,e,n,i){this.callApi("user","bind",function(t){i(t.code)},{phone:t,code:e,password:n,device_id:webService.uuid})},t.prototype.getRedcoinHistory=function(t,e){this.callApi("coin","index",function(t){e(t)},{uid:t},"get")},t.prototype.getWatchPublicWX=function(t,e){this.callApi("user","getUserInfo",function(t){e(t)},{uid:t},"post")},t.prototype.getServer=function(t,e){this.callApi("user","server",function(t){e(t)},{uid:t},"post")},t.prototype.callApi=function(t,e,n,i,o){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o="post"),i||(i={}),i.pf=alien.Native.instance.platformId;var a=GameConfig.WEB_SERVICE_URL+t+"/"+e,r="post"==o?alien.Ajax.POST:alien.Ajax.GET;r.call(alien.Ajax,a,i,function(t){if(GameConfig.DEBUG&&console.log("get:"+t),n){var e=JSON.parse(t);if(e.code>0&&(GameConfig.DEBUG&&console.log(a,e.code,e.message),500==e.code))return void Alert.show(",20181302:00:00",0,function(){MainLogic.instance.closeSelf()});n(e)}})},t.prototype.postError=function(t,e){var n="";MainLogic.instance.selfData&&(n=MainLogic.instance.selfData.nickname),n?n+=" #$% ":n="",alien.Ajax.POST(GameConfig.WEB_SERVICE_URL+"/load/error",{uuid:this.uuid,type:t,body:n+e})},t.prototype.getHornRec=function(t){alien.Ajax.GET(GameConfig.WEB_SERVICE_URL+"/msg/chatmsg",{},function(e){if(t){var n=JSON.parse(e);0==n.code&&t(n.data)}})},t.prototype.postLoginStep=function(t,e){void 0===e&&(e="")},t.prototype.getExHistory=function(t,e){var n=UserData.instance.getToken();alien.Ajax.POST(GameConfig.WEB_SERVICE_URL+"/wechat/redcoin",{uid:server.uid,token:n,page:t},function(t){var n=JSON.parse(t);e(n)})},t.prototype.goRechageFei=function(t,e){alien.Ajax.POST(GameConfig.WEB_SERVICE_URL+"/mobile/onlineorder",t,function(t){var n=JSON.parse(t);e(n)})},t.prototype.doCodeExchange=function(t,e){alien.Ajax.POST("https://wx.yiyuc.com/ddz-shop/exchangecode",t,function(t){var n=JSON.parse(t);e(n)})},t}();__reflect(WebService.prototype,"WebService");var webService=new WebService,BrowData=function(){function t(){this._browsEnable={},this.init()}return t.prototype.init=function(){for(var e=t.BrowID.BROW_MIN;e<=t.BrowID.BROW_MAX;++e)this._browsEnable[e]={enable:!0}},t.prototype.checkCanBuyByBrowId=function(t){return this._browsEnable[t]?this._browsEnable[t].enable:!1},t.prototype.startCDByBrowId=function(t){var e=this;this._browsEnable[t]&&(this._browsEnable[t].enable=!1,egret.setTimeout(function(){e._browsEnable[t].enable=!0},this,200))},t.prototype.getBrowCostGold=function(t){var e=GameConfig.getBrowCfgById(t);return e?e.price:null},t.getBrowAniDataById=function(e){if(!t.brows[e])return null;var n=t.brows[e].json,i=t.brows[e].png,o=t.brows[e].actName;return{json:n,png:i,actName:o}},t.createBrowMCById=function(e){var n=t.getBrowAniDataById(e);if(!n)return null;var i=RES.getRes(n.json),o=RES.getRes(n.png),a=new egret.MovieClipDataFactory(i,o),r=new egret.MovieClip(a.generateMovieClipData(n.actName));return r},t.isNeedXMoveById=function(e){return t.brows[e].xMove},t.getBrowAniWHById=function(e){var n=t.brows[e].width,i=t.brows[e].height;return{width:n,height:i}},t.getBrowAniLastStayById=function(e){return t.brows[e].fStay},t.BrowID={BROW_MIN:1,BROW_666:1,BROW_TORTISE:2,BROW_TOMATO:3,BROW_LOVE:4,BROW_GOOD:5,BROW_MAX:5},t.brows=(_a={},_a[t.BrowID.BROW_666]={json:"brow666Ani_json",png:"brow666Ani_png",actName:"brow666",xMove:!1,width:260,height:260},_a[t.BrowID.BROW_TORTISE]={json:"browTortiseAni_json",png:"browTortiseAni_png",actName:"browTortise",xMove:!1,width:170,height:118},_a[t.BrowID.BROW_TOMATO]={json:"browTomatoAni_json",png:"browTomatoAni_png",actName:"browTomato",xMove:!1,width:230,height:220,fStay:.4},_a[t.BrowID.BROW_LOVE]={json:"browLoveAni_json",png:"browLoveAni_png",actName:"browLove",xMove:!1,width:194,height:200},_a[t.BrowID.BROW_GOOD]={json:"browGoodAni_json",png:"browGoodAni_png",actName:"browGood",xMove:!0,width:208,height:330},_a),t}();__reflect(BrowData.prototype,"BrowData");var _a,alien;!function(t){var e=function(){function t(e,n,i,o,a,r,s){void 0===i&&(i=null),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===r&&(r=!1),void 0===s&&(s=0),this._oldProperties={},this._t=0,this.target=e,this._calProps=i?i:t.round,this.duration=n,this.loop=o,this.reverse=r,this.delay=s,this.updateRegisterPos(),a&&this.play()}return t.prototype.updateRegisterPos=function(){this._oldProperties.x=this.target.x,this._oldProperties.y=this.target.y,this._oldProperties.scaleX=this.target.scaleX,this._oldProperties.scaleY=this.target.scaleY,this._oldProperties.skewX=this.target.skewX,this._oldProperties.skewY=this.target.skewY,this._oldProperties.rotation=this.target.rotation,this._oldProperties.alpha=this.target.alpha},t.prototype.play=function(){this._tween||(this._count=0,this._playStep())},t.prototype._playStep=function(){return this.loop>0&&this._count>=this.loop?void this.stop():(this._count++,this.t=this.reverse?2*Math.PI:0,this._tween=egret.Tween.get(this),void this._tween.wait(this.delay).to({t:this.reverse?0:2*Math.PI},this.duration).call(this._playStep,this))},Object.defineProperty(t.prototype,"t",{get:function(){return this._t},set:function(t){if(this.target.stage){this._t=t;var e=this._calProps.call(this,this._t);e.hasOwnProperty("x")&&(this.target.x=(e.x||0)+this._oldProperties.x),e.hasOwnProperty("y")&&(this.target.y=(e.y||0)+this._oldProperties.y),e.hasOwnProperty("sx")&&(this.target.scaleX=e.sx),e.hasOwnProperty("sy")&&(this.target.scaleY=e.sy),e.hasOwnProperty("skewX")&&(this.target.skewX=e.skewX),e.hasOwnProperty("skewY")&&(this.target.skewY=e.skewY),e.hasOwnProperty("r")&&(this.target.rotation=e.r),e.hasOwnProperty("alpha")&&(this.target.alpha=e.alpha)}},enumerable:!0,configurable:!0}),t.prototype.stop=function(t,e,n){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===n&&(n=1e3),this._tween&&(egret.Tween.removeTweens(this),t&&egret.Tween.get(this.target).to(this._oldProperties,n),this._tween=null)},Object.defineProperty(t.prototype,"playing",{get:function(){return null!=this._tween},enumerable:!0,configurable:!0}),t.round=function(t){return{x:Math.cos(t),y:Math.sin(t)}},t.cos=function(t){return{x:Math.cos(t),y:0}},t.sin=function(t,e){return t=t||1,{x:0,y:Math.sin(e)*t}},t.rotate=function(t){return{r:360*t/Math.PI/2}},t.shake=function(t,e){return t=t||10,{r:Math.sin(2*e)*t}},t.breath=function(t,e){return{sx:Math.sin(e)*t+1,sy:-Math.sin(e+Math.PI/4)*t+1}},t}();t.Wave=e,__reflect(e.prototype,"alien.Wave",["alien.IAnimation"])}(alien||(alien={}));var DebugHelper=function(){function t(){}return t.isAdmin=function(){return"seacole"==MainLogic.instance.selfData.nickname.substr(0,7)?!0:!1},t}();__reflect(DebugHelper.prototype,"DebugHelper");var ErrorConfig=function(){function t(){}return t.BMG_LOAD_ERROR="BMG_LOAD_ERROR",t.CONFIG_LOAD_ERROR="CONFIG_LOAD_ERROR",t.RESOURCE_LOAD_ERROR="RESOURCE_LOAD_ERROR",t.REPORT_ERROR="REPORT_ERROR",t}();__reflect(ErrorConfig.prototype,"ErrorConfig");var EventNames=function(){function t(){}return t.PGAME_RECORD_DATA_REFRESH="personalGameRecordDataRefresh",t.INVITE_DATA_REFRESH="inviteDataRefresh",t.LOADING_PROGRESS="loadingProgress",t.BUTTON_BAR_TAP="buttonBarTap",t.CLOCK_0="clock0",t.SELECT_CHAT="selectChat",t.SELECT_CARDS="selectCards",t.TAP_SEAT="tapSeat",t.LOG="log",t.CONTINUE_PLAY="continuePlay",t.SHOW_DISCONNECT="showDisconnect",t.HIDE_DISCONNECT="hideDisconnect",t.SHOW_WAITING="showWaiting",t.HIDE_WAITING="hideWaiting",t.SHOW_GAME_EFFECT="showGameEffect",t.SHOW_TOAST="showToast",t.SHOW_PAYCHAT="showPayChat",t.SHOW_ANNOUNCE="showAnnounce",t.HIDE_ANNOUNCE="hideAnnounce",t.SHOW_TOP_NOTIFY="showTopNotify",t.HIDE_TOP_NOTIFY="hideTopNotify",t.MY_USER_INFO_UPDATE="myUserInfoUpdate",t.REFRESH_MATCH_LIST="refreshMatchList",t.MATCH_CD_NOTIFICATION="matchCDNotification",t.BAG_INFO_REFRESH="bagInfoRefresh",t.BAG_COUNT_CHANGE="bagCountChange",t.MAIL_LIST_REFRESH="mailListRefresh",t.MAIL_UNREAD_UPDATE="mailUnOpenUpdate",t.MISSION_LIST_REFRESH="missionListRefresh",t.GOLD_UPDATE="goldUpdate",t.GOLD_RAIN_EFFECT="goldRainEffect",t.WX_SHARE="wxShare",t.CONNECT_SERVER="connectToServer",t.SERVER_CLOSE="serverClose",t.SERVER_ERROR="serverError",t.LOGIN_SUCCESS="LOGIN_SUCCESS",t.ENTER_BACKGROUND="enterBackground",t.USER_FRREWARD_GET_SUCC="USER_FRREWARD_GET_SUCC",t.USER_DTREWARD_GET_SUCC="USER_DTREWARD_GET_SUCC",t.ACT_RED_CHANGE="ACT_RED_CHANGE",t.USER_SHARE_RESULT="USER_SHARE_RESULT",t.USER_RED_COUNT_CHANGE="USER_RED_COUNT_CHANGE",t.HORN_TALK_RECORDS_CHANGE="HORN_TALK_RECORDS_CHANGE",t.CENTER_ROOM_HORN_POS="CENTER_ROOM_HORN_POS",t.NATIONAL_INFO_CHANGE="NATIONAL_INFO_CHANGE",t.TO_NORMAL_MATCH="TO_NORMAL_MATCH",t.CLOSE_REVIVE_PANEL="CLOSE_REVIVE_PANEL",t.BUY_REVIVE_SUCC="BUY_REVIVE_SUCC",t.ACCOUNT_ERROR="ACCOUNT_ERROR",t.HIDE_MOSTTOP_TIP="HIDE_MOSTTOP_TIP",t.RECV_SOCKET_DATA="RECV_SOCKET_DATA",t.START_OTHER_GAME="START_OTHER_GAME",t.SERVER_HASUPDATE="SERVER_HASUPDATE",t.FRECHARGE_HASUPDATE="FRECHARGE_HASUPDATE",t.LOGINAPP_HASUPDATE="LOGINAPP_HASUPDATE",t.GET_CARDS_RECORDER_REWARD_REQ="user.GetCardsRecorderRewardReq",t.GET_FRESHMAN_REWARD_REQ="user.GetFreshManRewardReq",t.GET_FRESHMAN_REWARD_REP="user.GetFreshManRewardRep",t.CREATE_PERSONAL_GAME_REQ="user.CreatePersonalGameReq",t.CREATE_PERSONAL_GAME_REP="user.CreatePersonalGameRep",t.JOIN_PGAME_REQ="user.JoinPGameReq",t.JOIN_PGAME_REP="user.JoinPGameRep",t.START_PGAME_REQ="user.StartPGameReq",t.START_PGAME_REP="user.StartPGameRep",t.QUERY_ROOMINFO_REQ="user.QueryRoomInfoReq",t.QUERY_ROOMINFO_REP="user.QueryRoomInfoRep",t.QUIT_PGAME_REQ="user.QuitPGameReq",t.QUIT_PGAME_REP="user.QuitRoomRep",t.GAME_DISSOLVE="user.GameDissolve",t.RECONNECT_PGAME_REQ="user.ReconnectPGameReq",t.RECONNECT_PGAME_REP="user.ReconnectPGameRep",t.USER_QUICK_JOIN_REQUEST="user.QuickJoinRequest",t.USER_QUICK_JOIN_RESPONSE="user.QuickJoinResonpse",t.USER_USER_INFO_REQUEST="user.UserInfoRequest",t.USER_USER_INFO_RESPONSE="user.UserInfoResonpse",t.USER_CHECK_RECONNECT_REQ="user.CheckReconnectReq",t.USER_CHECK_RECONNECT_REP="user.CheckReconnectRep",t.USER_RECONNECT_TABLE_REQ="user.ReconnectTableReq",t.USER_RECONNECT_TABLE_REP="user.ReconnectTableRep",t.USER_LOGIN_RESPONSE="user.loginResponse",t.USER_PLAYERS_AMOUNT_REQ="user.PlayersAmountReq",t.USER_PLAYERS_AMOUNT_REP="user.PlayersAmountRep",t.USER_MODIFY_USER_INFO_REQ="user.ModifyUserInfoReq",t.USER_MODIFY_USER_INFO_REP="user.ModifyUserInfoRep",t.USER_REDCOIN_RANKING_LIST_REQ="user.RedcoinRankingListReq",t.USER_REDCOIN_RANKING_LIST_REP="user.RedcoinRankingListRep",t.USER_OPERATE_REP="user.OperateRep",t.USER_OPERATE_REQ="user.OperateReq",t.USER_DAY_SIGN_IN_REQ="user.DaySigninOptReq",t.USER_DAY_SIGN_IN_REP="user.DaySigninOptRep",t.USER_NOTIFY_KICK_OUT="user.NotifyKickout",t.USER_MATCH_SING_UP_INFO_REQ="user.MatchSignupInfoReq",t.USER_MATCH_SING_UP_INFO_REP="user.MatchSignupInfoRep",t.USER_MATCH_SING_UP_REQ="user.MatchSignupReq",t.USER_MATCH_SING_UP_REP="user.MatchSignupRep",t.USER_MATCH_START_NTF="user.MatchStartNtf",t.USER_MATCH_INFO_NTF="user.MatchInfoNtf",t.USER_ENTER_MATCH_REQ="user.EnterMatchReq",t.USER_ENTER_MATCH_REP="user.EnterMatchRep",t.USER_RED_PACKET_ANNOUNCE="user.RedPacketAnnounce",t.USER_BAG_INFO_REQ="user.BagInfoReq",t.USER_BAG_INFO_REP="user.BagInfoRep",t.USER_GIVE_UP_MATCH_REQ="user.GiveupMatchReq",t.USER_GIVE_UP_MATCH_REP="user.GiveupMatchRep",t.USER_ALMS_REQ="user.AlmsReq",t.USER_ALMS_REP="user.AlmsRep",t.USER_RECHARGE_RESULT_NOTIFY="user.RechargeResultNotify",t.USER_REDCOIN_EXCHANGE_GOODS_REQ="user.RedcoinExchangeGoodsReq",t.USER_REDCOIN_EXCHANGE_GOODS_REP="user.RedcoinExchangeGoodsRep",t.USER_LOTTERY_RED_COIN_REQ="user.LotteryRedcoinReq",t.USER_LOTTERY_RED_COIN_REP="user.LotteryRedcoinRep",t.USER_PAY_TO_CHAT_REQ="user.Pay2chatReq",t.USER_PAY_TO_CHAT_REP="user.Pay2chatRep",t.USER_FRESH_MAN_REDCOIN_LOTTERY_CHANCEGOT="user.FreshManRedcoinLotteryChanceGot",t.USER_GET_TASKREW_REQ="user.GetDayTaskRewardReq",t.USER_GET_TASKREW_REP="user.GetDayTaskRewardRep",t.USER_GET_FRREWARD_REQ="user.GetFirstRechargeRewardReq",t.USER_GET_FRREWARD_REP="user.GetFirstRechargeRewardRep",t.USER_GET_REWARD_REQ="user.GetRewardReq",t.USER_GET_REWARD_REP="user.GetRewardRep",t.USER_GET_ACTInfo_REQ="user.GetActivityInfoReq",t.USER_GET_ACTInfo_REP="user.GetActivityInfoRep",t.USER_DiamondGame_REQ="user.DiamondGameReq",t.USER_DiamondGame_REP="user.DiamondGameRep",t.USER_MailList_REP="user.MailListRep",t.USER_MailModify_REP="user.MailModifyRep",t.USER_MailUnread_REP="user.MailUnreadRep",t.USER_MailOperate_REQ="user.MailReq",t.USER_MailGetReward_REP="user.MailGetRewardRep",t.QUIT_WAITING_QUEUE_REQ="user.QuitWaitingQueueReq",t.USER_MatchOperate_REQ="user.MatchOperateReq",t.USER_MatchOperate_REP="user.MatchOperateRep",t.GAME_RECONNECT_REP="game.ReconnectRep",t.GAME_USER_ONLINE="game.UserOnline",t.GAME_USER_INFO_IN_GAME_REQ="game.UserInfoInGameReq",t.GAME_USER_INFO_IN_GAME_REP="game.UserInfoInGameRep",t.GAME_SET_SESSION="game.SetSession",t.GAME_GAME_START_NTF="game.GameStartNtf",t.GAME_SET_CARDS="game.SetCards",t.GAME_ADD_CARD="game.AddCard",t.GAME_UPDATE_GAME_INFO="game.UpdateGameInfo",t.GAME_ASK_MASTER="game.AskMaster",t.GAME_ANSWER_MASTER="game.AnswerMaster",t.GAME_SET_SCORE="game.SetScore",t.GAME_SHOW_CARD="game.ShowCard",t.GAME_ASK_PLAY_CARD="game.AskPlayCard",t.GAME_USE_CARD_NTF="game.UseCardNtf",t.GAME_TALK_NTF="game.TalkNtf",t.GAME_OPERATE_REQ="game.OperateReq",t.GAME_OPERATE_REP="game.OperateRep",t.GAME_GAME_END="game.GameEnd",t.GAME_ENTER_TABLE="game.EnterTable",t.GAME_LEAVE_TABLE="game.LeaveTable",t.GAME_TABLE_INFO="game.TableInfo",t.GAME_GIVE_UP_GAME_REQ="game.GiveUpGameReq",t.GAME_GIVE_UP_GAME_REP="game.GiveUpGameRep",t.GAME_ASK_READY="game.AskReady",t.GAME_GET_READY_REQ="game.GetReadyReq",t.GAME_GET_READY_REP="game.GetReadyRep",t.GAME_USER_OFFLINE="game.UserOffline",t
}();__reflect(EventNames.prototype,"EventNames");var GameConfig=function(){function t(){}return t.getRoomConfigById=function(t){var e;return this.roomList.forEach(function(n){return n.roomID==t?(e=n,!0):void 0}),e},t.getSuitableRoomConfig=function(t){for(var e=0;e<this.roomList.length;++e)if(1==this.roomList[e].roomType&&this.roomList[e].maxScore>t&&this.roomList[e].minScore<=t)return this.roomList[e]},t.getRoomConfigByMatchId=function(t){for(var e=0;e<this.roomList.length;++e)if(this.roomList[e].matchId==t)return this.roomList[e]},t.setMatchSignupFlag=function(t,e){this.roomList.forEach(function(n){n.matchId==t&&(n.is_signup=e)})},t.anyMatchSignuped=function(){for(var t=0;t<this.roomList.length;++t)if(this.roomList[t].is_signup>0)return!0;return!1},t.getRoomConfig=function(t){var e=this.getRoomConfigById(t);return e||(e=this.getRoomConfigByMatchId(t)),e},t.getMatchConfigById=function(t){for(var e in this.matchConfig)if(parseInt(e)==t)return this.matchConfig[e]},t.init=function(){lang=new Language(RES.getRes("lang")),this.CARD_WIDTH*=this.CARD_SCALE,this.CARD_HEIGHT*=this.CARD_SCALE,this.CARD_GAP_H*=this.CARD_SCALE,this.CARD_OFFSET=this.CARD_WIDTH-this.CARD_GAP_H},t.getUrl=function(e){var n=this;alien.Ajax.GET((this.DEBUG?this.RESOURCE_URL:lang.config_url)+"geturl.php",{},function(i){var o=JSON.parse(i);n.DEBUG||(t.WEB_SERVICE_URL=o.WEB_SERVICE_URL,t.WX_LOGIN_URL=o.WX_LOGIN_URL,t.RESOURCE_URL=o.RESOURCE_URL,t.RECHARGE_URL=o.RECHARGE_URL,t.REGISTER_URL=o.REGISTER_URL,t.PASSWORD_URL=o.PASSWORD_URL,t.HOME_PAGE_URL=o.HOME_PAGE_URL,t.DOWNLOAD_PAGE_URL=o.DOWNLOAD_PAGE_URL,t.LOBBY_PAGE_URL=o.LOBBY_PAGE_URL),console.log("WX_LOGIN_URL:"+t.WX_LOGIN_URL),console.log("WEB_SERVICE_URL:"+t.WEB_SERVICE_URL),console.log("RESOURCE_URL:"+t.RESOURCE_URL),console.log("RECHARGE_URL:"+t.RECHARGE_URL),t.urlData=o,e()},function(){webService.postError(ErrorConfig.CONFIG_LOAD_ERROR,"geturl.php")})},t.getUrlData=function(e){e(t.urlData)},t.initServer=function(t){this.SERVER_URL=t,console.log("SERVER_URL===>",this.SERVER_URL),this.init_SERVER_URL_TAIL()},t.init_SERVER_URL_TAIL=function(){var e=t.SERVER_URL,n=e.split("."),i=n[0],o=i.substr(i.length-1);t.SERVER_URL_TAIL=o,console.log("SERVER_URL_TAIL===>",t.SERVER_URL_TAIL)},t.getServerUrl=function(t,e,n){},t.resetRoomList=function(){this.roomList=JSON.parse(JSON.stringify(this.roomListBak))},t._formatChatCost=function(t){var e={},n=null;for(var i in t)n=t[i].split(":"),e[Number(i)+1]={id:Number(n[0]),cost:Number(n[1])};return e},t.parseShareRewardCfg=function(){var t=this.dbsConfig.day_share_reward.split("|");if(t){for(var e={},n=null,i=0;i<t.length;++i)n=t[i].split(":"),e[n[0]]=parseInt(n[1]);this._dayShareCfg=e}},t.loadConfigs=function(e){var n=this;SceneLoading.setLoadingText(""),alien.Ajax.GET((this.DEBUG?this.RESOURCE_URL:lang.config_url)+"config.php",{id:this.gameId},function(i){var o=JSON.parse(i);n.dbsConfig=o.dbs_config,n.rid2gt=o.rid2gt,n.chatCost=t._formatChatCost(n.dbsConfig.chat_consume);var a=o.custom;n.almsConfig=n.dbsConfig.alms,n._dayShareCfg=n.dbsConfig.day_share_reward,n.parseShareRewardCfg(),n._diamondExCfg=n.dbsConfig.diamond_exc,n.currencyRatio=a.currency_ratio,n.rechargeRatio=a.recharge_ratio,n.exchangeRatio=a.exchange_ratio;var r=n.dbsConfig.login_app_reward.split("|");if(r){for(var s={},h=null,c=0;c<r.length;++c)h=r[c].split(":"),s[h[0]]=parseInt(h[1]);n.loginAppRew=s}n.wxService=a.qq,n.extendWX=a.extendWX,n.signInRewardConfig=n.dbsConfig.daysignin.map(function(t){return Utils.parseGoodsString(t)}),n.roomListBak=o.game.rooms,n.roomListBak.sort(function(t,e){return t.roomID-e.roomID}),n.roomList=o.game.rooms,n._browList=o.game_prop,n._dayTaskList=o.day_task,t._formatFRechargeDays(n.dbsConfig.firstrechargereward.reward),n.roomList.sort(function(t,e){return t.roomID-e.roomID}),n.matchConfig=o.match,n.goodsConfig=o.goods,n.rechargeConfig=o.recharge,n.exchangeConfig=o.red_coin_exchange,n.exchangeGoodsConfig=o.red_coin_goods,n.personalGameConfig=o.personalgame,n.testers=o.testers,n.cardsRecorderConfig=o.cards_recorder_buy_option,e(o)})},t._formatNationalLoginRewCfg=function(){for(var t={},e=0,n=0,i=null,o=this.nationalCfg.daysignin,a=0;a<o.length;++a)i=o[a].split(":"),e=Number(i[0]),n=Number(i[1]),t[a+1]={id:e,num:n};this.nationalCfg.daysignin=t},t._formatFRechargeDays=function(t){for(var e=null,n={},i=null,o=0;o<t.length;++o){e=t[o].split("|"),n[o]=[];for(var a=0;a<e.length;++a)i=e[a].split(":"),n[o].push({id:parseInt(i[0]),num:parseInt(i[1])})}this._fRechargeCfg=n},t.getBrowCfgById=function(t){var e=null;if(this._browList)for(var n=0;n<this._browList.length;++n)if(t==this._browList[n].id)return{id:this._browList[n].id,currency:this._browList[n].currency,price:this._browList[n].price};return e},t.getDayTaskList=function(){return this._dayTaskList},t.getFRechargeRewByDay=function(t){return 1>t?null:this._fRechargeCfg&&this._fRechargeCfg[t-1]?this._fRechargeCfg[t-1]:null},t.getFRechargeInfo=function(){for(var e=0;e<t.rechargeConfig.length;++e)if(t.rechargeConfig[e].firstrecharge)return t.rechargeConfig[e];return LogUtil.error("getFRechargeInfo------error----->"),null},t.getReviveBagInfo=function(){for(var e=0;e<t.rechargeConfig.length;++e)if(10009==t.rechargeConfig[e].product_id)return t.rechargeConfig[e];return LogUtil.error("getReviveBagInfo------error----->"),null},t.getLoginAppRew=function(){return this.loginAppRew},t.getItemNameById=function(t){var e=this._itemName[t];return e?e:null},t.getLoginAppRewText=function(){if(this.loginAppRew){var t="",e=null;for(var n in this.loginAppRew)e=this.getItemNameById(Number(n)),e&&(t+=e+"x"+this.loginAppRew[n]+"\n");return t}return""},t.getNationalCfg=function(){return this.nationalCfg},t.isInNationalTime=function(){var t={isInTime:!1,isBefore:!1,isAfter:!1};if(this.nationalCfg&&this.nationalCfg.trigger_time&&this.nationalCfg.finish_time){var e=(new Date).getTime(),n=1e3*this.nationalCfg.trigger_time,i=1e3*this.nationalCfg.finish_time;e>=n&&i>=e?t.isInTime=!0:n>e?(t.isInTime=!1,t.isBefore=!0,t.isAfter=!1):e>i&&(t.isInTime=!1,t.isBefore=!1,t.isAfter=!0)}return t},t.isTimeToGetNationalInviteRew=function(){if(this.nationalCfg&&this.nationalCfg.finish_time){var t=(new Date).getTime(),e=1e3*this.nationalCfg.finish_time;if(t>=e)return!0}return!1},t.getNationalInviteRewByNum=function(t){if(this.nationalCfg&&this.nationalCfg.invite&&4==this.nationalCfg.invite.length){var e=this.nationalCfg.invite,n=e[0].e,i=e[1].e,o=e[2].e,a=e[3].e,r=.01*e[0].reward,s=.01*e[1].reward,h=.01*e[2].reward,c=.01*e[3].reward;return n>=t?t*r:i>=t?(t-n)*s+r*n:o>=t?n*r+s*(i-n)+(t-i)*h:a>=t?n*r+s*(i-n)+(o-i)*h+(t-o)*c:n*r+(i-n)*s+(o-i)*h+(a-o)*c}return 0},t.getNationalLoginRewByDay=function(t){if(this.nationalCfg&&this.nationalCfg.daysignin&&this.nationalCfg.daysignin[t]){var e=this.nationalCfg.daysignin[t];if(e){var n=(a={},a[0]="x{0}",a[1]="x{0}",a[2]="x{0}",a[101]="x{0}",a),i=n[e.id],o=e.num;if(1==e.id&&(o=.01*o),i)return i=i.replace("{0}",o)}}return null;var a},t.shouldShowNationalBtn=function(){var t="2017-09-30 23:50:00",e=new Date(Date.parse(t.replace(/-/g,"/"))).getTime(),n=(new Date).getTime();return n>=e?!0:!1},t.getNationalInviteRewTimeOut=function(){var t="2017-10-15 00:00:00",e=new Date(Date.parse(t.replace(/-/g,"/"))).getTime(),n=(new Date).getTime();return n>=e?!0:!1},t.getChatCostInfoByType=function(t){return this.chatCost&&this.chatCost[t]?this.chatCost[t]:null},t.copyText=function(t,e,n,i){void 0===i&&(i=!1);var o=e;if(alien.Native.instance.isNative)alien.Native.instance.toClipboard(o),i?Toast.show(""):Alert.show(""+n+"!");else{var a=document.getElementById("ddzCopyTex"),r=document.getElementById("ddzCopyBtn");a.style.visibility="visible",a.value=o;var s=new Clipboard(".copyBtn");s.on("success",function(t){i?Toast.show(""):Alert.show(""+n+"!")}),s.on("error",function(t){Alert.show(""+n+"")}),r.click(),a.style.visibility="hidden"}},t.getShareRewCfg=function(){return this._dayShareCfg},t.getDiamondExCfg=function(){return this._diamondExCfg},t.getRid2gt=function(t){return this.rid2gt&&this.rid2gt[t]?this.rid2gt[t]:null},t.downApp=function(){var t="https://m.hztangyou.com/down/?src=h5ddz";window.top.location.href=t},t.DEBUG=!1,t.IS_NATIVE_DEBUG=!1,t.IS_NATIVE_SHOW_TIP=!0,t.gameName="ddz",t.gameAlice="ddz",t.gameId=1,t.platform="bode",t.CHAT_COUNT_DOWN=1,t.CARD_SCALE=1,t.CARD_WIDTH=140,t.CARD_HEIGHT=178,t.CARD_GAP_H=50,t.CARD_GAP_V=100,t.SERVER_URL="ws://192.168.0.91:9001/ws",t.WX_LOGIN_URL="http://www.htgames.cn/zhanghaichuan",t.WEB_SERVICE_URL="http://192.168.1.7:8081/",t.REPORT_URL="http://120.27.162.46:8866/_.gif",t.RESOURCE_URL="http://192.168.0.81/laoqifeng/platform/",t.RECHARGE_URL="http://pay.exunsoul.com:8998/index/pay?account=",t.REGISTER_URL="http://reg.gamebode.com/regist.html",t.PASSWORD_URL="http://reg.gamebode.com/motify.html",t.HOME_PAGE_URL="http://reg.gamebode.com/index.html",t.DOWNLOAD_PAGE_URL="http://reg.gamebode.com/index.html",t.LOBBY_PAGE_URL="http://reg.gamebode.com/game_list_1.html",t.EXCHANGE_URL="http://192.168.0.86:8998/coin/index",t.currencyRatio=1,t.rechargeRatio=1e3,t.exchangeRatio=100,t.wxService="",t.extendWX="",t.loginAppRew=null,t._itemName=(_a={},_a[0]="",_a[1]="",_a[2]="",_a[3]="",_a[101]="",_a[41001]="",_a[41002]="",_a[41003]="",_a),t}();__reflect(GameConfig.prototype,"GameConfig");var lang,_a,GameData=function(t){function e(){var e=t.call(this)||this;return e.name="save",e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}(DataStorage);__reflect(GameData.prototype,"GameData");var Language=function(t){function e(e){var n=t.call(this)||this;return n.splitCache={},n.id=new LanguageIds,alien.Utils.injectProp(n,e),n}return __extends(e,t),e.prototype.split=function(t,e){var n=this.splitCache[t];return n||(n=this.splitCache[t]=lang[t].split(",")),n[e]},e.prototype.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return alien.StringUtils.formatApply(this[t],e)},e}(LanguagePack);__reflect(Language.prototype,"Language");var alien;!function(t){var e=function(){function t(){}return t.init=function(t){this.ID=t},t.getName=function(t,e){return void 0===e&&(e=null),(e||!this.ID||""==this.ID?e:this.ID)+"_"+t},t.getItem=function(t,e){return void 0===e&&(e=null),egret.localStorage.getItem(this.getName(t,e))},t.setItem=function(t,e,n){return void 0===n&&(n=null),egret.localStorage.setItem(this.getName(t,n),e)},t.getItemObj=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i;try{i=JSON.parse(this.getItem(t,n))}catch(o){}return i||(i=e),i},t.setItemObj=function(t,e,n){return void 0===n&&(n=null),this.setItem(t,JSON.stringify(e),n)},t.ID="",t}();t.localStorage=e,__reflect(e.prototype,"alien.localStorage")}(alien||(alien={}));var ResNames=function(){function t(){}return t.bank_panel_inner_bg="bank_panel_inner_bg",t.bank_word_30="bank_word_30",t.bank_word_31="bank_word_31",t.bank_word_32="bank_word_32",t.bank_word_33_h="bank_word_33_h",t.bank_word_33_n="bank_word_33_n",t.bank_word_34_h="bank_word_34_h",t.bank_word_34_n="bank_word_34_n",t.bank_word_35_h="bank_word_35_h",t.bank_word_35_n="bank_word_35_n",t.bank_word_36="bank_word_36",t.common_alert_bg="common_alert_bg",t.common_avatar_bg="common_avatar_bg",t.common_avatar_light="common_avatar_light",t.common_avatar_mask="common_avatar_mask",t.common_bg_inner="common_bg_inner",t.common_btn_21_h="common_btn_21_h",t.common_btn_21_n="common_btn_21_n",t.common_btn_6_h="common_btn_6_h",t.common_btn_6_n="common_btn_6_n",t.common_btn_add_favorite_h="common_btn_add_favorite_h",t.common_btn_add_favorite_n="common_btn_add_favorite_n",t.common_btn_back_small_h="common_btn_back_small_h",t.common_btn_back_small_n="common_btn_back_small_n",t.common_btn_blue_d="common_btn_blue_d",t.common_btn_blue_h="common_btn_blue_h",t.common_btn_blue_n="common_btn_blue_n",t.common_close_h="common_close_h",t.common_btn_close_icon_c="common_btn_close_icon_c",t.common_btn_close_icon_h="common_btn_close_icon_h",t.common_btn_close_icon_n="common_btn_close_icon_n",t.common_close_n="common_close_n",t.common_btn_gb_h="common_btn_gb_h",t.common_btn_gb_n="common_btn_gb_n",t.common_btn_get_code_d="common_btn_get_code_d",t.common_btn_get_code_h="common_btn_get_code_h",t.common_btn_get_code_n="common_btn_get_code_n",t.common_btn_increase="common_btn_increase",t.common_btn_lab_cancel_h="common_btn_lab_cancel_h",t.common_btn_lab_cancel_n="common_btn_lab_cancel_n",t.common_btn_lab_confirm_h="common_btn_lab_confirm_h",t.common_btn_lab_confirm_n="common_btn_lab_confirm_n",t.common_btn_lab_reconnect_h="common_btn_lab_reconnect_h",t.common_btn_lab_reconnect_n="common_btn_lab_reconnect_n",t.common_btn_lsx_h="common_btn_lsx_h",t.common_btn_lsx_n="common_btn_lsx_n",t.common_btn_lx_h="common_btn_lx_h",t.common_btn_lx_n="common_btn_lx_n",t.common_btn_orange1_1="common_btn_orange1_1",t.common_btn_orange1_2="common_btn_orange1_2",t.common_btn_orange1_3="common_btn_orange1_3",t.common_btn_orange2_h="common_btn_orange2_h",t.common_btn_orange2_n="common_btn_orange2_n",t.common_btn_orange_d="common_btn_orange_d",t.common_btn_orange_h="common_btn_orange_h",t.common_btn_orange_n="common_btn_orange_n",t.common_btn_plus_h="common_btn_plus_h",t.common_btn_plus_n="common_btn_plus_n",t.common_btn_reduce="common_btn_reduce",t.common_btn_register_h="common_btn_register_h",t.common_btn_register_n="common_btn_register_n",t.common_btn_return_d="common_btn_return_d",t.common_btn_return_h="common_btn_return_h",t.common_btn_return_n="common_btn_return_n",t.common_btn_to_register_h="common_btn_to_register_h",t.common_btn_to_register_n="common_btn_to_register_n",t.common_dropdown_bg="common_dropdown_bg",t.common_dropdown="common_dropdown",t.common_dropdown_checkbox="common_dropdown_checkbox",t.common_dropdown_d="common_dropdown_d",t.common_dropdown_h="common_dropdown_h",t.common_dropdown_n="common_dropdown_n",t.common_gold_bg="common_gold_bg",t.common_h_slider_thumb_button="common_h_slider_thumb_button",t.common_h_slider_track="common_h_slider_track",t.common_h_slider_track_highlight="common_h_slider_track_highlight",t.common_light="common_light",t.common_match_info_bg="common_match_info_bg",t.common_progress_circle_thumb="common_progress_circle_thumb",t.common_progress_circle_track="common_progress_circle_track",t.common_progress_thumb="common_progress_thumb",t.common_progress_thumb_layer_0="common_progress_thumb_layer_0",t.common_progress_thumb_layer_1="common_progress_thumb_layer_1",t.common_progress_thumb_layer_2="common_progress_thumb_layer_2",t.common_progress_thumb_repeat="common_progress_thumb_repeat",t.common_progress_track="common_progress_track",t.common_radio_1="common_radio_1",t.common_radio_2="common_radio_2",t.common_switch_lab_off="common_switch_lab_off",t.common_switch_lab_on="common_switch_lab_on",t.common_tab_button_h="common_tab_button_h",t.common_tab_button_n="common_tab_button_n",t.common_tab_tutton_h="common_tab_tutton_h",t.common_tab_tutton_n="common_tab_tutton_n",t.common_text_input_bg2="common_text_input_bg2",t.common_text_input_bg="common_text_input_bg",t.common_toast="common_toast",t.common_waiting_bg_1="common_waiting_bg_1",t.common_waiting_bg_2="common_waiting_bg_2",t.common_word_15="common_word_15",t.common_word_16="common_word_16",t.exchange_btn_1="exchange_btn_1",t.exchange_btn_2="exchange_btn_2",t.exchange_btn_3_h="exchange_btn_3_h",t.exchange_btn_3_n="exchange_btn_3_n",t.exchange_btn_4_h="exchange_btn_4_h",t.exchange_btn_4_n="exchange_btn_4_n",t.exchange_btn_5_h="exchange_btn_5_h",t.exchange_btn_6_h="exchange_btn_6_h",t.exchange_btn_6_n="exchange_btn_6_n",t.exchange_btn_7_h="exchange_btn_7_h",t.exchange_btn_7_n="exchange_btn_7_n",t.exchange_btn_word_1_h="exchange_btn_word_1_h",t.exchange_btn_word_1_n="exchange_btn_word_1_n",t.exchange_btn_word_2_h="exchange_btn_word_2_h",t.exchange_btn_word_2_n="exchange_btn_word_2_n",t.exchange_btn_word_3_h="exchange_btn_word_3_h",t.exchange_btn_word_3_n="exchange_btn_word_3_n",t.exchange_btn_word_4="exchange_btn_word_4",t.exchange_image_1="exchange_image_1",t.exchange_image_10="exchange_image_10",t.exchange_image_11="exchange_image_11",t.exchange_image_12="exchange_image_12",t.exchange_image_13="exchange_image_13",t.exchange_image_14="exchange_image_14",t.exchange_image_15="exchange_image_15",t.exchange_image_16="exchange_image_16",t.exchange_image_17="exchange_image_17",t.exchange_image_18="exchange_image_18",t.exchange_image_19="exchange_image_19",t.exchange_image_2="exchange_image_2",t.exchange_image_20="exchange_image_20",t.exchange_image_21="exchange_image_21",t.exchange_image_22="exchange_image_22",t.exchange_image_23="exchange_image_23",t.exchange_image_24="exchange_image_24",t.exchange_image_25="exchange_image_25",t.exchange_image_26="exchange_image_26",t.exchange_image_27="exchange_image_27",t.exchange_image_29="exchange_image_29",t.exchange_image_3="exchange_image_3",t.exchange_image_30="exchange_image_30",t.exchange_image_31="exchange_image_31",t.exchange_image_32="exchange_image_32",t.exchange_image_33="exchange_image_33",t.exchange_image_34="exchange_image_34",t.exchange_image_35="exchange_image_35",t.exchange_image_4="exchange_image_4",t.exchange_image_6="exchange_image_6",t.exchange_image_9="exchange_image_9",t.icon_amount="icon_amount",t.icon_clock="icon_clock",t.icon_gold="icon_gold",t.icon_head1="icon_head1",t.icon_head2="icon_head2",t.icon_head3="icon_head3",t.icon_head4="icon_head4",t.icon_head5="icon_head5",t.icon_head6="icon_head6",t.icon_head7="icon_head7",t.icon_head8="icon_head8",t.icon_head_default="icon_head_default",t.icon_master="icon_master",t.icon_master_card="icon_master_card",t.icon_room_0="icon_room_0",t.icon_room_1="icon_room_1",t.icon_score="icon_score",t.icon_sign_up="icon_sign_up",t.loading_icon="loading_icon",t.loading_logo="loading_logo",t.login_bg_3_2="login_bg_3_2",t.login_bg_3="login_bg_3",t.login_bg_4="login_bg_4",t.login_bg_5="login_bg_5",t.login_bg_6="login_bg_6",t.login_bt_word_wjmm_h="login_bt_word_wjmm_h",t.login_bt_word_wjmm_n="login_bt_word_wjmm_n",t.login_bt_word_zczh_h="login_bt_word_zczh_h",t.login_bt_word_zczh_n="login_bt_word_zczh_n",t.login_btn_collect_h="login_btn_collect_h",t.login_btn_collect_n="login_btn_collect_n",t.login_btn_dl_h="login_btn_dl_h",t.login_btn_dl_n="login_btn_dl_n",t.login_btn_home_page_h="login_btn_home_page_h",t.login_btn_home_page_n="login_btn_home_page_n",t.login_btn_ksdl_h="login_btn_ksdl_h",t.login_btn_ksdl_n="login_btn_ksdl_n",t.login_btn_ls_h="login_btn_ls_h",t.login_btn_ls_n="login_btn_ls_n",t.login_btn_word_ksdl_h="login_btn_word_ksdl_h",t.login_btn_word_ksdl_n="login_btn_word_ksdl_n",t.login_btn_word_ls_h="login_btn_word_ls_h",t.login_btn_word_ls_n="login_btn_word_ls_n",t.login_panel_bg="login_panel_bg",t.match_bg_1="match_bg_1",t.match_btn_exit_h="match_btn_exit_h",t.match_btn_exit_n="match_btn_exit_n",t.match_btn_exit_txt_h="match_btn_exit_txt_h",t.match_btn_exit_txt_n="match_btn_exit_txt_n",t.match_btn_help_h="match_btn_help_h",t.match_btn_help_n="match_btn_help_n",t.match_btn_join_h="match_btn_join_h",t.match_btn_join_n="match_btn_join_n",t.match_btn_reward_h="match_btn_reward_h",t.match_btn_reward_n="match_btn_reward_n",t.match_btn_sign_up_h="match_btn_sign_up_h",t.match_btn_sign_up_n="match_btn_sign_up_n",t.match_finish_bg="match_finish_bg",t.match_finish_top="match_finish_top",t.match_float_bg="match_float_bg",t.match_panel_bg_2="match_panel_bg_2",t.match_panel_bg="match_panel_bg",t.match_waiting_1_h="match_waiting_1_h",t.match_waiting_1_n="match_waiting_1_n",t.match_waiting_2_h="match_waiting_2_h",t.match_waiting_2_n="match_waiting_2_n",t.match_waiting_3_h="match_waiting_3_h",t.match_waiting_3_n="match_waiting_3_n",t.match_waiting_4_h="match_waiting_4_h",t.match_waiting_4_n="match_waiting_4_n",t.match_word_17="match_word_17",t.match_word_18="match_word_18",t.match_word_19="match_word_19",t.match_word_20="match_word_20",t.match_word_21="match_word_21",t.match_word_22="match_word_22",t.match_word_24="match_word_24",t.match_word_26="match_word_26",t.match_word_29="match_word_29",t.match_word_4="match_word_4",t.match_word_5="match_word_5",t.match_word_6="match_word_6",t.play_bg_1="play_bg_1",t.play_bg_2="play_bg_2",t.play_bg_3="play_bg_3",t.play_bg_4="play_bg_4",t.play_bg_5="play_bg_5",t.play_bg_6="play_bg_6",t.play_bottom_bar_bg="play_bottom_bar_bg",t.play_bottom_bar_bg_long="play_bottom_bar_bg_long",t.play_btn_anger_h="play_btn_anger_h",t.play_btn_anger_n="play_btn_anger_n",t.play_btn_chat_1="play_btn_chat_1",t.play_btn_chat_2="play_btn_chat_2",t.play_btn_praiser_h="play_btn_praiser_h",t.play_btn_praiser_n="play_btn_praiser_n",t.play_btn_ridiculer_h="play_btn_ridiculer_h",t.play_btn_ridiculer_n="play_btn_ridiculer_n",t.play_btn_trusteeship_d="play_btn_trusteeship_d",t.play_btn_trusteeship_h="play_btn_trusteeship_h",t.play_btn_trusteeship_n="play_btn_trusteeship_n",t.play_btn_urge_h="play_btn_urge_h",t.play_btn_urge_n="play_btn_urge_n",t.play_btn_word_1_d="play_btn_word_1_d",t.play_btn_word_1_h="play_btn_word_1_h",t.play_btn_word_1_n="play_btn_word_1_n",t.play_btn_word_2_d="play_btn_word_2_d",t.play_btn_word_2_h="play_btn_word_2_h",t.play_btn_word_2_n="play_btn_word_2_n",t.play_btn_word_3_h="play_btn_word_3_h",t.play_btn_word_3_n="play_btn_word_3_n",t.play_btn_word_again_d="play_btn_word_again_d",t.play_btn_word_again_h="play_btn_word_again_h",t.play_btn_word_again_n="play_btn_word_again_n",t.play_btn_word_come_d="play_btn_word_come_d",t.play_btn_word_come_h="play_btn_word_come_h",t.play_btn_word_come_n="play_btn_word_come_n",t.play_btn_word_continue_h="play_btn_word_continue_h",t.play_btn_word_continue_n="play_btn_word_continue_n",t.play_btn_word_exchange_h="play_btn_word_exchange_h",t.play_btn_word_exchange_n="play_btn_word_exchange_n",t.play_btn_word_getready_h="play_btn_word_getready_h",t.play_btn_word_getready_n="play_btn_word_getready_n",t.play_btn_word_no_d="play_btn_word_no_d",t.play_btn_word_no_h="play_btn_word_no_h",t.play_btn_word_no_n="play_btn_word_no_n",t.play_btn_word_nocall_h="play_btn_word_nocall_h",t.play_btn_word_nocall_n="play_btn_word_nocall_n",t.play_btn_word_prompt_d="play_btn_word_prompt_d",t.play_btn_word_prompt_h="play_btn_word_prompt_h",t.play_btn_word_prompt_n="play_btn_word_prompt_n",t.play_bubble="play_bubble",t.play_card_count_bg="play_card_count_bg",t.play_chat_bg="play_chat_bg",t.play_failed="play_failed",t.play_hand_ok="play_hand_ok",t.play_master_card_bg="play_master_card_bg",t.play_match_detail_bg="play_match_detail_bg",t.play_match_place_info_bg="play_match_place_info_bg",t.play_name_bg="play_name_bg",t.play_robot="play_robot",t.play_robot_eye="play_robot_eye",t.play_success="play_success",t.play_word_1="play_word_1",t.play_word_2="play_word_2",t.play_word_3="play_word_3",t.play_word_4="play_word_4",t.play_word_5="play_word_5",t.play_word_6="play_word_6",t.play_word_7="play_word_7",t.profile_txt_1="profile_txt_1",t.recharge_bg_34="recharge_bg_34",t.recharge_bg_35="recharge_bg_35",t.recharge_bg_36="recharge_bg_36",t.recharge_bg_37="recharge_bg_37",t.recharge_bg_38="recharge_bg_38",t.recharge_bg_39="recharge_bg_39",t.recharge_bg_40="recharge_bg_40",t.redgift_bg="redgift_bg",t.redgift_happy="redgift_happy",t.redgift_icon="redgift_icon",t.redgift_label_bg="redgift_label_bg",t.redgift_sorry="redgift_sorry",t.room_ads_collect="room_ads_collect",t.room_bg_1="room_bg_1",t.room_bg_2="room_bg_2",t.room_bg_3="room_bg_3",t.room_btn_bank_h="room_btn_bank_h",t.room_btn_bank_n="room_btn_bank_n",t.room_btn_lobby_h="room_btn_lobby_h",t.room_btn_lobby_n="room_btn_lobby_n",t.room_btn_setup_d="room_btn_setup_d",t.room_btn_setup_h="room_btn_setup_h",t.room_btn_setup_n="room_btn_setup_n",t.room_channel_icon_0="room_channel_icon_0",t.room_channel_icon_1="room_channel_icon_1",t.room_channel_lab_0="room_channel_lab_0",t.room_channel_lab_1="room_channel_lab_1",t.room_item_ads="room_item_ads",t.room_item_bg="room_item_bg",t.room_item_bottom="room_item_bottom",t.room_match_item_bg="room_match_item_bg",t.room_seprate="room_seprate",t.room_tip_gold_can_get="room_tip_gold_can_get",t.room_word_0="room_word_0",t.room_word_13="room_word_13",t.room_word_14="room_word_14",t.room_word_1="room_word_1",t.room_word_23="room_word_23",t.room_word_25="room_word_25",t.room_word_27="room_word_27",t.room_word_28="room_word_28",t.room_word_2="room_word_2",t.room_word_3="room_word_3",t.room_word_8="room_word_8",t.setting_btn_about_h="setting_btn_about_h",t.setting_btn_about_n="setting_btn_about_n",t.setting_btn_feedback_h="setting_btn_feedback_h",t.setting_btn_feedback_n="setting_btn_feedback_n",t.setting_btn_help_h="setting_btn_help_h",t.setting_btn_help_n="setting_btn_help_n",t.setting_btn_logout_d="setting_btn_logout_d",t.setting_btn_logout_h="setting_btn_logout_h",t.setting_btn_logout_n="setting_btn_logout_n",t.setting_word_1="setting_word_1",t.setting_word_2="setting_word_2",t.setting_word_3="setting_word_3",t.lang="lang",t.sheet_loading="sheet_loading",t.sheet_bank_c="sheet_bank_c",t.sheet_common="sheet_common",t.sheet_common_c="sheet_common_c",t.sheet_icon_c="sheet_icon_c",t.sheet_login_c="sheet_login_c",t.sheet_match="sheet_match",t.sheet_match_c="sheet_match_c",t.sheet_play="sheet_play",t.sheet_play_c="sheet_play_c",t.sheet_profile_c="sheet_profile_c",t.sheet_redgift="sheet_redgift",t.sheet_room_c="sheet_room_c",t.sheet_setting="sheet_setting",t.sheet_poker="sheet_poker",t.sheet_recharge="sheet_recharge",t.game_proto="game_proto",t.user_proto="user_proto",t.font_num_0="font_num_0",t.font_num_1="font_num_1",t.font_num_2="font_num_2",t.font_num_3="font_num_3",t.font_num_6="font_num_6",t.font_num_7="font_num_7",t.font_num_8="font_num_8",t.font_num_9="font_num_9",t.login_bg="login_bg",t.play_bg="play_bg",t.room_bg="room_bg",t.bgm="bgm",t.Man_1="Man_1",t.Man_10="Man_10",t.Man_11="Man_11",t.Man_12="Man_12",t.Man_13="Man_13",t.Man_14="Man_14",t.Man_15="Man_15",t.Man_2="Man_2",t.Man_3="Man_3",t.Man_4="Man_4",t.Man_5="Man_5",t.Man_6="Man_6",t.Man_7="Man_7",t.Man_8="Man_8",t.Man_9="Man_9",t.Man_buyao1="Man_buyao1",t.Man_buyao2="Man_buyao2",t.Man_buyao3="Man_buyao3",t.Man_buyao4="Man_buyao4",t.Man_dui1="Man_dui1",t.Man_dui10="Man_dui10",t.Man_dui11="Man_dui11",t.Man_dui12="Man_dui12",t.Man_dui13="Man_dui13",t.Man_dui2="Man_dui2",t.Man_dui3="Man_dui3",t.Man_dui4="Man_dui4",t.Man_dui5="Man_dui5",t.Man_dui6="Man_dui6",t.Man_dui7="Man_dui7",t.Man_dui8="Man_dui8",t.Man_dui9="Man_dui9",t.Man_feiji="Man_feiji",t.Man_jiabei="Man_jiabei",t.Man_liandui="Man_liandui",t.Man_NoOrder="Man_NoOrder",t.Man_Order="Man_Order",t.Man_sandaiyi="Man_sandaiyi",t.Man_sandaiyidui="Man_sandaiyidui",t.Man_shunzi="Man_shunzi",t.Man_sidaier="Man_sidaier",t.Man_sidailiangdui="Man_sidailiangdui",t.Man_tuple1="Man_tuple1",t.Man_tuple10="Man_tuple10",t.Man_tuple11="Man_tuple11",t.Man_tuple12="Man_tuple12",t.Man_tuple13="Man_tuple13",t.Man_tuple2="Man_tuple2",t.Man_tuple3="Man_tuple3",t.Man_tuple4="Man_tuple4",t.Man_tuple5="Man_tuple5",t.Man_tuple6="Man_tuple6",t.Man_tuple7="Man_tuple7",t.Man_tuple8="Man_tuple8",t.Man_tuple9="Man_tuple9",t.Man_wangzha="Man_wangzha",t.Man_zhadan="Man_zhadan",t.Woman_1="Woman_1",t.Woman_10="Woman_10",t.Woman_11="Woman_11",t.Woman_12="Woman_12",t.Woman_13="Woman_13",t.Woman_14="Woman_14",t.Woman_15="Woman_15",t.Woman_2="Woman_2",t.Woman_3="Woman_3",t.Woman_4="Woman_4",t.Woman_5="Woman_5",t.Woman_6="Woman_6",t.Woman_7="Woman_7",t.Woman_8="Woman_8",t.Woman_9="Woman_9",t.Woman_buyao1="Woman_buyao1",t.Woman_buyao2="Woman_buyao2",t.Woman_buyao3="Woman_buyao3",t.Woman_buyao4="Woman_buyao4",t.Woman_dui1="Woman_dui1",t.Woman_dui10="Woman_dui10",t.Woman_dui11="Woman_dui11",t.Woman_dui12="Woman_dui12",t.Woman_dui13="Woman_dui13",t.Woman_dui2="Woman_dui2",t.Woman_dui3="Woman_dui3",t.Woman_dui4="Woman_dui4",t.Woman_dui5="Woman_dui5",t.Woman_dui6="Woman_dui6",t.Woman_dui7="Woman_dui7",t.Woman_dui8="Woman_dui8",t.Woman_dui9="Woman_dui9",t.Woman_feiji="Woman_feiji",t.Woman_liandui="Woman_liandui",t.Woman_NoOrder="Woman_NoOrder",t.Woman_Order="Woman_Order",t.Woman_Rob1="Woman_Rob1",t.Woman_Rob2="Woman_Rob2",t.Woman_Rob3="Woman_Rob3",t.Woman_sandaiyi="Woman_sandaiyi",t.Woman_sandaiyidui="Woman_sandaiyidui",t.Woman_shunzi="Woman_shunzi",t.Woman_sidaier="Woman_sidaier",t.Woman_sidailiangdui="Woman_sidailiangdui",t.Woman_tuple1="Woman_tuple1",t.Woman_tuple10="Woman_tuple10",t.Woman_tuple11="Woman_tuple11",t.Woman_tuple12="Woman_tuple12",t.Woman_tuple13="Woman_tuple13",t.Woman_tuple2="Woman_tuple2",t.Woman_tuple3="Woman_tuple3",t.Woman_tuple4="Woman_tuple4",t.Woman_tuple5="Woman_tuple5",t.Woman_tuple6="Woman_tuple6",t.Woman_tuple7="Woman_tuple7",t.Woman_tuple8="Woman_tuple8",t.Woman_tuple9="Woman_tuple9",t.Woman_wangzha="Woman_wangzha",t.Woman_zhadan="Woman_zhadan",t.sheet_exchange="sheet_exchange",t.font_num_10="font_num_10",t.font_num_12="font_num_12",t.ani_coin_png="ani_coin_png",t.ani_coin_json="ani_coin_json",t.bgm_play="bgm_play",t.bgm_room="bgm_room",t.effect_gold_rain="effect_gold_rain",t}();__reflect(ResNames.prototype,"ResNames");var SceneNames=function(){function t(){}return t.LOADING="loading",t.MOST_TOP="mostTop",t.EFFECT="effect",t.EFFECT2="effect2",t.COMMON="common",t.COVER="cover",t.MENU="menu",t.GUIDE="guide",t.ROOM="room",t.LEVEL="level",t.LOADING_TIP="loadingTip",t.LOGIN="login",t.PLAY="play",t.RESULT="result",t.COLLECTIONS="collections",t.GIFT="gift",t.RECHARGE="recharge",t}();__reflect(SceneNames.prototype,"SceneNames");var _encrypt=alien.Encrypt.encryptStr,_decrypt=alien.Encrypt.encryptStr,UserData=function(t){function e(){var e=t.call(this)||this;return e.name="user",e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.prefix=t},e.prototype._setValue=function(t,e,n){void 0===n&&(n=!1);var i=_encrypt(t),o=_encrypt(e);this.setItem(i,o,n)},e.prototype._getValue=function(t){var e=_encrypt(t),n=this.save[e]||null;return n&&(n=_decrypt(n)),n},e.prototype.saveLocalPhone=function(t,e){if(void 0===e&&(e=!1),t&&11==t.length){var n="phone",i=t;this.setBindPhone(!0),this._setValue(n,i,e)}},e.prototype.saveLocalAli=function(t,e,n){void 0===n&&(n=!0);var i="ali",o=t+"|"+e;this._setValue(i,o,n)},e.prototype.setBindWx=function(t){var e="bindWx",n="0";t&&(n="1"),this._setValue(e,n)},e.prototype.hasBindWx=function(){var t="bindWx",e=this._getValue(t);return e&&"1"==e?!0:!1},e.prototype.setBindAli=function(t){var e="bindAli",n="0";t&&(n="1"),this._setValue(e,n)},e.prototype.hasBindAli=function(){var t="bindAli",e=this._getValue(t);return e&&"1"==e?!0:!1},e.prototype.setBindPhone=function(t){var e="bindPhone",n="0";t&&(n="1"),this._setValue(e,n)},e.prototype.hasBindPhone=function(){var t="bindPhone",e=this._getValue(t);return e&&"1"==e?!0:!1},e.prototype.getLocalAli=function(){var t="ali",e=this._getValue(t);if(e){var n=e,i=n.split("|");if(i.length<2)return null;var o=i[0],a=i[1];return{account:o,name:a}}return null},e.prototype.getLocalPhone=function(){var t="phone";return this._getValue(t)},e.prototype.setToken=function(t,e){void 0===e&&(e=!1);var n="token",i=t;this._setValue(n,i,e)},e.prototype.setUid=function(t,e){void 0===e&&(e=!1);var n="uid",i=t;this._setValue(n,i,e)},e.prototype.setSk=function(t,e){void 0===e&&(e=!1);var n="sk",i=t;this._setValue(n,i,e)},e.prototype.getToken=function(){var t="token";return this._getValue(t)},e.prototype.getUid=function(){var t="uid";return this._getValue(t)},e.prototype.getSk=function(){var t="sk";return this._getValue(t)},e}(DataStorage);__reflect(UserData.prototype,"UserData");var UserInfoData=function(){function t(){this._sysTalkMaxN=10,this._hornTalkRecMaxN=20,this.clean()}return t.prototype.hasRecorder=function(){return this.cardsRecorder&&this.cardsRecorder.length>=7&&this.cardsRecorder[6]>0?!0:!1},t.prototype.todayHasBuyRevive=function(){return this.diamondrelive>=1?!0:!1},t.prototype.setTodayHasBuyRevive=function(){this.diamondrelive+=1},t.prototype.isMaxBuyDiamondRevive=function(){var t=this.getDiamondReviveMaxBuy();
return this.diamondrelive>=t?!0:!1},t.prototype.getDiamondReviveMaxBuy=function(){for(var t=GameConfig.rechargeConfig,e=0;e<t.length;++e)if(10009==t[e].product_id)return t[e].maxBuyNum;return 3},t.prototype.initData=function(e){var n=this;e.cardsRecorder&&e.cardsRecorder.length<1&&(e.cardsRecorder=null),alien.Utils.injectProp(this,e,function(e,i,o){"nickname"==i?o&&(""!=o?e.nickname=Base64.decode(o):e.nickname=o):"sex"==i?t.updateSex(e,o):"gold"==i||"redcoingot"==i||"totalwincnt"==i||"totallosecnt"==i||"totaldrawcnt"==i||"diamondgiftgot"==i||"diamondrelive"==i?(e[i]=parseInt(o),"redcoingot"==i&&(e[i]=e[i]/100)):"frechargerewardday"==i?(o>=1&&9>=o||-1==o)&&(e[i]=parseInt(o),-1!=o&&alien.Dispatcher.dispatch(EventNames.FRECHARGE_HASUPDATE)):"showredpoint"==i?o&&o.length>=1&&(e[i]=o):"wincnt"==i?o&&o.length&&(e[i]=o):"daytaskprogress"==i?o.length>=1&&(e[i]=o):"daytaskstatus"==i?o&&7==o.length&&(e[i]=o,n._calculateOverTaskNum(o)):"imageid"==i&&o&&0==o.indexOf("head")&&o.length<=10?e[i]="icon_head_default":e[i]=o}),0==this.sex&&t.updateSex(this,0),0!=this.recorderfirstrewardgot||e.recorderfirstrewardgot||(this.recorderfirstrewardgot=null)},t.updateSex=function(t,e){void 0===e&&(e=0),t.sex=e,t.sexStr=lang.sex[t.sex],t.sexVoiceStr=lang.sexVoice[t.sex]},t.prototype._calculateOverTaskNum=function(t){for(var e=0,n=0;n<t.length;++n)1==t[n]&&(e+=1);this._dayTaskOverNum=e},t.prototype.getWinRate=function(){var t=this.totalwincnt+this.totaldrawcnt+this.totallosecnt;return 0==t||0==this.totalwincnt?0:this.totalwincnt/t},t.prototype.getGold=function(){return this.gold},t.prototype.addGold=function(t){var e=this.gold+t;this.gold=e,0>e&&(this.gold=0)},t.prototype.getDayTaskPre=function(){return this.daytaskprogress},t.prototype.getDayTaskAllTStatus=function(){return this.daytaskstatus},t.prototype.getDayTaskOverCount=function(){return this._dayTaskOverNum},t.prototype.isNotBuyFRecharge=function(){return-1==this.frechargerewardday?!0:!1},t.prototype.isHadGetFRechargeRew=function(){return this.frechargerewardday>=2&&this.frechargerewardday<=9?!0:!1},t.prototype.isGetTodayFRechargeRew=function(){return 8==this.frechargerewardday?!0:!1},t.prototype.isFRechargeRewGetOver=function(){return this.frechargerewardday>=1&&this.frechargerewardday<=7?!1:!0},t.prototype.getFRechargeRewGetDay=function(){return this.frechargerewardday},t.prototype.setFRechargeTodayHasGet=function(){this.frechargerewardday=8,alien.Dispatcher.dispatch(EventNames.USER_FRREWARD_GET_SUCC)},t.prototype.isTodayHasSign=function(){return this.todayHasSign},t.prototype.setTodaySigned=function(t){this.todayHasSign=t},t.prototype.isSignGoldAddByFRecharge=function(){return this.signrewardaddremain&&this.signrewardaddremain>0?!0:!1},t.prototype.isNotGetFRechargeSignAdd=function(){return 7==this.signrewardaddremain?!0:!1},t.prototype.signSuccSubSignAddRemin=function(){!this.isNotBuyFRecharge()&&this.isHadGetFRechargeRew()&&this.signrewardaddremain&&(this.signrewardaddremain-=1,this.signrewardaddremain<0&&(this.signrewardaddremain=0))},t.prototype.setTaskHasGetRew=function(t){for(var e=0;e<this.daytaskstatus.length;++e)e+1==t&&(this.daytaskstatus[e]=2);this._calculateOverTaskNum(this.daytaskstatus),alien.Dispatcher.dispatch(EventNames.USER_DTREWARD_GET_SUCC)},t.prototype.addHornTalkRec=function(t){if(t&&t.nickname&&t.msg){var e=new Date(t.time),n=e.getHours(),i=e.getMinutes(),o=e.getSeconds();10>n&&(n="0"+n),10>i&&(i="0"+i),10>o&&(o="0"+o);var a=n+":"+i+":"+o,r={time:a,name:Base64.decode(t.nickname),msg:t.msg,isUser:!0};this._hornTalkRec.length>=this._hornTalkRecMaxN&&this._hornTalkRec.shift(),this._hornTalkRec.push(r),this._hornTalkShowList.push(r),alien.Dispatcher.dispatch(EventNames.HORN_TALK_RECORDS_CHANGE,r)}},t.prototype.addHornTalkRecByHttp=function(t){if(t&&t.nickname&&t.msg&&t.add_time){var e=t.add_time.substr(-8),n=t.nickname,i=t.msg,o={time:e,name:n,msg:i,isUser:!0};this._hornTalkRec.length>=this._hornTalkRecMaxN&&this._hornTalkRec.shift(),this._hornTalkRec.push(o)}},t.prototype.cleanLocalHornRecByHttp=function(){this._hornTalkRec=[]},t.prototype.setHornTalkRecMaxLen=function(t){this._hornTalkRecMaxN=t},t.prototype.getHornTalkRecList=function(){return this._hornTalkRec},t.prototype.getHornTalkShowLen=function(){return this._hornTalkShowList.length},t.prototype.getFrontHornTalkShow=function(){var t=null;return this._hornTalkShowList.length>0&&(t=this._hornTalkShowList[0],this._hornTalkShowList.shift()),t},t.prototype.addSysTalkRec=function(t){this._sysTalkRec[0]={msg:t,isUser:!1},alien.Dispatcher.dispatch(EventNames.HORN_TALK_RECORDS_CHANGE)},t.prototype.getSysTalkRecList=function(){return this._sysTalkRec},t.prototype.setNationalActInfo=function(t){this._nationalInfo=t,alien.Dispatcher.dispatch(EventNames.NATIONAL_INFO_CHANGE)},t.prototype.getNationalGetLoginRewDay=function(){return this._nationalInfo&&this._nationalInfo.getRewDay?this._nationalInfo.getRewDay:0},t.prototype.hasGetNationalTodayLoginRew=function(){return this._nationalInfo&&2==this._nationalInfo.todayGet?!0:!1},t.prototype.getNationalInviteNum=function(){return this._nationalInfo&&this._nationalInfo.inviteNum?this._nationalInfo.inviteNum:0},t.prototype.getNationalInviteRew=function(){return this._nationalInfo&&this._nationalInfo.inviteNum?GameConfig.getNationalInviteRewByNum(this._nationalInfo.inviteNum):0},t.prototype.hasGetNationalInviteRew=function(){return this._nationalInfo&&this._nationalInfo.getInviteRew&&2==this._nationalInfo.getInviteRew?!0:!1},t.prototype.hasGetNewDiamond=function(){return 1==this.diamondgiftgot?!0:!1},t.prototype.setHasGetNewDiamond=function(){this.diamondgiftgot=1},t.prototype.setNationalGetLoginRewDay=function(t){this._nationalInfo.getRewDay=t,this._nationalInfo.todayGet=2},t.prototype.getFreeBrowCount=function(){return this.freeBrowCount},t.prototype.setFreeBrowCount=function(t){this.freeBrowCount=t},t.prototype.addFreeBrowCount=function(t){var e=this.freeBrowCount+t;e>=0?this.freeBrowCount=e:this.freeBrowCount=0},t.prototype.shouldShowTaskRed=function(){return this.showredpoint&&this.showredpoint.length>=1&&1==this.showredpoint[0]?!0:!1},t.prototype.shouldShowActFirstRechareRedRed=function(){return this.showredpoint&&this.showredpoint.length>=2&&1==this.showredpoint[1]?!0:!1},t.prototype.shouldShowActDownAppRed=function(){return this.showredpoint&&this.showredpoint.length>=3&&1==this.showredpoint[2]?!0:!1},t.prototype.shouldShowActThanksRed=function(){return this.showredpoint&&this.showredpoint.length>=4&&1==this.showredpoint[3]?!0:!1},t.prototype.setNotShowTaskRed=function(){this.showredpoint[0]=0},t.prototype.setNotShowActFirstRechargeRed=function(){this.showredpoint[1]=0,this.updateActRed()},t.prototype.setNotShowActDownAppRed=function(){this.showredpoint[2]=0,this.updateActRed()},t.prototype.setNotShowActThanksRed=function(){this.showredpoint[3]=0,this.updateActRed()},t.prototype.setNotLoginApp=function(t){this.notLoginApp=t},t.prototype.shouldShowActRed=function(){if(this.showredpoint&&this.showredpoint.length>1)for(var t=1;t<this.showredpoint.length;++t)if(0!=this.showredpoint[t])return!0;return!1},t.prototype.updateActRed=function(){alien.Dispatcher.dispatch(EventNames.ACT_RED_CHANGE)},t.prototype.hasNotLoginApp=function(){return this.notLoginApp},t.prototype.getNorRoomRedNum=function(){var t=0;if(this.wincnt)for(var e=0;e<this.wincnt.length;++e)t+=this.wincnt[e].chance;return t},t.prototype.getRoomNeedWinCntGetRed=function(t){var e=5;if(this.wincnt&&this.wincnt.length)for(var n=0;n<this.wincnt.length;n++)if(this.wincnt[n].roomid==t){var i=this.wincnt[n].cnt;return!i||0>=i?(i=0,e):5-i%5}return e},t.prototype.getOneNorRoomRedFromSmall=function(){if(this.wincnt)for(var t=0;t<this.wincnt.length;++t)if(this.wincnt[t].chance>0)return this.wincnt[t];return null},t.prototype.clean=function(){this.diamondrelive=0,this.showredpoint=[0,0,0,0],this.freeBrowCount=0,this._nationalInfo={getRewDay:0,todayGet:0,inviteNum:0,getInviteRew:0},this._hornTalkShowList=[],this._hornTalkRec=[],this._sysTalkRec=[],this.uid=0,this.nickname=null,this.diamondgiftgot=0,this.money=0,this.gold=0,this.exp=0,this.vipexp=0,this.sex=0,this.sexStr=null,this.sexVoiceStr=null,this.imageid=null,this.havesecondpwd=0,this.isbinding=0,this.wincnt=[],this.drawcnt=0,this.fakeuid=0,this.bindphone=null,this.redcoin=0,this.seatid=0,this.freshmanredcoinsent=0,this.beans=null,this.rcminexcexpiretime=0,this.rcminexcchanceused=null,this.freshrewardgot=null,this.redcoingot=0,this.totalwincnt=0,this.totallosecnt=0,this.totaldrawcnt=0,this.recorderfirstrewardgot=0,this.cardsRecorder=null,this._dayTaskOverNum=0,this.daytaskprogress=[0,0],this.daytaskstatus=[0,0,0,0,0,0,0],this.frechargerewardday=null,this.todayHasSign=null,this.signrewardaddremain=null,this.notLoginApp=!1},t}();__reflect(UserInfoData.prototype,"UserInfoData");var WxHelper=function(){function t(){}return t.share=function(t,e,n){if(void 0===n&&(n=[]),alien.Native.instance.isWXMP){var i=UserData.instance,o=i.getSk();o||(o="",Reportor.instance.reportCodeError("sk error share"));var a={};a.imgUrl=GameConfig.RESOURCE_URL+"shareIcon.jpg",a.title1=lang.thirdPartWxMp.title2,a.link1=GameConfig.WX_LOGIN_URL+"?state=3&share_sk="+o,t==this.SHARE_FREE_GAME?(a.title2=lang.thirdPartWxMp.title3,a.desc2=alien.StringUtils.format(lang.thirdPartWxMp.desc3,n[2],n[0],n[1]),a.link2=GameConfig.WX_LOGIN_URL+"?state=3&share_room="+n[2]):(a.title2=lang.thirdPartWxMp.title2,a.desc2=lang.thirdPartWxMp.desc2,a.link2=GameConfig.WX_LOGIN_URL+"?state=3&share_sk="+o),alien.Native.instance.share(a,e)}},t.shareDownApp=function(t){var e={},n=UserData.instance,i=n.getSk();e.title=lang.thirdPartWxMp.title2,e.description=lang.thirdPartWxMp.desc2,e.shareType=0,e.sharePlatform=2,e.url="https://wx.yiyuc.com/appshare/qrcode.php?sk="+i,alien.Native.instance.share(e,t)},t._onShareRet=function(t){var e=!1;3==t.code&&(e=!0,PanelShare.instance.close()),alien.Dispatcher.dispatch(EventNames.USER_SHARE_RESULT,{shareSucc:e})},t.doWebH5ShareCfg=function(){t.share(2,t._onShareRet.bind(t))},t.doNativeShare=function(){t.shareForNative(2,t._onShareRet.bind(t))},t.shareForNative=function(t,e,n){void 0===n&&(n=[]);var i=2,o=UserData.instance,a=o.getSk();a||(a="");var r=!0,s=GameConfig.WX_LOGIN_URL+"?state=3&share_sk="+a,h="https://m.hztangyou.com/down/",c="https://m.hztangyou.com/down/",l={};r?l.url=s:(l.url=c,"iOS"==egret.Capabilities.os&&(l.url=h)),l.title=lang.thirdPartWxMp.title2,l.description=lang.thirdPartWxMp.desc2,t==this.SHARE_FREE_GAME&&(l.title=lang.thirdPartWxMp.title3,l.description=alien.StringUtils.format(lang.thirdPartWxMp.desc3,n[2],n[0],n[1]),l.url=GameConfig.WX_LOGIN_URL+"?state=3&share_room="+n[2]),l.shareType=0,l.sharePlatform=i,alien.Native.instance.share(l,e)},t.shareImageNative=function(t,e,n){if(void 0===n&&(n=[]),!alien.Native.instance.isNative)return void console.log("shareImageNative not native!");var i=2;switch(t){case this.SHARE_IMAGE_TO_FRIENDS:i=2;break;case this.SHARE_IMAGE_TO_TIMELINE:default:i=3}var o={};o.title=lang.thirdPartWxMp.title2,o.shareType=1,o.url=n[0],o.sharePlatform=i,o.description="",alien.Native.instance.share(o,e)},t.shareForPhone=function(){webService.getShareImgUrlByScene(function(t){var e=JSON.parse(t);0==e.code&&(window.top.location.href=e.url)},1)},t.NATIVE_SHARE_SUCC=0,t.SHARE_FREE_GAME=1,t.SHARE_GAME=2,t.SHARE_IMAGE_BASE=10,t.SHARE_IMAGE_TO_TIMELINE=11,t.SHARE_IMAGE_TO_FRIENDS=12,t}();__reflect(WxHelper.prototype,"WxHelper");var NormalButton=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bgRes="",e}return __extends(e,t),Object.defineProperty(e.prototype,"bgUp",{get:function(){return this._bgRes?this._bgRes+(RES.hasRes(this._bgRes+"_n")?"_n":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgDown",{get:function(){return this._bgRes?this._bgRes+(RES.hasRes(this._bgRes+"_h")?"_h":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgDisabled",{get:function(){return this._bgRes?this._bgRes+(RES.hasRes(this._bgRes+"_d")?"_d":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgRes",{get:function(){return this._bgRes},set:function(t){this._bgRes=t,this.bgDisplay&&(this.bgDisplay.source=this.bgUp)},enumerable:!0,configurable:!0}),e}(eui.Button);__reflect(NormalButton.prototype,"NormalButton");var StateButton=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelIconDisplay=null,e._labelIcon="",e.bgImg=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"iconUp",{get:function(){return this._labelIcon?this._labelIcon+(RES.hasRes(this._labelIcon+"_n")?"_n":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconDown",{get:function(){return this._labelIcon?this._labelIcon+(RES.hasRes(this._labelIcon+"_h")?"_h":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconDisabled",{get:function(){return this._labelIcon?this._labelIcon+(RES.hasRes(this._labelIcon+"_d")?"_d":""):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelIcon",{get:function(){return this._labelIcon},set:function(t){this._labelIcon=t,this.iconDisplay&&(this.iconDisplay.source=this.iconUp)},enumerable:!0,configurable:!0}),e}(eui.Button);__reflect(StateButton.prototype,"StateButton");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?i(o):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function o(t){e.call(i,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ActList=function(t){function e(){var e=t.call(this)||this;return e._lastSelectIdx=0,e._labels=[],e._selfData=MainLogic.instance.selfData,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.init=function(){this.skinName=components.ActList},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI()},e.prototype.onAddToStage=function(t){this._initEvent()},e.prototype._onFRechargeUpdate=function(){if(!this._selfData.isNotBuyFRecharge()){for(var t=0;t<this._labels.length;++t)if(1==this._labels[t].id){this._labels.splice(t,1);break}this._leftLabelsDataProvider.source=this._labels,this._leftLabelsDataProvider.refresh(),this._frechargeNode&&(PanelFirstRecharge.nullInstance(),this._frechargeNode=null),this._changeSelectByIdx(-1)}},e.prototype._onLoginAppUpdate=function(){if(!alien.Native.instance.isNative&&this._selfData.hasNotLoginApp()){var t=this._selfData.shouldShowActDownAppRed();this._labels.push({tit:"APP",id:2,sel:!1,"new":t,cb:this._onClickAPPAct.bind(this)}),this._leftLabelsDataProvider.source=this._labels,this._leftLabelsDataProvider.refresh()}},e.prototype._initEvent=function(){this._enableEvent(!0),this.leftLabelList.addEventListener(egret.Event.CHANGE,this._onSelectItem,this);var t=EventManager.instance;t.registerOnObject(this,alien.Dispatcher,EventNames.FRECHARGE_HASUPDATE,this._onFRechargeUpdate,this),t.registerOnObject(this,alien.Dispatcher,EventNames.LOGINAPP_HASUPDATE,this._onLoginAppUpdate,this),EventManager.instance.enableOnObject(this)},e.prototype._setNotRedById=function(t){for(var e=0;e<this._labels.length;++e)if(this._labels[e].id==t){this._labels[e]["new"]=!1,this._leftLabelsDataProvider.itemUpdated(this._labels[e]);break}},e.prototype._getIdxById=function(t){for(var e=0;e<this._labels.length;++e)if(this._labels[e].id==t)return e;return-1},e.prototype._setNotShowFirstRechargeRed=function(){this._selfData.shouldShowActFirstRechareRedRed()&&(this._selfData.setNotShowActFirstRechargeRed(),server.reqClickFirstRecharge(),this._setNotRedById(1))},e.prototype._setNotShowThanksRed=function(){this._selfData.shouldShowActThanksRed()&&(this._selfData.setNotShowActThanksRed(),server.reqClickThanksgiving(),this._setNotRedById(3))},e.prototype._setNotShowDownAppRed=function(){this._selfData.shouldShowActDownAppRed()&&(this._selfData.setNotShowActDownAppRed(),server.reqClickDownApp(),this._setNotRedById(2))},e.prototype._onGetWatchWXHttpRep=function(t){if(t&&0==t.code&&t.data&&1!=t.data.has_subscribe){var e={tit:"",sel:!1,id:4,"new":!1,cb:this._onClickWatch.bind(this)};this._labels.push(e),this._leftLabelsDataProvider.source=this._labels,this._leftLabelsDataProvider.refresh()}},e.prototype._initLeftBtns=function(){var t={tit:"",sel:!1,id:3,"new":!1,cb:this._onClickThanksgiving.bind(this)};if(Utils.isInTimeSection("2017-11-23 00:00:00","2017-11-26 00:00:00",(new Date).getTime())){var e=this._selfData.shouldShowActThanksRed();t["new"]=e,this._labels.push(t)}var n={tit:"",id:1,sel:!1,"new":!1,cb:this._onClickFirstRecharge.bind(this)};if(this._selfData.isNotBuyFRecharge()){var i=this._selfData.shouldShowActFirstRechareRedRed();n["new"]=i,this._labels.push(n)}if(!alien.Native.instance.isNative&&this._selfData.hasNotLoginApp()){var o=this._selfData.shouldShowActDownAppRed();this._labels.push({tit:"APP",id:2,sel:!1,"new":o,cb:this._onClickAPPAct.bind(this)})}this._labels.push({tit:"",sel:!1,"new":!1,id:0,cb:this._onClickDelegate.bind(this)})},e.prototype._initUI=function(){this._labels=[],this._initLeftBtns(),this.leftLabelList.itemRenderer=ActListItem,this.leftLabelList.dataProvider=this._leftLabelsDataProvider=new eui.ArrayCollection(this._labels),this.leftLabelList.selectedIndex=0,this.leftLabelList.validateNow()},e.prototype._changeSelectByIdx=function(t){var e=this;(t>=this.leftLabelList.$children.length||0>t)&&(t=0);var n=t;this._leftLabelsDataProvider.source[this._lastSelectIdx].sel=0,this._leftLabelsDataProvider.itemUpdated(this._labels[this._lastSelectIdx]),this._lastSelectIdx=n;var i=this.leftLabelList.getChildAt(n);this._selectCb&&egret.setTimeout(function(){var t=i.localToGlobal(.5*i.width,.5*i.height);e._selectCb({item:i,pos:t})},this,50);for(var o=0;o<this._leftLabelsDataProvider.length;++o)if(o==n){this._leftLabelsDataProvider.source[o].sel=!0,this._leftLabelsDataProvider.itemUpdated(this._labels[n]);break}this._selectItem=this._labels[n],this._labels[n].cb(),egret.callLater(function(){e.leftLabelList.selectedIndex=-1},this)},e.prototype._onSelectItem=function(){this._changeSelectByIdx(this.leftLabelList.selectedIndex)},e.prototype._onClickThanksgiving=function(){this._showThanksgiving()},e.prototype._onClickFirstRecharge=function(){this._showFirstRecharge()},e.prototype._onClickAPPAct=function(){this._showAPPAct()},e.prototype._onClickDelegate=function(){this._showDelegate()},e.prototype._onClickWatch=function(){this._showWatchWX()},e.prototype._onClickDayBuy=function(){this._showDayBuy()},e.prototype._checkDayBuy=function(){this._dayBuygNode||(this._dayBuygNode=PanelDayBuy.getInstance(),this.parent.addChild(this._dayBuygNode))},e.prototype._checkWatchWX=function(){this._watchWXNode||(this._watchWXNode=PanelWatchWX.getInstance(),this.parent.addChild(this._watchWXNode))},e.prototype._checkThanksgiving=function(){this._thanksgivingNode||(this._thanksgivingNode=PanelThanksgiving.getInstance(),this.parent.addChild(this._thanksgivingNode))},e.prototype._onFRLightLoadOver=function(t){"firstRechargelight"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onFRLightLoadOver,this),this._selectItem&&1==this._selectItem.id&&this._showFirstRecharge())},e.prototype._checkFrecharge=function(){this._frechargeNode||(RES.isGroupLoaded("firstRechargelight")?(this._frechargeNode=PanelFirstRecharge.getInstance(),this.parent.addChild(this._frechargeNode)):(RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onFRLightLoadOver,this),RES.loadGroup("firstRechargelight")))},e.prototype._checkAppAct=function(){this._appNode||(this._appNode=PanelDownApp.getInstance(),this.parent.addChild(this._appNode))},e.prototype._checkDelegate=function(){this._delegateNode||(this._delegateNode=PanelDelegate.getInstance(),this.parent.addChild(this._delegateNode))},e.prototype._enableThanksShow=function(t){this._thanksgivingNode&&(this._thanksgivingNode.visible=t,t&&server.reqThanksBuyCounts())},e.prototype._enableFrechargeShow=function(t){this._frechargeNode&&(this._frechargeNode.visible=t)},e.prototype._enableAppActShow=function(t){this._appNode&&(this._appNode.visible=t)},e.prototype._enableDelegateActShow=function(t){this._delegateNode&&(this._delegateNode.visible=t)},e.prototype._enableDayBuyShow=function(t){this._dayBuygNode&&(this._dayBuygNode.visible=t)},e.prototype._enableWatchWXShow=function(t){this._watchWXNode&&(this._watchWXNode.visible=t)},e.prototype._showThanksgiving=function(){this._checkThanksgiving(),this._enableAppActShow(!1),this._enableFrechargeShow(!1),this._enableDelegateActShow(!1),this._enableThanksShow(!0),this._enableDayBuyShow(!1),this._enableWatchWXShow(!1),this._setNotShowThanksRed()},e.prototype._showFirstRecharge=function(){this._checkFrecharge(),this._enableAppActShow(!1),this._enableFrechargeShow(!0),this._enableDelegateActShow(!1),this._enableThanksShow(!1),this._enableDayBuyShow(!1),this._enableWatchWXShow(!1),this._setNotShowFirstRechargeRed()},e.prototype._showAPPAct=function(){this._checkAppAct(),this._enableAppActShow(!0),this._enableFrechargeShow(!1),this._enableDelegateActShow(!1),this._enableThanksShow(!1),this._enableDayBuyShow(!1),this._enableWatchWXShow(!1),this._setNotShowDownAppRed()},e.prototype._showDelegate=function(){this._checkDelegate(),this._enableAppActShow(!1),this._enableFrechargeShow(!1),this._enableDelegateActShow(!0),this._enableDayBuyShow(!1),this._enableWatchWXShow(!1),this._enableThanksShow(!1)},e.prototype._showDayBuy=function(){this._checkDayBuy(),this._enableAppActShow(!1),this._enableFrechargeShow(!1),this._enableDelegateActShow(!1),this._enableDayBuyShow(!0),this._enableWatchWXShow(!1),this._enableThanksShow(!1)},e.prototype._showWatchWX=function(){this._checkWatchWX(),this._enableAppActShow(!1),this._enableFrechargeShow(!1),this._enableDelegateActShow(!1),this._enableThanksShow(!1),this._enableDayBuyShow(!1),this._enableWatchWXShow(!0)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),this.leftLabelList.removeEventListener(egret.Event.CHANGE,this._onSelectItem,this),alien.EventManager.instance.disableOnObject(this)},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.setShowAppAct=function(){var t=this._getIdxById(2);0>t&&(t=0),this._changeSelectByIdx(t)},e.prototype.setShowFirstRecharge=function(){var t=this._getIdxById(1);0>t&&(t=0),this._changeSelectByIdx(t)},e.prototype.setShowThanksgiving=function(){var t=this._getIdxById(3);0>t&&(t=0),this._changeSelectByIdx(t)},e.prototype.setSelectChangeFunc=function(t){this._selectCb=t},e}(eui.Component);__reflect(ActList.prototype,"ActList");var ActListItem=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalColor=8866329,e.selColor=14770739,e.normalBg="common_btn1_n",e.selBg="common_btn1_h",e}return __extends(e,t),e.prototype._showFlagImg=function(t){this.flagImg.visible=t},e.prototype._setTit=function(t){this.titLabel.text=t},e.prototype._setSelect=function(){this.bgImg.source=this.selBg,this.titLabel.textColor=this.selColor},e.prototype._setNormal=function(){this.bgImg.source=this.normalBg,this.titLabel.textColor=this.normalColor},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this._setTit(this.data.tit),this.data.sel?this._setSelect():this._setNormal(),this.data["new"]?this._showFlagImg(!0):this._showFlagImg(!1)},e}(eui.ItemRenderer);__reflect(ActListItem.prototype,"ActListItem");var Avatar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefault(),this._initTouchEvent(),this.imgAvatar.source="icon_head_default",this.imgMask&&(this.imgAvatar.mask=this.imgMask)},e.prototype.getHeadCenGlobalPos=function(){if(!this._headCGlobalPos){var t=this.imgAvatar.x,e=this.imgAvatar.y,n=this.imgAvatar.width,i=this.imgAvatar.height;new egret.Point(0,0);this._headCGlobalPos=this.imgAvatar.localToGlobal(t+.5*n,e+.5*i)}return this._headCGlobalPos},e.prototype._initDefault=function(){this._headTouchFunc=null,this.bg_img.touchEnabled=!1},e.prototype._initTouchEvent=function(){this.bg_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTouchHead,this)},e.prototype._onTouchHead=function(){this._headTouchFunc&&this._headTouchFunc()},e.prototype.setHeadTouchFunc=function(t){this._headTouchFunc=t},e.prototype.setHeadTouch=function(t){this.bg_img.touchEnabled=t},e.prototype.setQuitFlagVisible=function(t){this.quitFlag.visible=t},e.prototype.setOwnerFlagVisible=function(t){this.ownerFlag.visible=t},Object.defineProperty(e.prototype,"imageId",{set:function(t){var e=t;t&&t!=this.imgAvatar.source&&(-1!=t.indexOf("http://")&&(e=t.replace("http://","https://")),this.imgAvatar.source=e)},enumerable:!0,configurable:!0}),e.prototype.clean=function(){this.imgAvatar.source=null},e}(eui.Component);__reflect(Avatar.prototype,"Avatar");var ButtonBar=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this)},e.prototype.onGrpButtonTap=function(t){var e={},n=t.target.name;n.indexOf("score")>=0?(e.action="setScore",e.score=parseInt(n.substr(6,1))):e.action=n,this.dispatchEventWith(EventNames.BUTTON_BAR_TAP,!1,e)},e.prototype.switchState=function(t,e){if(void 0===e&&(e=-1),this.currentState=t,e>=0)for(var n=1;3>=n;n++){var i=this["score_"+n];i.enabled=n>e}},e.prototype.modifyButton=function(t,e){var n=this;egret.callLater(function(){var i=n.grpButton.getChildByName(t);i&&(i.enabled=e)},this)},e}(eui.Component);__reflect(ButtonBar.prototype,"ButtonBar");var ButtonDoTaskSkin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaultUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0)},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this),this.mNormal_img[e](egret.TouchEvent.TOUCH_BEGIN,this._onTouchNormalBegin,this),this.mNormal_img[e](egret.TouchEvent.TOUCH_END,this._onTouchNormalEnd,this),this.mNormal_img[e](egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._onTouchNormalCancel,this),this.mNormal_img[e](egret.TouchEvent.TOUCH_CANCEL,this._onTouchNormalCancel,this)},e.prototype._onTouchNormalBegin=function(){this.mNormal_img.source=this._press},e.prototype._onTouchNormalEnd=function(){this.mNormal_img.source=this._noraml,this._clickFunc&&this._clickFunc()},e.prototype._onTouchNormalCancel=function(){this.mNormal_img.source=this._noraml},e.prototype._initDefaultUI=function(){this._noraml=this.mNormal_img.source,this._press=this.mPress_img.source,this.mNormal_img.visible=!0,this.mPress_img.visible=!1},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1)},e.prototype.setClickFunc=function(t){t&&(this._clickFunc=t)},e.prototype.setPngs=function(t,e){this._noraml=t,this._press=e,this.mNormal_img.source=this._noraml},e.prototype.enableTouch=function(t){this.mNormal_img.touchEnabled=t},e.prototype.setOnePngAndForbidTouch=function(t){this.mNormal_img.source=t,this.enableTouch(!1)},e}(eui.Component);__reflect(ButtonDoTaskSkin.prototype,"ButtonDoTaskSkin");var CDClock=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.start=function(t,e){void 0===e&&(e=null),this.labNum.text=t.toString(),this._endTime=server.tsServer+t,this._timer=CountDownService.register(t,this.renderTime.bind(this),e),this.visible=!0},e.prototype.stop=function(t){void 0===t&&(t=!1),this.labNum.text="",CountDownService.unregister(this._timer),t&&(this.visible=!1)},e.prototype.renderTime=function(t){this.labNum.text=t.toString()},e}(eui.Component);__reflect(CDClock.prototype,"CDClock");var CDProgressBar=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._offset=-Math.PI/2,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addChild(this._mask=new egret.Shape),this.thumb.mask=this._mask;var e=this.thumb.width,n=this.thumb.height;this._radius=Math.sqrt(e*e+n*n)/2,this._center={x:this.thumb.width/2,y:this.thumb.height/2}},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&this._setValue(this._value=t)},enumerable:!0,configurable:!0}),e.prototype._setValue=function(t){var e=this._mask.graphics,n=t,i=this._radius,o=this._center.x,a=this._center.y;e.clear(),e.beginFill(16711680),e.moveTo(o,a),e.drawArc(o,a,i,n,2*Math.PI+this._offset),e.lineTo(o,a),e.endFill()},e.prototype.onSecond=function(t){this.labelDisplay&&(this.labelDisplay.text=t.toString())},e.prototype.play=function(t,e){void 0===e&&(e=0),this.value=this._offset,this._tween=egret.Tween.get(this).wait(e).to({value:2*Math.PI+this._offset},1e3*t),this._timer>0&&egret.clearInterval(this._timer),this._timer=CountDownService.register(t,this.onSecond.bind(this)),this.visible=!0},e.prototype.stop=function(){this._tween&&this._tween.setPaused(!0),this._timer>0&&egret.clearInterval(this._timer),this.visible=!1},e}(eui.Component);__reflect(CDProgressBar.prototype,"CDProgressBar");var ChatBubble=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(t){var e=this;this.labContent.text=t,this.visible=!0,this.alpha=0,egret.Tween.get(this,null,null,!0).to({alpha:1},200).wait(5e3).to({alpha:0},200).call(function(){e.visible=!1})},e}(eui.Component);__reflect(ChatBubble.prototype,"ChatBubble");var ChatList=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=components.ChatListSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=IRUpDownIcon,this.list.dataProvider=new eui.ArrayCollection(lang.chatList),this.list.addEventListener(egret.Event.CHANGE,this.onSelectItem,this)},e.prototype.onSelectItem=function(t){var e=this;this._callback(this.list.selectedIndex),egret.callLater(function(){e.list.selectedIndex=-1},this),this.close()},e.prototype.show=function(t){this._callback=t,egret.Tween.get(this.grp,null,null,!0).to({scrollV:0},200,egret.Ease.cubicIn)},e.prototype.close=function(t){void 0===t&&(t=!0),t?egret.Tween.get(this.grp,null,null,!0).to({scrollV:-this.height},200,egret.Ease.cubicIn):this.grp.scrollV=-this.height},e}(eui.Component);__reflect(ChatList.prototype,"ChatList");var ExchangeShowInfo=function(t){function e(){var e=t.call(this)||this;return e._exchageViews=[],e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeFromStage,e),e}return __extends(e,t),e.prototype.createChildren=function(){this._exservice=ExchangeService.instance;for(var t=0;3>t;t++){var e=new ExchangeShowInfoView;e.touchChildren=!1,e.touchEnabled=!1,e.alpha=0,this.addChild(e),this._exchageViews.push(e)}},e.prototype.addToStage=function(t){this.onShow()},e.prototype.removeFromStage=function(t){this.onHide()},e.prototype.onShow=function(){this._timer||(this._timer=new egret.Timer(1e3,0)),this._timer.addEventListener(egret.TimerEvent.TIMER,this.showing,this),this._timer.start()
},e.prototype.onHide=function(){null!=this._timer&&(this._timer.stop(),this._timer.removeEventListener(egret.TimerEvent.TIMER,this.showing,this),this._timer=null)},e.prototype.showing=function(){var t=this._exchageViews.pop();if(t){var e=this._exservice._showInfoQueen.shift();e?(t.setData(e),t.x=0,t.y=0,t.alpha=1,egret.Tween.get(t).to({x:0,y:-50},1e3).to({x:0,y:-150,alpha:0},2e3).call(this.showend,this,[t])):this._exchageViews.push(t)}},e.prototype.showend=function(t){this._exchageViews.push(t)},e}(eui.Component);__reflect(ExchangeShowInfo.prototype,"ExchangeShowInfo");var ExchangeShowInfoView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.skinName=components.ExchangeShowInfoSkin},e.prototype.setData=function(t){t.hasOwnProperty("nickname")?this.lbl_name.text=t.nickname:this.lbl_name.text="",this.lbl_coin.textFlow=(new egret.HtmlTextParser).parser("<font color='#F0FF00'>"+Utils.exchangeRatio(t.money,!0)+"</font> ")},e}(eui.Component);__reflect(ExchangeShowInfoView.prototype,"ExchangeShowInfoView");var _allCfg=(_a={},_a[4]="{0}",_a[5]="{0}",_a[6]="{0}",_a[7]="{0}",_a[8]="{0}",_a),_stCfg=(_b={},_b[3]="",_b[4]="",_b[5]="",_b[6]="",_b[7]="",_b),FeiHistoryItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),null!=this.data){var e=new Date(1e3*this.data.recordtime),n=alien.TimeUtils.timeFormatForEx(e,"-","-","",!1);this.exTimeLabel.text=":  "+n,this.typeImg.source="exchange_"+this.data.goodsid,this._initDesc(),this._initStatus(),this.statusBgImg.addClickListener(this._onClickStatus,this,!1)}},e.prototype._initStatus=function(){var t=this.data,e=t.status,n=this.data.goodsid;3==e?(this.statusBgImg.source="common_btn_orange3",this.statusBgImg.touchEnabled=!0):4==e&&(5==n||6==n)?(this.statusBgImg.source="common_btn_orange3",this.statusBgImg.touchEnabled=!0):(this.statusBgImg.source="common_btn_orange2_gray",this.statusBgImg.touchEnabled=!1),_stCfg[e]&&(this.exStatusLabel.text=_stCfg[e],4==e&&(5==n||6==n?this.exStatusLabel.text="":4==n&&(this.exStatusLabel.text="")))},e.prototype._initDesc=function(){var t=this.data;if(_allCfg[t.goodsid]){var e=_allCfg[t.goodsid];e=e.replace("{0}",t.goodsamount),this.exDescLabel.text=e}},e.prototype.updateInfo=function(t){this.data=t},e.prototype._onClickStatus=function(){var t=this.data;t.item=this;var e=t.status;(3==e||4==e)&&PanelFeiEx.getInstance().show(t)},e}(eui.ItemRenderer);__reflect(FeiHistoryItem.prototype,"FeiHistoryItem");var _a,_b,FlyGold=function(t){function e(){var e=t.call(this)||this;return e.skinName=components.FlyGoldSkin,e}return __extends(e,t),e.prototype.fly=function(t,e,n,i,o){void 0===o&&(o=1e3),this.visible=!0,this.rotation=360*Math.random();var a=t+123,r=e+68,s=o;this.x=a,this.y=r;var h=this.getBezier(t,e,n,i);egret.Tween.get(this,null,null,null).to({x:n,y:i,rotation:this.rotation+180,_bezier:h},s).call(this.flyEnd,this)},e.prototype.flyEnd=function(){this.visible=!1,this.dispatchEvent(new egret.Event("flyComplete"))},e.prototype.getBezier=function(t,e,n,i){var o,a,r,s=15,h=n-t,c=i-e,l=Math.random(),u=[];r=Math.abs(h)<Math.abs(c)?.5>l?1:2:.5>l?3:4;for(var p,d=2,_=1;d>_;_++)p=0+50*Math.random(),1==r||2==r?(a=e+(i-e)/d*_,o=1==r?t+(n-t)/d*_-s-p:t+(n-t)/d*_+s+p):(o=t+(n-t)/d*_,a=3==r?e+(i-e)/d*_+s+p:e+(i-e)/d*_-s-p),u.push({x:o,y:a});return u},e}(eui.Component);__reflect(FlyGold.prototype,"FlyGold");var GCardsGold=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t){t&&null!=t||(t=0),this.gold.text=t},e}(eui.Component);__reflect(GCardsGold.prototype,"GCardsGold");var Gold=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnRecharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnRechargeTap,this)},e.prototype.onBtnRechargeTap=function(t){"withButton"==this.currentState?PanelExchange2.instance.show():"diamondBuy"==this.currentState&&PanelExchange2.instance.show(1)},e.prototype._formatGold=function(t){this.nGold=t;var e=""+t;return t>=1e6?e=e.substring(0,e.length-4)+"":t>1e5&&(e=e.substr(0,2)+"."+e.substr(2,1)+""),e},e.prototype.updateGold=function(t){this.labGold&&(this.labGold.text=this._formatGold(t))},e.prototype.setEmpty=function(){this.labGold.text=""},e.prototype.showDiamond=function(){this.imgIcon.source="icon_diamond"},e.prototype.setType=function(t,e){if(void 0===e&&(e=0),this._isMatch=t)switch(e){case 0:this.imgIcon.source=ResNames.icon_score;break;case 1:this.imgIcon.source=ResNames.icon_gold}else this.imgIcon.source=ResNames.icon_gold;this.btnRecharge.visible=!t},e}(eui.Component);__reflect(Gold.prototype,"Gold");var _nativeBridge=alien.Native.instance,Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),e.prototype._initExt=function(){if(_nativeBridge.isAndroidWebView()){var t=console.log.bind(console);console.log=function(){for(var e=arguments,n=e.length,i="[js]",o=0;n>o;o++){var a=e[o];if("object"==typeof a){var r=JSON.stringify(e[o]);i+=r?r:e[o]}else i+=e[o];i+="  "}e=null,t(i)}}var e=OtherGameManager.instance;alien.Native.instance.isNative||(RES.$getVirtualUrl=function(t){var n=t;if(e.isRunOtherGame()&&-1==t.indexOf("://")){var i=e.getCurGameUrlRoot();i&&(n=i+t)}return n}),egret.DisplayObject.prototype.addClickListener=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!0);var i=this,o=i.scaleX,a=i.scaleY,r=function(){n&&egret.Tween.get(i).to({scaleX:o+.1,scaleY:a+.1},50)},s=function(n){n.stopImmediatePropagation(),egret.Tween.get(i).to({scaleX:o,scaleY:a},50),t&&t.call(e,n)},h=function(){n&&egret.Tween.get(i).to({scaleX:o,scaleY:a},50)},c=function(){n&&egret.Tween.get(i).to({scaleX:o,scaleY:a},50)},l=function(){u(!1)},u=function(t){var e="addEventListener";t||(e="removeEventListener"),i[e](egret.TouchEvent.TOUCH_BEGIN,r),i[e](egret.TouchEvent.TOUCH_END,s),i[e](egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,h),i[e](egret.TouchEvent.TOUCH_CANCEL,c),i[e](egret.Event.REMOVED_FROM_STAGE,l)};u(!0)},egret.ImageLoader.crossOrigin="anonymous"},e.prototype.doNativeInit=function(){if(console.log("doNativeInit===========>",_nativeBridge.isNative,egret.Capabilities.os),_nativeBridge.isNative){var t=3,e="C9029BAFD559F19C50E0247E2E9B57353",n="C2E5D5868229A2EFA0563E5C3A3A66881",i="wx2f626b869698b735",o=e,a="cbe075303b",r="cec021ffbd",s=a,h=!1,c="adbddfsf",l="223",u=!1;"iOS"==egret.Capabilities.os&&(o=n,s=r);var p={logLevel:t,deAppId:o,deChannelId:"",wxAppId:i,hasAli:!1,xgDebug:u,xgAccount:c,xgTag:l,bugAppId:s,bugDebug:h};_nativeBridge.setKeepScreenOn(!0),_nativeBridge.getAppChannelId(function(t){p.deChannelId=t,_nativeBridge.call("initNative",p,function(t){var e=JSON.parse(t);console.log("initNative-------->",t,e.result)})})}},e.prototype.initMta=function(){if(!alien.Native.instance.isNative){var t=document.createElement("script");t.src="https://pingjs.qq.com/h5/stats.js?v2.0.2",t.setAttribute("name","MTAH5"),t.setAttribute("sid","500485827");var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}},e.prototype.createChildren=function(){this._initExt(),t.prototype.createChildren.call(this),RES.setMaxLoadingThread(8);var e=_nativeBridge.getUrlArg();_nativeBridge.setInMiniApp(e.egretnative),this.doGameInit()},e.prototype.doGameInit=function(){this.initMta(),this.doNativeInit(),e._instance=this,this._resetCfgAndRoomFalse(),AdvanceMethod.start(),Reportor.instance.start(),this.init()},e.prototype.init=function(){"iOS"==egret.Capabilities.os&&(this.stage.frameRate=45),alien.Dispatcher.init(),alien.StageProxy.init(this.stage,this),alien.SceneManager.init(this),alien.localStorage.init(GameConfig.gameName),alien.TickerManager.activate(),new ObjectPoolInit,console.log("DEBUG :"+GameConfig.DEBUG),egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onGotEnvInfo=function(t){alien.Utils.injectProp(Environment,t)},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},e.prototype._onWXReadyCallInit=function(){var t=alien.Native.instance;t.isNative||(t.initWXFunc(),t.wxConfig())},e.prototype._initH5Info=function(){var t=this,e=_nativeBridge.getUrlArg();console.log("_initH5Info=====>",_nativeBridge.isNative,e),_nativeBridge.isNative||(e.wx_code?e.notWx&&"1"==e.notWx?_nativeBridge.setChannelName("wxqr"):(_nativeBridge.setChannelName("wxmp"),window.top.isWXReady()?this._onWXReadyCallInit():window.top.onWXReadyFunc(function(){t._onWXReadyCallInit()})):e.ali_code&&(e.notAli&&"1"==e.notAli?_nativeBridge.setChannelName("aliqr"):_nativeBridge.setChannelName("ali")))},e.prototype._doCreateScene=function(){SceneLoading.setLoadingText(""),alien.SceneManager.register(SceneNames.LOGIN,SceneLogin,"preload"),alien.SceneManager.register(SceneNames.ROOM,SceneRoom,"preload"),alien.SceneManager.register(SceneNames.PLAY,ScenePlay,"play"),RES.loadGroup("common"),RES.loadGroup("room"),SceneLoading.setLoadingText(""),webService.loadLog(1,1),this._initH5Info(),this.createScene()},e.prototype.onResourceLoadComplete=function(t){var e=this;"common"==t.groupName?this._onRoomLoadOver():"preload"==t.groupName&&(GameConfig.init(),GameConfig.getUrl(function(){alien.SceneManager.register(SceneNames.LOADING,SceneLoading,"preload");var t=!0;_nativeBridge.isNative&&(t=!1),alien.SceneManager.show(SceneNames.LOADING,{showCopyRight:t}),_nativeBridge.closeStartImg(),_nativeBridge.isNative?(SceneLoading.setLoadingText(""),_nativeBridge.checkAppUpdate(function(){e._doCreateScene()})):e._doCreateScene()}))},e.prototype.onResourceLoadError=function(t){egret.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){},e.prototype._resetCfgAndRoomFalse=function(){this._cfgLoadOver=!1,this._roomLoadOver=!1},e.prototype._onRoomLoadOver=function(){this._roomLoadOver=!0,this._checkRoomAndCfgOkAndStart()},e.prototype._onCfgInitOver=function(){this._cfgLoadOver=!0,this._checkRoomAndCfgOkAndStart()},e.prototype._checkRoomAndCfgOkAndStart=function(){console.log("_checkRoomAndCfgOkAndStart=======>"+this._cfgLoadOver+"|"+this._roomLoadOver),this._cfgLoadOver&&this._roomLoadOver&&(this._resetCfgAndRoomFalse(),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),MainLogic.instance.delayStart())},e.prototype.createScene=function(){var t=this;console.log("createScene============>"),async.parallel([function(t){alien.SceneManager.addTopScene(SceneNames.COMMON,SceneCommon),alien.SceneManager.addEffectScene(SceneNames.EFFECT,SceneEffect),alien.SceneManager.addMostTopScene(SceneNames.MOST_TOP,SceneMostTop);var e=RES.getRes("badwords_txt"),n=e.split("\n");Utils.setSensitiveWord(n),alien.Native.instance.getDeviceUUID(function(e){GameConfig.IS_NATIVE_SHOW_TIP=!e.not_show_tip,webService.uuid=e.uuid,t()},GameConfig.platform)},function(t){GameConfig.loadConfigs(function(e){t()})}],function(){t._onCfgInitOver()})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var GoodsItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t){1==t.id?this.numLabel.text=t.count:this.numLabel.text="x"+t.count,this.iconImg.source="room_"+t.id},e.parseUrl=function(t){return GameConfig.RESOURCE_URL+"goods-icon/goods_"+t+".png"},e}(eui.Component);__reflect(GoodsItem.prototype,"GoodsItem");var HornTalkItem=function(t){function e(){var e=t.call(this)||this;return e._enableEvent(!0),e}return __extends(e,t),e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this)},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this._initByData()},e.prototype._initByData=function(){var t=this.data,e="";if(t.isUser){var n=t.name.substr(0,9);e="<font color='#ffffff'>"+n+":</font> <font color='#654116'>"+t.msg+"</font>"}else e="<font color='#FFEA00'>  </font><font color='#FFEA00'>"+t.msg+"</font>";var i=(new egret.HtmlTextParser).parser(e);this.text_label.textFlow=i},e}(eui.ItemRenderer);__reflect(HornTalkItem.prototype,"HornTalkItem");var InviteListItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.itemIndex%2==0?this.bg.visible=!0:this.bg.visible=!1,"0"==this.data.status?this.status.source="invite_6":this.status.source="invite_5",this.data.nickname.length>9&&(this.data.nickname=this.data.nickname.substr(0,6),this.data.nickname=this.data.nickname+"..."),this.lbName.text=this.data.nickname,this.lbTime.text=this.data.add_time},e}(eui.ItemRenderer);__reflect(InviteListItem.prototype,"InviteListItem");var Loading=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._count=8,e.R=50,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addChild(this._container=new egret.DisplayObjectContainer);for(var e=2*Math.PI/this._count,n=0;n<this._count;n++){var i=new LoadingItem;i.play(e*(this._count-n-1)),this._container.addChild(i),i.x=Math.cos(e*n)*this.R,i.y=Math.sin(e*n)*this.R}},e.prototype.play=function(){alien.TickerManager.register(this)},e.prototype.stop=function(){alien.TickerManager.unregister(this)},e.prototype.update=function(){alien.Utils.enumChildren(this._container,function(t){t.update()})},e}(eui.Group);__reflect(Loading.prototype,"Loading",["alien.ITicker"]);var LoadingItem=function(t){function e(){var e=t.call(this,RES.getRes(ResNames.loading_icon))||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.anchorOffsetX=this.anchorOffsetY=this.width/2},e.prototype.update=function(){this._radius+=.08,this.alpha=this.scaleX=this.scaleY=(Math.sin(this._radius+this._offset)+1)/2},e.prototype.play=function(t){this._offset=t,this._radius=0},e}(egret.Bitmap);__reflect(LoadingItem.prototype,"LoadingItem");var LoadingProcess=function(t){function e(){var e=t.call(this)||this;e.group=new eui.Group,e.group.width=584,e.group.height=93,e.addChild(e.group),e.back=new eui.Image(RES.getRes("loding_image_23")),e.back.scale9Grid=new egret.Rectangle(38,6,231,7),e.back.x=0,e.back.y=71,e.back.width=584,e.group.addChild(e.back),e.scroller1=new eui.Scroller,e.scroller1.width=0,e.scroller1.height=21,e.scroller1.x=0,e.scroller1.y=71;var n=new eui.Group;e.scroller1.viewport=n,e.pro=new eui.Image(RES.getRes("loding_image_24")),e.pro.scale9Grid=new egret.Rectangle(38,7,231,6),e.pro.width=584,n.addChild(e.pro);for(var i=18;560>i;i+=18){var o=new eui.Image(RES.getRes("loding_image_25"));o.x=i,o.y=5,n.addChild(o)}var a=new eui.Image(RES.getRes("loding_image_26"));a.scale9Grid=new egret.Rectangle(51,6,200,2),a.width=584,n.addChild(a);var r=new eui.Image(RES.getRes("loding_image_27"));return r.scale9Grid=new egret.Rectangle(38,11,231,3),r.width=584,n.addChild(r),e.group.addChild(e.scroller1),e.light=new eui.Image(RES.getRes("loding_image_28")),e.light.x=0,e.light.y=76,e.group.addChild(e.light),e.plane=new eui.Image(RES.getRes("loding_image_29")),e.plane.x=0,e.plane.y=29,e.group.addChild(e.plane),e.lab1=new eui.Label,e.lab1.size=18,e.lab1.text="...",e.lab1.fontFamily="",e.lab1.horizontalCenter=0,e.lab1.y=7,e.lab1.textColor=354118,e.group.addChild(e.lab1),e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.setProcess=function(t,e){t>e&&(t=e),this.scroller1.width=t/e*this.pro.width,this.light.x=this.scroller1.width-this.light.width+4,this.light.x>this.pro.width-this.light.width-4&&(this.light.x=this.pro.width-this.light.width-4),this.plane.x=this.scroller1.width-this.plane.width+17,this.lab1.text=t+"/"+e},e}(eui.Component);__reflect(LoadingProcess.prototype,"LoadingProcess");var MarqueeText=function(t){function e(){var e=t.call(this)||this;return e.announceonly=!1,e._bInLobby=!1,e._bScrolling=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.skinName=components.MarqueeSkin,this.m_width=this.maskR.width,this.step=3},e.prototype.clear=function(){this.stop()},e.prototype.addToStage=function(t){this.x=alien.StageProxy.stage.stageWidth-this.width>>1,this.y=114,alien.StageProxy.stage.addEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.removeFromStage=function(t){alien.StageProxy.stage.removeEventListener(egret.Event.RESIZE,this.onResize,this),this.clear()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth-this.width>>1},e.prototype.show=function(t){void 0===t&&(t=null),this.visible&&this._bScrolling||(this.announceonly=t,this.txt.text="",this.txt.x=this.maskR.x,this.checkNext())},e.prototype.onMouseOver=function(t){this.isMouseOver=!0},e.prototype.onMouseOut=function(t){this.isMouseOver=!1},e.prototype.deleteAnnounce=function(){ExchangeService.instance.deleteAnnounce(),this._bScrolling=!1,this._bInLobby||(this.visible=!1)},e.prototype.showOne=function(t){var e=this;this.visible=!0,this.txt.textFlow=(new egret.HtmlTextParser).parser(t.text),this.txt.x=this.m_width;var n=-this.txt.width,i=50*Math.floor((this.txt.x-n)/this.step);this.txt.alpha=1,this.announceonly?(this._bScrolling=!0,egret.Tween.get(this.txt).to({x:n},i).call(this.deleteAnnounce.bind(this))):(this._bScrolling=!0,1==t.type?egret.Tween.get(this.txt).to({x:n},i).call(this.checkNext.bind(this,!0)):egret.setTimeout(function(){e.txt.x=.5*(e.m_width-e.txt.measuredWidth),e.txt.visible=!1,e.txt.alpha=0,egret.Tween.get(e.txt).set({visible:!0}).to({alpha:1},200).wait(3e3).to({alpha:0},1e3).wait(1e3).call(e.checkNext.bind(e,!0))},this,200))},e.prototype.checkNext=function(t){void 0===t&&(t=!1),t&&ExchangeService.instance.deleteAnnounce();var e=this.getNextText();""==e.text?this.stop():this.showOne(e)},e.prototype.getNextText=function(){var t=(MainLogic.instance.selfData,{type:1,text:""});if(ExchangeService.instance.announce&&ExchangeService.instance.announce.length>0){this.imgRedCoin.visible=!1,this.imgTrumpet.visible=!0,this.txt.textColor=16047376;var e=ExchangeService.instance.announce;t.type=1,t.text="<font color='#FFEA00'>  </font><font color='#FFEA00'>"+e+"</font>"}else if(!this._bInLobby&&ExchangeService.instance.matchChampionMsg&&ExchangeService.instance.matchChampionMsg.length){this.imgRedCoin.visible=!0,this.imgTrumpet.visible=!1,this.txt.textColor=16777215;var n=ExchangeService.instance.matchChampionMsg.shift();t.type=2,n?t.text=n.content:t.text=""}else if(!this._bInLobby&&ExchangeService.instance._showInfoQueen&&ExchangeService.instance._showInfoQueen.length){this.imgRedCoin.visible=!0,this.imgTrumpet.visible=!1,this.txt.textColor=16777215;var n=ExchangeService.instance._showInfoQueen.shift();if(t.type=3,n){n.hasOwnProperty("nickname")||(n.nickname="");var i=n.nickname+"  ";i+="<font color='#F0FF00'>"+Utils.exchangeRatio(n.money,!0)+"</font> ",t.text=i}else t.text=""}return t},e.prototype.stop=function(){this._bScrolling=!1,this._bInLobby||(egret.Tween.removeTweens(this.txt),this.visible=!1)},e.prototype.setInLobby=function(t){this._bInLobby=t},e.prototype.enableSendHorn=function(t){t&&(this.imgRedCoin.visible=!1,this.openHorn_img.visible=!1,this.openHorn_img.addClickListener(this._onClickOpenHornTalk,this)),this.openHorn_img.touchEnabled=!1},e.prototype._onClickOpenHornTalk=function(){PanelHornTalk.getInstance().show()},e}(eui.Component);__reflect(MarqueeText.prototype,"MarqueeText");var MasterCards=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);for(var e=0;3>e;e++){var n=Card.create({pid:0});n.scaleX=n.scaleY=.4,n.x=62*e,this.container.addChild(n)}},e.prototype.initData=function(){var t=this;[0,0,0].forEach(function(e,n){var i=t.container.getChildAt(n);i.showBack()}),this.updateScore(0,1)},e.prototype.showCards=function(t,e){var n=this;t.forEach(function(t,i){var o=n.container.getChildAt(i);o.pokerId=t,o.showFront(!e)})},e.prototype.updateScore=function(t,e){var n=""+t;t>=1e4&&(n=""+t/1e4+""),this.labBase.text=n,this.labMultiple.text=e.toString()},e.prototype.updateMultiple=function(t){0>t||(this.labMultiple.text=""+t)},e}(eui.Component);__reflect(MasterCards.prototype,"MasterCards");var NavigationPage=alien.NavigationPage,Page=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=components.PageSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentWidth=100,this.percentHeight=100},e.prototype.beforeShow=function(t,e){"push"==t&&(this.label.text=e.label,this.bg.fillColor=Math.floor(16777215*Math.random()))},e}(NavigationPage);__reflect(Page.prototype,"Page");var QProgressBar=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._maximum=100,e._minimum=0,e._value=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpThumb.mask=this.imgThumbMask,this._maxWidth=this.grpThumb.width},e.prototype.startAnimation=function(){this.imgRepeat.play()},e.prototype.stopAnimation=function(){this.imgRepeat.stop()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=Math.max(Math.min(t,this.maximum),0),this.updateValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximum",{get:function(){return this._maximum},set:function(t){this._maximum=t,this.updateValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimum",{get:function(){return this._minimum},set:function(t){this._minimum=t,this.updateValue()},enumerable:!0,configurable:!0}),e.prototype.updateValue=function(){this.labelDisplay.text=this._value+"/"+this._maximum;var t=this._maxWidth*(this._value/this._maximum);egret.Tween.get(this.grpThumb,null,null,!0).to({width:t},100),egret.Tween.get(this.imgThumbMask,null,null,!0).to({width:t},100)},e}(eui.Component);__reflect(QProgressBar.prototype,"QProgressBar");var RedPacketProcess=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.light.visible=1==this.data},e.prototype.getLightImg=function(){return this.light},e}(eui.ItemRenderer);__reflect(RedPacketProcess.prototype,"RedPacketProcess");var Robot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),new alien.Wave(this.eye,1e3,e.eyeAni)},e.eyeAni=function(t){return{alpha:(Math.sin(t)+1)/2}},e}(eui.Component);__reflect(Robot.prototype,"Robot");var ShopItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnConfirmTap,this)},e.prototype._refreshLeftTime=function(){var t=(new Date).getTime(),e=Utils.getTimeStampDiff(t,this.data.timeStamp,"minute");e=Math.floor(e);var n=e/60;return n=Math.floor(n),e%=60,0==n&&0==e?(this._showPreAndTime(!1),void PanelExchange2.instance.onTimeExpired([this.data.goodsid])):void(this.labAddition.text=""+n+"")},e.prototype._clearRepeatInterval=function(){this.mTimeInterval&&(egret.clearInterval(this.mTimeInterval),this.mTimeInterval=0)},e.prototype._showPreAndTime=function(t){var e=this;t?(this._clearRepeatInterval(),this._refreshLeftTime(),this.mTimeInterval=egret.setInterval(function(){e._refreshLeftTime()},this,6e4)):this._clearRepeatInterval(),this.grpAddition.visible=t,this.mPre_img.visible=t},e.prototype._doExchange=function(){var t,e=this;if(PanelExchange2.instance.lv_goods.selectedItem){var n=PanelExchange2.instance.lv_goods.selectedItem,i=this;if(0!=n.product_id){var o=UserData.instance.hasBindPhone();if(!o)return void PanelBindPhone.getInstance().show(2,{showClose:!0},function(){i._doExchange()})}var a=n.amount;if(0==n.goodsid)t=alien.StringUtils.format(lang.exchange_redcoin_gold,a);else{if(1==n.goodsid)return t=alien.StringUtils.format(lang.exchange_redcoin_red,a),void Alert.show("");if(4==n.goodsid){var r="{0}";t=alien.StringUtils.format(r,n.amount)}else if(6==n.goodsid){var r="{0}APP";t=alien.StringUtils.format(r,n.amount)}else if(5==n.goodsid){var r="{0}";t=alien.StringUtils.format(r,n.amount)}else if(7==n.goodsid){var r="{0}";t=alien.StringUtils.format(r,n.amount)}else if(0==n.product_id){var r="{0}";1==n.item_type?r+="":3==n.item_type&&(r+=""),t=alien.StringUtils.format(r,n.num)}}Alert.show(t,1,function(t){if("confirm"==t){var i=n.coin/100;0==n.product_id&&(i=n.money);var o=(MainLogic.instance.selfData.redcoin||0)/100;if(i>o)return void egret.setTimeout(function(){Alert.show("")},e,300);ExchangeService.instance.doRedExchange(n)}})}},e.prototype._doBuy=function(){RechargeService.instance.doRecharge(this.data.product_id)},e.prototype.onBtnConfirmTap=function(t){this.data.amount?this._doExchange():0==this.data.product_id?this._doExchange():this._doBuy()},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=!1,n="",i=0,o="";this.data.item_type?1==this.data.item_type||(2==this.data.item_type?(i=1,n="",o=""):3==this.data.item_type&&(i=2,n="")):i=this.data.goodsid;var a="",r=lang.currency;a=4==this.data.goodsid?this.data.amount+"":5==this.data.goodsid?this.data.amount+"":6==this.data.goodsid?this.data.amount+"":7==this.data.goodsid?this.data.amount+"":this.data.num+n,0==this.data.product_id&&(r=""),this.labGold.text=a,this.imgIcon.source=GoodsItem.parseUrl(i),this.btnConfirm.money_label.text=o+this.data.money+r,this.data.addition>0&&(this.labAddition.text=lang.format(lang.id.recharge_addition,this.data.addition)),this.btnConfirm.skin._Image1.source="common_btn_orange2_n",this.data.amount?(this.mPre_img.visible=!0,this.exchange_img.visible=!0,0==this.data.goodsid?this.labGold.text=this.data.amount+lang.gold:1==this.data.goodsid||4==this.data.goodsid?(this.labGold.text=o+Utils.exchangeRatio(this.data.amount,!0),1==this.data.amount&&this.data.first&&this.data.timeStamp&&(e=!0)):6==this.data.goodsid?(this.mPre_img.source="exchange_pre2",e=!0):7==this.data.goodsid&&(this.data.first?(this.mPre_img.source="exchange_pre",e=!0):e=!1),this._showPreAndTime(e),this.btnConfirm.money_label.text=o+this.data.coin/100):(this.mPre_img.visible=!1,this.exchange_img.visible=!1,this.btnConfirm.money_label.horizontalCenter=0,0==this.data.product_id&&(this.btnConfirm.skin._Image1.source="common_btn_orange3",this.exchange_img.visible=!0,this.mPre_img.visible=!0,this.mPre_img.source="exchange_pre1")),this.grpAddition.visible=this.data.addition>0||this.data.first},e}(eui.ItemRenderer);__reflect(ShopItem.prototype,"ShopItem");var Toast=function(){function t(){}return t.show=function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=0),alien.Dispatcher.dispatch(EventNames.SHOW_TOAST,{content:t,color:e,delay:n})},t}();__reflect(Toast.prototype,"Toast");var UserInfoView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(t){this.updateHeadImage(t.imageid),this.updateNickname(t),isNaN(t.gold)||this.updateGold(t.gold)},e.prototype.updateNickname=function(t){var e=MainLogic.instance.selfData;if(t.uid==e.uid){if(e.nickname){var n=e.nickname.substr(0,10);this.labNickName.text=n+"("+e.fakeuid+")"}}else this.labNickName.text=t.nickname},e.prototype.updateHeadImage=function(t){t&&t!=this.avatar.imageId&&(this.avatar.imageId=t)},e.prototype.clean=function(){this.avatar.clean(),this.labNickName.text="",this.gold.setEmpty()},e.prototype.getAvatarPos=function(){return this._globalPos||(this._globalPos=this.localToGlobal(this.avatar.x+this.avatar.width/2-20,this.avatar.y+this.avatar.height/2-20)),this._globalPos},e.prototype.updateGold=function(t){this.gold.updateGold(t)},e.prototype.updateDiamond=function(t){this.diamond.updateGold(t)},e.prototype.hideGuessRight=function(){this.grpGRLight.visible=!1},e.prototype.playWinGoldAnimate=function(){this.grpGRLight.visible=!0,this.grpAnimate.visible=!0,this.star0.visible=!1,this.star1.visible=!1,this.star2.visible=!1,egret.Tween.get(this.light).set({loop:!0,visible:!0,rotation:0}).to({rotation:360},2e3).to({visible:!1}).wait(1700).call(this.hideGuessRight,this),egret.Tween.get(this.star0).set({alpha:.3,x:40,y:40,scale:1,visible:!0}).to({alpha:1,x:17,y:-9,scale:1.3},800).to({alpha:0},100).to({alpha:.3,x:40,y:40,scale:1}).to({alpha:1,x:34,y:-11,scale:1.3},1e3).to({alpha:0},100),egret.Tween.get(this.star1).set({alpha:.3,x:40,y:40,scale:1,visible:!0}).wait(200).to({alpha:1,x:5,y:74,scale:1.3},1e3).to({alpha:0},100).to({alpha:.3,x:40,y:40,scale:1}).to({alpha:1,x:8,y:86,scale:1.3},1e3).to({alpha:0},100),egret.Tween.get(this.star2).set({alpha:.3,x:40,y:40,scale:1,visible:!0}).wait(300).to({alpha:1,x:85,y:28,scale:1.3},1e3).to({alpha:0},100).to({alpha:.3,x:40,y:40,scale:1}).to({alpha:1,x:70,y:74,scale:1.3},1e3).to({alpha:0},100)},e}(eui.Component);__reflect(UserInfoView.prototype,"UserInfoView");var DayTaskItemInfo=function(t){function e(){var e=t.call(this)||this;return e._enableEvent(!0),e}return __extends(e,t),e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this),server[e](EventNames.USER_GET_TASKREW_REP,this._onRecvGetRewRep,this)},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this._initByData()},e.prototype._initByData=function(){if(this.info_group.visible=!0,this._tStatusFunc=(e={},e[0]=this._onNotOverBtn.bind(this),e[1]=this._onHasOverBtn.bind(this),e[2]=this._onHasGetRewardBtn.bind(this),e),this.data.total<=0&&(this.data.total=1),this.data.rew&&2==this.data.rew.length){var t=this.data.num;t>this.data.total&&(t=this.data.total),this._nMinWidth=this.mPro_img.texture.textureWidth,this._fMinPro=this._nMinWidth/this.mProBg_img.width,this._initRewPng(this.data.rew),this._initProgress(t,this.data.total),this._initTaskDesc(this.data.taskDesc1),this._initRewSucc(),this._initDescExt(this.data.taskDesc2),this._initBtnAndFunc(this.data.status),this.mTaskDesc1_label.x=this.mTaskDesc_label.x+this.mTaskDesc_label.width
}var e},e.prototype._initRewSucc=function(){var t=(s={},s[0]="x{0}",s[41003]="x{0}",s[2]="x{0}",s[1]="x{0}",s),e=this.data.rew[0].id,n=this.data.rew[0].num,i=this.data.rew[1].id,o=this.data.rew[1].num,a=t[e],r=t[i];this.data.rewDesc="\n1."+a.replace("{0}",n)+"  2."+r.replace("{0}",o);var s},e.prototype._initRew0ByIdAndNum=function(t,e){this.mReward0High_img.visible=!0,41003==t?(this.mReward0_img.source="task_red1",this.mReward0Num_label.text="x"+e):0==t&&(this.mReward0_img.source="room_0",this.mReward0Num_label.text=""+e,this.mReward0High_img.visible=!1)},e.prototype._initRew1ByIdAndNum=function(t,e){1==t?(this.mReward1_img.source="task_re2",this.mReward1Num_label.text=e+""):2==t&&(this.mReward1_img.source="room_2",this.mReward1Num_label.text=e+"")},e.prototype._initRewPng=function(t){this._initRew0ByIdAndNum(t[0].id,t[0].num),this._initRew1ByIdAndNum(t[1].id,t[1].num)},e.prototype._initTaskDesc=function(t){this.mTaskDesc_label.text=t},e.prototype._initDescExt=function(t){this.mTaskDesc1_label.text=t},e.prototype._onPlayNormalMatch=function(){PanelDayTask.getInstance().close(),alien.Dispatcher.dispatch(EventNames.TO_NORMAL_MATCH)},e.prototype._onInviteFriend=function(){alien.Native.instance.isNative?WxHelper.doNativeShare():PanelShare.instance.showInviteFriend()},e.prototype._onGetRewardReq=function(){var t={taskid:this.data.id};server.send(EventNames.USER_GET_TASKREW_REQ,t)},e.prototype._getTextByResult=function(t){var e=null;if(0==t)e=":"+this.data.rewDesc;else{var n=(i={},i[1]=lang.taskNotExist,i[2]=lang.taskNotOver,i[3]=lang.taskHasGetRew,i);e=n[t]?n[t]:" "}return e;var i},e.prototype._onRecvGetRewRep=function(t){if(t.data.taskid==this.data.id){var e=this._getTextByResult(t.data.result);Alert.show(e,0,null,"left"),0==t.data.result&&(MainLogic.instance.selfData.setTaskHasGetRew(t.data.taskid),egret.setTimeout(function(){this._onHasGetRewardBtn()},this,200))}},e.prototype._initProgress=function(t,e){var n=t/e;if(this.mPro_label.text=t+"/"+e,n<this._fMinPro){if(0==n)return void(this.mPro_img.visible=!1);this.mPro_img.width=this._nMinWidth}else n>=1?this.mPro_img.width=this.mProBg_img.width:this.mPro_img.width=n*this.mProBg_img.width;this.mPro_img.visible=!0},e.prototype._initBtnAndFunc=function(t){this._tStatusFunc[t]?this._tStatusFunc[t]():LogUtil.info("_initBtnAndFunc=====error=======>",t)},e.prototype._onNotOverBtn=function(){this.mDoTask_btn.setPngs("task_doTask_n","task_doTask_p"),1==this.data.condition?this.mDoTask_btn.setClickFunc(this._onPlayNormalMatch.bind(this)):this.mDoTask_btn.setClickFunc(this._onInviteFriend.bind(this)),this.mDoTask_btn.enableTouch(!0)},e.prototype._onHasOverBtn=function(){this.mDoTask_btn.setPngs("task_getReward_n","task_getReward_p"),this.mDoTask_btn.enableTouch(!0),this.mDoTask_btn.setClickFunc(this._onGetRewardReq.bind(this))},e.prototype._onHasGetRewardBtn=function(){this.mDoTask_btn.setOnePngAndForbidTouch("task_get")},e}(eui.ItemRenderer);__reflect(DayTaskItemInfo.prototype,"DayTaskItemInfo");var otherGameCfg=(_a={},_a[2]={name:"crazy32",urlRoot:"http://192.168.0.81/laoqifeng/doudizhu/games/c32test/web/171207160146/",mainJs:"main.min.js",gameId:3,listenAllProto:!1,entryClassName:"Crazy32GameEntry"},_a[3]={name:"niuniu",urlRoot:"http://192.168.0.235:8085/",mainJs:"main.min.js",gameId:4,listenAllProto:!1,entryClassName:"NiuNiuMain"},_a[4]={name:"fish",urlRoot:"http://192.168.0.5:8086/",mainJs:"main.min.js",gameId:5,listenAllProto:!0,entryClassName:"FishMain"},_a),_a,DragonGameChunTian=function(t){function e(){var e=t.call(this,"gm_chuntian")||this;return e.armature=e.addArmature("gm_chuntian"),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("gm_chuntian",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("gm_chuntian",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameChunTian.prototype,"DragonGameChunTian");var DragonGameFeiJi=function(t){function e(){var e=t.call(this,"gm_feiji")||this;return e.armature=e.addArmature("gm_feiji"),e.armature.animation.timeScale=.75,e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("gm_feiji",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("gm_feiji",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameFeiJi.prototype,"DragonGameFeiJi");var DragonGameLianDui=function(t){function e(e){var n=t.call(this,"gm_shunziliandui")||this;return n.needMinnor=e,n.armature=n.addArmature("shunziliandui"),n.armature.display.scaleX=1.2,n.armature.display.scaleY=1.2,n.armature.animation.timeScale=.6,n}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("liandui",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("liandui",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameLianDui.prototype,"DragonGameLianDui");var DragonGameShunZi=function(t){function e(e){var n=t.call(this,"gm_shunziliandui")||this;return n.needMinnor=e,n.armature=n.addArmature("shunziliandui"),n.armature.display.scaleX=1.2,n.armature.display.scaleY=1.2,n.armature.animation.timeScale=.6,n}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("shunzi",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("shunzi",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameShunZi.prototype,"DragonGameShunZi");var DragonGameWangZha=function(t){function e(){var e=t.call(this,"gm_wangzha")||this;return e.armature=e.addArmature("gm_wangzha"),e.armature.animation.timeScale=.8,e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("gm_wangzha",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("gm_wangzha",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameWangZha.prototype,"DragonGameWangZha");var DragonGameZhaDan=function(t){function e(){var e=t.call(this,"gm_zhadan")||this;return e.armature=e.addArmature("gm_zhadan"),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("gm_zhadan",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("gm_zhadan",1,1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonGameZhaDan.prototype,"DragonGameZhaDan");var DragonHongBao=function(t){function e(){var e=t.call(this,"hongbao")||this;return e.armature1=e.addArmature("hongbao"),e.armature2=e.addArmature("hongbao"),e.btn=new StateButton,e.btn.skinName=ui.PlayOrangeButtonSkin,e.btn.labelIcon="play_btn_13",e.btn.x=-100,e.btn.y=203,e.addChild(e.btn),e.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTap,e),e.btn.visible=!1,e.stop1(),e.stop2(),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e)},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e)},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop1=function(){this.armature1.removeEventListener(egret.Event.COMPLETE,this.onComplete1.bind(this),this),this.armature1.animation.gotoAndStop("hongbao1",1),this.armature1.display.visible=!1},e.prototype.stop2=function(){this.armature2.removeEventListener(egret.Event.COMPLETE,this.onComplete2.bind(this),this),this.armature2.animation.gotoAndStopByFrame("hongbao2",1),this.armature2.display.visible=!1},e.prototype.play1=function(t){this.stop2(),this.armature1.display.visible=!0,this.btn.visible=!1,t?(this.armature1.animation.gotoAndPlayByFrame("hongbao1",1,1),this.armature1.addEventListener(egret.Event.COMPLETE,this.onComplete1.bind(this),this)):this.armature1.animation.gotoAndPlayByFrame("hongbao1",55,1)},e.prototype.play2=function(){this.stop1(),this.armature2.display.visible=!0,this.btn.visible=!1,this._closeImg=new eui.Image("common_close_n"),this.addChild(this._closeImg),this._closeImg.addClickListener(this._onTouchClose,this),this.parent&&(this._closeImg.x=.5*this.parent.width-400,this._closeImg.y=.5*-this.parent.height+180),this.armature2.addEventListener(egret.Event.COMPLETE,this.onComplete2.bind(this),this),this.armature2.animation.gotoAndPlayByFrame("hongbao2",1,1)},e.prototype.onComplete1=function(t){this.dispatchEvent(new egret.Event(egret.Event.COMPLETE))},e.prototype.onComplete2=function(t){this.btn.visible=!0},e.prototype.onTap=function(t){this.stop1(),this.stop2(),this.parent&&this.parent.removeChild(this),ExchangeService.instance.doChou(1003)},e.prototype._onTouchClose=function(){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonHongBao.prototype,"DragonHongBao");var DragonHongBaoWarn=function(t){function e(){var e=t.call(this,"hongbaodonghua")||this;return e.armature1=e.addArmature("hongbaodonghua"),e.armature2=e.addArmature("hongbaodonghua"),e.stop1(),e.stop2(),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e)},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e)},e.prototype.onResize=function(t){this.x=.5*alien.StageProxy.stage.stageWidth+424,this.y=.5*alien.StageProxy.stage.stageHeight+16},e.prototype.stop1=function(){this.armature1.removeEventListener(egret.Event.COMPLETE,this.onComplete1.bind(this),this),this.armature1.animation.gotoAndStop("hongbaodonghua1",1),this.armature1.display.visible=!1},e.prototype.stop2=function(){this.armature2.animation.gotoAndStopByFrame("hongbaodonghua2",1),this.armature2.display.visible=!1},e.prototype.play1=function(){this.stop2(),this.armature1.display.visible=!0,this.armature1.animation.gotoAndPlayByFrame("hongbaodonghua1",1,1),this.armature1.addEventListener(egret.Event.COMPLETE,this.onComplete1.bind(this),this)},e.prototype.play2=function(){this.rect||(this.rect=new eui.Rect(this.armature2.display.width,this.armature2.display.height),this.rect.x=-this.rect.width>>1,this.rect.y=-this.rect.height>>1,this.rect.alpha=.01,this.rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.addChild(this.rect)),this.stop1(),this.armature2.display.visible=!0,this.armature2.animation.gotoAndPlayByFrame("hongbaodonghua2",1,-1)},e.prototype.onComplete1=function(t){this.stop1(),this.play2()},e.prototype.onTap=function(t){},e}(DragonBase);__reflect(DragonHongBaoWarn.prototype,"DragonHongBaoWarn");var DragonJingDeng=function(t){function e(){var e=t.call(this,"jingdeng")||this;return e.armature=e.addArmature("jingdeng"),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.stop=function(){this.armature.animation.gotoAndStopByFrame("jingdeng",1)},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("jingdeng",1,-1)},e.prototype.onComplete=function(t){this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonJingDeng.prototype,"DragonJingDeng");var DragonManager=function(){function t(){this.dragonbonesFactory=new dragonBones.EgretFactory,this.register()}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.addDragon=function(t,e,n){this.dragonbonesFactory.getDragonBonesData(t.name)||(this.dragonbonesFactory.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),this.dragonbonesFactory.addTextureAtlasData(this.dragonbonesFactory.parseTextureAtlasData(n,e)))},t.prototype.getDragon=function(t){return this.dragonbonesFactory.buildArmature(t)},t.prototype.register=function(){egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(.02)},this)},t}();__reflect(DragonManager.prototype,"DragonManager");var DragonMatch9Rule=function(t){function e(){var e=t.call(this,"guize")||this;return e.guize=e.addArmature("guize"),e.touchEnabled=!0,e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.onResize(e)},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.onResize=function(t){this.x=alien.StageProxy.stage.stageWidth>>1,this.y=alien.StageProxy.stage.stageHeight>>1},e.prototype.stop=function(){this.guize.animation.gotoAndStopByFrame("guize",1)},e.prototype.play=function(t){void 0===t&&(t=null),this.callback=t,this.guize.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.guize.animation.gotoAndPlayByFrame("guize",1,1)},e.prototype.onComplete=function(t){this.callback&&this.callback(),this.parent&&this.parent.removeChild(this)},e}(DragonBase);__reflect(DragonMatch9Rule.prototype,"DragonMatch9Rule");var DragonSign=function(t){function e(){var e=t.call(this,"sign")||this;return e.armature=e.addArmature("sign"),e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop()},e.prototype.stop=function(){this.timeOutId&&egret.clearTimeout(this.timeOutId),this.armature.removeEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndStop("sign")},e.prototype.play=function(){this.armature.addEventListener(egret.Event.COMPLETE,this.onComplete.bind(this),this),this.armature.animation.gotoAndPlayByFrame("sign",1,1)},e.prototype.onComplete=function(t){this.armature.animation.gotoAndPlayByFrame("sign",30,1)},e}(DragonBase);__reflect(DragonSign.prototype,"DragonSign");var DragonSignBtn=function(t){function e(){var e=t.call(this,"signBtn")||this;return e.armature=e.addArmature("signBtn"),e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.addToStage=function(e){t.prototype.addToStage.call(this,e),this.play()},e.prototype.removeFromStage=function(e){t.prototype.removeFromStage.call(this,e),this.stop(),this.parent&&this.parent.removeChild(this)},e.prototype.stop=function(){this.armature.animation.gotoAndStop("signBtn")},e.prototype.play=function(){this.armature.animation.gotoAndPlayByFrame("signBtn",1,-1)},e}(DragonBase);__reflect(DragonSignBtn.prototype,"DragonSignBtn");var IRButton=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.imgIcon.source=this.iconUp,this.imgBg.source=this.bgUp},Object.defineProperty(e.prototype,"iconUp",{get:function(){return this.data?this.data.icon+"_n":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconDown",{get:function(){return this.data?this.data.icon+"_h":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgUp",{get:function(){return this.data?this.data.bg+"_n":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgDown",{get:function(){return this.data?this.data.bg+"_h":""},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(IRButton.prototype,"IRButton");var IRContainer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.item.setData(this.data)},e}(eui.ItemRenderer);__reflect(IRContainer.prototype,"IRContainer");var IRUpDownIcon=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.img.source=this.iconUp},Object.defineProperty(e.prototype,"iconUp",{get:function(){return this.data?this.data.icon+"_n":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconDown",{get:function(){return this.data?this.data.icon+"_h":""},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(IRUpDownIcon.prototype,"IRUpDownIcon");var CreateTable=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this;return e.infoList=[],e.basescore=[],e.maxodd=[],e.roundcnt=[],e.scorelimit=[],e.createcost=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=components.CreateTableSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);EventManager.instance;this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.btnCreate.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreate,this),server.addEventListener(EventNames.CREATE_PERSONAL_GAME_REP,this.onCreateRep,this)},e.prototype.updateCreateCost=function(t){var e=0;t&&this.createcost&&this.createcost[t]&&(e=this.createcost[t]),e&&e>0?this.lbcreatecost.text=": "+e:this.lbcreatecost.text=": "},e.prototype.onCreateRep=function(t){var e=t.data;if(0!=e.result)7==e.result||11==e.result||4==e.result?PanelRechargeTips.instance.show():ImgToast.instance.show(this,lang.createPGameErr[e.result]);else{var n={roomID:e.roomid,maxodd:this.maxodd[this.info2.Index],maxround:this.roundcnt[this.info1.Index],baseScore:this.basescore[this.info3.Index],matchType:1,personalgame:!0,enterTableData:this.enterTableData,owner:server.uid};alien.SceneManager.show(SceneNames.PLAY,n,alien.sceneEffect.Fade),this.dealAction()}},e.prototype.onCreate=function(t){var e=MainLogic.instance.selfData.gold;return e<this.scorelimit[this.info4.Index]?void PanelRechargeTips.instance.show():void server.CreatePersonalGameReq(1,this.basescore[this.info3.Index],this.roundcnt[this.info1.Index],this.maxodd[this.info2.Index],this.scorelimit[this.info4.Index])},e.prototype.show=function(t){if(void 0===t&&(t=null),!this.basescore||this.basescore.length<1){var e=GameConfig.personalGameConfig.ddz;this.basescore=e.basescore,this.maxodd=e.maxodd,this.roundcnt=e.roundcnt,this.scorelimit=e.scorelimit,this.createcost=e.createcost}this.info1.setData(this.roundcnt),this.info2.setData(this.maxodd),this.info3.setData(this.basescore,this),this.info4.setData(this.scorelimit),this._callback=t,this.popup()},e.prototype.onBtnCloseClick=function(t){this.dealAction()},e}(alien.PanelBase);__reflect(CreateTable.prototype,"CreateTable");var CreateTableInfo=function(t){function e(){var e=t.call(this)||this;return e.data=[],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);for(var e=0;4>e;++e)this["img"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.radioClicked,this)},e.prototype.radioClicked=function(t){var e=Number(t.currentTarget.name);(0>e||e>this.data.length)&&(e=0),this.setIndex(e)},e.prototype.setData=function(t,e){void 0===e&&(e=null),this.data=t,this.parent_view=e;for(var n=0;4>n;++n)n<t.length?(this["img"+n].visible=!0,this["lb"+n].visible=!0,"0"==this.data[n].toString()?this["lb"+n].text="":this["lb"+n].text=this.data[n].toString()):(this["img"+n].visible=!1,this["lb"+n].visible=!1);this.setIndex(0)},e.prototype.setIndex=function(t){t||(t=0);for(var e=0;4>e;++e)e==t?(this["img"+e].source="personal_radio_c",this["lb"+e].textColor=16774656):(this["img"+e].source="personal_radio_n",this["lb"+e].textColor=16777215);this.index=t,this.parent_view&&this.parent_view.updateCreateCost(this.index)},Object.defineProperty(e.prototype,"Index",{get:function(){return this.index},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(CreateTableInfo.prototype,"CreateTableInfo");var DetailItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t,e){this.lbName.text=t,e&&null!=e||(e=0),e>=0?(this.lbGold.text="+"+e,this.lbGold.textColor=6875916):(this.lbGold.text=e,this.lbGold.textColor=16586519)},e}(eui.Component);__reflect(DetailItem.prototype,"DetailItem");var HistoryItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.lbOwner.text=this.data.owner_cn,this.lbTime.text=this.data.createtime,this.lbCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.CheckDetailClick,this)},e.prototype.CheckDetailClick=function(t){PersonalDetail.instance.show(this.data.gameinfo)},e}(eui.ItemRenderer);__reflect(HistoryItem.prototype,"HistoryItem");var HistoryRecord=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=components.HistoryRecordSkin,this.list.itemRenderer=HistoryItem,this._dataProvide||(this._dataProvide=new eui.ArrayCollection([]),this.list.dataProvider=this._dataProvide)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=HistoryItem,this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.scroll2end,this),PersonalGameHistory.instance.addEventListener(EventNames.PGAME_RECORD_DATA_REFRESH,this.onGameRecordDataUpdate,this)},e.prototype.onGameRecordDataUpdate=function(t){var e=t.data;this._dataProvide.source=e,this._dataProvide.refresh()},e.prototype.scroll2end=function(t){PersonalGameHistory.instance.getDataList()},e.prototype.show=function(t,e){void 0===e&&(e=null),this._dataProvide.source=t,this._dataProvide.refresh(),this.scroller.viewport.scrollV=0,this._callback=e,this.popup()},e.prototype.onBtnCloseClick=function(t){this.dealAction()},e}(alien.PanelBase);__reflect(HistoryRecord.prototype,"HistoryRecord");var ImgToast=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=personal.ToastSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.enableTouch=function(t){this.touchEnabled=t,this.lb.touchEnabled=t,this.bgImg.touchEnabled=t},e.prototype.show=function(t,e){var n=this;t.contains(this)&&t.removeChild(this),t.addChild(this),this.x=t.width/2-this.width/2,this.y=t.height/2-this.height/2,this.lb.text=e,this.alpha=0,egret.Tween.get(this,null,null,!0).to({alpha:1},300).wait(1500).to({alpha:0},300).call(function(){t.contains(n)&&t.removeChild(n)})},e}(eui.Component);__reflect(ImgToast.prototype,"ImgToast");var ImgWordBtn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setTit=function(t){this.titImg.source=t,this.newSrc=t},e.prototype.useNewTit=function(){this.newSrc&&(this.titImg.source=this.newSrc)},e.prototype.setDisable=function(){this.infoGroup.touchEnabled=!1,this.touchEnabled=!1,this.bgImg.source="common_btn_orange2_gray",this.useNewTit()},e.prototype.setEnable=function(){this.bgImg.source="common_btn_orange2_n",this.infoGroup.touchEnabled=!0,this.touchEnabled=!0,this.useNewTit()},e}(eui.Component);__reflect(ImgWordBtn.prototype,"ImgWordBtn");var JoinTable=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=personal.JoinTableSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.btnJoin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoin,this);for(var e=0;12>e;++e)this["btn"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNumberClick,this);this.roomid=0,server.addEventListener(EventNames.JOIN_PGAME_REP,this.onJoinRep,this)},e.prototype.onNumberClick=function(t){var e=Number(t.currentTarget.name);if(10>e){if(!(this.roomid<1e5))return;this.roomid=10*this.roomid+e}else 10==e?this.roomid=Math.floor(this.roomid/10):11==e&&(this.roomid=0);this.lbRoomID.text=0==this.roomid?"":this.roomid.toString()},e.prototype.onJoinRep=function(t){var e=t.data;0!=e.result&&(2==e.result?PanelRechargeTips.instance.show():ImgToast.instance.show(this,lang.joinPGameErr[e.result]))},e.prototype.onShare=function(t){},e.prototype.onSearch=function(t){server.QueryRoomInfoReq(this.roomid)},e.prototype.onJoin=function(t){server.JoinPGameReq(this.roomid)},e.prototype.setPlayerInfo=function(t,e,n){this["player"+t].imageId=e,this["PInfo"+t].setName(n)},e.prototype.show=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.roomid=0,this.lbOwner.text="",this.lbRoomID.text="",this._callback=t,this.popup(),e&&(this.roomid=e,this.lbRoomID.text=String(e),server.JoinPGameReq(e))},e.prototype.onBtnCloseClick=function(t){this.dealAction()},e}(alien.PanelBase);__reflect(JoinTable.prototype,"JoinTable");var PersonalDetail=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=personal.DetailSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this)},e.prototype.show=function(t,e,n,i){if(void 0===e&&(e=null),void 0===n&&(n=!1),void 0===i&&(i=null),t&&t.length>0)for(var o=0;3>o;++o)t[o]&&this["item"+(o+1)].setData(t[o].nickname,t[o].gold);this.lbLeave.visible=!1,this.imgPoint.visible=!1,this.btnLeave.visible=!1,n&&(this.btnLeave.visible=!0,this.btnLeave.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this)),i&&(this.lbLeave.visible=!0,this.imgPoint.visible=!0,this.lbLeave.text=""+i+""),this._callback=e,this.popup()},e.prototype.onBtnCloseClick=function(t){this._callback&&this._callback("confirm"),this.dealAction()},e}(alien.PanelBase);__reflect(PersonalDetail.prototype,"PersonalDetail");var PersonalGame=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=personal.PersnalGameSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnCreate.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreate,this),this.btnJoin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoin,this),this.btnHistory.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHitory,this)},e.prototype.beforeShow=function(e){t.prototype.beforeShow.call(this,e)},e.prototype.onCreate=function(t){CreateTable.instance.show()},e.prototype.onJoin=function(t){JoinTable.instance.show()},e.prototype.onHitory=function(t){PersonalGameHistory.instance.clearDataList(),PersonalGameHistory.instance.getDataList(),HistoryRecord.instance.show(PersonalGameHistory.instance.source)},e}(alien.NavigationPage);__reflect(PersonalGame.prototype,"PersonalGame");var PInfItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.lbName.text=t},e}(eui.Component);__reflect(PInfItem.prototype,"PInfItem");var TableInfo=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=personal.TableInfoSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.btnStart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this),this.btnShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),server.addEventListener(EventNames.START_PGAME_REP,this.onStartGameRep,this)},e.prototype.onJoinRep=function(t){var e=t.data;0!=e.result&&PanelAlert.instance.show(""+e.result,0)},e.prototype.onStartGameRep=function(t){var e=t.data;0!=e.result?PanelAlert.instance.show(""+e.result,0):alien.SceneManager.show(SceneNames.PLAY,this.roominfo,alien.sceneEffect.Fade)},e.prototype.onShare=function(t){},e.prototype.onStart=function(t){server.StartPGameReq(this.roomid)},e.prototype.setPlayerInfo=function(t,e,n){this["player"+t].imageId=e,this["PInfo"+t].setName(n)},e.prototype.show=function(t,e){void 0===e&&(e=null),this.roomid=t.roomid,this.lbRoomid.text=t.roomid,this.lbLimit.text=t.maxodd,this.lbRound.text=t.roundcnt,this.lbBScore.text=t.basescore,this.roominfo={roomid:t.roomid,maxOdds:t.maxodd,roundcnt:t.roundcnt,baseScore:t.basescore,matchType:1,personalgame:!0},t.owner&&this.setPlayerInfo(1,t.owner.imageId,t.owner.nickname),this._callback=e,this.popup()
},e.prototype.onBtnCloseClick=function(t){this.dealAction()},e}(alien.PanelBase);__reflect(TableInfo.prototype,"TableInfo");var RedRank=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.arr=[],this.dataProvider=new eui.ArrayCollection(this.arr),this.list.itemRenderer=RedRankInfo,this.list.dataProvider=this.dataProvider;var e=alien.EventManager.instance;e.registerOnObject(this,server,EventNames.USER_REDCOIN_RANKING_LIST_REP,this.onRedcoinRankingListRep,this)},e.prototype.onAddToStage=function(t){alien.EventManager.instance.enableOnObject(this),server.getRedcoinRankingListReq()},e.prototype.onRemoveFromStage=function(t){alien.EventManager.instance.disableOnObject(this)},e.prototype._checkDataFormat=function(){for(var t=null,e={score:null,nickname:null,ranking:null,uid:0},n=[],i=0;i<this.arr.length;++i)t=this.arr[i],t&&t.score&&t.ranking&&(e=t,e.nickname=e.nickname||"",n.push(e));this.arr=n},e.prototype.onRedcoinRankingListRep=function(t){this.arr=t.data.list,this.myRank.data=this.arr.shift(),this._checkDataFormat(),this.dataProvider.source=this.arr,this.dataProvider.refresh()},e}(eui.Component);__reflect(RedRank.prototype,"RedRank");var RedRankInfo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){this.data.score=this.data.score||0,this.data.ranking=this.data.ranking||0;var e=this.data.uid,n=this.data.ranking;e==MainLogic.instance.selfData.uid?(this.score.textColor=15859456,this.nickname.textColor=15859456,this.rank.textColor=15859456):(this.score.textColor=16777215,this.nickname.textColor=16777215,this.rank.textColor=16777215),this.score.text=Utils.exchangeRatio(this.data.score/100,!0),this.nickname.text=Base64.decode(this.data.nickname),this.nickname.text=this.nickname.text.substr(0,10),this.rank1.visible=1==n,this.rank2.visible=2==n,this.rank3.visible=3==n,this.back1.visible=1==n,this.back2.visible=2==n,this.back3.visible=3==n,0==n?this.rank.text="--":this.rank.text=n+"",this.rank.visible=n>3||1>n,this.back.visible=n>3||1>n}},e}(eui.ItemRenderer);__reflect(RedRankInfo.prototype,"RedRankInfo");var alien;!function(t){var e=function(){function t(t){this._target=t}return t.prototype.fadeIn=function(t){void 0===t&&(t=200),this._duration=t,this._targetAlpha=1,this._target.alpha=0,this._target.visible=!0,this.play()},t.prototype.fadeOut=function(t){void 0===t&&(t=200),this._duration=t,this._targetAlpha=0,this._target.alpha=1,this.play()},t.prototype.play=function(){this._tween=egret.Tween.get(this._target).to({alpha:this._targetAlpha},this._duration).set({visible:this._targetAlpha>0})},t.prototype.stop=function(){this._tween&&egret.Tween.removeTweens(this._target)},t}();t.Fade=e,__reflect(e.prototype,"alien.Fade",["alien.IAnimation"])}(alien||(alien={}));var PageChannels=function(t){function e(){var e=t.call(this)||this;return e.setClickRedNormal(!1),e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=pages.PageChannelSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize(null);var e=EventManager.instance;e.registerOnObject(this,alien.Dispatcher,EventNames.TO_NORMAL_MATCH,this.onToNormalMatch,this)},e.prototype._showPaiLiDownload=function(){var t=GameConfig.wxService,e=",:"+t+"\n()";PanelAlert3.instance.show(e,0,function(){GameConfig.copyText(this.parent,t,"("+t+")")})},e.prototype.setClickRedNormal=function(t){this._bRedNormal=t},e.prototype.isClickRedRoom=function(){return this._bRedNormal},e.prototype.onToNormalMatch=function(){this.navigation.push(PageNormalChannel)},e.prototype.onToRedNormal=function(t){void 0===t&&(t=!0),this.setClickRedNormal(!0),server.checkReconnect()},e.prototype.onSelectChannel=function(t){var e=t.currentTarget.name;switch(e){case"normal":this.onToNormalMatch();break;case"match":this.navigation.push(PageMatchChannel);break;case"diy":this.navigation.push(PersonalGame);break;case"red":this.onToRedNormal()}"red"!=e&&this.setClickRedNormal(!1)},e.prototype.beforeShow=function(t){this.enter_normal.addClickListener(this.onSelectChannel,this),this.enter_match.addClickListener(this.onSelectChannel,this),this.enter_diy.addClickListener(this.onSelectChannel,this),this.enter_red.addClickListener(this.onSelectChannel,this),this.setClickRedNormal(!1),EventManager.instance.enableOnObject(this),MainLogic.instance.hideIndexDownAndRefresh()},e.prototype.beforeHide=function(){EventManager.instance.disableOnObject(this)},e.prototype.onResize=function(t){},e.defName="PageChannels",e}(alien.NavigationPage);__reflect(PageChannels.prototype,"PageChannels");var IRChannel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.imgIcon.source="room_channel_icon_"+this.data.id,this.imgLabel.source="room_channel_lab_"+this.data.id,1==this.data.id},e.prototype.playOpenAnimate=function(){this.openFlag.visible=!0,egret.Tween.get(this.openFlag).set({visible:!0,y:87}).to({y:77},446).to({y:87},446).call(this.playOpenAnimate,this)},e}(eui.ItemRenderer);__reflect(IRChannel.prototype,"IRChannel");var PageMatchChannel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=pages.PageMatchChannelSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=IRContainer},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),server.addEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),alien.Dispatcher.addEventListener(EventNames.REFRESH_MATCH_LIST,this.onRefreshMatchList,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),server.removeEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),alien.Dispatcher.removeEventListener(EventNames.REFRESH_MATCH_LIST,this.onRefreshMatchList,this)},e.prototype.onMatchSignUpInfoRep=function(t){var e=t.data,n=null;this._roomList.some(function(t){return t.matchId==e.matchid?(n=t,!0):void 0}),n&&(n.is_signup=null==e.is_signup?0:e.is_signup,n.today_cnt=null==e.today_cnt?0:e.today_cnt,n.signup_cnt=null==e.signup_cnt?0:e.signup_cnt,n.signUpCountTest=n.signup_cnt+lang.people,n.todayCountText=n.today_cnt+"/"+n.maxDayPlayCnt,this._dataProvide.itemUpdated(n))},e.prototype.onRefreshMatchList=function(t){this._dataProvide.refresh()},e.prototype._setShareSuccGames=function(t){alien.localStorage.setItem("shareSucc",""+t)},e.prototype._getShareSuccGames=function(){var t=alien.localStorage.getItem("shareSucc");return t?Number(t):-1},e.prototype._shouldShareForFree=function(){return!1},e.prototype._onWXShareRet=function(t){var e=t.data.shareSucc;e&&(this.selectedRoom&&this.selectedRoom.matchId&&this._setShareSuccGames(this.selectedRoom.matchId),alien.Dispatcher.removeEventListener(EventNames.USER_SHARE_RESULT,this._onWXShareRet,this)),PanelShare.instance.close()},e.prototype._onFreePopShare=function(){var t=this;Alert.show("",0,function(){alien.Dispatcher.addEventListener(EventNames.USER_SHARE_RESULT,t._onWXShareRet,t),PanelShare.instance.showInviteFriend()})},e.prototype._onJoinMatch=function(){if(this.selectedRoom.ads);else{for(var t=0;t<GameConfig.roomList.length;++t)if(2==GameConfig.roomList[t].is_signup)return void server.checkReconnect();if(this.selectedRoom.is_signup)1==this.selectedRoom.is_signup?PanelMatchCountDown.instance.show(this.selectedRoom):2==this.selectedRoom.is_signup&&server.checkReconnect();else if(this.selectedRoom.maxOwnGoldLimit&&this.selectedRoom.maxOwnGoldLimit<MainLogic.instance.selfData.gold)Alert.show(alien.StringUtils.formatApply(lang.match_sign_up_result[16],[this.selectedRoom.maxOwnGoldLimit,this.selectedRoom.name]));else{var e=this._shouldShareForFree();e?this._onFreePopShare():PanelMatchSignUp.instance.show(this.selectedRoom)}}},e.prototype.selectRoom=function(e){t.prototype.selectRoom.call(this,e),this._onJoinMatch()},e.prototype.dealRoomList=function(){t.prototype.dealRoomList.call(this),this._roomList.forEach(function(t){t.ads||server.getMatchSignUpInfo(t.matchId)})},e.prototype.isAfterInNatonalLast500Match=function(){var t="2017-10-07 19:30:00",e=new Date(Date.parse(t.replace(/-/g,"/"))).getTime(),n=(new Date).getTime();return n>=e?!0:!1},e.prototype.beforeShow=function(e){t.prototype.beforeShow.call(this,e);var n=null;n=GameConfig.roomList.filter(function(t){return 2==t.roomType}),n.sort(function(t,e){return t.sortid-e.sortid}),this._roomList=n,this.dealRoomList(),this._dataProvide.source=this._roomList},e.defName="PageMatchChannel",e}(PageChannelBase);__reflect(PageMatchChannel.prototype,"PageMatchChannel");var MatchRoom=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setData=function(t){if(this.currentState=t.ads?"ads":"normal",!t.ads){if(this.labName.text=t.name,this.lbOpenTime.text=t.shortName,t.hasOwnProperty("startDate")){var e=MatchService.getNextTurn(t);this.labLimit.text=t.limitText=e.nextTime,t.nextIndex=e.nextIndex}else this.labLimit.text=t.limitText;switch(t.matchType){case 0:this.labReward.text=t.rewardText;break;case 1:}this.imgSignUp.visible=t.is_signup}},e}(eui.Component);__reflect(MatchRoom.prototype,"MatchRoom");var PageNormalChannel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=pages.PageNormalChannelSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=IRNormalRoom},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),server.addEventListener(EventNames.USER_PLAYERS_AMOUNT_REP,this.onPlayersAmount,this),this.wxMp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.navigateToUrl,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),server.removeEventListener(EventNames.USER_PLAYERS_AMOUNT_REP,this.onPlayersAmount,this),this.wxMp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.navigateToUrl,this)},e.prototype.selectRoom=function(e){t.prototype.selectRoom.call(this,e),server.checkReconnect()},e.prototype.onPlayersAmount=function(t){var e=this,n=t.data;n.info.forEach(function(t,n){var i=e.getRoomById(t.room_id);i&&(i.amount=t.amount)}),this._dataProvide.refresh()},e.prototype.fastJoin=function(){},e.prototype.navigateToUrl=function(){this.followCourse()},e.prototype.beforeShow=function(e){t.prototype.beforeShow.call(this,e),server.getPlayersAmount(),this.setRoomType(1),this.wxMp.visible=!0},e.prototype.followCourse=function(){PanelFollowCourse.instance.show()},e.prototype.beforeHide=function(t,e){void 0===e&&(e=null),this.removeListeners()},e.defName="PageNormalChannel",e}(PageChannelBase);__reflect(PageNormalChannel.prototype,"PageNormalChannel");var IRNormalRoom=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.imgName.source="room_word_"+(this.data.roomID-1e3*GameConfig.gameId-1),1003==this.data.roomID?this.labLimit.text=lang.format(lang.id.roomLimit2,Utils.roomScoreFormat(Utils.currencyRatio(this.data.baseScore)),Utils.roomScoreFormat(Utils.currencyRatio(this.data.minScore))):this.labLimit.text=lang.format(lang.id.roomLimit1,Utils.roomScoreFormat(Utils.currencyRatio(this.data.baseScore)),Utils.roomScoreFormat(Utils.currencyRatio(this.data.minScore)),Utils.roomScoreFormat(Utils.currencyRatio(this.data.maxScore)));var e=this.data.amount||0;this.labOnlineCount.text=alien.StringUtils.format(lang.roomAmount,e)},e}(eui.ItemRenderer);__reflect(IRNormalRoom.prototype,"IRNormalRoom");var PanelAct=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelActSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.actList.setSelectChangeFunc(this._onSelectChange.bind(this))},e.prototype._onSelectChange=function(t){var e=t.pos,n=this.infoGroup.globalToLocal(e.x,e.y);this.arrImg.y=n.y},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.setShowAppAct=function(){this.actList.setShowAppAct()},e.prototype.setShowFirstRecharge=function(){this.actList.setShowFirstRecharge()},e.prototype.setShowThanksgiving=function(){this.actList.setShowThanksgiving()},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelAct.prototype,"PanelAct");var PanelActAndNotice=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelActAndNotice},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this),this.actNormalGroup.addClickListener(this._onClickTitAct,this,!1),this.noticeNormalGroup.addClickListener(this._onClickTitNotice,this,!1)},e.prototype._initUI=function(){},e.prototype._checkAct=function(){this._act||(this._act=PanelAct.getInstance(),this.addChild(this._act))},e.prototype._checkNotice=function(){this._notice||(this._notice=PanelNotice.getInstance(),this.addChild(this._notice))},e.prototype._checkAdded=function(){this.parent||this.popup()},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._onClickTitAct=function(){this.showAct()},e.prototype._onClickTitNotice=function(){this.showNotice()},e.prototype.showFRecharge=function(){this.showAct(),this._act.setShowFirstRecharge()},e.prototype.showThanksgiving=function(){this.showAct(),this._act.setShowThanksgiving()},e.prototype.showAPPAct=function(){this.showAct(),this._act.setShowAppAct()},e.prototype._enableShowAct=function(t){this._act&&(this._act.visible=t)},e.prototype._enableShowNotice=function(t){this._notice&&(this._notice.visible=t)},e.prototype.showAct=function(){this.currentState="act",this._enableShowAct(!0),this._enableShowNotice(!1),this._checkAct(),this._checkAdded()},e.prototype.showNotice=function(){this.currentState="notice",this._enableShowAct(!1),this._enableShowNotice(!0),this._checkNotice(),this._checkAdded()},e.prototype.showRedExchange=function(){this.showNotice()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelActAndNotice.prototype,"PanelActAndNotice");var PanelAlert=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelAlertSkin,this._defaultConfirmString=this.btnConfirm.labelIcon,this._defaultCancelString=this.btnCancel.labelIcon},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.grpButtonShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this)},e.prototype.onGrpButtonTap=function(t){this.dealAction(t.target.name)},e.prototype.show=function(t,e,n,i,o){switch(void 0===e&&(e=0),void 0===n&&(n=null),void 0===i&&(i="center"),void 0===o&&(o=null),this.popup(),this.btnConfirm.labelIcon=this._defaultConfirmString,this.btnCancel.labelIcon=this._defaultCancelString,this.btnConfirm.scaleX=1,this.btnConfirm.scaleY=1,this.btnConfirm.bgImg.visible=!0,this.labContent.text=t,null==o&&(o=[{text:t}]),this.labContent.textFlow=o,this._callback=n,this.labContent.textAlign=i,this.grpButtonShare.visible=!1,this.grpButton.visible=!0,e){case 0:this.grpButton.contains(this.btnCancel)&&this.grpButton.removeChild(this.btnCancel);break;case 1:this.grpButton.contains(this.btnCancel)||this.grpButton.addChild(this.btnCancel);break;case 2:this.grpButtonShare.visible=!0,this.grpButton.visible=!1,this.grpButton.contains(this.btnCancel)||this.grpButton.addChild(this.btnCancel)}},e.getInstance=function(){return this._instance},e}(alien.PanelBase);__reflect(PanelAlert.prototype,"PanelAlert");var Alert=function(){function t(){}return t.show=function(t,e,n,i,o){void 0===e&&(e=0),void 0===n&&(n=null),void 0===i&&(i="center"),void 0===o&&(o=null),PanelAlert.instance.show(t,e,n,i,o)},t}();__reflect(Alert.prototype,"Alert");var PanelAlert2=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelAlert2Skin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnConfirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnConfirmTap,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this)},e.prototype.onBtnConfirmTap=function(t){this.dealAction(t.target.name)},e.prototype.onBtnCloseTap=function(t){this.dealAction()},e.prototype.show=function(t,e,n){void 0===n&&(n=null),this.popup(),this.labContent.text=t,this._callback=n,this.btnConfirm.bgRes=e},e}(alien.PanelBase);__reflect(PanelAlert2.prototype,"PanelAlert2");var Alert2=function(){function t(){}return t.show=function(t,e,n){void 0===n&&(n=null),PanelAlert2.instance.show(t,e,n)},t}();__reflect(Alert2.prototype,"Alert2");var PanelAlert3=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelAlertSkin,this._defaultConfirmString=this.btnConfirm.labelIcon,this._defaultCancelString=this.btnCancel.labelIcon},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},e.prototype.onGrpButtonTap=function(t){this.dealAction(t.target.name)},e.prototype.show=function(t,e,n,i){switch(void 0===e&&(e=0),void 0===n&&(n=null),void 0===i&&(i=!1),this.popup(),this.btnConfirm.labelIcon=this._defaultConfirmString,this.btnCancel.labelIcon=this._defaultCancelString,this.btnClose.visible=i,this.labContent.textFlow=(new egret.HtmlTextParser).parser(t),this._callback=n,e){case 0:this.grpButton.contains(this.btnCancel)&&this.grpButton.removeChild(this.btnCancel);break;case 1:this.grpButton.contains(this.btnCancel)||this.grpButton.addChild(this.btnCancel)}},e}(alien.PanelBase);__reflect(PanelAlert3.prototype,"PanelAlert3");var Alert3=function(){function t(){}return t.show=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=""),void 0===i&&(i=!1),PanelAlert3.instance.show(t,0,e,i),PanelAlert3.instance.btnConfirm.labelIcon=n},t}();__reflect(Alert3.prototype,"Alert3");var PanelBeforeMatch=function(t){function e(){return t.call(this,alien.popupEffect.Flew,{withFade:!0,ease:egret.Ease.backOut,direction:"up"},alien.popupEffect.Flew,{withFade:!0,ease:egret.Ease.backIn,direction:"up"})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelBeforeMatchSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.show=function(t,e,n){void 0===n&&(n=0),this.popup();var i;i=1==t?ResNames.match_word_4:e>1?ResNames.match_word_6:ResNames.match_word_5,n>1&&(this.labCount.text=n.toString()),this.grpCount.visible=n>1,this.img.source=i,egret.setTimeout(this.dealAction,this,2e3)},e}(alien.PanelBase);__reflect(PanelBeforeMatch.prototype,"PanelBeforeMatch");var PanelBindPhone=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelBindPhoneSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._nIntervalId=-1,this._okCallback=null,this.args={},this._showCountLabel(!1),this._resetCountNum(),this.phone.prompt=_phonePrompt,this.phone.maxChars=_phoneLen,this.code.maxChars=_codeLen,this.code.prompt=_codePrompt,this.phone.inputType=egret.TextFieldInputType.TEL,this.code.inputType=egret.TextFieldInputType.TEL,this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this),this.getCodeImg.addClickListener(this._onClickGetCode,this),this.bindNowImg.addClickListener(this._onClickBindNow,this)},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this)},e.prototype._checkPhone=function(){var t=this.phone.text;return t&&11==t.length?!0:!1},e.prototype._checkCode=function(){var t=this.code.text;return t?!0:!1},e.prototype._showCountLabel=function(t){this.countLabel.visible=t},e.prototype._resetCountNum=function(){this._nCountTime=60},e.prototype._clearCountInterval=function(){-1!=this._nIntervalId&&egret.clearInterval(this._nIntervalId),this._nIntervalId=-1},e.prototype._startCountDown=function(){var t=this;this._clearCountInterval(),this._resetCountNum(),this.countLabel.text=""+this._nCountTime,this._showCountLabel(!0),this._nIntervalId=egret.setInterval(function(){return t._nCountTime<1?(t._clearCountInterval(),t._showCountLabel(!1),void t._showGetCode(!0)):(t._nCountTime-=1,void(t.countLabel.text=""+t._nCountTime))},this,1e3)},e.prototype._showGetCode=function(t){this.getCodeImg.visible=t},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._onClickGetCode=function(){return this._checkPhone()?(webService.getCode(this.phone.text,function(t){var e=(o={},o[0]="",o[1e3]="",o[2015]="",o[2018]="",o[2019]="",o),n=t.code,i=e[n]||"";Toast.show(i);var o}),this._showGetCode(!1),void this._startCountDown()):void Toast.show(_phonePrompt)},e.prototype._enableTouch=function(t,e){t.touchEnabled=e},e.prototype._onClickBindNow=function(){return this._checkPhone()&&this._checkCode()?void(1==this.bindType?this._bindByLogin():2==this.bindType&&this._bindByExchange()):void Toast.show("")},e.prototype._bindByExchange=function(){var t=this,e=this.phone.text,n=this.code.text;this._enableTouch(this.bindNowImg,!1),webService.bindPhoneByExchange(e,n,function(e){var n=e.code,i=e.message,o=e.data.phone;console.log("_bindByExchange====>",o);var a=function(){var e=t._okCallback;UserData.instance.saveLocalPhone(o,!0),t.dealAction(),e&&e()};0!=n&&(this._enableTouch(this.bindNowImg,!0),a=function(){}),Alert3.show(i,a,"common_btn_lab_confirm")}.bind(this))},e.prototype._bindByLogin=function(){var t=this.phone.text,e=this.code.text,n=this;this._enableTouch(this.bindNowImg,!1),webService.bindPhoneByLogin(t,e,this.args.unid,this.args.share_sk,function(t){var e=t.code,i=t.message,o=t.data.phone;console.log("_bindByLogin====>",o);var a=function(){UserData.instance.saveLocalPhone(o,!0);var t=n._okCallback;t&&t()};0!=e&&(this._enableTouch(this.bindNowImg,!0),a=function(){}),Alert.show(i,0,a)}.bind(this))},e.prototype._onRemoveFromStage=function(){this._clearCountInterval(),this._enableEvent(!1),e._instance=null},e.prototype._showClose=function(t){this.closeImg.visible=t},e.prototype.show=function(t,e,n){void 0===n&&(n=null),this.popup(null,!0,{alpha:0});var i=alien.Native.instance,o=i.getUrlArg();this._okCallback=n,this.bindType=t,this.args=e,o.share_sk&&(this.args.share_sk=o.share_sk),this._showClose(e.showClose)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(alien.PanelBase);__reflect(PanelBindPhone.prototype,"PanelBindPhone");var PanelBuyRecorder=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelBuyRecorderSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyClick,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyClick,this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyClick,this)},e.prototype.addListeners=function(){var t=EventManager.instance;t.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this.onMyUserInfoUpdate,this),alien.EventManager.instance.enableOnObject(this)},e.prototype.removeListeners=function(){alien.EventManager.instance.disableOnObject(this)},e.prototype.onMyUserInfoUpdate=function(t){void 0===t&&(t=null);var e=t?t.data.userInfoData:MainLogic.instance.selfData,n=0,i="";e.cardsRecorder&&e.cardsRecorder[6]>0&&(n=Math.ceil(e.cardsRecorder[6]/3600/24),i="("+e.cardsRecorder[0]+""+e.cardsRecorder[1]+""+e.cardsRecorder[2]+""+e.cardsRecorder[3]+":"+e.cardsRecorder[4]+")"),this.lbRemain.text=String(n),n>0?(this.lbRemain.textColor=2131744,egret.localStorage.setItem("opencardsrecorder","1"),egret.localStorage.removeItem("cardsrecorderexpirenotice")):this.lbRemain.textColor=16711680,this.lbExpire.text=i},e.prototype.show=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),MainLogic.instance.refreshSelfInfo(),this.addListeners(),this._callback=t,this.onMyUserInfoUpdate(),this.popup()},e.prototype.onBuyClick=function(t){var e=Number(t.currentTarget.name)-1,n=GameConfig.cardsRecorderConfig[e];n&&n.id&&RechargeService.instance.doRecharge(n.id)},e.prototype.onBtnCloseClick=function(t){this.removeListeners(),this.dealAction()},e}(alien.PanelBase);__reflect(PanelBuyRecorder.prototype,"PanelBuyRecorder");var PanelChoosePay=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelChoosePay},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this),this.payWx.addClickListener(this._onClickWX,this),this.payAli.addClickListener(this._onClickAli,this)},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this)},e.prototype._enableTouch=function(t,e){t.touchEnabled=e},e.prototype._onClickWX=function(){webService.getRechargeCfgByWX(this._id)},e.prototype._onClickAli=function(){webService.getRechargeCfgByAli(this._id)},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1),e._instance=null},e.prototype.show=function(t){this.popup(null,!0,{alpha:0}),this._id=t},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(alien.PanelBase);__reflect(PanelChoosePay.prototype,"PanelChoosePay");var PanelDayBuy=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelDayBuy},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.buyImg.addClickListener(this._onClickBuy,this)},e.prototype._onClickBuy=function(){RechargeService.instance.doRecharge("10021")},e.prototype._initUI=function(){this.buyImg.setTit("common_buy"),this.buyImg.setDisable()},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelDayBuy.prototype,"PanelDayBuy");var PanelDayTask=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelDayTaskSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaut(),this._initEvent()},e.prototype._formatEveryTaskData=function(){var t=GameConfig.getDayTaskList();if(!t)return[];for(var e=MainLogic.instance.selfData,n=e.getDayTaskPre(),i=e.getDayTaskAllTStatus(),o=[],a=[],r=[],s=null,h=0,c=0,l=[],u=[],p=0;p<t.length;++p){r=[],a=t[p].reward.split("|");for(var d=0;d<a.length;++d)o=a[d].split(":"),h=Number(o[0]),c=Number(o[1]),1==h&&(c/=100),r.push({id:h,num:c});if(s={},s.id=p+1,s.status=i[p]||0,s.condition=t[p].condition,s.total=t[p].progress,1==t[p].condition)s.num=n[0]||0,s.taskDesc1=""+s.total+"",s.taskDesc2="";else if(2==t[p].condition&&(s.num=n[1]||0,s.taskDesc1=""+s.total+"",s.taskDesc2="(5)",1==t[p].week)){var _=s.total-s.num;0>_&&(_=0),r.unshift({id:41003,num:_})}1==t[p].day&&2==t[p].tp&&(s.num=n[2]||0),s.rew=r,1==t[p].day?1==t[p].condition&&l.push(s):1==t[p].week}return{day:l,week:u}},e.prototype._initDefaut=function(){this._allTaskInfo=this._formatEveryTaskData(),this._dataArr=this._allTaskInfo.day,!this._dataArr||this._dataArr.length<1||(this._dataProvider=new eui.ArrayCollection(this._dataArr),this.mTask_list.itemRenderer=DayTaskItemInfo,this.mTask_list.dataProvider=this._dataProvider)},e.prototype._initEvent=function(){this._enableEvent(!0);var t="addClickListener";this.mClose_btn[t](this._onTouchClose,this),this.dayTaskImg[t](this._onClickDayTask,this,!1),this.weekTaskImg[t](this._onClickWeekTask,this,!1);
var e=alien.EventManager.instance;e.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this._userinfoUpdate,this),e.registerOnObject(this,alien.Dispatcher,EventNames.USER_DTREWARD_GET_SUCC,this._onDayTaskRewGetSucc,this)},e.prototype._onDayTaskRewGetSucc=function(){this._allTaskInfo=this._formatEveryTaskData(),"day"==this.currentState?this._showDayTask():"week"==this.currentState&&this._showWeekTask()},e.prototype._showDayTask=function(){var t=[];this._allTaskInfo.day&&this._allTaskInfo.day.length>=1&&(t=this._allTaskInfo.day),this._dataProvider.source=t,this._dataProvider.refresh()},e.prototype._showWeekTask=function(){var t=[];this._allTaskInfo.week&&this._allTaskInfo.week.length>=1&&(t=this._allTaskInfo.week),this._dataProvider.source=t,this._dataProvider.refresh()},e.prototype._onClickDayTask=function(){this.currentState="day",this._showDayTask()},e.prototype._onClickWeekTask=function(){this.currentState="week",this._showWeekTask()},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onAddToStage=function(){EventManager.instance.enableOnObject(this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this)},e.prototype._userinfoUpdate=function(){this._allTaskInfo=this._formatEveryTaskData(),"day"==this.currentState?this._showDayTask():"week"==this.currentState&&this._showWeekTask()},e.prototype.show=function(){this.popup(null,!0,{alpha:0})},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelDayTask.prototype,"PanelDayTask");var PanelDelegate=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelDelegateSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent(),this._showDelegate()},e.prototype._initEvent=function(){this._enableEvent(!0),this.wxCp_img.addClickListener(this._onClickCopyKeFuWX,this),this.publicCp_img.addClickListener(this._onClickCopyPublicWX,this)},e.prototype._initUI=function(){},e.prototype._onClickCopyKeFuWX=function(){var t=GameConfig.extendWX;GameConfig.copyText(this,t,"("+t+")")},e.prototype._onClickCopyPublicWX=function(){GameConfig.copyText(this,"","()")},e.prototype._onScrollTop=function(){this.content_scroller.stopAnimation(),this.content_scroller.viewport.scrollV=0,this.content_scroller.viewport.validateNow()},e.prototype._showDelegate=function(){this._onScrollTop(),this.info_label.text="",alien.Native.instance.isNative&&(this.info_label.text="\n    151()\r\n \r:"+GameConfig.extendWX),this.content_scroller.scrollPolicyV="off",this._showCopyWX(!0),this.noticeFlag_img.source="notice_delegate_tit"},e.prototype._showCopyWX=function(t){this.wxCp_img.visible=t,this.publicCp_img.visible=t},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelDelegate.prototype,"PanelDelegate");var PanelDownApp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelDownAppSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.down_img.addClickListener(this._onClickDownApp,this)},e.prototype._onClickDownApp=function(){GameConfig.downApp()},e.prototype._initUI=function(){},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelDownApp.prototype,"PanelDownApp");var PanelExchange2=function(t){function e(){return t.call(this,alien.popupEffect.Fade,{},alien.popupEffect.Fade,{})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelExchange2Skin,this._self=MainLogic.instance.selfData},e.prototype._filterTimeStampByGoodsId=function(t){var e=MainLogic.instance.selfData.rcminexcexpiretime;if(e){var n=(new Date).getTime(),i=1e3*e;i>n?this._showBefore(i,t):this._showAfter(t)}else this._showAfter(t)},e.prototype.updateExchangeList=function(){"card"==this.currentState&&(this._filterTimeStampByGoodsId([4,6]),this._dataProvide.source=this.itemList,this._dataProvide.refresh())},e.prototype.updateRedList=function(){"red"==this.currentState&&(this._filterTimeStampByGoodsId([7]),this._dataProvide.source=this.itemList,this._dataProvide.refresh())},e.prototype.updateJDList=function(){"jd"==this.currentState&&(this.itemList=GameConfig.exchangeConfig.filter(function(t){return 5==t.goodsid}),this._dataProvide.source=this.itemList,this._dataProvide.refresh())},e.prototype._initJD=function(){for(var t=GameConfig.exchangeConfig,e=!1,n=0;n<t.length;++n)if(5==t[n].goodsid){e=!0;break}e||(this.jdLabel.visible=!1,this.flagJdImg.visible=!1)},e.prototype._initH5=function(){var t=alien.Native.instance;t.isNative?this._clickRedFunc=this._showRed.bind(this):(this.redLabel.text="",this._clickRedFunc=function(){var t="APP\n<font color='#FF0000'></font>",e=(new egret.HtmlTextParser).parser(t),n=PanelAlert.instance;n.show("",0,function(t){"confirm"==t&&GameConfig.downApp()},"center",e),n.btnConfirm.bgImg.visible=!1,n.btnConfirm.scaleX=1.5,n.btnConfirm.scaleY=1.5,n.btnConfirm.labelIcon="go_down"})},e.prototype._showAfter=function(t){this.itemList=GameConfig.exchangeConfig.filter(function(e){e.timeStamp=0;for(var n=!1,i=t.length,o=0;i>o;++o)e.goodsid==t[o]&&(n=!0);return null==e.first&&n})},e.prototype._showBefore=function(t,e){this.itemList=GameConfig.exchangeConfig.filter(function(n){n.timeStamp=t;for(var i=!1,o=0;o<e.length;++o)n.goodsid==e[o]&&(i=!0);return null==n.after&&i})},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentWidth=100,this.percentHeight=100,this.exCodeInput.prompt=_exCodePrompt,this.lv_goods.dataProvider=this._dataProvide=new eui.ArrayCollection,this.lv_history.dataProvider=this._historyProvide=new eui.ArrayCollection,this.lv_history.itemRenderer=FeiHistoryItem,this._isReqHistory=!1,this.hisoryInfoScroller.addEventListener(egret.Event.CHANGE,this._onHistoryScroll,this),this.onResize(null),this.lv_goods.itemRenderer=ShopItem;var e=EventManager.instance;e.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this.onMyUserInfoUpdate,this),e.registerOnObject(this,this.btn_history,egret.TouchEvent.TOUCH_TAP,this.onHistory,this),e.registerOnObject(this,this.close_group,egret.TouchEvent.TOUCH_TAP,this.onClose,this),e.registerOnObject(this,this.flagGoldImg,egret.TouchEvent.TOUCH_TAP,this._onClickGoldGroup,this),e.registerOnObject(this,this.flagDiamondImg,egret.TouchEvent.TOUCH_TAP,this._onClickDiamondGroup,this),e.registerOnObject(this,this.flagExchangeImg,egret.TouchEvent.TOUCH_TAP,this._onClickExchangeGroup,this),e.registerOnObject(this,this.btn_recorder,egret.TouchEvent.TOUCH_TAP,this.onRecorderClick,this),e.registerOnObject(this,this.redExchangeImg,egret.TouchEvent.TOUCH_TAP,this._onClickExchange,this),e.registerOnObject(this,this.flagJdImg,egret.TouchEvent.TOUCH_TAP,this._onClickJD,this),e.registerOnObject(this,this.flagRedImg,egret.TouchEvent.TOUCH_TAP,this._onClickRed,this),e.registerOnObject(this,this.flagExImg,egret.TouchEvent.TOUCH_TAP,this._onClickExHistory,this),e.registerOnObject(this,this.flagCodeImg,egret.TouchEvent.TOUCH_TAP,this._onClickCodeExchange,this),e.registerOnObject(this,this.exCodeImg,egret.TouchEvent.TOUCH_TAP,this._onClickCodeExNow,this),e.registerOnObject(this,alien.StageProxy.stage,egret.Event.RESIZE,this.onResize,this),e.registerOnObject(this,alien.Dispatcher,EventNames.BAG_INFO_REFRESH,this._onBagRefresh,this),this._initJD(),this._initH5()},e.prototype.onResize=function(t){},e.prototype._onClickCodeExchange=function(){this.currentState="exCode"},e.prototype._onClickCodeExNow=function(){var t=this.exCodeInput.text;if(!t||t.length<1)Toast.show("");else{var e=UserData.instance.getUid();webService.doCodeExchange({uid:e,code:t,type:GameConfig.SERVER_URL_TAIL},function(t){Alert.show(t.message)})}},e.prototype._showGold=function(){this.currentState="gold";for(var t=[],e=GameConfig.rechargeConfig,n=0;n<e.length;++n)e[n].firstrecharge||1!=e[n].item_type||t.push(e[n]);this._dataProvide.source=t,this._dataProvide.refresh()},e.prototype._showDiamond=function(){for(var t=[],e=GameConfig.rechargeConfig,n=0;n<e.length;++n)10009!=e[n].product_id&&3==e[n].item_type&&t.push(e[n]);this._dataProvide.source=t,this._dataProvide.refresh(),this.currentState="diamond"},e.prototype._showExchange=function(){this.currentState="card",this.updateExchangeList()},e.prototype._showJD=function(){this.currentState="jd",this.updateJDList()},e.prototype._onClickGoldGroup=function(){this._showGold()},e.prototype._onClickDiamondGroup=function(){this._showDiamond()},e.prototype._onClickExchangeGroup=function(){this._showExchange()},e.prototype.onHistory=function(){PanelExchange3.instance.show()},e.prototype.onClose=function(){this.close()},e.prototype.onMyUserInfoUpdate=function(t){void 0===t&&(t=null);var e=t?t.data.userInfoData:this._self,n=BagService.instance.getItemCountById(3);if(this.gold.updateGold(e.gold),this.diamond.updateGold(n),this.avatar.imageId=e.imageid,e.nickname){var i=e.nickname.substr(0,10);this.labNickName.text=i+"("+e.fakeuid+")"}this._self.redcoin=MainLogic.instance.selfData.redcoin,this.updateExchangeList(),this.flashData(!1)},e.prototype._onClickExchange=function(){this._showExchange()},e.prototype._onClickJD=function(){this._showJD()},e.prototype._onClickRed=function(){this._clickRedFunc()},e.prototype._onClickExHistory=function(){this._showExHistory()},e.prototype.flashData=function(t){if(void 0===t&&(t=!1),this.lbRedCoin.text=""+(null==this._self.redcoin?"0.00":Utils.exchangeRatio(this._self.redcoin/100,!0)),t){for(var e=0;e<GameConfig.exchangeConfig.length;++e)if(GameConfig.exchangeConfig[e].after){for(var n=0;n<this.itemList.length;++n)if(this.itemList[n].first){this.itemList.splice(n,1,GameConfig.exchangeConfig[e]);break}break}this._dataProvide.source=this.itemList,this._dataProvide.refresh()}},e.prototype.show=function(t){var e=this;void 0===t&&(t=0),this.popup(),EventManager.instance.enableOnObject(this),egret.setTimeout(function(){e.onMyUserInfoUpdate(),1==t?e._showDiamond():2==t?e._showExchange():3==t?e._showJD():4==t?e._showRed():5==t?e._showExHistory():e._showGold()},this,50)},e.prototype._showRed=function(){this.currentState="red",this.updateRedList()},e.prototype._showExHistory=function(){var t=this,e=this;webService.getExHistory(1,function(n){if(e.currentState="history",0==n.code){var i=n.data.items;t._historyInfo=n.data,e._initExRecordInfo(i),t.hisoryInfoScroller.viewport.scrollV=0}})},e.prototype._onHistoryScroll=function(t){var e=this;if(this.hisoryInfoScroller.viewport.scrollV>=this.hisoryInfoScroller.height){var n=this._historyInfo.current_page,i=this;n<this._historyInfo.total_page&&!i._isReqHistory&&(i._isReqHistory=!0,webService.getExHistory(n+1,function(t){if(i._isReqHistory=!1,0==t.code){t.data.items;i._historyInfo.items=e._historyInfo.items.concat(t.data.items),i._historyInfo.current_page=t.data.current_page,i._initExRecordInfo(i._historyInfo.items)}}))}},e.prototype._initExRecordInfo=function(t){this._historyProvide.source=t,this._historyProvide.refresh()},e.prototype.close=function(e){void 0===e&&(e=!1),e?alien.PopUpManager.removePopUp(this):t.prototype.close.call(this),EventManager.instance.disableOnObject(this)},e.prototype.onTimeExpired=function(t){this._showAfter(t),this._dataProvide.source=this.itemList,this._dataProvide.refresh()},e.prototype._onBagRefresh=function(){var t=BagService.instance.getItemCountById(3);this.diamond.updateGold(t)},e.prototype.onRecorderClick=function(t){PanelBuyRecorder.instance.show()},e}(alien.PanelBase);__reflect(PanelExchange2.prototype,"PanelExchange2");var PanelExchange3=function(t){function e(){return t.call(this,alien.popupEffect.Fade,{},alien.popupEffect.Fade,{})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelExchange3Skin,this._self=MainLogic.instance.selfData},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.lv_list1.itemRenderer=IRExchangeHistory,this.lv_list2.itemRenderer=IRExchangeDetail,this.list1=new eui.ArrayCollection,this.list2=new eui.ArrayCollection,this.lv_list1.dataProvider=this.list1,this.lv_list2.dataProvider=this.list2;var e=EventManager.instance;e.registerOnObject(this,this.btn_close,egret.TouchEvent.TOUCH_TAP,this.onClose,this),e.registerOnObject(this,this.btn_changetype,egret.TouchEvent.TOUCH_TAP,this.onChangeType,this)},e.prototype.onChangeType=function(){"detail"==this.skin.currentState?this.skin.currentState="hirstory":this.skin.currentState="detail"},e.prototype.loadConfigs=function(t){var e=this;webService.getRedcoinHistory(this._self.uid,function(t){if(t&&t.data){var n=t.data.concat(),i=[];if(null!=t.data)for(var o=0;o<t.data.length;o++)"2"==t.data[o].type&&i.push(t.data[o]);e.list1.source=n,e.list1.refresh(),e.list2.source=i,e.list2.refresh()}})},e.prototype.onClose=function(){this.close()},e.prototype.show=function(){this.popup(),EventManager.instance.enableOnObject(this),this.loadConfigs(null)},e.prototype.close=function(){t.prototype.close.call(this),EventManager.instance.disableOnObject(this)},e}(alien.PanelBase);__reflect(PanelExchange3.prototype,"PanelExchange3");var IRExchangeHistory=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),null!=this.data){if(this.data.recordtime){var e=new Date(1e3*this.data.recordtime),n=alien.TimeUtils.timeFormatForEx(e);this.lbl_time.text=n}"1"==this.data.type?(this.lbl_dis.text=lang.exchange_roomid[this.data.roomid],this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400):"2"==this.data.type?(this.lbl_dis.text=""+this.data.goodsamount+GameConfig.exchangeGoodsConfig[this.data.goodsid].describe,this.lbl_change.text="-"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=5142788):"3"==this.data.type?(this.lbl_dis.text=lang.match_reward,this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400):"4"==this.data.type?(this.lbl_dis.text="",this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400):"78"==this.data.type?(this.lbl_dis.text="",this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400):"82"==this.data.type?(this.lbl_dis.text="",this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400):(this.lbl_dis.text=":"+this.data.type,this.lbl_change.text="+"+Utils.exchangeRatio(this.data.coin/100,!0),this.lbl_change.textColor=16646400)}},e}(eui.ItemRenderer);__reflect(IRExchangeHistory.prototype,"IRExchangeHistory");var IRExchangeDetail=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.goodsid&&(this.lbl_dis.text=""+this.data.goodsamount+GameConfig.exchangeGoodsConfig[this.data.goodsid].describe),this.data.recordtime){var e=new Date(1e3*this.data.recordtime),n=alien.TimeUtils.timeFormatForEx(e);this.lbl_time.text=n}switch(this.data.status){case"1":this.lbl_status.text="...";break;case"2":this.lbl_status.text="";break;case"3":this.lbl_status.text="...";break;case"4":this.lbl_status.text="";break;case"7":this.lbl_status.text=""}},e}(eui.ItemRenderer);__reflect(IRExchangeDetail.prototype,"IRExchangeDetail");var PanelFeiEx=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelFeiExSkin,this._okFunc=null},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._enableEvent(!0),this._initSpInfo(),this.closeBtn.addClickListener(this._onClickClose,this),this.okImg.addClickListener(this._onClickOK,this)},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this)},e.prototype._enableTouch=function(t,e){t.touchEnabled=e},e.prototype._onAlertFei=function(){var t=this.info.id,e=this.input2.text,n=this,i=" <font color='#FF0000'>"+this.info.goodsamount+"</font>    <font color='#FF0000'>"+e+"</font>",o=(new egret.HtmlTextParser).parser(i);Alert.show("",0,function(i){"confirm"==i&&webService.goRechageFei({uid:server.uid,coinid:t,phone:e},function(t){0==t.code?(n.info.status=5,Alert3.show("2",null,"common_btn_lab_confirm"),n.info.item&&n.info.item.updateInfo(n.info)):Alert3.show(",:"+t.data+"|"+t.code,null,"common_btn_lab_confirm")})},"center",o)},e.prototype._onAlertAli=function(){var t=this.info.id,e=this.input1.text,n=this,i=this.input2.text,o=" <font color='#FF0000'>"+this.info.goodsamount+"</font> \n:<font color='#FF0000'>"+i+"</font>",a=(new egret.HtmlTextParser).parser(o);Alert.show("",0,function(o){"confirm"==o&&webService.goRechageFei({uid:server.uid,coinid:t,account:i,account_name:e},function(t){0==t.code?(n.info.status=4,UserData.instance.saveLocalAli(i,e),Alert3.show("",null,"common_btn_lab_confirm"),n.info.item&&n.info.item.updateInfo(n.info)):Alert3.show(",:"+t.data+"|"+t.code,null,"common_btn_lab_confirm")})},"center",a)},e.prototype._onClickOK=function(){this._okFunc&&this._okFunc()},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._initFei=function(){var t=this,e=UserData.instance.getLocalPhone();e&&11==e.length&&(this.input2.text=e),this.currentState="fei",this._okFunc=function(){var e=t.input2.text;e&&11==e.length?t._onAlertFei():Toast.show("11")}.bind(this)},e.prototype._initSpInfo=function(){this.liantong.labelDisplay.text="",this.dianxin.labelDisplay.text="",this.yidong.value="10086",this.yidong.value="10010",this.yidong.value="10000",this._onSelectYD(),this.yidong.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onSelectYD,this),this.liantong.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onSelectLT,this),this.dianxin.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onSelectDX,this)},e.prototype._showFeiKaSp=function(){this.currentState="sp";var t=this;this._okFunc=function(){t._curSpNum&&5==t._curSpNum.length&&webService.goRechageFei({uid:server.uid,coinid:t.info.id,sp:t._curSpNum},function(e){t._onGetCardRet(e)})}},e.prototype._onSelectYD=function(){this._curSpNum="10086",this.yidong.currentState="downAndSelected",this.liantong.currentState="up",this.dianxin.currentState="up"},e.prototype._onSelectLT=function(){this._curSpNum="10010",this.yidong.currentState="up",this.liantong.currentState="downAndSelected",this.dianxin.currentState="up"},e.prototype._onSelectDX=function(){this._curSpNum="10000",this.yidong.currentState="up",this.liantong.currentState="up",this.dianxin.currentState="downAndSelected"},e.prototype._copyCardInfo=function(){var t=this.input1.text,e=this.input2.text,n=":"+t+":"+e;GameConfig.copyText(this,n,n,!0)},e.prototype._initFeiKa=function(){var t=this;if(3==this.info.status)return void this._showFeiKaSp();4==this.info.status&&(this.currentState="card");var e=this.info.send_listid,n=e.cards.card,i=n.cardno,o=n.cardpws,a=n.expiretime;this.input1.text=i,this.input2.text=o,this.input3.text=a;var r=this.info.sp||e.cardname;this.input1.touchEnabled=!1,this.input2.touchEnabled=!1,this.input3.touchEnabled=!1,egret.setTimeout(function(){t.descLabel.text=""+r,t.descLabel.textAlign="center"},this,50),this._okFunc=this._copyCardInfo.bind(this)},e.prototype._initAli=function(){this.currentState="ali";var t=this,e=UserData.instance.getLocalAli();e&&e.name&&e.account&&(this.input1.text=e.name,this.input2.text=e.account),this._okFunc=function(){var e=this.input2.text,n=t.input1.text;n&&n.length>1&&e&&e.length>1?t._onAlertAli():Toast.show("")}},e.prototype._onGetCardRet=function(t){var e=this,n=t.data;0==t.code?(e.info.status=4,5==e.info.goodsid?(e.info.send_listid=this.info.send_listid||{},e.info.send_listid.cardno=n.cardnum,e.info.send_listid.cardpwd=n.cardpwd,e.info.send_listid.expiretime=n.expiretime,e.info.money=n.money,this._initJD()):6==e.info.goodsid&&(e.info.send_listid=this.info.send_listid||{cards:{card:{}}},e.info.send_listid.cards.card.cardno=n.cardno,e.info.send_listid.cards.card.cardpws=n.cardpws,e.info.send_listid.cards.card.expiretime=n.expiretime,e.info.sp=n.sp,e.info.money=n.money,e._initFeiKa()),e.info.item&&e.info.item.updateInfo(e.info)):Alert3.show(",:"+t.data+"|"+t.code,null,"common_btn_lab_confirm")},e.prototype._initJD=function(){var t=this;this.currentState="card";var e=this;if(3==e.info.status)return void webService.goRechageFei({uid:server.uid,coinid:e.info.id},function(t){e._onGetCardRet(t)});if(4==e.info.status){var n=this.info.send_listid,i=n.cardno||n.cardnum,o=n.cardpwd,a=n.expiretime,r=this.info.goodsamount||this.info.money;egret.setTimeout(function(){t.descLabel.text=""+r+"E",t.descLabel.textAlign="center"},this,50),this.input1.text=i,this.input2.text=o,this.input3.text=a,this.input1.touchEnabled=!1,this.input2.touchEnabled=!1,this.input3.touchEnabled=!1,this._okFunc=this._copyCardInfo.bind(this)}},e.prototype.show=function(t){this._bShow||(this._bShow=!0,this.info=t,"4"==t.goodsid?this._initFei():"7"==t.goodsid||"8"==t.goodsid?this._initAli():"6"==t.goodsid?this._initFeiKa():"5"==t.goodsid&&this._initJD(),this.popup(null,!0,{alpha:0}))},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(alien.PanelBase);__reflect(PanelFeiEx.prototype,"PanelFeiEx");var PanelFollowCourse=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelFollowCourseSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._enableEvent(!0)},e.prototype.playAnimate=function(){for(var t=1;7>t;++t)egret.Tween.get(this["step"+t]).set({visible:!0,alpha:0}).wait(1200*(t-1)).to({alpha:1},1200)},e.prototype.setStepVisible=function(t){for(var e=1;7>e;++e)this["step"+e].visible=t},e.prototype.stopAnimate=function(){for(var t=1;7>t;++t)egret.Tween.removeTweens(this["step"+t]);this.setStepVisible(!0)},e.prototype.show=function(){this.setStepVisible(!1),this.playAnimate(),this.popup()},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this),this.copyWX_img[e](egret.TouchEvent.TOUCH_TAP,this._onClickCopyWX,this),this.btnClose[e](egret.TouchEvent.TOUCH_TAP,this._onTouchClose,this)},e.prototype._onTouchClose=function(){this.stopAnimate(),this.dealAction()},e.prototype._onAddToStage=function(){},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._onClickCopyWX=function(){GameConfig.copyText(this.parent,"","()")},e}(alien.PanelBase);__reflect(PanelFollowCourse.prototype,"PanelFollowCourse");var PanelFreshManReward=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelFreshManRewardSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),server.addEventListener(EventNames.GET_FRESHMAN_REWARD_REP,this.onGetRewardRep,this),this.btnGet.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetClick,this)},e.prototype.onGetRewardRep=function(t){var e=t.data;0==e.result?(alien.Dispatcher.dispatch(EventNames.GOLD_RAIN_EFFECT),PanelAlert3.instance.show(": "+e.gold+","),server.removeEventListener(EventNames.GET_FRESHMAN_REWARD_REP,this.onGetRewardRep,this),MainLogic.instance.selfData.freshrewardgot=2,this.close()):Alert.show(":"+e.result)},e.prototype.show=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._callback=e,this.popup()},e.prototype.onGetClick=function(t){server.GetFreshManReward()},e}(alien.PanelBase);__reflect(PanelFreshManReward.prototype,"PanelFreshManReward");var PanelFRGetRew=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelFRGetRewardSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._enableEvent(!0)},e.prototype._enableEvent=function(t){var e="addEventListener";0==t&&(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this.mGet_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchGetRewBtn,this)},e.prototype._onTouchGetRewBtn=function(){MainLogic.instance.onGoGetRewardReq(),this.dealAction()},e.prototype.show=function(){this._day=MainLogic.instance.selfData.getFRechargeRewGetDay(),this.popup(null,!0,{alpha:0})},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelFRGetRew.prototype,"PanelFRGetRew");var PanelFirstRecharge=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e._onAddToStage,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._enableEvent(!0)},e.prototype.init=function(){this.skinName=panels.PanelFirstRecharge},e.prototype._onMyUserInfoUpdate=function(){this._initGoRechargeBtn()},e.prototype._onGoRecharge=function(){var t=GameConfig.getFRechargeInfo();t&&RechargeService.instance.doRecharge(t.product_id)},e.prototype._onGetRew=function(){MainLogic.instance.onGoGetRewardReq(),this.dealAction()},e.prototype._initUI=function(){this._initGoRechargeBtn(),this._playMaskAni(),this._playFontLightAni(),this._playItemLightAni()},e.prototype._initGoRechargeBtn=function(){var t=MainLogic.instance.selfData,e=!t.isNotBuyFRecharge();this._hasBuy||(this._hasBuy=e,e?(this.mGoRecharge_btn.setPngs("frecharge_get_n","frecharge_get_p"),this.mGoRecharge_btn.setClickFunc(this._onGetRew.bind(this))):(this.mGoRecharge_btn.setPngs("frecharge_gopay_n","frecharge_gopay_p"),this.mGoRecharge_btn.setClickFunc(this._onGoRecharge.bind(this))))},e.prototype._playMaskAni=function(){this.mMoneyLight_img.mask=this.mMoneyLight_mask;var t=this.mMoneyLight_mask.x,e=this.mMoneyLight_mask.y,n=this.mMoneyLight_img.x+this.mMoneyLight_img.width+10,i=null;(i=function(o){egret.Tween.get(o.mMoneyLight_mask).to({x:n,y:e},1e3).wait(500).to({x:t,y:e},500).call(function(){i(o)})})(this)},e.prototype._playFontLightAni=function(){var t=this,e=null;this.mLight2_img.visible=!1,this.mLight3_img.visible=!1,e=function(t,n,i,o,a,r){n.scaleX=i,n.scaleY=i,egret.Tween.get(n).to({scaleX:a,scaleY:a},800).wait(500).to({scaleX:i,scaleY:o},500).call(function(){e(t,n,i,o,a,r)})},e(this,this.mLight1_img,0,0,this.mLight1_img.scaleX,this.mLight1_img.scaleY),egret.setTimeout(function(){t.mLight2_img.visible=!0,e(t,t.mLight2_img,0,0,t.mLight2_img.scaleX,t.mLight2_img.scaleY)},this,600),egret.setTimeout(function(){t.mLight3_img.visible=!0,e(t,t.mLight3_img,0,0,t.mLight3_img.scaleX,t.mLight3_img.scaleY)},this,1e3)},e.prototype._playLightOnTarget=function(t){var e=RES.getRes("frLightAni_json"),n=RES.getRes("frLightAni_png"),i=new egret.MovieClipDataFactory(e,n),o=new egret.MovieClip(i.generateMovieClipData("frlight"));return o.anchorOffsetX=57,o.anchorOffsetY=60,o.gotoAndPlay(1,-1),o.x=t.x,o.y=t.y,t.parent.addChild(o),o},e.prototype._playItemLightAni=function(){this._playLightOnTarget(this.item1Img),this._playLightOnTarget(this.item2Img),this._playLightOnTarget(this.item3Img),this._playLightOnTarget(this.item4Img)},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemoveFromStage,this)},e.prototype._onAddToStage=function(){var t=EventManager.instance;t.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this._onMyUserInfoUpdate,this),EventManager.instance.enableOnObject(this)},e.prototype._onRemoveFromStage=function(){this._enableEvent(!1),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this._onAddToStage,this),e._instance=null,EventManager.instance.disableOnObject(this)},e.prototype.show=function(){this.popup(null,!0,{alpha:0})},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.nullInstance=function(){if(e._instance){var t=this._instance;t.parent.removeChild(t)}},e.setDisableGet=function(){e._instance&&(e._instance.mGoRecharge_btn.visible=!1)},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelFirstRecharge.prototype,"PanelFirstRecharge");var PanelGetItems=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelGetItemsSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.dragon||(this.dragon=new DragonSign,this.dragon.x=this.group.width>>1,this.dragon.y=this.group.height>>1,this.dragon.stop()),this.list.itemRenderer=IRGoodsGet,this.list.dataProvider=this._dataProvider=new eui.ArrayCollection,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)
},e.prototype.onTap=function(t){this.dealAction()},e.prototype.show=function(t){this.popup(this.dealAction.bind(this)),this.group.addChildAt(this.dragon,1);var e=t.count;MainLogic.instance.selfData.isSignGoldAddByFRecharge()&&(e+=.2*t.count),alien.Native.instance.isNative&&(e+=.5*t.count),this.msg.text=""+e,this.playMsg()},e.prototype.playMsg=function(){egret.Tween.removeTweens(this.msg),this.msg.alpha=0,egret.Tween.get(this.msg).wait(300).to({alpha:1},300)},e.prototype.close=function(){t.prototype.close.call(this)},e.lightWave=function(t){return{r:360*t/Math.PI/2}},e}(alien.PanelBase);__reflect(PanelGetItems.prototype,"PanelGetItems");var IRGoodsGet=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=GoodsManager.instance.getGoodsById(this.data.id);this.labGoodsName.text=e.name+"x"+this.data.count,this.imgGoodsIcon.source=GoodsItem.parseUrl(this.data.id)},e}(eui.ItemRenderer);__reflect(IRGoodsGet.prototype,"IRGoodsGet");var PanelGetRed=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelGetRedSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefault(),this._initEvent()},e.prototype._initDefault=function(){this._allBigStars=[];for(var t=0;5>t;++t)this._allBigStars[t]=this["lightStar"+(t+1)+"_img"];this._allBigStarHide(),this._showGetRed(!1),this._showStarBg(!0)},e.prototype._showGetRed=function(t){this.getRed_img.visible=t},e.prototype._showStarGroup=function(t){this.lightStar_group.visible=t},e.prototype._showStarBg=function(t){this.mBgStar_img.visible=t},e.prototype._allBigStarHide=function(){for(var t=0;5>t;++t)this._allBigStars[t].visible=!1},e.prototype._initEvent=function(){this._enableEvent(!0)},e.prototype._onAddToStage=function(){this.getRed_img.addClickListener(this._onClickGetRed,this),this.close_img.addClickListener(this._onTouchClose,this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._onClickGetRed=function(){ExchangeService.instance.doChou(this._roomId)},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this)},e.prototype._onAniStarOver=function(){var t=this;egret.Tween.get(this.lightStar_group).wait(300).to({alpha:0},100).call(function(){t.lightStar_group.visible=!1,t.lightStar_group.alpha=1,egret.Tween.get(t.getRed_img).set({scaleX:.1,scaleY:.1,visible:!0}).to({scaleX:1,scaleY:1},100)})},e.prototype._onAllStarMoveOver=function(){var t=this,e=egret.Tween;egret.setTimeout(function(){t._showStarBg(!1);var n=0,i=null,o=t;(i=function(){e.get(o._allBigStars[n]).to({scaleX:1.5,scaleY:1.5},100).to({scaleX:1,scaleY:1},50).call(function(){return n>=4?void o._onAniStarOver():(n++,void i())})})()},this,50)},e.prototype._bottomToBig=function(t,e){var n=this,i=this._allBigStars[e],o=i.x,a=i.y;t.visible=!1;var r=t.localToGlobal(t.x,t.y);r=this.lightStar_group.globalToLocal(r.x,r.y);var s=new eui.Image("play_star_big");this.lightStar_group.addChild(s);var h=t.width/s.width,c=t.height/s.height;s.x=r.x+.5*t.width,s.y=r.y+.5*t.height,s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height,s.scaleX=h,s.scaleY=c,egret.Tween.get(s).to({x:o,y:a,scaleX:1,scaleY:1},500).call(function(){n.lightStar_group.removeChild(s),n._allBigStars[e].visible=!0,4==e&&n._onAllStarMoveOver()})},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype.show=function(t,e){var n=this;this._roomId=t;var i=e;this.popup(null,!0),egret.setTimeout(function(){var t=n,e=0,o=0,a=null;a=function(){e>=i.length?o&&(egret.clearInterval(o),o=0):(t._bottomToBig(i[e],e),e++)},a(),o=egret.setInterval(function(){a()},n,100)},this,500)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelGetRed.prototype,"PanelGetRed");var PanelHornTalk=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelHornTalk},e.prototype._setChatCost=function(){var t=GameConfig.getChatCostInfoByType(2),e=0;t&&3==t.id&&(e=t.cost),this._costNum=e,this.costGold_label.text=""+e},e.prototype._onClickSendMsg=function(){var t=MainLogic.instance.selfData,e=BagService.instance.getItemCountById(3);if(this._hasSendMsg)Toast.show("");else if(this._nCurCoolTime>-1)Toast.show("");else if(e<this._costNum)Toast.show("");else if(this.talk_editText.text&&this.talk_editText.text.length>=1){var n=this._onReplaceSensitive(this.talk_editText.text);server.sendHornMsg(2,n),this.talk_editText.text="";var i={time:(new Date).getTime(),nickname:Base64.encode(t.nickname),msg:n};t.addHornTalkRec(i),this._setHasSendMsg(!0)}else Toast.show("")},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaut(),this._initEvent(),EventManager.instance.enableOnObject(this)},e.prototype._formatTalk=function(){var t=MainLogic.instance.selfData,e=t.getHornTalkRecList(),n=t.getSysTalkRecList(),i=[];return i=i.concat(e),i=i.concat(n)},e.prototype._initDefaut=function(){this._hasSendMsg=!1,this._nDefaultCoolTime=5,this._nIntervalRepeatId=-1,this._dataArr=this._formatTalk(),this._dataProvider=new eui.ArrayCollection(this._dataArr),this.talkRec_list.itemRenderer=HornTalkItem,this.talkRec_list.dataProvider=this._dataProvider,this._onScrollToBottom(),this._setChatCost()},e.prototype._setHasSendMsg=function(t){this._hasSendMsg=t},e.prototype._onHornRecChange=function(t){var e=t.data;e&&(this._dataArr.push(e),this._dataProvider.source=this._dataArr,this._dataProvider.refresh(),this._onScrollToBottom())},e.prototype._onScrollToBottom=function(){var t=this;egret.setTimeout(function(){t.horn_scroller.viewport.contentHeight<t.horn_scroller.height||(t.horn_scroller.viewport.scrollV=t.horn_scroller.viewport.contentHeight-t.horn_scroller.height,t.horn_scroller.viewport.validateNow())},this,100)},e.prototype._initEvent=function(){this._enableEvent(!0),this.close_img.addClickListener(this._onTouchClose,this),this.sendMsg_img.addClickListener(this._onClickSendMsg,this);var t=alien.EventManager.instance;t.registerOnObject(this,alien.Dispatcher,EventNames.HORN_TALK_RECORDS_CHANGE,this._onHornRecChange,this)},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),server[e](EventNames.USER_PAY_TO_CHAT_REP,this._onRecvHornRep,this),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype._onRecvHornRep=function(t){var e=t.data,n=MainLogic.instance.selfData.nickname;if(e)if(null==e.result)for(var i=e.chatinfo,o=0;o<i.length;++o)Base64.decode(i[o].nickname)==n&&(this._hasSendMsg&&this._startCool(),this._setHasSendMsg(!1));else this._setHasSendMsg(!1)},e.prototype.show=function(){this.popup(null,!0,{alpha:0})},e.prototype._onReplaceSensitive=function(t){for(var e=Utils.getSensitiveWord(),n=t,i=0;i<e.length;++i)n=n.replace(new RegExp(e[i],"g"),"*");return n},e.prototype._clearRepeatInterval=function(){this._nIntervalRepeatId>0&&(egret.clearInterval(this._nIntervalRepeatId),this._nIntervalRepeatId=-1)},e.prototype._startCool=function(){this._clearRepeatInterval(),this._nCurCoolTime=this._nDefaultCoolTime,this._nIntervalRepeatId=egret.setInterval(this._coolUpdate,this,1e3)},e.prototype._stopCool=function(){this._clearRepeatInterval()},e.prototype._coolUpdate=function(){this._nCurCoolTime-=1,this._nCurCoolTime>=0||this._stopCool()},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelHornTalk.prototype,"PanelHornTalk");var PanelInviteList=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelInvateListSkin,this.list.itemRenderer=InviteListItem,this._dataProvide||(this._dataProvide=new eui.ArrayCollection([]),this.list.dataProvider=this._dataProvide)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);EventManager.instance;this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.scroll2end,this),InviteService.instance.addEventListener(EventNames.INVITE_DATA_REFRESH,this.onInviteDataUpdate,this),this._showNoInviteTipGroup(!0)},e.prototype.onInviteDataUpdate=function(t){var e=t.data;this._dataProvide.source=e,this._dataProvide.refresh(),this._showNoInviteByInviteList(),this.lbCount.text=""+InviteService.instance.complete_amount+"51"},e.prototype.scroll2end=function(t){InviteService.instance.getInvitePlayersList()},e.prototype._showNoInviteTipGroup=function(t){this.noInviteGroup.visible=t},e.prototype._showNoInviteByInviteList=function(){this._dataProvide.source.length>0?this._showNoInviteTipGroup(!1):this._showNoInviteTipGroup(!0)},e.prototype.show=function(t,e){void 0===e&&(e=null),this._dataProvide.source=t,this._dataProvide.refresh(),this.scroller.viewport.scrollV=0,this._callback=e,this.popup(),this.lbCount.text=""+InviteService.instance.complete_amount+"51"},e.prototype.onBtnCloseClick=function(t){this.dealAction()},e}(alien.PanelBase);__reflect(PanelInviteList.prototype,"PanelInviteList");var PanelLogin=function(t){function e(){var e=t.call(this,alien.popupEffect.Flew,{direction:"up",ease:egret.Ease.backOut},alien.popupEffect.Flew,{direction:"up",ease:egret.Ease.backIn})||this;return e.addExcludeForClose(["confirm"]),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelLoginSkin},e.prototype.addListeners=function(){this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this)},e.prototype.removeListeners=function(){this.grpButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this)},e.prototype.onGrpButtonTap=function(t){switch(t.target.name){case"forgot":break;case"register":break;case"confirm":var e=this.tiID.text,n=this.tiPassword.text,i=!0;GameData.instance.setItem("id",e,!0),this.dealAction("confirm",{id:e,password:n,autoLogin:i})}},e.prototype.onBtnCloseTap=function(t){this.dealAction()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.show=function(t){this._callback=t,this.popup(),this.tiID.text=GameData.instance.getItem("id"),this.tiPassword.text="",this.addListeners()},e.prototype.close=function(){t.prototype.close.call(this),this.removeListeners()},e}(alien.PanelBase);__reflect(PanelLogin.prototype,"PanelLogin");var PanelMail=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this;return e.skinName=panels.PanelMailSkin,e}return __extends(e,t),e.getInstance=function(){return void 0==this._instance&&(this._instance=new e),this._instance},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=IRContainer,this.list.dataProvider=this._dataProvider=new eui.ArrayCollection(MailService.instance.source),this._initEvent()},e.prototype.addListener=function(){this.list.addEventListener(egret.Event.CHANGE,this.onSelectItem,this),MailService.instance.addEventListener(EventNames.MAIL_LIST_REFRESH,this.onMailListRefresh,this)},e.prototype.removeListener=function(){this.list.removeEventListener(egret.Event.CHANGE,this.onSelectItem,this),MailService.instance.removeEventListener(EventNames.MAIL_LIST_REFRESH,this.onMailListRefresh,this)},e.prototype.onSelectItem=function(t){var e=this,n=this.list.selectedItem;this.tipOpenMailItem(n),egret.callLater(function(){e.list.selectedIndex=-1},this)},e.prototype.tipOpenMailItem=function(t){PanelMailDetails.getInstance().show(t),0==t.status&&MailService.instance.openMail(t.id)},e.prototype.onMailListRefresh=function(t){t.data&&t.data.mailData?this._dataProvider.itemUpdated(t.data.mailData):this._dataProvider.refresh(),MailService.instance.source.length<=0?this._showNoMail(!0):this._showNoMail(!1)},e.prototype._showNoMail=function(t){this.noMailGroup.visible=t},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._initEvent=function(){this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.show=function(){this.popup(),this.addListener(),this._dataProvider.refresh(),MailService.instance.source.length<=0?this._showNoMail(!0):this._showNoMail(!1)},e}(alien.PanelBase);__reflect(PanelMail.prototype,"PanelMail");var MailItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t){this._data=t,0==t.status?this.currentState="new":this.currentState="read",this.title_label.text=t.title,this.time_label.text=alien.TimeUtils.tsToDateString(t.sendtime)},e.states=["new","read"],e}(eui.Component);__reflect(MailItem.prototype,"MailItem");var PanelMailDetails=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.getInstance=function(){return void 0==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.skinName=panels.PanelMailDetailsSkin},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._initEvent(),this.goodsList.itemRenderer=MailGoodsItem,this.goodsList.dataProvider=this._goodsData=new eui.ArrayCollection},e.prototype._onClickGetRew=function(){this._canGetReward&&MailService.instance.getReward(this._mailData.id)},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._initEvent=function(){this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this),this.getImg.addClickListener(this._onClickGetRew,this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.show=function(t){this._mailData=t,this.popup(),this.content_label.text=t.content,this._goodsData.source=t.attachment,this._canGetReward=!1,t.attachment&&t.attachment.length>0?2!=t.status?(this.getImg.source="room_get",this.getImg.touchEnabled=!0,this._canGetReward=!0):(this.getImg.source="room_getGray",this.getImg.touchEnabled=!1):this.getImg.visible=!1},e}(alien.PanelBase);__reflect(PanelMailDetails.prototype,"PanelMailDetails");var MailGoodsItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.goodsItem.setData(e)},e}(eui.ItemRenderer);__reflect(MailGoodsItem.prototype,"MailGoodsItem");var PanelMatch9GetRew=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this;return e._isShow=!1,e}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelMatch9GRew},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaut(),this._initEvent()},e.prototype._initDefaut=function(){var t=0;this.rank_bitmap.text="",this.get_label.text="";for(var e=0;3>e;++e)t=e+1,this["name"+t+"_label"].text="",this["turn1_"+t+"label"].text="",this["turn2_"+t+"label"].text="",this["turn3_"+t+"label"].text="",this["turn4_"+t+"label"].text=""},e.prototype._initEvent=function(){this.getRew_img.addClickListener(this._onClickGetRew,this),this._enableEvent(!0);alien.EventManager.instance},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onAddToStage=function(){EventManager.instance.enableOnObject(this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this)},e.prototype._onClickGetRew=function(){Alert.show(""+this.get_label.text+" ",0,function(){server.playing||alien.SceneManager.instance.currentSceneName!=SceneNames.ROOM&&alien.SceneManager.show(SceneNames.ROOM,null,alien.sceneEffect.Fade,null,null,!1,SceneNames.LOADING)}),this.dealAction(),BagService.instance.refreshBagInfo()},e.prototype._initByData=function(t,e){if(e){var n=0,i="",o=0,a=e.resultInfo,r=e.params[0];this.rank_bitmap=r;var s=MatchService.getRewardStringByRank(t,r,"");this.get_label.text=s;for(var h=0;h<a.length;++h)n=h+1,o=a[h].params[0]+a[h].params[1]+a[h].params[2],i=Base64.decode(a[h].nickname),this["name"+n+"_label"].text=i.substr(0,4),this["turn1_"+n+"label"].text=a[h].params[0],this["turn2_"+n+"label"].text=a[h].params[1],this["turn3_"+n+"label"].text=a[h].params[2],this["turn4_"+n+"label"].text=o}},e.prototype.show=function(t,e){this.popup(null,!0,{alpha:0}),this._isShow=!0,this._initByData(t,e)},e.prototype.isShow=function(){return this._isShow},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelMatch9GetRew.prototype,"PanelMatch9GetRew");var PanelMatch9Info=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelMatch9Info},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaut(),this._initEvent()},e.prototype._initDefaut=function(){for(var t=1;4>t;t++)this["turn"+t+"_label"].visible=!1,this["turn"+t+"_1label"].text="",this["turn"+t+"_2label"].text="",this["turn"+t+"_3label"].text=""},e.prototype._initEvent=function(){this._enableEvent(!0);alien.EventManager.instance},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onAddToStage=function(){EventManager.instance.enableOnObject(this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this)},e.prototype.show=function(t){this.popup(this.dealAction.bind(this),!0,{alpha:0}),this._initByData(t)},e.prototype._initByData=function(t){if(t)for(var e=1,n=0;n<t.length;++n)e=t[n].round,-1==t[n].aver?(this["turn"+e+"_2label"].text="..",this["turn"+e+"_3label"].text=""):(this["turn"+e+"_2label"].text=t[n].aver||0,this["turn"+e+"_3label"].text=t[n].score||0),this["turn"+e+"_label"].visible=!0,this["turn"+e+"_1label"].text=t[n].change||0},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelMatch9Info.prototype,"PanelMatch9Info");var PanelMatchCountDown=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchCountDownSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButtons.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonsTap,this)},e.prototype.onGrpButtonsTap=function(t){var e;switch(t.target.name){case"reward_intro":e=GameConfig.getMatchConfigById(this.roomInfo.matchId),PanelMatchIntro.instance.show(lang.match_title_reward_intro,e.reward);break;case"match_intro":e=GameConfig.getMatchConfigById(this.roomInfo.matchId),PanelMatchIntro.instance.show(lang.match_title_match_intro,e.des);break;case"close":this.dealAction();break;case"cancel":MatchService.instance.cancelMatch(this.roomInfo)}},e.prototype.show=function(t){this.popup(),this.roomInfo=t,this.labTitle.text=t.name,this.labReward.text=t.masterReward;var e=server.tsNow,n=MatchService.getNextTurn(t),i=n.nextTs;this._updateSignNum(0),server.addEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),server.getMatchSignUpInfo(t.matchId),this._timer=CountDownService.register(i-e,this.onTimer.bind(this))},e.prototype.close=function(){t.prototype.close.call(this),CountDownService.unregister(this._timer),egret.clearTimeout(this.matchinforeqTick),server.removeEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this)},e.prototype.onTimer=function(t){this.labCD.text=alien.TimeUtils.timeFormat(t,"{2}:{1}:{0}")},e.prototype._updateSignNum=function(t){this.sign_label.text=""+t+""},e.prototype.onMatchSignUpInfoRep=function(t){var e=t.data;e&&e.matchid==this.roomInfo.matchId&&e.signup_cnt&&e.signup_cnt>0&&1==e.is_signup&&(this._updateSignNum(e.signup_cnt),this.matchinforeqTick=egret.setTimeout(function(){this.roomInfo&&this.roomInfo.matchId&&server.getMatchSignUpInfo(this.roomInfo.matchId)},this,1e5))},e}(alien.PanelBase);__reflect(PanelMatchCountDown.prototype,"PanelMatchCountDown");var PanelMatchIntro=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchIntroSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this)},e.prototype.onBtnCloseTap=function(t){this.dealAction()},e.prototype.show=function(t,e){this.popup(this.dealAction.bind(this)),this.info_scroller.viewport.scrollV=0,this.info_scroller.viewport.validateNow(),this.labTitle.text=t,"string"==typeof e?this.labContent.text=e:this.labContent.text=e.join("\n")},e}(alien.PanelBase);__reflect(PanelMatchIntro.prototype,"PanelMatchIntro");var PanelMatchNotice=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this;return e._matchTopNotify=alien.Utils.parseColorTextFlow(lang.match_notice_alert),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchNoticeSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnCancelMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancelMatchTap,this)},e.prototype.onGrpButtonTap=function(t){this.dealAction(t.target.name)},e.prototype.onBtnCancelMatchTap=function(t){MatchService.instance.cancelMatch(this.roomInfo),this.dealAction(t.target.name)},e.prototype.show=function(t,e){void 0===e&&(e=30),this.popup(),this.roomInfo=t,this._matchTopNotify[1].text=this.roomInfo.name,this._timer=CountDownService.register(e,this.onTimer.bind(this))},e.prototype.close=function(){t.prototype.close.call(this),CountDownService.unregister(this._timer)},e.prototype.onTimer=function(t){this._matchTopNotify[3].text=t.toString(),this.labContent.textFlow=this._matchTopNotify},e}(alien.PanelBase);__reflect(PanelMatchNotice.prototype,"PanelMatchNotice");var PanelMatchResult=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchResultSkin,this.list.itemRenderer=RankItem,this.list.dataProvider=this._dataProvide=new eui.ArrayCollection,this._switchTimer||(this._switchTimer=new egret.Timer(2e3),this._switchTimer.addEventListener(egret.TimerEvent.TIMER,this.switchGroup,this),this._switchTimer.start())},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnConfirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancelTap,this),this.btnGetReward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancelTap,this),this.grpRank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSwitch,this),this.grpResult.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSwitch,this)},e.prototype.clickSwitch=function(){this.switchGroup(null),this._switchTimer.reset(),this._switchTimer.start()},e.prototype.switchGroup=function(t){this.grpRank.visible=!this.grpRank.visible,this.grpResult.visible=!this.grpResult.visible},e.prototype.onBtnCancelTap=function(t){this.rewardContent&&this.rewardContent.length>0&&(alien.Native.instance.isNative?Alert.show(""+this.rewardContent+" "):Alert.show(""+this.rewardContent+" ")),this.dealAction()},e.prototype.onAlertBtn=function(t,e){if("cancel"==t){var n=this.rank;204==this.matchId?n+=200:201==this.matchId&&(n+=500);var i=ShareImageManager.instance.getShareScene(ShareImageManager.GAME_TYPE_MATCH,n);ShareImageManager.instance.start(server.uid,i)}},e.prototype._formatRewInfo=function(t){var e=(r={},r[0]=":{0}",r[1]=":{0}",r[2]=":{0}",r[101]=":{0}",r),n=function(t,n){var i=n;return e[t]?(1==t&&(i=n/100),e[t].replace("{0}",i)):void 0},i=t.split("|"),o="";if(i[0]){var a=i[0].split(":");a&&(o=n(Number(a[0]),Number(a[1])))}return o;var r},e.prototype.show=function(t,e){this._callback=e,this.popup(),this.grpRank.visible=!1,this.grpResult.visible=!0,this.matchId=t.matchid,this.rank=t.params[0];var n=MainLogic.instance.selfData;this.labPlayerName.text=n.nickname+":",this.labMatchName.text=lang.format(lang.id.match_result_match_name,server.roomInfo.name);var i=t.params[0];this.labNumber.text=i.toString(),this.labPraise.text=lang.match_result_praise[i>3?2:i>1?1:0];var o="";o=t.strreward?this._formatRewInfo(t.strreward):MatchService.getRewardStringByRank(server.roomInfo,i,"\n"),this.rewardContent=o,o?(this.labReward.text=o,this.btnConfirm.visible=!1,this.btnGetReward.visible=!0):(this.btnConfirm.visible=!0,this.btnGetReward.visible=!1),this.grpReward.visible=!!o,this._dataProvide.source=t.rankInfo},e}(alien.PanelBase);__reflect(PanelMatchResult.prototype,"PanelMatchResult");var RankItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.rank.text=this.data.rank,this.score.text=null==this.data.score?0:this.data.score,this.data.inmatch&&1==this.data.inmatch?(this.inmatch.visible=!0,this.score.visible=!1):(this.inmatch.visible=!1,this.score.visible=!0),this.nickName.text=Base64.decode(this.data.nickname),MainLogic.instance.selfData.uid==this.data.uid?(this.rank.textColor=16770048,this.nickName.textColor=16770048,this.score.textColor=16770048):(this.rank.textColor=16777215,this.nickName.textColor=16777215,this.score.textColor=16777215)},e}(eui.ItemRenderer);__reflect(RankItem.prototype,"RankItem");var PanelMatchRevive=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelMatchRevive},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.closeImg.addClickListener(this._onTouchClose,this),this.reviveImg.addClickListener(this._onClickReviveImg,this),this.giveUpImg.addClickListener(this._onClickGiveUpImg,this)},e.prototype._onClickReviveImg=function(){this._reviveFunc&&this._reviveFunc()},e.prototype._onClickGiveUpImg=function(){this._giveUpFunc&&this._giveUpFunc()},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.updateCountDown=function(t){this.reviveLabel.text="("+t+")"},e.prototype.setRankSub=function(t){this.rankLabel.text=""+t},e.prototype.setReviveCost=function(t){this.costLabel.text=""+t},e.prototype.show=function(t,e){this._giveUpFunc=e,this._reviveFunc=t,this.popup(null,!0,{alpha:0})},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelMatchRevive.prototype,"PanelMatchRevive");var PanelMatchSignUp=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this;return e._count=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchSignUpSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButtons.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonsTap,this)},e.prototype.onGrpButtonsTap=function(t){var e;switch(t.target.name){case"reward_intro":e=GameConfig.getMatchConfigById(this.roomInfo.matchId),PanelMatchIntro.instance.show(lang.match_title_reward_intro,e.reward);break;case"match_intro":e=GameConfig.getMatchConfigById(this.roomInfo.matchId),PanelMatchIntro.instance.show(lang.match_title_match_intro,e.des);break;case"close":this.dealAction();break;case"sign_up":var n=0,i=this.paySelect[this.ddPay.index];"number"!=typeof i.data&&(n=i.data.id),MatchService.instance.signUp(this.roomInfo,n)
}},e.prototype.show=function(t){this.popup(),this.roomInfo=t,this.labTitle.text=t.name,this.labLimit.text=t.limitText,this.labAmount.text=t.signUpCountTest,this.labSignUpCount.text=t.todayCountText;var e=this.paySelect=[{text:t.entryMoneyText,data:t.entryMoney}],n=GoodsManager.instance.getGoodsById(t.ticketId),i=BagService.instance.getItemCountById(t.ticketId)>0&&!!n;if(n&&e.push({text:n.name+"x"+t.entryTicket,data:n,disable:!i}),this.ddPay.items=e,i&&(this.ddPay.index=1),t.hasOwnProperty("startDate")){var o=MatchService.getNextTurn(t);this.labLimit.text=t.limitText=o.nextTime,server.getMatchSignUpInfo(t.matchId)}else this.labLimit.text=t.limitText,this._timer=egret.setInterval(this.fakeAmount,this,1e3)},e.prototype.close=function(){t.prototype.close.call(this),this._timer>0&&egret.clearInterval(this._timer)},e.prototype.fakeAmount=function(){var t=Math.ceil((this.roomInfo.maxPlayer-this._count)/2);this._count+=alien.MathUtils.makeRandomInt(t+1),this.labAmount.text=this._count+lang.people,this._count>=this.roomInfo.maxPlayer&&(this._count=0)},e}(alien.PanelBase);__reflect(PanelMatchSignUp.prototype,"PanelMatchSignUp");var PanelMatchWaiting=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchWaitingSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._isShow=!1,this.btnCancelMath.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancelMatchTap,this)},e.prototype.onMatchSignUpInfoRep=function(t){var n=t.data;n&&n.matchid==this.roomInfo.matchId&&n.signup_cnt&&n.signup_cnt>0&&(this.progressBar.value=n.signup_cnt,1==n.is_signup&&(this.matchinforeqTick=egret.setTimeout(function(){e.instance.roomInfo&&e.instance.roomInfo.matchId&&server.getMatchSignUpInfo(e.instance.roomInfo.matchId)},this,5e3)))},e.prototype.onBtnCancelMatchTap=function(t){this.dealAction(),MatchService.instance.cancelMatch(this.roomInfo)},e.prototype.show=function(t){var e=this;this.popup(),this.roomInfo=t,this._isShow=!0,this.labReward.text=t.masterReward,this.progressBar.maximum=t.maxPlayer,this.labTitle.text=this.roomInfo.name,this.roomInfo.forbidRobot&&1==this.roomInfo.forbidRobot?(this.progressBar.value=1,server.addEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),server.getMatchSignUpInfo(t.matchId)):(this.progressBar.value=0,this.fakeCount=alien.MathUtils.split(t.maxPlayer,alien.MathUtils.makeRandomInt(t.startTimeout[1],t.startTimeout[0])),this._timer=egret.setInterval(function(){e.progressBar.value+=e.fakeCount.pop()||0},this,1e3))},e.prototype.close=function(){t.prototype.close.call(this),this._isShow=!1,egret.clearTimeout(this.matchinforeqTick),server.removeEventListener(EventNames.USER_MATCH_SING_UP_INFO_REP,this.onMatchSignUpInfoRep,this),this._timer>0&&(egret.clearInterval(this._timer),this._timer=0)},e.prototype.isWaitingShow=function(){return this._isShow},e}(alien.PanelBase);__reflect(PanelMatchWaiting.prototype,"PanelMatchWaiting");var PanelMatchWaitingInner=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelMatchWaitingInnerSkin,this._tf=alien.Utils.parseColorTextFlow(lang.match_get_in)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._wave=new alien.Wave(this.lab,2e3,function(t){return{alpha:.3+.5*(Math.sin(t)+1)*.7}},0,!1)},e.prototype.show=function(t){void 0===t&&(t=-1),console.log("PanelMatchWaitingInner.show:"+t),this.popup(null,!1,{alpha:0}),0>t?this.lab.text=lang.match_waiting_other_desk_2:0==t?this.lab.text=lang.match_waiting_other_desk_1:(this._tf[1].text=t+"",this.lab.textFlow=this._tf),this._wave.play()},e.prototype.close=function(){t.prototype.close.call(this),this._wave&&this._wave.stop()},e}(alien.PanelBase);__reflect(PanelMatchWaitingInner.prototype,"PanelMatchWaitingInner");var PanelModifyNickname=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=alien.EventManager.instance;e.registerOnObject(this,server,EventNames.USER_MODIFY_USER_INFO_REP,this.onModifyUserInfoRep,this),e.registerOnObject(this,this.grpButtons,egret.TouchEvent.TOUCH_TAP,this.onGrpButtonsTap,this)},e.prototype.onGrpButtonsTap=function(t){switch(t.target.name){case"close":this.dealAction();break;case"confirm":var e=0,n=this.tiNickname.text,i=alien.Utils.getByteLen(n);if(4>i||i>16?e=5:Utils.regNickname(n)&&(e=1001),e>0)this.labErr.text=lang.modify_profile_err[e];else{this.labErr.text="";var o={nickname:Base64.encode(n)};server.modifyUserInfo(o),this._submitData=o}}},e.prototype.onModifyUserInfoRep=function(t){var e=t.data,n=e.rname||0;0==n?(MainLogic.instance.selfData.initData(this._submitData),Toast.show(lang.modify_profile_err[0]),alien.Dispatcher.dispatch(EventNames.MY_USER_INFO_UPDATE),this.dealAction()):this.labErr.text=lang.modify_profile_err[e.rname]},e.prototype.show=function(){this.skinName||(this.skinName=panels.PanelModifyNicknameSkin),this.popup(),this.labErr.text="",alien.EventManager.instance.enableOnObject(this)},e.prototype.close=function(){t.prototype.close.call(this),alien.EventManager.instance.disableOnObject(this)},e}(alien.PanelBase);__reflect(PanelModifyNickname.prototype,"PanelModifyNickname");var PanelNotice=function(t){function e(){var e=t.call(this)||this;return e._lastSelectIdx=0,e._labels=[],e}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelNoticeSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent(),egret.setTimeout(this.setShowRedExchange,this,100)},e.prototype._initEvent=function(){this._enableEvent(!0),this.wxCp_img.addClickListener(this._onClickCopyKeFuWX,this),this.publicCp_img.addClickListener(this._onClickCopyPublicWX,this),this.leftLabelList.addEventListener(egret.Event.CHANGE,this._onSelectItem,this)},e.prototype._initUI=function(){this._labels=[{tit:"",sel:!1,"new":!1,cb:this._onClickGameNotice.bind(this)}],this.leftLabelList.itemRenderer=ActListItem,this.leftLabelList.dataProvider=this._leftLabelsDataProvider=new eui.ArrayCollection(this._labels)},e.prototype._changeSelectByIdx=function(t){var e=this,n=t;this._leftLabelsDataProvider.source[this._lastSelectIdx].sel=0,this._leftLabelsDataProvider.itemUpdated(this._labels[this._lastSelectIdx]),this._lastSelectIdx=n;var i=this.leftLabelList.getChildAt(n),o=i.localToGlobal(.5*i.width,.5*i.height),a=this.infoGroup.globalToLocal(o.x,o.y);this.arrImg.y=a.y;for(var r=0;r<this._leftLabelsDataProvider.length;++r)if(r==n){this._leftLabelsDataProvider.source[r].sel=!0,this._leftLabelsDataProvider.itemUpdated(this._labels[n]);break}this._labels[n].cb(),egret.callLater(function(){e.leftLabelList.selectedIndex=-1},this)},e.prototype._onSelectItem=function(){this._changeSelectByIdx(this.leftLabelList.selectedIndex)},e.prototype._onClickCopyKeFuWX=function(){var t=GameConfig.wxService;"delegate"==this.currentState&&(t=GameConfig.extendWX),GameConfig.copyText(this,t,"("+t+")")},e.prototype._onClickCopyPublicWX=function(){GameConfig.copyText(this,"","()")},e.prototype._onScrollTop=function(){this.content_scroller.stopAnimation(),this.content_scroller.viewport.scrollV=0,this.content_scroller.viewport.validateNow()},e.prototype._showRedExchange=function(){this._onScrollTop(),this.info_label.text='\n    1\n    2""\n    32)	"" \r\r\n',this.content_scroller.scrollPolicyV="off",this._showCopyWX(!0),this.noticeFlag_img.source="notice_red_tit"},e.prototype.setShowRedExchange=function(){this._changeSelectByIdx(0)},e.prototype._onClickRedExchange=function(){this._showRedExchange()},e.prototype._showDelegate=function(){this._onScrollTop(),this.info_label.text="",this.content_scroller.scrollPolicyV="off",this._showCopyWX(!0),this.noticeFlag_img.source="notice_delegate_tit"},e.prototype._onClickDelegate=function(){this._showDelegate()},e.prototype._showCopyWX=function(t){this.wxCp_img.visible=t,this.publicCp_img.visible=t},e.prototype.showGameNotice=function(){this._onScrollTop(),this.info_label.text="\n    \n:\n    1\n    2\n    3\n    4\n\r\r\n\n    \n\r\r\r\n                  20171027\n",this.content_scroller.scrollPolicyV="on",this._showCopyWX(!1),this.noticeFlag_img.source="notice_game_tit"},e.prototype._onClickGameNotice=function(){this.showGameNotice()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelNotice.prototype,"PanelNotice");var PanelPhoneLogin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelPhoneLoginSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initEvent(),this.unid="",this.sk="",this._nIntervalId=-1,this.phoneLabel.prompt=_phonePrompt,this.phoneLabel.maxChars=_phoneLen,this.codeLabel.maxChars=_codeLen,this.codeLabel.prompt=_codePrompt,this._showCountLabel(!1),this._initPhone(),this._resetCountNum(),this.phoneLabel.inputType=egret.TextFieldInputType.TEL,this.codeLabel.inputType=egret.TextFieldInputType.TEL},e.prototype._initPhone=function(){var t=UserData.instance.getLocalPhone();t&&11==t.length&&(this.phoneLabel.text=t)},e.prototype._checkPhone=function(t){var e=t;return e&&11==e.length?!0:!1},e.prototype._checkCode=function(t){var e=t;return e?!0:!1},e.prototype._showCountLabel=function(t){this.countLabel.visible=t},e.prototype._resetCountNum=function(){this._nCountTime=60},e.prototype._clearCountInterval=function(){-1!=this._nIntervalId&&egret.clearInterval(this._nIntervalId),this._nIntervalId=-1},e.prototype._startCountDown=function(){var t=this;this._clearCountInterval(),this._resetCountNum(),this.countLabel.text=""+this._nCountTime,this._showCountLabel(!0),this._nIntervalId=egret.setInterval(function(){return t._nCountTime<1?(t._clearCountInterval(),t._showCountLabel(!1),void t._showGetCode(!0)):(t._nCountTime-=1,void(t.countLabel.text=""+t._nCountTime))},this,1e3)},e.prototype._showGetCode=function(t){this.getCodeImg.visible=t},e.prototype._onClickGetCode=function(){var t=this.phoneLabel.text;if(!this._checkPhone(t))return void Toast.show(_phonePrompt);var e=(n={},n[0]="",n[1e3]="",n[2015]="",n[2018]="",n[2019]="",n);webService.getCode(this.phoneLabel.text,function(t){var n=t.code,i=e[n]||"";Toast.show(i)}),this._showGetCode(!1),this._startCountDown();var n},e.prototype._enableTouch=function(t,e){t.touchEnabled=e},e.prototype._initEvent=function(){this._enableEvent(!0),this.closeImg.addClickListener(this._onClickClose,this),this.getCodeImg.addClickListener(this._onClickGetCode,this),this.loginImg.addClickListener(this._onClickLogin,this)},e.prototype._onClickLogin=function(){var t=this.phoneLabel.text,e=this.codeLabel.text,n=this;if(!n._checkPhone(t))return void Toast.show(_phonePrompt);if(!n._checkCode(e))return void Toast.show(_codePrompt);n._enableTouch(n.loginImg,!1);var i=alien.Native.instance,o=i.getUrlArg();o.share_sk&&(n.sk=o.share_sk),webService.loginByPhone(t,e,n.unid,n.sk,function(t){n.dealAction(),LoginService.instance.onVerifyResponse(t)}.bind(n))},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._clearCountInterval(),this._enableEvent(!1),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype.show=function(){this.popup(null,!0,{alpha:0})},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelPhoneLogin.prototype,"PanelPhoneLogin");var PanelPlayerInfo=function(t){function e(){var e=t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this;return e._cleanData(),e._browData=new BrowData,e}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelPlayerInfo},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initTouchEvent(),this._initDefault()},e.prototype._cleanData=function(){this._browData=null,e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";0==t&&(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this.brow1_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchBrow1Btn,this),this.brow2_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchBrow2Btn,this),this.brow3_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchBrow3Btn,this),this.brow4_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchBrow4Btn,this),this.brow5_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchBrow5Btn,this),this.report_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchReportBtn,this),this.close_btn[e](egret.TouchEvent.TOUCH_TAP,this._onTouchCloseBtn,this)},e.prototype._initTouchEvent=function(){this._enableEvent(!0)},e.prototype._initFreeBrow=function(){var t=MainLogic.instance.selfData.getFreeBrowCount(),e=!1;t>0&&(e=!0);for(var n=0,i=0;5>i;++i)n=i+1,this["brow"+n+"Gold_img"].visible=!e,this["brow"+n+"Price_img"].visible=!e,this["brow"+n+"Free_img"].visible=e;this.mFLeft_label.visible=e,this.mFLeft_label.text=":"+t},e.prototype._initDefault=function(){this.head_img.mask=this.headMask_img,this._initFreeBrow()},e.prototype._setNick=function(t){this.nick_label.text=t},e.prototype._setGames=function(t){this.games_label.text=""+t},e.prototype._setGold=function(t){var e=""+t;t>=1e5&&(e=t>=1e6?e.substring(0,e.length-4)+"":e.substr(0,2)+"."+e.substr(2,1)+""),this.gold_label.text=e},e.prototype._setWinRate=function(t){this.winRate_label.text=t},e.prototype._setHeadImg=function(t){var e=t;t&&-1!=t.indexOf("http://")&&(e=t.replace("http://","https://")),this.head_img.source=e},e.prototype._setRedBeg=function(t){this.redbeg_label.text=t.toFixed(1).toString()},e.prototype._onBuyBrow=function(t){if(this._uid!=server.uid){this.dealAction();var e=this._browData.getBrowCostGold(t);if(e){var n=MainLogic.instance.selfData.getFreeBrowCount(),i=MainLogic.instance.selfData.getGold()||0;return 0>n&&e>i?ImgToast.instance.show(this,lang.browNoGold):void(this._browData.checkCanBuyByBrowId(t)&&(this._browData.startCDByBrowId(t),server.send(EventNames.GAME_OPERATE_REQ,{optype:5,params:[this._seatId,t]})))}}},e.prototype._onTouchBrow1Btn=function(){var t=BrowData.BrowID.BROW_666;this._onBuyBrow(t)},e.prototype._onTouchBrow2Btn=function(){var t=BrowData.BrowID.BROW_TORTISE;this._onBuyBrow(t)},e.prototype._onTouchBrow3Btn=function(){var t=BrowData.BrowID.BROW_TOMATO;this._onBuyBrow(t)},e.prototype._onTouchBrow4Btn=function(){var t=BrowData.BrowID.BROW_LOVE;this._onBuyBrow(t)},e.prototype._onTouchBrow5Btn=function(){var t=BrowData.BrowID.BROW_GOOD;this._onBuyBrow(t)},e.prototype._onReportRet=function(t){t&&(0==t.code?ImgToast.instance.show(this,lang.reportSucc):30001==t.code&&ImgToast.instance.show(this,lang.repeatReport))},e.prototype._onTouchReportBtn=function(){if(this._uid!=server.uid){var t=UserData.instance.getToken(),e=server.uid,n=1,i=server.getRoomId(),o=server.getTableId(),a=this._uid;webService.reportUser(t,e,n,i,o,a,this._onReportRet.bind(this))}},e.prototype._showBrowAndReport=function(t){this.browAndReport_group.visible=t},e.prototype._onTouchCloseBtn=function(){this.dealAction()},e.prototype.show=function(t){this._uid=t.uid,this._seatId=t.seatId,this._setNick(t.nick),this._setGold(t.gold),this._setGames(t.game),this._setWinRate(t.winRate),this._setRedBeg(t.redBeg),this._setHeadImg(t.head),server.isMatch&&this._uid!=server.uid&&this._hidePlayerInfo(),this.popup(this.dealAction.bind(this),!0,{alpha:0})},e.prototype._hidePlayerInfo=function(){this.nick_label.text="***",this.gold_label.text="***",this.games_label.text="***",this.winRate_label.text="***",this.redbeg_label.text="***",this.head_img.source="icon_head_default"},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),this._cleanData()},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.onPlayerLeave=function(t){var n=e._instance;n&&n._seatId==t&&n.close()},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelPlayerInfo.prototype,"PanelPlayerInfo");var PanelProfile=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelProfileSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=alien.EventManager.instance;e.registerOnObject(this,server,EventNames.USER_MODIFY_USER_INFO_REP,this.onModifyUserInfoRep,this),e.registerOnObject(this,this.rbBoy,egret.TouchEvent.TOUCH_TAP,this.onRbBoyTap,this),e.registerOnObject(this,this.rbGirl,egret.TouchEvent.TOUCH_TAP,this.onRbGirlTap,this),e.registerOnObject(this,this.btnClose,egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this),e.registerOnObject(this,this.avatar,egret.TouchEvent.TOUCH_TAP,this.onBtnPickAvatarTap,this)},e.prototype.onModifyUserInfoRep=function(t){var e=t.data;switch(e.result){case 0:MainLogic.instance.selfData.initData(this._submitData),this.updateProfile();break;case 1:break;case 2:}},e.prototype.onRbBoyTap=function(t){var e={sex:1};server.modifyUserInfo(e),this._submitData=e},e.prototype.onRbGirlTap=function(t){var e={sex:2};server.modifyUserInfo(e),this._submitData=e},e.prototype.updateProfile=function(){var t=MainLogic.instance.selfData;this.avatar.imageId=t.imageid,this.labNickname.text=t.nickname,this.labGold.text=Utils.currencyRatio(t.gold),this.labID.text=t.fakeuid+"",this.rbBoy.selected=0==t.sex||1==t.sex,this.rbGirl.selected=2==t.sex},e.prototype.onBtnCloseTap=function(t){this.dealAction()},e.prototype.onBtnPickAvatarTap=function(t){},e.prototype.onPanelSelectAvatarResult=function(t,e){"select"==t&&server.modifyUserInfo(this._submitData={imageid:e.url})},e.prototype.show=function(t){this.popup(this.dealAction.bind(this)),this._callback=t,this.updateProfile(),alien.EventManager.instance.enableOnObject(this)},e.prototype.close=function(){t.prototype.close.call(this),alien.EventManager.instance.disableOnObject(this)},e}(alien.PanelBase);__reflect(PanelProfile.prototype,"PanelProfile");var PanelRechargeTips=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelRechargeTipsSkin,_nativeBridge.isWXMP?this.currentState="wxmp":this.currentState="phone"},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseClick,this),this.btnExchange.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchangeClick,this),this.btnBuy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRechargeClick,this),this.btnShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareClick,this)},e.prototype.show=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._callback=t,this.popup()},e.prototype.onExchangeClick=function(){PanelExchange2.instance.show(0),this.close()},e.prototype.onRechargeClick=function(){PanelExchange2.instance.show(),this.close()},e.prototype.onShareClick=function(){_nativeBridge.isNative?WxHelper.doNativeShare():_nativeBridge.isWXMP||_nativeBridge.isAli()||WxHelper.shareForPhone(),this.close()},e.prototype.onBtnCloseClick=function(t){this._callback&&this._callback("confirm"),this.dealAction()},e}(alien.PanelBase);__reflect(PanelRechargeTips.prototype,"PanelRechargeTips");var PanelReviveBag=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelReviveSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.close_img.addClickListener(this._onTouchClose,this),this.revive_img.addClickListener(this._onClickBuyRevive,this)},e.prototype._initUI=function(){var t=GameConfig.getReviveBagInfo();if(t){var e=t.goods.split(":");this.item1Num_label.text="x"+e[1];var n=t.goods.split("|");if(2==n.length){var i=n[0].split(":"),o=n[1].split(":");this.item2Num_label.text="x"+i[1];var a=o[1]+"";o[1]%24==0&&(a=o[1]/24+""),this.item3Num_label.text=a}}},e.prototype._onTouchClose=function(){this.dealAction(),alien.Dispatcher.dispatch(EventNames.CLOSE_REVIVE_PANEL)},e.prototype._onClickBuyRevive=function(){var t="10009";"noRecorder"==this.currentState&&(t="10016"),RechargeService.instance.doRecharge(t)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.prototype._checkShouldState=function(){var t=MainLogic.instance.selfData.todayHasBuyRevive();t?this.currentState="noRecorder":this.currentState="hasRecorder"},e.prototype._onBagRefresh=function(){var t=BagService.instance.getItemCountById(3);t>=this._diamondLimitNum&&(this.dealAction(),alien.Dispatcher.dispatch(EventNames.BUY_REVIVE_SUCC))},e.prototype.show=function(t){this._diamondLimitNum=t;var e=this.diamoneTip_label.text;this.diamoneTip_label.text=e.replace("{0}",t),this.popup(null,!0,{alpha:0}),this._checkShouldState();var n=alien.EventManager.instance;n.registerOnObject(this,alien.Dispatcher,EventNames.BAG_INFO_REFRESH,this._onBagRefresh,this),alien.EventManager.instance.enableOnObject(this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelReviveBag.prototype,"PanelReviveBag");var PanelSelectAvatar=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelSelectAvatarSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list.itemRenderer=IRAvatar;for(var e=[],n=1;8>=n;n++)e.push(n);this.list.dataProvider=new eui.ArrayCollection(e),this.list.addEventListener(egret.Event.CHANGE,this.onSelectAvatar,this),this.btnUpload.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnUploadTap,this)},e.prototype.onBtnUploadTap=function(t){},e.prototype.onSelectAvatar=function(t){var e=this;this.dealAction("select",{url:"head"+this.list.selectedItem+".png"}),egret.callLater(function(){e.list.selectedIndex=-1},this)},e.prototype.show=function(t){this._callback=t,this.popup(this.dealAction.bind(this)),this.currentState=alien.Native.instance.isNative?"upload":"select"},e}(alien.PanelBase);__reflect(PanelSelectAvatar.prototype,"PanelSelectAvatar");var IRAvatar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.imgAvatar.source="icon_head"+this.data},e}(eui.ItemRenderer);__reflect(IRAvatar.prototype,"IRAvatar");var PanelSetting=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!0,ease:egret.Ease.backIn})||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.skinName=panels.PanelSettingSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.grpButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCloseTap,this),"true"==lang.debug&&(this.btnLogout.visible=!0)},e.prototype.onGrpButtonTap=function(t){switch(t.target.name){case"logout":MainLogic.instance.stop(),UserData.instance.clearData(["id"]),MainLogic.instance.showLogin(),this.dealAction();break;case"bind_weixin":break;case"music":alien.SoundManager.instance.switchMusic();break;case"effect":alien.SoundManager.instance.switchEffect();break;case"vibrate":alien.SoundManager.instance.switchVibrate();break;case"report":""==this.labWxService.text&&(this.labWxService.text=alien.StringUtils.format(lang.wx_service,GameConfig.wxService)),this.labWxService.visible=!0,this.grpButton.visible=!1;break;case"help":""==this.labGz.text&&(this.labGz.textFlow=(new egret.HtmlTextParser).parser(lang.ddz_gz)),this.grpGz.visible=!0,this.grpButton.visible=!1}},e.prototype.onBtnCloseTap=function(t){this.labWxService.visible?(this.labWxService.visible=!1,this.grpButton.visible=!0):this.grpGz.visible?(this.grpGz.visible=!1,this.grpButton.visible=!0):this.dealAction()},e.prototype.show=function(){this.popup(this.dealAction.bind(this)),this.switchMusic.selected=!alien.SoundManager.instance.musicMute,this.switchEffect.selected=!alien.SoundManager.instance.effectMute,this.switchVibrate.selected=!alien.SoundManager.instance.vibrateMute,this.btnLogout.enabled=!server.playing,this.labWxService.visible=!1,this.grpGz.visible=!1,this.grpButton.visible=!0},e}(alien.PanelBase);__reflect(PanelSetting.prototype,"PanelSetting");var PanelShare=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelShareSkin},Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},e.prototype.onTap=function(t){this.parent&&this.close()},e.prototype.show=function(){this.popup()},e.prototype.showInviteFriend=function(){this.desc_img.source="room_share2",this.show()},e.prototype.sendGameToFriend=function(){this.desc_img.source="room_share1",this.show()},e}(alien.PanelBase);__reflect(PanelShare.prototype,"PanelShare");var PanelSign=function(t){function e(){return t.call(this,alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backOut},alien.popupEffect.Scale,{withFade:!1,ease:egret.Ease.backIn})||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelSign,this._signCount=0},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initDefaut(),this._initEvent()},e.prototype._initDefaut=function(){for(var t=MainLogic.instance.selfData.getNationalGetLoginRewDay(),e=null,n=1;8>n;++n)e=this["state"+n+"_img"],t>=n?e.visible=!0:e.visible=!1},e.prototype._initEvent=function(){this.getRew_img.addClickListener(this._onClickGetRew,this),this.close_img.addClickListener(this._onClickClose,this),this._enableEvent(!0);var t=alien.EventManager.instance;t.registerOnObject(this,alien.Dispatcher,EventNames.NATIONAL_INFO_CHANGE,this._updateByGetRewRep,this)},e.prototype._onClickClose=function(){this.dealAction()},e.prototype._onAddToStage=function(){EventManager.instance.enableOnObject(this)},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),alien.EventManager.instance.disableOnObject(this),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),server[e](EventNames.USER_DAY_SIGN_IN_REP,this._onSignInRep,this),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this)},e.prototype._onSignInRep=function(t){var e=t.data,n=MainLogic.instance.selfData;switch(1==e.today&&n.setTodaySigned(!0),e.optype){case 1:this._signCount=e.total_day||0,this._updateSignInfo();break;case 2:if(0==e.result){var i=this._signCount;n.setTodaySigned(!0),this._signCount++,n.signSuccSubSignAddRemin(),BagService.instance.refreshBagInfo(),this._updateSignInfo(),this._showGetSuccByIdx(i),alien.Dispatcher.dispatch(EventNames.GOLD_RAIN_EFFECT)}}},e.prototype._onClickGetRew=function(t){server.getSignReward()},e.prototype._updateByGetRewRep=function(){for(var t=this._signCount,e=1;t>=e;++e)this["state"+e+"_img"].visible=!0},e.prototype._updateSignInfo=function(){var t=GameConfig.signInRewardConfig;if(this._signCount<=t.length)for(var e=0;e<this._signCount;++e)this["state"+(e+1)+"_img"].visible=!0;this._initTodayGet()},e.prototype._initTodayGet=function(){var t=MainLogic.instance.selfData.isTodayHasSign();t||this._signCount>=7?(this.getRew_img.source="room_getGray",this.getRew_img.touchEnabled=!1):(this.getRew_img.source="room_get",this.getRew_img.touchEnabled=!0)},e.prototype._showGetSuccByIdx=function(t){var e=GameConfig.signInRewardConfig;if(t>=0&&e&&t<e.length){var n=e[t][0];PanelGetItems.instance.show(n)}},e.prototype._initItemInfo=function(){for(var t=GameConfig.signInRewardConfig,e=0;e<t.length;++e){for(var n=t[e],i="",o=0;o<n.length;++o)i=n[o].count,2==n[o].id?i=n[o].count>=24?n[o].count/24+"":n[o].count+"":0==n[o].id&&alien.Native.instance.isNative&&(i=""+1.5*n[o].count),this["itemNum"+e+"_"+o+"label"].text=i;this["state"+(e+1)+"_img"].visible=!1}},e.prototype.show=function(){this.popup(),this._initItemInfo(),server.getSignInInfo()},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelSign.prototype,"PanelSign");var PanelThanksgiving=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelThanksgivingSkin,this._signInfo=[0,0,0],this._buyCount=0
},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initEvent(),this._initUI()},e.prototype._initEvent=function(){this._enableEvent(!0),this.buyImg.addClickListener(this._onClickBuyImg,this),this.getImg.addClickListener(this._onClickGetImg,this),server.addEventListener(EventNames.USER_OPERATE_REP,this._onRecvUserOperateRep,this),server.addEventListener(EventNames.USER_RECHARGE_RESULT_NOTIFY,this._onRechargeResultNotify,this)},e.prototype._onRechargeResultNotify=function(t){var e=t.data;if(0==e.result){var n=e.productid;(10018==n||10019==n||10020==n)&&(this._buyCount+=1,this._initBuy())}},e.prototype._onRecvUserOperateRep=function(t){var e=t.data;if(4==e.optype)null==e.result&&e.params&&e.params.length>=6&&(this._buyCount=e.params[0],this._todaySign=e.params[1],this._signInfo=e.params.slice(3),this._initSignInfo(),this._initBuy());else if(6==e.optype&&null==e.result){this._signInfo[e.params[0]-1]=1;for(var n=0;n<this._signInfo.length;++n)1!=this._signInfo[n]&&n<e.params[0]-1&&(this._signInfo[n]=2);this._tipGetSignRewSucc(),this._todaySign=1,this._initSignInfo()}},e.prototype._tipGetSignRewSucc=function(){Alert.show("")},e.prototype._initUI=function(){this.buyImg.setTit("thanks_buy"),this.buyImg.setDisable(),this.getImg.setDisable()},e.prototype._onClickBuyImg=function(){var t="10018";this._buyCount<1?t="10018":this._buyCount<3?t="10019":this._buyCount<6&&(t="10020"),RechargeService.instance.doRecharge(t)},e.prototype._onClickGetImg=function(){server.reqThanksSign()},e.prototype._setBuyPro=function(t){this.buyProLabel.text=t},e.prototype._initBuy=function(){this._setBuyPro(this._buyCount+"/6"),this._buyCount>=6?this.buyImg.setDisable():this.buyImg.setEnable()},e.prototype._initSignInfo=function(){1==this._todaySign?this.getImg.setDisable():this.getImg.setEnable();for(var t=0;t<this._signInfo.length;++t)1==this._signInfo[t]?(this["get"+t+"Img"].visible=!0,this["get"+t+"Img"].source="thanks_r"):0==this._signInfo[t]?this["get"+t+"Img"].visible=!1:(this["get"+t+"Img"].visible=!0,this["get"+t+"Img"].source="thanks_w")},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelThanksgiving.prototype,"PanelThanksgiving");var PanelWatchWX=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.skinName=panels.PanelWatchWX},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._initUI(),this._initEvent()},e.prototype._initEvent=function(){this._enableEvent(!0),this.watchImg.addClickListener(this._onClickWatch,this)},e.prototype._onClickWatch=function(){PanelFollowCourse.instance.show()},e.prototype._initUI=function(){},e.prototype._onTouchClose=function(){this.dealAction()},e.prototype._onRemovedToStage=function(){this._enableEvent(!1),e._instance=null},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.remove=function(){e._instance&&e._instance.close()},e}(alien.PanelBase);__reflect(PanelWatchWX.prototype,"PanelWatchWX");var SceneCommon=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.SceneCommonSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),GameConfig.DEBUG&&alien.Dispatcher.addEventListener(EventNames.LOG,this.onLog,this),alien.Dispatcher.addEventListener(EventNames.SHOW_TOP_NOTIFY,this.onShowTopNotify,this),alien.Dispatcher.addEventListener(EventNames.HIDE_TOP_NOTIFY,this.onHideTopNotify,this),this.labVersion.text="v:"+this.makeVersionString(version),this.grpTopNotify.y=-50},e.prototype.makeVersionString=function(t){var e=t;return alien.Native.instance.isNative&&(e+="iOS"==egret.Capabilities.os?"i":"Android"==egret.Capabilities.os?"a":"n"),e},e.prototype.onShowTopNotify=function(t){var e=t.data;this.grpTopNotify.visible=!0,"string"==typeof e.content?this.labTopNotify.text=e.content:e.content(this.labTopNotify),this.btnTopNotify.visible=e.showButton,e.showButton&&this.btnTopNotify.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTopNotifyTap.bind(this,e.onTap),this);var n=egret.Tween.get(this.grpTopNotify,null,null,!0).to({y:0},200);e.delay&&e.delay>0&&n.wait(e.delay).call(this.hideTopNotify,this)},e.prototype.onHideTopNotify=function(t){this.hideTopNotify()},e.prototype.hideTopNotify=function(){egret.Tween.get(this.grpTopNotify,null,null,!0).to({y:-this.grpTopNotify.height},200),this.btnTopNotify.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTopNotifyTap,this)},e.prototype.onBtnTopNotifyTap=function(t,e){this.hideTopNotify(),t&&t()},e.prototype.onLog=function(t){this.labLog.appendText(t.data+"\n");var e=this.scroller.viewport;e.scrollV=this.labLog.height-e.height},e.prototype.beforeShow=function(t){},e}(alien.SceneBase);__reflect(SceneCommon.prototype,"SceneCommon");var SceneEffect=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.SceneEffectSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),alien.Dispatcher.addEventListener(EventNames.GOLD_RAIN_EFFECT,this.onGoldRainEffect,this)},e.prototype.onGoldRainEffect=function(t){this.goldRainEffectLayer.play()},e.prototype.beforeShow=function(t){},e}(alien.SceneBase);__reflect(SceneEffect.prototype,"SceneEffect");var SceneLoading=function(t){function e(){var e=t.call(this)||this;return e.skinName=scenes.SceneLoadingSkin,e}return __extends(e,t),e.setLoadingText=function(t){e._instance&&e._instance.setDescText(t)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),e._instance=this,this.showCopyRight(!1)},e.prototype.showCopyRight=function(t){this.copyRightImg.visible=t,this.noticeImg.visible=t},e.prototype.setDescText=function(t){this.descLabel.text=t},e.prototype.resetDesc=function(){this.setDescText("...")},e.prototype.beforeShow=function(t){this.showCopyRight(t.showCopyRight||!1)},e.prototype.onHide=function(){},e}(alien.SceneBase);__reflect(SceneLoading.prototype,"SceneLoading");var SceneManager=alien.SceneManager,SceneLogin=function(t){function e(){var e=t.call(this)||this;return e._loginData={uid:0,token:""},e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.SceneLoginSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=alien.EventManager.instance;alien.Dispatcher.addEventListener(EventNames.LOGIN_SUCCESS,this._onLoginSuccess,this),e.registerOnObject(this,this.grpSelectButton,egret.TouchEvent.TOUCH_TAP,this.onGrpSelectButtonTap,this),this.initBtnsByChannel()},e.prototype.initBtnsByChannel=function(){var t=alien.Native.instance;t.isNative?this.currentState="justWx":"true"==lang.debug?this.currentState="all":t.isWXMP||t.isAli()?this.grpSelectButton.visible=!1:this.currentState="justPhone"},e.prototype._openNewWindow=function(t,e,n,i){var o=null,a=(window.screen.availHeight-30-i)/2,r=(window.screen.availWidth-10-n)/2;o=window.open(t,e,"height="+i+",innerHeight="+i+",width="+n+",innerWidth="+n+",top="+a+",left="+r+",status=no,toolbar=no,menubar=no,location=no,resizable=no,scrollbars=0,titlebar=no")},e.prototype.onGrpSelectButtonTap=function(t){_nativeBridge.isNative&&(this.waitTimeOut=setTimeout(function(){alien.Dispatcher.dispatch(EventNames.HIDE_WAITING)},15e3));var e=LoginService.instance;switch(t.target.name){case"quick":webService.fastLogin(e.onVerifyResponse.bind(e));break;case"input":PanelLogin.instance.show(this.onPanelLoginResult.bind(this));break;case"weixin":_nativeBridge.isNative?LoginService.instance.doAppWxLogin():window.top.openWXQRCode();break;case"phone":PanelPhoneLogin.getInstance().show()}},e.prototype.onPanelLoginResult=function(t,e){var n=LoginService.instance;switch(t){case"close":break;case"confirm":webService.login(e.id,e.password,n.onVerifyResponse.bind(n))}},e.prototype._onLoginSuccess=function(){PanelLogin.instance.close()},e.prototype.beforeShow=function(t){webService.loadLog(1,0),alien.EventManager.instance.enableOnObject(this),alien.Native.instance.isWXMP||LoginService.instance.checkLocalToken()},e.prototype.onShow=function(t){},e.prototype.beforeHide=function(){this.waitTimeOut&&clearTimeout(this.waitTimeOut),alien.EventManager.instance.disableOnObject(this)},e}(alien.SceneBase);__reflect(SceneLogin.prototype,"SceneLogin");var SceneMostTop=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.SceneMostTopSkin,this._setHasAccountError(!1),this.grpWaiting.visible=!1},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._reconnectInterval=0,this.grpToast.visible=!1,this.grpDisconnect.visible=!1,alien.Dispatcher.addEventListener(EventNames.SHOW_WAITING,this.onShowWaiting,this),alien.Dispatcher.addEventListener(EventNames.HIDE_WAITING,this.onHideWaiting,this),alien.Dispatcher.addEventListener(EventNames.SHOW_DISCONNECT,this.onShowDisconnect,this),alien.Dispatcher.addEventListener(EventNames.HIDE_DISCONNECT,this.onHideDisconnect,this),alien.Dispatcher.addEventListener(EventNames.LOGIN_SUCCESS,this._onLoginSuccess,this),alien.Dispatcher.addEventListener(EventNames.SHOW_TOAST,this.onShowToast,this),alien.Dispatcher.addEventListener(EventNames.ACCOUNT_ERROR,this._onAccountError,this),this.btnReconnect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnReconnectTap,this),server.addEventListener(EventNames.USER_LOGIN_RESPONSE,this._onLoginResponse,this),alien.Dispatcher.addEventListener(EventNames.HIDE_MOSTTOP_TIP,this._onClearAllTip,this)},e.prototype.onShowWaiting=function(t){this.grpWaiting.visible=!0,this.loading.play(),this.labLoadingTip.text=t.data?t.data.content:""},e.prototype.onHideWaiting=function(t){this.grpWaiting.visible=!1,this.loading.stop()},e.prototype.onShowToast=function(t){this.grpToast.visible=!0,this.labToast.text=t.data.content,this.labToast.textColor=t.data.color>=0?t.data.color:15527148,egret.Tween.get(this.grpToast,null,null,!0).to({alpha:1},200).wait(t.data.delay||1e3).to({alpha:0},200)},e.prototype._clearReconnectInterval=function(){0!=this._reconnectInterval&&egret.clearInterval(this._reconnectInterval),this._reconnectInterval=0},e.prototype._setHasAccountError=function(t){this._bHasAccountErr=t},e.prototype._onLoginSuccess=function(){this._clearReconnectInterval(),this._hideAllGrp(),this._setHasAccountError(!1)},e.prototype._onLoginResponse=function(){this._clearReconnectInterval()},e.prototype._tryReconnect=function(){var t=0;this.btnReconnect.visible=!1,this.labDisconnect.text="",this._clearReconnectInterval();var e=function(){return t>=3?(this.grpDisconnect.visible=!0,this.btnReconnect.visible=!0,this.labDisconnect.text="",void this._clearReconnectInterval()):(t+=1,void LoginService.instance.doReconnect())}.bind(this);this._reconnectInterval=egret.setInterval(function(){e()},this,5e3),e()},e.prototype._onClearAllTip=function(){this._clearReconnectInterval(),this._hideAllGrp()},e.prototype._hideAllGrp=function(){this.grpToast.visible=!1,this.grpDisconnect.visible=!1,this.grpWaiting.visible=!1},e.prototype.onBtnReconnectTap=function(t){this.btnReconnect.visible=!1,this.btnReconnect.clickFunc&&this.btnReconnect.clickFunc()},e.prototype.onShowDisconnect=function(t){this._bHasAccountErr||(this.grpDisconnect.visible=!0,this.btnReconnect.visible=!0,this.grpToast.visible=!1,this.grpWaiting.visible=!1,this.labDisconnect.text=t.data.content,this.btnReconnect.label=t.data.button||lang.reconnect,alien.Native.instance.isNative&&(this.btnReconnect.visible=!1,egret.setTimeout(this._tryReconnect,this,1e3)),this.btnReconnect.clickFunc=this._tryReconnect.bind(this))},e.prototype._onAccountError=function(t){this._setHasAccountError(!0),this.grpDisconnect.visible=!0,this.btnReconnect.visible=!0,this.grpToast.visible=!1,this.grpWaiting.visible=!1,this.labDisconnect.text=t.data.content,this.btnReconnect.label=lang.confirm,this.btnReconnect.clickFunc=function(){this._hideAllGrp(),LoginService.instance.doRelogin()}.bind(this)},e.prototype.onHideDisconnect=function(t){this.grpDisconnect.visible=!1},e.prototype.beforeShow=function(t){},e}(alien.SceneBase);__reflect(SceneMostTop.prototype,"SceneMostTop");var ScenePlay=function(t){function e(){var e=t.call(this)||this;return e._askPlayCardCount=0,e._cache=[],e._seats=[],e.isPersonalGame=!1,e.remainCards=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e._curMatch9Play=1,e._lastTap={},e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.ScenePlaySkin,this._tfMatchPlayInfo=alien.Utils.parseColorTextFlow(lang.match_play_info)},e.prototype.initGuessCardsView=function(){this.grpGuessOp.y=-250,this.grpGuessOp.visible=!1,this.grpGuessResult.visible=!1,this.guessWrong.visible=!1,this.grpGuessRight.visible=!1,this.grpGRLight.visible=!1;for(var t=0;6>t;++t)this["GCGold"+t].visible=!1,this["GCGold"+t].goldNum=0,this.guesscount[t]=0;this.setGuessCardsMultiple([1.2,3,6,15,20,300]),this.lbGuessConsume.text=""+this._roomInfo.guessbet+""},e.prototype.createChildren=function(){this.guesscount=[0,0,0,0,0,0],this.percentWidth=100,this.percentHeight=100,t.prototype.createChildren.call(this),this._redNormalNum=-1,this._askDoubleTimeOutId=0,this._isOverFive=!1,this._isShowWZAni=!1,this.recorderBubble.visible=!1,this.cdProgressBar.stop(),this.gamestarted=!1,this.isowner=!1,this._mySeat=this.seat0,this._mySeat.width=alien.StageProxy.stage.stageWidth-20;for(var e=0;3>e;e++)this._seats[e]=this["seat"+e],this["labChange"+e].visible=!1;this.grpRedNotice.visible=!1,this.labWaiting.visible=!1,this.btnShare.visible=!1,this.redListDataArr=[1,1,1,1,1],this.redListDataProvider=new eui.ArrayCollection(this.redListDataArr),this.redList.itemRenderer=RedPacketProcess,this.redList.dataProvider=this.redListDataProvider,server.isMatch||this.isPersonalGame||this.dragonHongBao||(this.dragonHongBao=new DragonHongBao),this.dragonChunTian=new DragonGameChunTian,this.dragonWangZha=new DragonGameWangZha,this.dragonZhaDan=new DragonGameZhaDan,this.dragonFeiJi=new DragonGameFeiJi,this.dragonMyLianDui=new DragonGameLianDui(!1),this.dragonRightLianDui=new DragonGameLianDui(!1),this.dragonLeftLianDui=new DragonGameLianDui(!0),this.dragonMyShunZi=new DragonGameShunZi(!1),this.dragonRightShunZi=new DragonGameShunZi(!1),this.dragonLeftShunZi=new DragonGameShunZi(!0),this._mySeat.userInfoView.currentState="my";var n=alien.EventManager.instance;n.registerOnObject(this,server,EventNames.USER_RECONNECT_TABLE_REP,this.onReconnectTableRep,this),n.registerOnObject(this,server,EventNames.GAME_GIVE_UP_GAME_REP,this.onGiveUpGameRep,this),n.registerOnObject(this,server,EventNames.USER_ALMS_REP,this.onAlmsResponse,this),n.registerOnObject(this,server,EventNames.USER_QUICK_JOIN_RESPONSE,this.onQuickJoinResponse,this),n.registerOnObject(this,server,EventNames.GAME_USER_INFO_IN_GAME_REP,this.onUserInfoInGameResponse,this),n.registerOnObject(this,server,EventNames.GAME_GAME_START_NTF,this.onGameStart,this,1e3),n.registerOnObject(this,server,EventNames.GAME_RECONNECT_REP,this.onReconnectRep,this),n.registerOnObject(this,server,EventNames.GAME_ADD_CARD,this.onAddCard,this),n.registerOnObject(this,server,EventNames.GAME_USE_CARD_NTF,this.onUseCard,this),n.registerOnObject(this,server,EventNames.GAME_SET_CARDS,this.onSetCards,this),n.registerOnObject(this,server,EventNames.GAME_ASK_MASTER,this.onAskMaster,this),n.registerOnObject(this,server,EventNames.GAME_SET_SCORE,this.onSetScore,this),n.registerOnObject(this,server,EventNames.GAME_SHOW_CARD,this.onShowCard,this),n.registerOnObject(this,server,EventNames.GAME_TABLE_INFO,this.onTableInfo,this),n.registerOnObject(this,server,EventNames.GAME_USER_ONLINE,this._onUserOnline,this),n.registerOnObject(this,server,EventNames.GAME_USER_OFFLINE,this._onUserOffline,this),n.registerOnObject(this,server,EventNames.GAME_GAME_END,this.onGameEnd,this,1e3),n.registerOnObject(this,server,EventNames.GAME_OPERATE_REP,this.onOperateRep,this),n.registerOnObject(this,server,EventNames.USER_OPERATE_REP,this.onUserOperateRep,this),n.registerOnObject(this,server,EventNames.GAME_UPDATE_GAME_INFO,this.onUpdateGameInfo,this),n.registerOnObject(this,server,EventNames.GAME_ENTER_TABLE,this.onEnterTable,this),n.registerOnObject(this,server,EventNames.GAME_LEAVE_TABLE,this.onLeaveTable,this),n.registerOnObject(this,server,EventNames.GAME_ASK_READY,this.onAskReady,this),n.registerOnObject(this,server,EventNames.GAME_GET_READY_REP,this.onGetReadyRep,this),n.registerOnObject(this,server,EventNames.USER_FRESH_MAN_REDCOIN_LOTTERY_CHANCEGOT,this.onFreshManRedcoinLotteryChanceGot,this),n.registerOnObject(this,server,EventNames.USER_LOTTERY_RED_COIN_REP,this.onLotteryRedCoinRep,this),n.registerOnObject(this,this.buttonBar,EventNames.BUTTON_BAR_TAP,this.onButtonBarTap,this),n.registerOnObject(this,this.grpButton,egret.TouchEvent.TOUCH_TAP,this.onGrpButtonTap,this),n.registerOnObject(this,alien.Dispatcher,EventNames.SELECT_CARDS,this.onSelectCards,this),n.registerOnObject(this,this.grpBg,egret.TouchEvent.TOUCH_TAP,this.onTap,this),n.registerOnObject(this,alien.Dispatcher,EventNames.SHOW_GAME_EFFECT,this.onShowGameEffect,this),n.registerOnObject(this,server,EventNames.QUIT_PGAME_REP,this.onQuitRoomRep,this),n.registerOnObject(this,this.seat0.userInfoView.gold,egret.TouchEvent.TOUCH_TAP,this._onClickGold,this),n.registerOnObject(this,this.seat0.userInfoView.diamond,egret.TouchEvent.TOUCH_TAP,this._onClickDiamond,this),n.registerOnObject(this,server,EventNames.GAME_DISSOLVE,this.onGameDissolve,this),n.registerOnObject(this,server,EventNames.START_PGAME_REP,this.onStartGameRep,this),n.registerOnObject(this,server,EventNames.QUERY_ROOMINFO_REP,this.onPGameRoomInfoRep,this),n.registerOnObject(this,server,EventNames.USER_DiamondGame_REP,this.onRedNormalMoneyInfoRep,this),n.registerOnObject(this,this.btnShare,egret.TouchEvent.TOUCH_TAP,this.onShare,this),n.registerOnObject(this,this.btnStart,egret.TouchEvent.TOUCH_TAP,this.onStart,this),n.registerOnObject(this,this._mySeat.redBgImg,egret.TouchEvent.TOUCH_TAP,this.onGrpRedcoinClick,this),n.registerOnObject(this,this._mySeat.redExchangeImg,egret.TouchEvent.TOUCH_TAP,this._onClickExchageRed,this),n.registerOnObject(this,this.grpGuessCards,egret.TouchEvent.TOUCH_TAP,this.onCloseGrpGuessOp,this),n.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this.myUserinfoUpdate,this),n.registerOnObject(this,alien.Dispatcher,EventNames.USER_RED_COUNT_CHANGE,this._onUserRedCountChange,this),n.registerOnObject(this,alien.Dispatcher,EventNames.HORN_TALK_RECORDS_CHANGE,this._onHornRecChange,this),n.registerOnObject(this,alien.Dispatcher,EventNames.BAG_INFO_REFRESH,this._onBagRefresh,this),n.registerOnObject(this,alien.Dispatcher,EventNames.CLOSE_REVIVE_PANEL,this._onCloseRevivePanel,this),n.registerOnObject(this,alien.Dispatcher,EventNames.BUY_REVIVE_SUCC,this._onBuyReviveSucc,this),n.registerOnObject(this,server,EventNames.USER_MatchOperate_REP,this._onRecvMatchOperateRep,this),this._mySeat.grpRecorder.visible=!1,this.grpGuessOp.y=-250,this.grpGuessOp.visible=!1,this.grpGuessResult.visible=!1,this.guessWrong.visible=!1,this.grpGuessRight.visible=!1,this.grpGRLight.visible=!1;for(var i=0;6>i;++i)this["GCGold"+i].visible=!1,this["GCGold"+i].goldNum=0,n.registerOnObject(this,this["guess_option"+i],egret.TouchEvent.TOUCH_TAP,this.onGuessOptionClick,this);this.btnRecord.visible=!0},e.prototype.setBeforeWincnt=function(){if(!server.isMatch&&!server.isPersonalGame&&(this.beforewincnt=0,MainLogic.instance.selfData.wincnt&&MainLogic.instance.selfData.wincnt.length))for(var t=0;t<MainLogic.instance.selfData.wincnt.length;t++)if(MainLogic.instance.selfData.wincnt[t].roomid==this._roomInfo.roomID){this.beforewincnt=MainLogic.instance.selfData.wincnt[t].cnt;break}},e.prototype._onUserOnline=function(t){var e=t.data;if(e&&e.seatid){var n=this.getSeatById(e.seatid);n&&n.setUserOffline(!1)}},e.prototype._onUserOffline=function(t){var e=t.data;if(e&&e.uid){var n=this.getSeatByUId(e.uid);n&&n.setUserOffline(!0)}},e.prototype._initGeneralHeadImgTouch=function(t){this.seat1.setHeadTouch(t),this.seat2.setHeadTouch(t),this._mySeat.setHeadTouch(t)},e.prototype._onPlayBrowInfo=function(t,e,n){var i=this.getSeatById(t),o=this.getSeatById(e);if(i&&o&&n){var a=BrowData.createBrowMCById(n);if(!a)return;var r=new eui.Image("play_animate_star");this.grpMain.addChild(r),r.anchorOffsetX=.6*r.width,r.anchorOffsetY=.5*r.height;var s=i.getHeadCenterPos(),h=o.getHeadCenterPos(),c=new egret.Point(0,0),l=new egret.Point(0,0);this.grpMain.globalToLocal(s.x,s.y,c),this.grpMain.globalToLocal(h.x,h.y,l),this.grpMain.addChild(a),a.visible=!1,a.scaleX=2,a.scaleY=2;var u=BrowData.getBrowAniWHById(n);a.anchorOffsetX=.25*u.width,a.anchorOffsetY=.25*u.height,a.addEventListener(egret.Event.COMPLETE,function(t){var e=BrowData.getBrowAniLastStayById(n);e?egret.Tween.get(a).wait(1e3*e).call(function(){this.grpMain.removeChild(a)}.bind(this)):this.grpMain.removeChild(a)},this),egret.Tween.get(r).set({x:c.x,y:c.y}).to({x:l.x,y:l.y},500).wait(200).call(function(){this.grpMain.removeChild(r),a.visible=!0,BrowData.isNeedXMoveById(n)?(egret.Tween.get(a).set({x:l.x-100,y:l.y}).to({x:l.x+100,y:l.y},1e3).wait(200).call(function(){this.grpMain.removeChild(a)}.bind(this)),a.gotoAndPlay(1,-1)):(a.x=l.x,a.y=l.y,a.gotoAndPlay(1,1))}.bind(this))}},e.prototype.recorderBubbleAnimate=function(){egret.Tween.removeTweens(this.recorderBubble),this.recorderBubbleAnimateReal()},e.prototype.recorderBubbleAnimateReal=function(){egret.Tween.get(this.recorderBubble).set({visible:!0,loop:!0}).to({y:82},446).to({y:72},446).call(this.recorderBubbleAnimateReal,this)},e.prototype.refreshCardsRecorderAbout=function(){var t=MainLogic.instance.selfData,e=egret.localStorage.getItem("cardsrecorderexpirenotice");t.recorderfirstrewardgot?t.cardsRecorder.length<1||t.cardsRecorder[6]<=0?(egret.Tween.removeTweens(this.recorderBubble),this.recorderBubble.visible=!1,e||(this.recorderBubble.source="play_recorder_outofdate",this.recorderBubble.visible=!0,this.recorderBubbleAnimate()),this._mySeat.grpRecorder.visible=!1):(egret.Tween.removeTweens(this.recorderBubble),this.recorderBubble.visible=!1):(this.recorderBubble.source="play_recorder_gift",this.recorderBubbleAnimate(),this._mySeat.grpRecorder.visible=!1)},e.prototype._showRecorder=function(t){this._mySeat.grpRecorder.visible=t},e.prototype.myUserinfoUpdate=function(t){var e=MainLogic.instance.selfData;e.hasRecorder()&&(this.recorderBubble.visible&&(egret.Tween.removeTweens(this.recorderBubble),this._showRecorder(!1),"play_recorder_gift"==this.recorderBubble.source&&e.recorderfirstrewardgot&&ImgToast.instance.show(this,""),this._showRecorder(!0),egret.localStorage.setItem("opencardsrecorder","1")),(!this.beforerecorderTime||this.beforerecorderTime<=0)&&server.playing&&server.gameOperate(6)),this.refreshCardsRecorderAbout(),this.updateRedCoinInfo()},e.prototype.switchRecorder=function(t){var e=MainLogic.instance.selfData;e.recorderfirstrewardgot&&1==e.recorderfirstrewardgot?e.hasRecorder()?(this._mySeat.grpRecorder.visible=!this._mySeat.grpRecorder.visible,this._mySeat.grpRecorder.visible?egret.localStorage.setItem("opencardsrecorder","1"):egret.localStorage.removeItem("opencardsrecorder")):PanelBuyRecorder.instance.show():server.getCardsRecorderReward(),"play_recorder_outofdate"==this.recorderBubble.source&&this.recorderBubble.visible&&(egret.localStorage.setItem("cardsrecorderexpirenotice","1"),egret.Tween.removeTweens(this.recorderBubble),this.recorderBubble.visible=!1)},e.prototype.showGuessView=function(){egret.Tween.get(this.grpGuessOp).set({visible:!0,x:0,y:-250}).to({x:0,y:0},146),this.grpGuessCards.touchEnabled=!0},e.prototype.onBtnGuessClick=function(t){this.grpGuessOp.visible?this.onCloseGrpGuessOp(null):this.showGuessView()},e.prototype.onGuessOptionClick=function(t){var e=Number(t.currentTarget.name);this.guesscount[e]>=20?(ImgToast.instance.show(this,lang.guessCardsNotice[1]),ImgToast.instance.enableTouch(!1)):(server.reqUserGuessNextCard(this._roomInfo.roomID,e+1),t.stopImmediatePropagation())},e.prototype._checkHasRedCanExchange=function(){var t=!1,e=MainLogic.instance.selfData,n=GameConfig.exchangeConfig.filter(function(t){if(1==t.goodsid){if(t.first){var n=e.rcminexcexpiretime,i=(new Date).getTime(),o=e.rcminexcchanceused;return 1e3*n>i&&!o?!0:!1}return!0}return!1});n.sort(function(t,e){return t.amount-e.amount});for(var i=Math.ceil(e.redcoin)/100,o=n.length,a=0;a<n.length;++a)if(n[a].amount>i){o=a;break}return o>0&&(t=!0),t},e.prototype.updateRedCoinInfo=function(){var t=MainLogic.instance.selfData,e=GameConfig.exchangeConfig.filter(function(e){if(4==e.goodsid){if(e.first){var n=t.rcminexcexpiretime,i=(new Date).getTime(),o=t.rcminexcchanceused;return 1e3*n>i&&!o?!0:!1}return!0}return!1});e.sort(function(t,e){return t.amount-e.amount});for(var n=Math.ceil(t.redcoin)/100,i=e.length,o=0;o<e.length;++o)if(e[o].amount>n){i=o;break}0==i?(this.grprn2.visible=!1,this.grprn1.visible=!0,this.lbremain1.text=""+Math.floor(100*e[i].amount-100*n)/100,this.lbrmb1.text=e[i].amount):i>0&&i<=e.length&&(this.grprn2.visible=!0,this.grprn1.visible=!1,this.lbrmb2.text=e[i-1].amount),this._mySeat.setRedcoin(null==n?"0.00":Utils.exchangeRatio(n,!0),!0)},e.prototype._onClickExchageRed=function(){PanelExchange2.instance.show(2)},e.prototype._showExchangeRedAni=function(){egret.Tween.get(this.grpRedNotice).set({visible:!0,alpha:1}).wait(1e3).to({alpha:0},2e3)},e.prototype.onGrpRedcoinClick=function(t){return this._checkHasRedCanExchange()?void PanelExchange2.instance.show(2):void this._showExchangeRedAni()},e.prototype.onGameDissolve=function(t){var e=t.data;if(PanelPlayerInfo.remove(),e.players&&e.players.length>0){for(var n=0;n<e.players.length;++n)e.players[n].nickname=Base64.decode(e.players[n].nickname);e.quitPlayer&&(e.quitPlayer=Base64.decode(e.quitPlayer),e.quitPlayer.length>8&&(e.quitPlayer=e.quitPlayer.substring(0,8))),PersonalDetail.instance.show(e.players,this.onAlertResult.bind(this,0),!0,e.quitPlayer)}else 2==e.reason&&Alert.show("",0,this.onAlertResult.bind(this,0))},e.prototype.onQuitRoomRep=function(t){var e=t.data;if(0==e.result)if(e.uid==server.uid)MainLogic.backToRoomScene();else if(server.playing){var n=this.getSeatByUId(e.uid);n&&n.setQuitFlagVisible(!0)}},e.prototype.onPGameRoomInfoRep=function(t){var e=t.data;this.setPGameView(e)},e.prototype.setStartPgameBtnVisible=function(t){this.btnStart.visible=t,this.imgStart.visible=t},e.prototype.onStartGameRep=function(t){var e=t.data;0!=e.result?PanelAlert.instance.show(""+e.result,0):(this.setStartPgameBtnVisible(!1),this.btnShare.visible=!1,this.gamestarted=!0)},e.prototype.onCloseGrpGuessOp=function(t){egret.Tween.get(this.grpGuessOp).set({visible:!0}).to({x:0,y:-250,visible:!1},146),this.grpGuessCards.touchEnabled=!1},e.prototype._justSetShareParams=function(){WxHelper.share(1,function(t){},[this.total_round,this.lbLimit.text,this.roomid])},e.prototype.onShare=function(t){this._justSetShareParams(),alien.Native.instance.isNative?WxHelper.shareForNative(1,null,[this.total_round,this.lbLimit.text,this.roomid]):PanelShare.instance.sendGameToFriend()},e.prototype.onStart=function(t){server.StartPGameReq(this.roomid)},e.prototype.addListeners=function(){server.isMatch&&MatchService.instance.addEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this),alien.EventManager.instance.enableOnObject(this),alien.Dispatcher.addEventListener(EventNames.SHOW_PAYCHAT,this.showLaba,this)},e.prototype.removeListeners=function(){server.isMatch&&MatchService.instance.removeEventListener(EventNames.USER_MATCH_INFO_NTF,this.onMatchInfoNtf,this),alien.EventManager.instance.disableOnObject(this),alien.Dispatcher.removeEventListener(EventNames.SHOW_PAYCHAT,this.showLaba,this)},e.prototype.showLaba=function(t){this.rollMsg.show()},e.prototype.onTap=function(t){var e=this._lastTap;(new Date).valueOf()-e.time<200&&alien.MathUtils.distance(e.x,e.y,t.stageX,t.stageY)<50&&(this.doubleTap(t),e=this._lastTap={}),e.x=t.stageX,e.y=t.stageY,e.time=(new Date).valueOf()},e.prototype.doubleTap=function(t){server.playing&&this._mySeat.cancelSelect()},e.prototype.initData=function(t){var e=this;void 0===t&&(t=!1),this.isPersonalGame?this._seats.forEach(function(t){t.initData({isMatch:!1,matchType:1})}):this._seats.forEach(function(n){var i={isMatch:server.isMatch,matchType:server.roomInfo.matchType,cleanUserInfo:!0,roomType:server.roomInfo.roomType,isSelf:!1};n==e._mySeat&&(i.isSelf=!0),t?(n==e._mySeat&&(i.cleanUserInfo=!1),n.initData(i)):n.initData(i)}),server.playing=!1,this.buttonBar.switchState("hidden"),this.btnContinue.visible=!1,this.btnHang.enabled=!1,this.labWaiting.visible=!1,this.masterCards.initData();for(var n=0;3>n;++n)this._seats[n].setOwnerFlagVisible(!1),this._seats[n].setQuitFlagVisible(!1),this["labChange"+n].visible=!1;this.flygoldindex=0},e.prototype.setGuessCardsMultiple=function(t){for(var e=0;e<t.length;++e)this["lbguess"+(e+1)].text="("+t[e]+")"},e.prototype._clearRecorderInfo=function(t){var e=t,n=t;4==t&&(n=1),this.remainCards=[e,e,e,e,e,e,e,e,e,e,e,e,e,n,n];for(var i=0;i<this.remainCards.length;++i)this._mySeat["lb"+(i+1)].text=this.remainCards[i],this._mySeat["lb"+(i+1)].textColor=10329501,4==e&&(this._mySeat["lb"+(i+1)].textColor=15169538);1==n&&(this._mySeat.lb14.textColor=5341696,this._mySeat.lb15.textColor=5341696)},e.prototype._setRecorderCardAndNum=function(t,e){var n=e;if(!(0>t||t>14||0>n)){0>n&&(n=0);var i=t,o=t+1;this.remainCards[i]=n,this._mySeat["lb"+o].text=n,4==n?this._mySeat["lb"+o].textColor=15169538:0==n?this._mySeat["lb"+o].textColor=10329501:this._mySeat["lb"+o].textColor=5341696}},e.prototype._subOneRecorderByCard=function(t){if(!(10>t||t>150)){var e=""+t,n=0;n=100>t?Number(e.substr(0,1)):Number(e.substr(0,2));var i=-1+n,o=this.remainCards[i];o+=-1,0>o&&(o=0),this._setRecorderCardAndNum(i,o)}},e.prototype._updateRecorderByCards=function(t){if(MainLogic.instance.selfData.hasRecorder()&&t&&t.length>0)for(var e=0;e<t.length;++e)this._subOneRecorderByCard(t[e])},e.prototype._setRecorderInfoByServerCard=function(t){if(t&&MainLogic.instance.selfData.hasRecorder()){this._clearRecorderInfo(4);for(var e=0;e<t.length;++e)this._subOneRecorderByCard(t[e])}},e.prototype._setRecorderInfoByServerNum=function(t){if(t&&15==t.length&&MainLogic.instance.selfData.hasRecorder()){this._clearRecorderInfo(0);for(var e=0;e<t.length;++e)this._setRecorderCardAndNum(e,t[e])}},e.prototype.newGame=function(){this._isOverFive=!1,this._isShowWZAni=!1,this.labWaiting.visible=!1,this._seats.forEach(function(t){t.reset(),t.setReady(!1)}),this._clearRecorderInfo(0);for(var t=0;3>t;t++)this["labChange"+t].visible=!1;server.playing=!0,this.btnContinue.visible=!1,this.btnHang.selected=!1,this.btnHang.enabled=!0,this.cdProgressBar.stop(),this.masterCards.initData(),server.roomInfo&&server.roomInfo.baseScore&&this.masterCards.updateScore(server.roomInfo.baseScore||0,1),alien.PopUpManager.instance.removeAllPupUp(),server.isMatch&&PanelMatchWaitingInner.instance.close(),egret.clearTimeout(this._timerClean),this._showResultTimeOutId&&egret.clearTimeout(this._showResultTimeOutId),this._showResultTimeOutId1&&egret.clearTimeout(this._showResultTimeOutId1),server.isMatch&&MainLogic.instance.alms(),server.isMatch||server.isPersonalGame||this.initGuessCardsView()},e.prototype.getRedCoinLackCnt=function(){var t=0;if(MainLogic.instance.selfData.wincnt&&MainLogic.instance.selfData.wincnt.length)for(var e=0;e<MainLogic.instance.selfData.wincnt.length;e++)if(MainLogic.instance.selfData.wincnt[e].roomid==this._roomInfo.roomID){var n=MainLogic.instance.selfData.wincnt[e].cnt;
n||(n=0),t=n%5;break}return 5-t},e.prototype.testFunction=function(){this.recorderBubble.visible=!0,this.recorderBubble.source="play_recorder_gift",this.myUserinfoUpdate(null)},e.prototype._onClickChat=function(){},e.prototype._closeChatList=function(){},e.prototype.onGrpButtonTap=function(t){switch(t.target.name){case"chat":return void this._onClickChat();case"setting":PanelSetting.instance.show();break;case"hang":server.hang(this.btnHang.selected);break;case"recorder":this.switchRecorder(null);break;case"back":server.isMatch?Alert.show(lang.match_cancel_alert,1,this.onAlertResult.bind(this,2)):this.isPersonalGame?Alert.show("",1,this.onAlertResult.bind(this,2)):server.playing?1e3==this._roomInfo.roomID?Alert.show(",",1,this.onAlertResult.bind(this,0)):Alert.show(alien.StringUtils.format(lang.backAlert,this.getRedCoinLackCnt()),1,this.onAlertResult.bind(this,0)):1e3==this._roomInfo.roomID?Alert.show("",1,this.onAlertResult.bind(this,0)):Alert.show(alien.StringUtils.format(lang.backAlert1,this.getRedCoinLackCnt()),1,this.onAlertResult.bind(this,0));break;case"continue":this._onClickReady();break;case"guessCards":this.grpGuessOp.visible?this.onCloseGrpGuessOp(null):(egret.Tween.get(this.grpGuessOp).set({visible:!0,x:0,y:-250}).to({x:0,y:0},146),this.grpGuessCards.touchEnabled=!0)}},e.prototype.sendQuickJoin=function(){if(this._onSendQuickJoin(),this._roomInfo&&1e3==this._roomInfo.roomID||this._roomInfo.style&&("diamond"==this._roomInfo.style||"queue"==this._roomInfo.style))return void server.quickJoin();var t=2e3;1001==this.roomid?t=1200:1002==this.roomid?t=1600:1002==this.roomid&&(t=2e3),t=Math.ceil(Math.random()*t+200),this._timerDelayJoin=egret.setTimeout(function(){server.quickJoin()},this,t)},e.prototype.test=function(){this.seat1.showJingDeng(),this.seat2.showJingDeng(),this.showDragonChunTian(),this.showDragonWangZha(),this.showDragonZhaDan(),this.showDragonFeiJi(),this.showDragonMyLianDui(),this.showDragonRightLianDui(),this.showDragonLeftLianDui(),this.showDragonMyShunZi(),this.showDragonLeftShunZi(),this.showDragonRightShunZi()},e.prototype.onButtonBarTap=function(t){switch(t.data.action){case"cancelSelect":this._mySeat.cancelSelect();break;case"pass":server.useCardNtf([]),this._mySeat.cancelSelect();break;case"use":var e=this._mySeat.getSelectPokerIds();server.useCardNtf(e);break;case"setScore":server.answerMaster(t.data.score),this.buttonBar.switchState("hidden");break;case"help":this._mySeat.help()||(server.useCardNtf([]),this._mySeat.cancelSelect(),this._mySeat.showNoMatchCards())}},e.prototype.onSelectCards=function(t){void 0===t&&(t=null),t&&(this._selectCardsCount=t.data.count),"useCard"==this.buttonBar.currentState&&this.buttonBar.modifyButton("cancelSelect",this._selectCardsCount>0),t&&(this._canUse=t.data.canUse),"useCard"==this.buttonBar.currentState&&this.buttonBar.modifyButton("use",this._canUse)},e.prototype.onBackResult=function(t){switch(t){case"confirm":MainLogic.backToRoomScene();break;case"cancel":}},e.prototype.onAlertResult=function(t,e){switch(e){case"confirm":switch(t){case 0:server.isMatch||server.isPersonalGame||server.playing||(1e3==this._roomInfo.roomID||1003==this._roomInfo.roomID||this._roomInfo.style&&("diamond"==this._roomInfo.style||"queue"==this._roomInfo.style)?server.QuitWaitingQueueReq():server.giveUpGame()),MainLogic.backToRoomScene();break;case 1:server.isMatch||server.isPersonalGame||(this.sendQuickJoin(),this.initData());break;case 2:this.isPersonalGame?server.QuitPGameReq(this.roomid):server.isMatch?100==this._roomInfo.matchId:server.playing&&server.giveUpGame(),MainLogic.backToRoomScene();break;case 3:PanelExchange2.instance.show()}break;case"cancel":}},e.prototype._onRecvMatchOperateRep=function(t){var e=t.data;if(e){if(1==e.optype)if(0==e.result)e.params&&e.params.length>=1&&this._mySeat.userInfoView.updateGold(e.params[0]),PanelMatchRevive.remove(),this._clearMatchReviveInterval(),egret.clearTimeout(this._timerClean),this.setlabWaiting(",,...");else{var n=(o={},o[3]="",o[4]="",o[5]="",o[7]="",o[8]="",o),i="";n[e.result]&&(i=n[e.result]),Alert.show(i,0,function(){this._onMatchReviveTimeOut(e)}.bind(this))}var o}},e.prototype.onQuickJoinResponse=function(t){var e=t.data;switch(e.result){case 0:console.log("join success."),this.hideDeskCards();break;case 1:console.log("join failed.");break;case 2:if(1e3==this._roomInfo.roomID)return void MainLogic.instance.noDiamondGetNewDiamondRewOrBuyRevive(this._roomInfo.minScore);PanelRechargeTips.instance.show(this.onAlertResult.bind(this,0)),server.playing||(this._showNextMasterCardGuessBtn(!0),this.btnContinue.visible=!0);break;case 3:Alert.show(lang.no_more_desk,0,this.onAlertResult.bind(this,0));break;case 4:console.log("join failed.");break;case 7:Alert.show("",0,function(){MainLogic.backToRoomScene()})}},e.prototype.hideDeskCards=function(){this._seats.forEach(function(t){t.cleanDesk()})},e.prototype.onReconnectTableRep=function(t){var e=t.data;0!=e.result&&(1==e.result||2==e.result)&&MainLogic.backToRoomScene()},e.prototype.onGiveUpGameRep=function(t){var e=t.data;switch(e.result){case 0:console.log("give up game success."),MainLogic.backToRoomScene({roomInfo:this._roomInfo});break;case 1:console.log("give up game failed.")}},e.prototype.onUserInfoInGameResponse=function(t){var e=t.data,n=MainLogic.instance.selfData;e.uid==n.uid&&e.gameprop>=0&&n.setFreeBrowCount(e.gameprop);var i=this.getSeatByUId(e.uid);i&&(e.offline?i.setUserOffline(!0):i.setUserOffline(!1),1e3==this._roomInfo.roomID?(i.updateUserInfoData(e),i==this._mySeat?(i.userInfoView.updateGold(e.gold),e.diamond&&this._setDiamondUI(e.diamond)):e.diamond&&i.userInfoView.updateGold(e.diamond)):server.isMatch?(e.nickname="",i.isMaster?e.imageid="icon_head9":e.imageid="icon_head10",i==this._mySeat?(i.userInfoData.initData(e),i.userInfoView.updateGold(e.gold),i.userInfoView.updateHeadImage(e.imageid)):i.updateUserInfoData(e)):(this.setRedProcess(),i.updateUserInfoData(e)))},e.prototype.redNormalSubDiamond=function(){},e.prototype.onGameStart=function(t){var e=this,n=t.data;this.beforeGameStart(),this._reconnectIn=!1,this._showMatch9WaitOtherPlayerOver(!1),this.playersSeatDown(n.playerinfo),this._cache.length>0&&(this._cache.forEach(function(t){t.method.call(e)}),this._cache.splice(0)),this.isPersonalGame?this.lbRound.text=String(this.cur_round)+"/"+String(this.total_round):server.isMatch||this.isPersonalGame||(this.setRedCoin(),this.setBeforeWincnt()),n.cardsrecorderremain&&MainLogic.instance.selfData.cardsRecorder&&(MainLogic.instance.selfData.cardsRecorder[6]=n.cardsrecorderremain,this.refreshCardsRecorderAbout()),this._showNextMasterCardGuessBtn(!1)},e.prototype._shouldTipRedNormalRule=function(){var t=alien.localStorage.getItem("redNormalRule");"1"!=t&&(this._showRedNormalRule(),alien.localStorage.setItem("redNormalRule","1"))},e.prototype.setRedCoin=function(){if(1!=MainLogic.instance.selfData.freshmanredcoinsent){var t=alien.localStorage.getItem("freshmanredcoinsent");"1"==t?this.showRedcoinDragon(!1):1e3!=this._roomInfo.roomID&&(server.startCache(),this.showRedcoinDragon(!0))}},e.prototype.onReconnectRep=function(t){var e=this;this.labWaiting.visible=!1;var n=t.data;this._reconnectIn=!0,this.beforeGameStart(),this.playersSeatDown(n.players),this._mySeat.addCards(n.params1,!this._reconnectIn),n.players.forEach(function(t){var n=e.getSeatById(t.seatid);if(n.setHang(1==t.params[1]),server.isMatch){var i={imageid:"icon_head10",nickname:""};n.userInfoView.update(i)}1==t.params[2]&&n.setUserOffline(!0),2==t.params[3]&&n.showDoubleFlag(!0),e._mySeat.seatid!=n.seatid&&n.setCardCount(t.params[0])});var i=[],o=n.params2.length;if(n.params2[o-1]>0){for(var a=o-1;a>=o-3;a--)i.unshift(n.params2[a]);this.showMasterCards(i,!0)}if(null!=n.mastersid&&n.mastersid>=0){var r=this.getSeatById(n.mastersid);r.setMaster(!0,!1)}if(server.isMatch||this.isPersonalGame||(this.setBeforeWincnt(),this.setRedCoin()),server.hang(!1),n.params3)for(var s=0;s<n.params3.length;++s)n.params3[s]&&this.setGCGold(s,n.params3[s]);if(n.params4&&this._setRecorderInfoByServerNum(n.params4),this.autoOpenRecorder(),BagService.instance.refreshBagInfo(),1==n.status||2==n.status){if(1==n.status){var h=new egret.Event("reconnect");h.data={seatid:n.cursid,time:n.time},this.onAskMaster(h)}else if(2==n.status){var c=-1,l=n.params2.slice(0,n.params2.length-3);if(n.params2.length>0){var u=this.getSeatById(n.presid);c=u.useCard(l,!1,!1)}this.onAskPlayCard({cardType:c,cardids:l,pseatid:n.presid,seatid:n.cursid,time:n.time})}}else{var p=n.params5[0];if(!p)return;var d=n.params5[1],_=this.getSeatById(p);_.setMaster(!0,!1),this.masterCards.updateScore(n.params5[0],d)}},e.prototype.showMasterCards=function(t,e){this.masterCards.showCards(t,e),this._seats.forEach(function(t){t.hideScore()})},e.prototype.playersSeatDown=function(t){var e=this;t.some(function(t){return t.uid==server.uid?(server.seatid=t.seatid,!0):void 0}),t.forEach(function(t){e.playerSeatDown(t)})},e.prototype.beforeGameStart=function(){this.newGame(),this._askPlayCardCount=0,server.isMatch&&this.updateMathTurnInfo()},e.prototype.onTableInfo=function(t){for(var e=t.data,n=0;n<e.players.length;++n)this.playerSeatDown(e.players[n])},e.prototype.onEnterTable=function(t){var e=t.data;this.playerSeatDown(e),this.hideDeskCards(),server.isPersonalGame&&this.setShareStart()},e.prototype.setlabWaiting=function(t){void 0===t&&(t=null),t?(this.labWaiting.text=t,this.labWaiting.visible=!0):this.labWaiting.visible=!1},e.prototype.setShareStart=function(){if(this.gamestarted)this.btnShare.visible=!1,this.setStartPgameBtnVisible(!1);else{var t=this.getPlayersAmount();t>=3?(this.btnShare.visible=!1,this.isowner?this.setStartPgameBtnVisible(!0):this.setlabWaiting("")):(this.setlabWaiting("ID:"+this.roomid),this.isowner&&this.setStartPgameBtnVisible(!1),this.btnShare.visible=!0,this.setStartPgameBtnVisible(!1))}},e.prototype.onLeaveTable=function(t){var e=t.data;if(e.uid==server.uid)switch(e.reason){case 0:case 1:case 2:case 3:server.isMatch||server.isPersonalGame||this.playerStandUp(e.uid);break;case 4:}else this.playerStandUp(e.uid);this.isPersonalGame&&this.setShareStart()},e.prototype.onAskReady=function(t){var e=t.data;this.cdProgressBar.play(e.time)},e.prototype.onGetReadyRep=function(t){var e=t.data,n=this.getSeatById(e.seatid);n.userInfoData.uid==server.uid&&this.cdProgressBar.stop(),n.setReady(!0)},e.prototype.onAskMaster=function(t){var e=t.data;this._mySeat.seatid==e.seatid?this.buttonBar.switchState("askMaster",e.score):this.buttonBar.switchState("hidden");var n=this.getSeatById(e.seatid);n&&n.startCD(e.time)},e.prototype.autoOpenRecorder=function(){var t=egret.localStorage.getItem("opencardsrecorder"),e=MainLogic.instance.selfData;e.hasRecorder()&&"1"==t&&this._showRecorder(!0)},e.prototype.onSetScore=function(t){var e=t.data,n=this.getSeatById(e.seatid);if(n&&(e.ismaster?(n.setMaster(e.ismaster,!this._reconnectIn),server.isMatch&&(e.imageid="icon_head9",e.nickname="",n==this._mySeat&&(e.uid=MainLogic.instance.selfData.uid),n.userInfoView.update(e)),this.autoOpenRecorder()):this._mySeat.seatid==e.seatid&&this.buttonBar.switchState("hidden"),e.score>0&&this.masterCards.updateMultiple(e.score),n.stopCD(),n.showScore(e.ismaster?-1:e.score),e.ismaster&&!server.isPersonalGame&&!server.isMatch&&1e3!=this._roomInfo.roomID)){this._showDoubleNoDouble(!0),this.doubleCost_label.text="x"+this._roomInfo.doublediamond;var i=this._checkShowFailDouble();this._doubleRet=i,i.bShow?this._showFailDouble(!0,i.nReason):this._showFailDouble(!1),this._mySeat.startCD(5),this._clearAskDoubleTimeOut(),this._askDoubleTimeOutId=egret.setTimeout(this._onMyAskDoubleTimeOut,this,5e3)}},e.prototype._clearAskDoubleTimeOut=function(){0!=this._askDoubleTimeOutId&&egret.clearTimeout(this._askDoubleTimeOutId),this._askDoubleTimeOutId=0},e.prototype.onAddCard=function(t){var e=t.data;if(server.isMatch&&e.reshufflecnt&&e.reshufflecnt>0)for(var n=0;3>n;++n){var i=this.getSeatById(n+1);i.updateGold(-100,server.isMatch)}this._mySeat.cancelSelect(),this._setRecorderInfoByServerCard(e.cardids),server.playing?this.addCard(e):(this._cache.splice(0),this._cache.push({method:this.addCard.bind(this,e)}))},e.prototype.addCard=function(t){var e=this.getSeatById(t.seatid);e.addCards(t.cardids,!0,!0),this.seat1.addCards([]),this.seat2.addCards([])},e.prototype.onUseCard=function(t){var e=t.data,n=this.getSeatById(e.seatid),i=-1;if(n&&(n.cleanDesk(),i=n.useCard(e.cardids),n.stopCD()),this._mySeat.seatid==e.seatid?(this.buttonBar.switchState("hidden"),this._mySeat.cancelSelect(),this._mySeat.hideNoMathCards(),this._mySeat.checkType([])):this._updateRecorderByCards(e.cardids),e.time&&e.cursid){var o=e.seatid;e.lastseatid==this._mySeat.seatid&&(o=0),this.onAskPlayCard({cardType:i,cardids:e.lastcards,pseatid:o,time:e.time,seatid:e.cursid})}},e.prototype.onSetCards=function(t){var e=t.data,n=this.getSeatById(e.seatid);n&&e.seatid!=server.seatid&&n.useCard(e.cardids,!0)},e.prototype.getGuessCardsType=function(t){if(!t||3!=t.length)return 0;t.sort(function(t,e){return t-e});var e=!0,n=!0,i=!1,o=!1,a=!1,r=!1;t.forEach(function(t,i){(140==t||150==t)&&(a=!0,n=e=!1),o||9!=Math.floor(t/10)&&10!=Math.floor(t/10)&&11!=Math.floor(t/10)||(o=!0),r||13!=Math.floor(t/10)||(r=!0)});for(var s=1;3>s;++s){Math.floor(t[s]/10);Math.floor(t[s]/10)==Math.floor(t[s-1]/10)&&(i=!0),a||(Math.floor(t[s]/10)-Math.floor(t[s-1]/10)!=1&&(e=!1),t[s]%10!=t[s-1]%10&&(n=!1))}return r&&e&&(e=!1),e||(1==Math.floor(t[0]/10)&&12==Math.floor(t[1]/10)&&13==Math.floor(t[2]/10)||1==Math.floor(t[0]/10)&&2==Math.floor(t[1]/10)&&13==Math.floor(t[2]/10))&&(e=!0),e&&n?6:e?5:n?4:a?3:i?2:o?1:0},e.prototype.setGCGold=function(t,e){0>t||t>5||!e||0>e||(++this.guesscount[t],this["GCGold"+t].goldNum+=e,this["GCGold"+t].visible=!0,this["GCGold"+t].setData(this["GCGold"+t].goldNum),this._mySeat.userInfoView.updateGold(MainLogic.instance.selfData.gold))},e.prototype.hideGuessRight=function(){this.grpGuessRight.visible=!1,this.grpGRLight.visible=!1},e.prototype.goldfly=function(t,e,n,i,o){for(var a=this.flygoldindex;a<this.flygoldindex+5;++a)egret.setTimeout(this["flygold"+a].fly,this["flygold"+a],70*(a-this.flygoldindex),e,n,i,o,700);this.flygoldindex+=5,egret.setTimeout(this.hideGuessRight,this,2800)},e.prototype.playGuessRightAnimate=function(t,e){var n=this.getSeatById(t),i=n.getAvatarPos();if(n==this._mySeat)this.grpGuessRight.visible=!0,this.gwingold.text="x"+e,egret.Tween.get(this.gcgoldLight0).set({visible:!0,alpha:0,scaleX:.76,scaley:.55}).to({alpha:1,scaleX:3.16,scaley:1.6},146).to({alpha:0,scaleX:1.62,scaley:.22},292),egret.Tween.get(this.gcgoldLight1).set({visible:!0,alpha:0,scaleX:.76,scaley:.55}).wait(438).to({alpha:1,scaleX:3.16,scaley:1.6},146).to({alpha:0,scaleX:1.62,scaley:.22},292).call(this.goldfly,this,[n,this.grpGuessRight.x,this.grpGuessRight.y,i.x,i.y]);else{var o=this.localToGlobal(this.btnGuessCards.x,this.btnGuessCards.y);this.goldfly(n,o.x,o.y,i.x,i.y)}n&&(n!=this._mySeat?(n.playWinGoldAnimate(),this._roomInfo&&1e3!=this._roomInfo.roomID&&!server.isMatch&&n.updateGold(e)):server.isMatch||n.updateGold(e))},e.prototype.playGuessWrongAnimate=function(){egret.Tween.get(this.guessWrong).set({visible:!0,alpha:0}).to({alpha:1},146).wait(1e3).to({alpha:0,visible:!1},1e3)},e.prototype._onServerBrowRep=function(t){if(null==t.result){if(t.params&&3==t.params.length){var e=t.params[0],n=t.params[1],i=t.params[2],o=GameConfig.getBrowCfgById(i);if(o&&0==o.currency&&o.price&&e==this._mySeat.seatid){var a=MainLogic.instance.selfData.getFreeBrowCount();a>0?MainLogic.instance.selfData.addFreeBrowCount(-1):server.isMatch||this._mySeat.updateGold(-o.price,server.isMatch)}this._onPlayBrowInfo(e,n,i)}}else 3==t.result?(ImgToast.instance.show(this,lang.browNoGold),ImgToast.instance.enableTouch(!1)):LogUtil.info("_onServerBrowRep------------->error",t.result)},e.prototype._showGetDayShareRewSucc=function(){var t=GameConfig,e=t.getShareRewCfg();if(e){var n=null,i=1,o=":\n";for(var a in e)n=t.getItemNameById(parseInt(a)),n&&(o+=i+"."+n+"x"+e[a]+"\n");ShareImageManager.instance.stop(!0,o)}},e.prototype.onUserOperateRep=function(t){var e=t.data;if(3==e.optype)null!=e.result?ImgToast.instance.show(this,lang.guessCardsNotice[e.result-1]):this.setGCGold(e.params[0]-1,this._roomInfo.guessbet);else if(2==e.optype);else if(7==e.optype&&null==e.result){var n=Utils.parseGoodsString(e.str),i=Utils.goodsListToString(n);Alert.show(i)}},e.prototype.onOperateRep=function(t){var e=t.data;if(4==e.optype)e.params&&e.params[0]?this.playGuessRightAnimate(e.seatid,e.params[0]):this.playGuessWrongAnimate();else if(5==e.optype)this._onServerBrowRep(e);else if(6==e.optype)this.beforerecorderTime=MainLogic.instance.selfData.cardsRecorder[6],e.params&&(this._showRecorder(!0),this._setRecorderInfoByServerNum(e.params));else if(7==e.optype)this._onServerDoubleRep(e);else{var n=e.optype||0,i=this.getSeatById(e.seatid);i.setHang(1==n),this._mySeat.seatid==e.seatid&&(1==n&&this.double_group.visible&&this._onMyAskDoubleTimeOut(),this.btnHang.selected=1==n)}},e.prototype.setGuessCardsType=function(t){this.grpGuessResult.visible=!0,this.guessCardsType.source="guesscards_"+(925+t),this.gcardtype.source="guesscards_"+(925+t)},e.prototype.onShowCard=function(t){var e=t.data,n=this.getSeatById(e.seatid);if(server.playing){var i=this.getGuessCardsType(e.cardids);i>0&&this.setGuessCardsType(i),this.showMasterCards(e.cardids,this._reconnectIn),n.addCards(e.cardids),n==this._mySeat&&this._updateRecorderByCards(e.cardids),this._showExchangeRedAni()}},e.prototype.onAskPlayCard=function(t){var e=t.cardType,n=this.getSeatById(t.seatid);if(n){n.cleanDesk();var i=t.time;if(this._mySeat.seatid==t.seatid){if(t.seatid==t.pseatid||0==t.pseatid)this.buttonBar.switchState("useCard"),this.buttonBar.modifyButton("pass",!1),this.buttonBar.modifyButton("help",!1),this._mySeat.checkType([]);else{var o=this._mySeat.checkType(t.cardids);o?this.buttonBar.switchState("useCard"):this.buttonBar.switchState("pass"),this.buttonBar.modifyButton("pass",!0),this.buttonBar.modifyButton("help",!0),o||(i>5&&(i=5),e==SHUANGWANG&&i>1&&(i=1),this._mySeat.showNoMatchCards(1e3*i))}this.onSelectCards(),this._mySeat.checkCanUse()}i>0&&n.startCD(i,this.onCDComplete.bind(this,t.time>i))}},e.prototype.onCDComplete=function(t){t&&(server.useCardNtf([]),this._mySeat.cancelSelect())},e.prototype.onPanelMatchResultClose=function(){alien.SceneManager.instance.currentSceneName!=SceneNames.ROOM&&alien.SceneManager.show(SceneNames.ROOM,null,alien.sceneEffect.Fade,null,null,!1,SceneNames.LOADING)},e.prototype._showMatchResult=function(t){var e=!1;return SceneManager.instance.currentSceneName==SceneNames.PLAY&&t.matchid==this._roomInfo.matchId&&t.params[0]>0&&6!=this._roomInfo.matchType&&(t.params[1]&&t.params[1]>0&&(MatchService.instance.updateScoreGetOut(t.matchid,t.params[1]),this.updateMathTurnInfo()),PanelMatchResult.instance.show(t,this.onPanelMatchResultClose.bind(this)),BagService.instance.refreshBagInfo(),e=!0),MatchService.instance.onMatchEndCheckRemoveMatchInfoNtf(t),e},e.prototype.onMatchInfoNtf=function(t){var e=t.data;switch(e.optype){case 101:break;case 102:this.labWaiting.visible=!1,this._showMatch9Rew(e),e.params&&e.params.length>=5&&e.params[2]>0?this._showMatchRevive(e):this._showMatchResult(e);break;case 103:this.updateMathTurnInfo();break;case 104:var n=this._tfMatchPlayInfo;n[0].text=e.params[0].toString(),n[2].text=e.params[1].toString(),this.labelMatchInfo.textFlow=this._tfMatchPlayInfo,server.isMatch&&6==server.roomInfo.matchType&&(this._match9Info=e.roundInfo,this._setMatch9CurRank(e.params[0]));break;case 105:this.updateMathTurnInfo();break;case 106:this.updateMathTurnInfo(),this._curMatch9Play=e.params[1]+1,this._curMatch9Play>=this._roomInfo.stage[0].handCount&&(this._curMatch9Play=this._roomInfo.stage[0].handCount),this._setMatch9Turn(this._curMatch9Play)}},e.prototype.updateMathTurnInfo=function(){var t,e=MatchService.instance,n=e.currentMatchMode,i=1==this._roomInfo.stage.length?"":lang.match_turn_name[n-1];switch(n){case 1:if(!e.scoreGetOut||void 0==e.scoreGetOut)return;t=lang.format(lang.id.match_top_info_1,e.currentPlay,Utils.currencyRatio(e.scoreGetOut));break;case 2:0==e.countPromote?(i=lang.match_turn_name[2],t=lang.format(lang.id.match_top_info_3,e.currentPlay)):(isNaN(e.currentTurn)&&(e.currentTurn=1),t=lang.format(lang.id.match_top_info_2,e.currentTurn,e.currentPlay,e.countPromote))}this.labMatchInfo.text=i+" "+t},e.prototype.playChangeEffect=function(t,e,n){void 0===n&&(n=0);var i=this["labChange"+t];i.font=RES.getRes(e>0?"font_num_1":"font_num_2");var o=Utils.currencyRatio(Math.abs(e));i.text=e>0?"+"+o:"-"+o,i.y+=50,i.alpha=0,i.visible=!0,egret.Tween.get(i).wait(n).to({y:i.y-50,alpha:1},1e3,egret.Ease.cubicOut)},e.prototype.onGameEnd=function(t){var e=!1;server.playing=!1;var n=t.data,i=this._roomInfo.kickbacks;i||(i=0);var o;this.buttonBar.switchState("hidden"),this._mySeat.setHang(!1),this._mySeat.setStatus(null),this.seat1.setStatus(null),this.seat2.setStatus(null);for(var a,r,s=0;3>s;++s){a=n.chanage[s],r=null==n.realkickback[s]?0:n.realkickback[s];var h=this.getSeatById(s+1);a>0&&(o=h),this._mySeat==h&&(e=a>0);var c=0;this.seat1==h?c=1:this.seat2==h&&(c=2),this.playChangeEffect(c,a+r,0),1e3==this._roomInfo.roomID?h!=this._mySeat?h.updateRednormalGold(a):h.updateRednormalGold(a,!0):h.updateGold(a,server.isMatch),h.stopCD()}this.btnHang.enabled=!1,this._mySeat.grpRecorder.visible=!1,this.showResult(e),this._clearRecorderInfo(0),PanelPlayerInfo.remove(),server.isPersonalGame?this.cur_round<this.total_round&&++this.cur_round:server.isMatch&&6==server.roomInfo.matchType&&(this._curMatch9Play+=1,this._curMatch9Play>this._roomInfo.stage[0].handCount?PanelMatch9GetRew.getInstance().isShow()||this._showMatch9WaitOtherPlayerOver(!0):this._setMatch9Turn(this._curMatch9Play)),this.refreshCardsRecorderAbout()},e.prototype._showMatch9WaitOtherPlayerOver=function(t){this.match9WaitOther_img.visible=t},e.prototype.showResult1=function(t){1e3==this._roomInfo.roomID?t&&this._showRedNormalImage(!0):!t||server.isMatch||server.isPersonalGame?!server.isMatch&&!server.isPersonalGame&&MainLogic.instance.selfData.gold<this._roomInfo.minScore&&(MainLogic.instance.alms(this._mySeat.userInfoData.gold)||PanelRechargeTips.instance.show(this.onAlertResult.bind(this,0))):t&&(this.addRedProcess(),this._isOverFive&&!this._isShowWZAni&&this._showRedNormalImage(!0)),this._timerClean=egret.setTimeout(this.cleanSeat,this,3e3,!0,!0)},e.prototype.showResult=function(t){return this.dragonChunTian.parent?void(this._showResultTimeOutId=egret.setTimeout(this.showResult,this,2e3,t)):void(this._showResultTimeOutId1=egret.setTimeout(this.showResult1,this,500,t))},e.prototype.onUpdateGameInfo=function(t){var e=t.data;if(e.tableid&&(this._roomInfo.tableId=e.tableid),1==e.optype){if(e.params1&&e.params1.length>2){var n=e.params1[1],i=""+n;n>=1e4&&(i=i.substring(0,i.length-4)+""),this.setlabWaiting("PK,"+i),egret.setTimeout(function(){this.setlabWaiting()},this,5e3),this.masterCards.updateScore(e.params1[1],e.params1[0])}}else e&&e.params1&&e.params1.length>=1&&250==e.params1[0]&&250==e.params1[1]?0==e.params1[3]||Alert.show(lang.noMoreGold3,1,this.onAlertResult.bind(this,1)):e.params1&&e.params1.length>=1?2==e.params1.length?(this._roomInfo.baseScore=e.params1[1],this.masterCards.updateScore(this._roomInfo.baseScore,e.params1[0])):this.masterCards.updateMultiple(e.params1[0]):e.params2&&e.params2.length>2&&e.params2[0]>0&&this.showDragonChunTian()},e.prototype.onAlmsResponse=function(t){var e=this,n=t.data;switch(n.result){case 0:var i=MainLogic.instance.selfData.gold,o=lang.format(lang.id.alms_success,Utils.currencyRatio(GameConfig.almsConfig.gold),GameConfig.almsConfig.count-n.usagecnt);if(server.isMatch||server.isPersonalGame)return void Alert.show(o);i+GameConfig.almsConfig.gold<this._roomInfo.minScore?PanelRechargeTips.instance.show(this.onAlertResult.bind(this,0)):Alert.show(o+lang.alms_success_continue,1,function(t){"confirm"==t?(e.initData(),e.sendQuickJoin()):MainLogic.backToRoomScene()});break;case 1:case 2:server.isMatch||PanelRechargeTips.instance.show(this.onAlertResult.bind(this,0))}},e.prototype.onAlmsAlertResult=function(t){MainLogic.instance.selfData.gold<server.roomInfo.minScore&&MainLogic.backToRoomScene()},e.prototype.playerSeatDown=function(t){t.uid==server.uid&&(server.seatid=t.seatid);var e=this.getSeatById(t.seatid);if(e&&e.userInfoData&&e.userInfoData.uid==t.uid)e&&e.updateUserInfoData(t);else{var n=new UserInfoData;n.initData(t),e=this._seats[(n.seatid+3-server.seatid)%3],e.userInfoData=n,e.seatid=t.seatid,e.setOwnerFlagVisible(!1),e.setQuitFlagVisible(!1),e.userInfoView.update(t)}return server.getUserInfoInGame(t.uid),e&&server.isMatch&&(t.nickname="",e.isMaster?t.imageid="icon_head9":t.imageid="icon_head10",e.updateUserInfoData(t),e.userInfoView.update(t)),e},e.prototype.playerStandUp=function(t){server.isMatch||t!=server.uid||(this.cdProgressBar.stop(),MainLogic.backToRoomScene());var e=this.getSeatByUId(t);e&&(PanelPlayerInfo.onPlayerLeave(e.seatid),e.cleanPlayer())},e.prototype.getPlayersAmount=function(){for(var t=0,e=0;e<this._seats.length;++e)this._seats&&null!=this._seats[e].userInfoData&&++t;return t},e.prototype.cleanSeat=function(t,e){var n=this;void 0===t&&(t=!1),void 0===e&&(e=!1);var i=0;this._seats.forEach(function(e){n["labChange"+i++].visible=!1,t?e!=n._mySeat?e.clean(t):e.cleanDesk():e.clean(t)}),egret.clearTimeout(this._timerClean),this.btnContinue.visible=!server.isPersonalGame&&!server.isMatch&&e,server.isMatch||server.isPersonalGame||(this.initGuessCardsView(),this.grpRedNotice.visible=!1)},e.prototype.getSeatById=function(t){var e=null;return this._seats.some(function(n){return n.userInfoData&&n.userInfoData.seatid==t?(e=n,!0):void 0}),e},e.prototype.getSeatByUId=function(t){var e=null;return this._seats.some(function(n){return n.userInfoData&&n.userInfoData.uid==t?(e=n,!0):void 0}),e},e.prototype.onLotteryRedCoinRep=function(t){0==t.data.result&&(this.setRedProcess(),this.updateRedCoinInfo())},e.prototype.setRedProcess=function(t){if(void 0===t&&(t=!1),!server.isMatch&&!server.isPersonalGame){if(0==MainLogic.instance.selfData.uid)return void(this._redProcessTimeOutId=egret.setTimeout(this.setRedProcess,this,200));this.redListDataArr=[0,0,0,0,0];var e=0,n=0;if(MainLogic.instance.selfData.wincnt&&MainLogic.instance.selfData.wincnt.length)for(var i=0;i<MainLogic.instance.selfData.wincnt.length;i++)if(MainLogic.instance.selfData.wincnt[i].roomid==this._roomInfo.roomID){var o=MainLogic.instance.selfData.wincnt[i].cnt;if(o||(o=0),n=o%5,this._isOverFive&&t&&!this._isShowWZAni)this.redListDataArr=[1,1,1,1,1];else for(var a=0;n>a;a++)this.redListDataArr[a]=1;e=MainLogic.instance.selfData.wincnt[i].chance,e||(e=0);break}this.redCount.text=""+e,e>=1&&this._showRedCount(!0),this.redListDataProvider.source=this.redListDataArr,this.redListDataProvider.refresh()}},e.prototype.addRedProcess=function(){if(this._isOverFive=!1,MainLogic.instance.selfData.wincnt&&MainLogic.instance.selfData.wincnt.length)for(var t=0;t<MainLogic.instance.selfData.wincnt.length;t++)if(MainLogic.instance.selfData.wincnt[t].roomid==this._roomInfo.roomID){if(this.beforewincnt&&this.beforewincnt<MainLogic.instance.selfData.wincnt[t].cnt)return void this.setRedProcess(!0);var e=MainLogic.instance.selfData.wincnt[t].cnt;e||(e=0);var n=MainLogic.instance.selfData.wincnt[t].chance;return n||(n=0),e%5==4?(this._isOverFive=!0,MainLogic.instance.selfData.wincnt[t].cnt=0,MainLogic.instance.selfData.wincnt[t].chance=n+1):MainLogic.instance.selfData.wincnt[t].cnt=e+1,void this.setRedProcess(!0)}MainLogic.instance.selfData.wincnt[0]={roomid:this._roomInfo.roomID,cnt:1,chance:0},this.setRedProcess(!0)},e.prototype.onFreshManRedcoinLotteryChanceGot=function(t){MainLogic.instance.selfData.freshmanredcoinsent=1,this.dragonHongBao.parent||this.addChild(this.dragonHongBao),this.dragonHongBao.play2(),this._isShowWZAni=!0},e.prototype.showRedcoinDragon=function(t){this.dragonHongBao.parent||this.addChild(this.dragonHongBao),t&&(alien.localStorage.setItem("freshmanredcoinsent","1"),this.dragonHongBao.addEventListener(egret.Event.COMPLETE,this.ondragonHongBaoComplete,this)),this.dragonHongBao.play1(t)},e.prototype.ondragonHongBaoComplete=function(t){this.dragonHongBao.removeEventListener(egret.Event.COMPLETE,this.ondragonHongBaoComplete,this),server.stopCache()},e.prototype.showDragonChunTian=function(){this.dragonChunTian.parent||this.addChild(this.dragonChunTian)},e.prototype.showDragonWangZha=function(){this.dragonWangZha.parent||this.addChild(this.dragonWangZha)},e.prototype.showDragonZhaDan=function(){this.dragonZhaDan.parent||this.addChild(this.dragonZhaDan)},e.prototype.showDragonFeiJi=function(){this.dragonFeiJi.parent||this.addChild(this.dragonFeiJi)},e.prototype.showDragonMyLianDui=function(){this.dragonMyLianDui.parent||(this.dragonMyLianDui.x=alien.StageProxy.stage.stageWidth>>1,this.dragonMyLianDui.y=alien.StageProxy.stage.stageHeight/2+20,this.addChild(this.dragonMyLianDui))},e.prototype.showDragonRightLianDui=function(){this.dragonRightLianDui.parent||(this.dragonRightLianDui.x=this.seat1.x+200,this.dragonRightLianDui.y=this.seat1.y+92,this.addChild(this.dragonRightLianDui))},e.prototype.showDragonLeftLianDui=function(){this.dragonLeftLianDui.parent||(this.dragonLeftLianDui.x=this.seat2.x+230,this.dragonLeftLianDui.y=this.seat2.y+92,this.addChild(this.dragonLeftLianDui))},e.prototype.showDragonMyShunZi=function(){this.dragonMyShunZi.parent||(this.dragonMyShunZi.x=alien.StageProxy.stage.stageWidth>>1,this.dragonMyShunZi.y=alien.StageProxy.stage.stageHeight/2+20,this.addChild(this.dragonMyShunZi))},e.prototype.showDragonRightShunZi=function(){this.dragonRightShunZi.parent||(this.dragonRightShunZi.x=this.seat1.x+200,this.dragonRightShunZi.y=this.seat1.y+92,this.addChild(this.dragonRightShunZi))},e.prototype.showDragonLeftShunZi=function(){this.dragonLeftShunZi.parent||(this.dragonLeftShunZi.x=this.seat2.x+230,this.dragonLeftShunZi.y=this.seat2.y+92,this.addChild(this.dragonLeftShunZi))},e.prototype.onShowGameEffect=function(t){switch(t.data.cardType){case 1:this.showDragonWangZha();break;case 2:this.showDragonZhaDan();break;case 9:this.showDragonFeiJi();break;case 11:case 12:"my"==t.data.state?this.showDragonMyLianDui():"right"==t.data.state?this.showDragonRightLianDui():"left"==t.data.state&&this.showDragonLeftLianDui();break;case 10:"my"==t.data.state?this.showDragonMyShunZi():"right"==t.data.state?this.showDragonRightShunZi():"left"==t.data.state&&this.showDragonLeftShunZi()}},e.prototype._setInDayFuTime=function(t){this._inDayGetTime=t},e.prototype._onClickDayBuy=function(){this._inDayGetTime&&Toast.show("")},e.prototype._initDayBuy=function(){var t=this,e=server.serverDate,n=e.getMinutes(),i=e.getSeconds(),o=-59+n,a=-60+i,r=11;this.dayFuDaiTimeLabel.text=o+":"+a,this.dayFuDaiTimeLabel.textColor=16777215,this._setInDayFuTime(!1);egret.setInterval(function(){a-=1,-1==a&&(a=59,o-=1),0==o&&0==a&&(t.dayFuDaiTimeLabel.textColor=16711680,t._setInDayFuTime(!0),r-=1,0>r&&t._initDayBuy())},this,1e3)},e.prototype.beforeShow=function(t){var e=this;alien.PopUpManager.removeAllPupUp(),this._showRedCount(!1),this.mRed_img.addClickListener(this._onClickRed,this),this.match9Rule_img.addClickListener(this._onClickMatch9Rule,this),this.matchInfo_img.addClickListener(this._onClickMatch9Info,this),this.match9RuleAniClose_btn.addClickListener(this._onCloseMatch9RuleAni,this),this.double_group.addClickListener(this._onClickDouble,this),this.noDouble_group.addClickListener(this._onClickNoDouble,this),this.redNormal_img.addClickListener(this._onClickRedNormal,this),this.redNormalHelp_img.addClickListener(this._onClickRedNormalHelp,this),this.dayBuyGroup.addClickListener(this._onClickDayBuy,this),this._showNextMasterCardGuessBtn(!1),this._showMatch9WaitOtherPlayerOver(!1),this._showDoubleNoDouble(!1),this._showFailDouble(!1);
var n=BagService.instance.getItemCountById(3);if(this._setDiamondUI(n),this._mySeat.grpRedcoin.visible=!1,t.personalgame)this._mySeat.showDiamond(!1),this.isPersonalGame=!0,server.isPersonalGame=!0,this.currentState="personalGame";else{this.isPersonalGame=!1,server.isPersonalGame=!1;var i=GameConfig.getRoomConfig(t.roomID);if(!i)return void MainLogic.backToRoomScene();server.roomInfo=this._roomInfo=i,server.isMatch=2==i.roomType,this.currentState=server.isMatch?"match":"normal",1e3==server.roomInfo.roomID||1003==server.roomInfo.roomID?(this.redNormalHelp_img.visible=!0,this.grpRed.visible=!0,1e3==server.roomInfo.roomID&&(this.grpRed.visible=!1,this._shouldTipRedNormalRule())):(this.grpRed.visible=!0,this.redNormalHelp_img.visible=!1),server.isMatch?(this._mySeat.showDiamond(!1),6==server.roomInfo.matchType?(this._showMatchTurnAndRank(!1),this._showMatch9Bottom(!0),this._setMatch9Turn(1),this._setMatch9CurRank(-1)):(this._showMatchTurnAndRank(!0),this._showMatch9Bottom(!1),this._showMatch9RuleAniCloseBtn(!1)),this.labMatchInfo.text=""):(this._mySeat.grpRedcoin.visible=!0,this._mySeat.showDiamond(!0),this.initGuessCardsView(),this.setRedProcess(),this.updateRedCoinInfo())}this._initGeneralHeadImgTouch(!0),this.addListeners(),this._newTable=!0,this.initData();var o=MainLogic.instance.selfData;server.isMatch||this._mySeat.userInfoView.updateGold(o.gold),egret.setTimeout(function(){e._mySeat.userInfoView.avatar.imageId=o.imageid,e._mySeat.userInfoView.updateNickname(o)},this,100),alien.SoundManager.instance.playMusic(ResNames.bgm),o&&o.cardsRecorder&&o.cardsRecorder.length>=7?this.beforerecorderTime=o.cardsRecorder[6]:this.beforerecorderTime=0,this.showLaba(null),this._clearRecorderInfo(0),this.refreshCardsRecorderAbout(),this._showRedNormalImage(!1)},e.prototype.setPGameView=function(t){this.lbRoomID.text=String(t.roomid),t.maxodd||(t.maxodd=""),this.lbLimit.text=String(t.maxodd),this.cur_round=null==t.playround?1:t.playround+1,this.lbRound.text=this.cur_round+"/"+String(t.maxround),this.isowner=t.owner==server.uid?!0:!1,this.owneruid=t.owner,this.roomid=t.roomid,this.total_round=t.maxround,this.masterCards.updateScore(t.bscore||0,1),this.gamestarted=t.gamestatus>1?!0:!1,alien.Native.instance.isNative||this._justSetShareParams(),this.isowner?(t.players&&t.players.length>=3?(this.setStartPgameBtnVisible(!0),this.btnShare.visible=!1):(this.setStartPgameBtnVisible(!1),this.btnShare.visible=!0),this.labWaiting.visible=!1):(this.setStartPgameBtnVisible(!1),this.btnShare.visible=!0,t.players&&t.players.length>=3?(this.labWaiting.text="",this.labWaiting.visible=!0):this.labWaiting.visible=!1),(2==t.gamestatus||t.players&&t.players.length>=3)&&(this.setStartPgameBtnVisible(!1),this.btnShare.visible=!1),t.players&&this.playersSeatDown(t.players),this.setShareStart();var e=this.getSeatByUId(this.owneruid);e&&e.setOwnerFlagVisible(!0),server.roomInfo=this._roomInfo={roomID:t.roomid,maxOdds:t.maxodd,maxround:t.maxround,baseScore:t.bscore,kickbacks:0}},e.prototype.onShow=function(t,e){switch(void 0===t&&(t=null),void 0===e&&(e=!1),t.personalgame?(this.isPersonalGame=!0,server.isMatch=!1,server.isPersonalGame=!0,t.roomID&&server.QueryRoomInfoReq(t.roomID),this.btnShare.visible=!0):server.isPersonalGame=!1,t.action){case"quick_join":this.sendQuickJoin();break;case"reconnect":server.reconnect(0),1e3==t.roomID&&server.reqRedNormalTime()}server.isMatch?(server.enterMatch(this._roomInfo.matchId),"reconnect"!=t.action?this.setlabWaiting("..."):this.setlabWaiting("...")):server.roomInfo&&1e3==server.roomInfo.roomID&&this._redNormalShowMatching()},e.prototype._redNormalShowMatching=function(){this.labWaiting.visible=!0,this.labWaiting.text="..."},e.prototype.beforeHide=function(){this.cleanSeat(),this.removeListeners(),this._timerClean&&egret.clearTimeout(this._timerClean),this._redProcessTimeOutId&&egret.clearTimeout(this._redProcessTimeOutId),this._showResultTimeOutId&&egret.clearTimeout(this._showResultTimeOutId),this._timerDelayJoin&&egret.clearTimeout(this._timerDelayJoin),this._showResultTimeOutId1&&egret.clearTimeout(this._showResultTimeOutId1),egret.Tween.removeTweens(this.recorderBubble),server.playing=!1,server.isMatch&&PanelMatchWaitingInner.instance.close()},e.prototype.onHide=function(e,n){void 0===e&&(e=null),void 0===n&&(n=!1),t.prototype.onHide.call(this,e,n),this._seats.forEach(function(t){t.stopCD()})},e.prototype._onClickRed=function(){var t=Number(this.redCount.text);if(0>=t){var e=MainLogic.instance.selfData.getRoomNeedWinCntGetRed(this._roomInfo.roomID);return void Toast.show(""+e+"")}ExchangeService.instance.doChou(this._roomInfo.roomID)},e.prototype._showRedCount=function(t){this.redCountBg_img.visible=t,this.redCount.visible=t},e.prototype._onUserRedCountChange=function(t){var e=t.data,n=!1;e.count>0&&(this.redCount.text=e.count,n=!0),this._showRedCount(n)},e.prototype._showMatch9RuleAniCloseBtn=function(t){this.match9RuleAniClose_btn.visible=t},e.prototype.onPlayMatch9RuleAni=function(){null==this._match9RuleAni&&(this._match9RuleAni=new DragonMatch9Rule,this._showMatch9RuleAniCloseBtn(!0)),this.match9Rule_group.visible=!0,this.match9Rule_group.addChild(this._match9RuleAni),this._match9RuleAni.play(this._onCloseMatch9RuleAni.bind(this))},e.prototype._onCloseMatch9RuleAni=function(){null!=this._match9RuleAni&&(this._match9RuleAni.stop(),this.match9Rule_group.removeChild(this._match9RuleAni),this._match9RuleAni=null),this.match9Rule_group.visible=!1,this._showMatch9RuleAniCloseBtn(!1)},e.prototype._showMatchTurnAndRank=function(t){this.matchRank_group.visible=t,this.matchTurn_group.visible=t},e.prototype._onClickMatch9Rule=function(){this.onPlayMatch9RuleAni()},e.prototype._setMatch9Turn=function(t){var e=GameConfig.getRoomConfigByMatchId(this._roomInfo.matchId);if(e.stage&&1==e.stage.length){var n=e.stage[0].handCount;this.match9Turn_label.textFlow=(new egret.HtmlTextParser).parser("<font color='#F0FF00'>"+t+"</font>/"+n)}},e.prototype._setMatch9CurRank=function(t){0>t?this.curRank_label.text="..":this.curRank_label.text=""+t},e.prototype._onClickMatch9Info=function(){PanelMatch9Info.getInstance().show(this._match9Info)},e.prototype._showMatch9Bottom=function(t){this.match9_bottom_group.visible=t},e.prototype._showMatch9Rew=function(t){if(t){var e=t.matchid,n=GameConfig.getRoomConfigByMatchId(e);n&&6==n.matchType&&PanelMatch9GetRew.getInstance().show(n,t)}this._showMatch9WaitOtherPlayerOver(!1)},e.prototype._onHornRecChange=function(){this.rollMsg.show()},e.prototype._checkShowFailDouble=function(){var t=this._mySeat,e=this.seat1,n=this.seat2,i=n.userInfoData.getGold()||0,o=e.userInfoData.getGold()||0,a=BagService.instance.getItemCountById(3),r=(MainLogic.instance.selfData.getGold(),{bShow:!1,nReason:1,sReason:""});return a<this._roomInfo.doublediamond?(r.bShow=!0,r.sReason=",",r.nReason=4):t.isMaster?i<this._roomInfo.doublelimit&&o<this._roomInfo.doublelimit&&(r.bShow=!0,r.nReason=3,r.sReason=""+this._roomInfo.doublelimit+","):n.isMaster?i<this._roomInfo.doublelimit&&(r.bShow=!0,r.nReason=1,r.sReason=""+this._roomInfo.doublelimit+","):o<this._roomInfo.doublelimit&&(r.bShow=!0,r.nReason=1,r.sReason=""+this._roomInfo.doublelimit+","),r},e.prototype._showDoubleNoDouble=function(t){this.double_group.visible=t,this.noDouble_group.visible=t},e.prototype._onClickDouble=function(){this._doubleRet&&this._doubleRet.bShow?ImgToast.instance.show(this,this._doubleRet.sReason):server.reqDouble()},e.prototype._onClickNoDouble=function(){server.reqNoDouble(),this._mySeat.stopCD(),this._clearAskDoubleTimeOut(),this._showDoubleNoDouble(!1),this._showFailDouble(!1)},e.prototype._onMyAskDoubleTimeOut=function(){this._mySeat.stopCD(),this._showDoubleNoDouble(!1),this._clearAskDoubleTimeOut(),this._showFailDouble(!1),this._mySeat.showDoubleTip(!0,!1)},e.prototype._onServerDoubleRep=function(t){if(t.params&&t.seatid&&t.params.length>=1){var e=t.params[0],n=this.getSeatById(t.seatid);1==e?(n.showDoubleTip(!0,!1),n.showDoubleFlag(!1)):(n.showDoubleTip(!0,!0),n.showDoubleFlag(!0),n==this._mySeat&&(this._clearAskDoubleTimeOut(),this._mySeat.stopCD(),this._showDoubleNoDouble(!1),this._showFailDouble(!1)))}},e.prototype._showFailDouble=function(t,e){if(void 0===e&&(e=null),t){if(!(e>=1&&4>=e))return;this.failDoubleDesc1_img.source="failDoublePre"+e}this.failDouble_group.visible=t},e.prototype._showNextMasterCardGuessBtn=function(t){this.btnGuessCards.visible=t},e.prototype._shouldQuickJoinForRedRoom=function(){var t=BagService.instance.getItemCountById(3);return t<this._roomInfo.minScore?(MainLogic.instance.noDiamondGetNewDiamondRewOrBuyRevive(this._roomInfo.minScore),!1):(this._redNormalShowMatching(),!0)},e.prototype._onClickReady=function(){this.initData(!0),(1e3!=this._roomInfo.roomID||this._shouldQuickJoinForRedRoom())&&(this.sendQuickJoin(),this._showNextMasterCardGuessBtn(!1),this.onCloseGrpGuessOp(null))},e.prototype._setDiamondUI=function(t){var e=t;this._mySeat.updateDiamond(e)},e.prototype._onSendQuickJoin=function(){this.btnContinue.visible=!1,server.isMatch||this.setlabWaiting("...")},e.prototype._onBagRefresh=function(){var t=BagService.instance.getItemCountById(3);this._roomInfo&&1e3==this._roomInfo.roomID&&server.playing||this._setDiamondUI(t)},e.prototype._onClickRedNormal=function(){1e3==this._roomInfo.roomID?server.reqRedNormalMoney():server.isMatch||server.isPersonalGame||ExchangeService.instance.doChou(this._roomInfo.roomID),this._showRedNormalImage(!1)},e.prototype._clearRedNormalInterval=function(){-1!=this._redNormalNum&&(egret.clearInterval(this._redNormalNum),this._redNormalNum=-1)},e.prototype._showRedNormalImage=function(t,e){if(void 0===e&&(e=10),this._clearRedNormalInterval(),t){var n=null;n=function(){egret.Tween.get(this.redNormal_img).to({rotation:20},100).to({rotation:-20},100).to({rotation:10},60).to({rotation:-10},60).wait(1e3).call(function(){n()}.bind(this))}.bind(this),n();var i=e,o=i,a=""+o;this._redNormalNum=egret.setInterval(function(){o-=1,0>o&&(o=0,this._showRedNormalImage(!1)),a=""+o,this.redNormal_label.text=a+"s"},this,1e3),this.redNormal_label.text=a+"s"}else egret.Tween.removeTweens(this.redNormal_img);this.redNormal_img.visible=t,this.redNormal_label.visible=t},e.prototype.onRedNormalMoneyInfoRep=function(t){var e=t.data;if(1==e.optype){if(null==e.result){this.fastRedValue=e.params;var n=Utils.exchangeRatio(e.params/100,!0);alien.Native.instance.isNative?Alert.show(""+n+"!"):Alert.show(""+n+"!")}}else if(2==e.optype)null==e.result&&e.params>0&&this._showRedNormalImage(!0,e.params);else if(3==e.optype&&null==e.result){var i=":"+e.params+"";MainLogic.instance.selfData.setHasGetNewDiamond(),Alert.show(i,0,function(){if(!server.playing&&this._roomInfo&&1e3==this._roomInfo.roomID){var t=BagService.instance.getItemCountById(3);if(this._roomInfo.minScore>t)return void MainLogic.instance.ifBuyReviveMaxTipShop(this._roomInfo.minScore);this.sendQuickJoin()}}.bind(this))}},e.prototype.onAlertBtn=function(t,e){if("cancel"==t){var n=this.fastRedValue,i=ShareImageManager.instance.getShareScene(ShareImageManager.GAME_TYPE_FAST,n);ShareImageManager.instance.start(server.uid,i)}},e.prototype._onBuyReviveSucc=function(){if(1e3==this._roomInfo.roomID){if(!this._shouldQuickJoinForRedRoom())return;this.sendQuickJoin()}},e.prototype._showRedNormalRule=function(){var t="";if(1e3==this._roomInfo.roomID)t=":"+this._roomInfo.minScore+"\n:,10\n:100\n:"+this._roomInfo.baseScore+""+this._roomInfo.maxOdds+"\n:"+this._roomInfo.kickbacks+"";else{if(1003!=this._roomInfo.roomID)return;t="\r\n\r\n\r\n1<503000\r\n250<<2005000\r\n3200<<50010000\r\n4>50030000\r\n"}Alert.show(t,0,null,"left")},e.prototype._onClickRedNormalHelp=function(){this._showRedNormalRule()},e.prototype._onCloseRevivePanel=function(){MainLogic.backToRoomScene()},e.prototype._onClickGold=function(){PanelExchange2.instance.show()},e.prototype._onClickDiamond=function(){PanelExchange2.instance.show(1)},e.prototype.doReconnectToGame=function(t){this.onShow({action:"reconnect",personalgame:t.personalgame,roomID:t.roomid})},e.prototype._clearMatchReviveInterval=function(){0!=this._matchReviveIntervalId&&egret.clearInterval(this._matchReviveIntervalId),this._matchReviveIntervalId=0},e.prototype._onMatchReviveTimeOut=function(t){this._clearMatchReviveInterval(),server.giveUpMatch(this._roomInfo.matchId),PanelMatchRevive.remove(),this._showMatchResult(t)||MainLogic.backToRoomScene()},e.prototype._showMatchRevive=function(t){var e=(this._roomInfo.stage,t.params[4]);this._clearMatchReviveInterval();var n=t.params[3],i=PanelMatchRevive.getInstance(),o=egret.setInterval(function(){n+=-1,0>n&&this._onMatchReviveTimeOut(t),i.updateCountDown(n)},this,1e3);this._matchReviveIntervalId=o;var a=function(){this._onMatchReviveTimeOut(t)},r=MainLogic.instance.selfData.getGold(),s=function(){r<t.params[2]?ImgToast.instance.show(i,""):server.reqMatchRevive()};i.show(s.bind(this),a.bind(this)),i.setRankSub(e),i.setReviveCost(t.params[2]),i.updateCountDown(n)},e}(alien.SceneBase);__reflect(ScenePlay.prototype,"ScenePlay");var EventManager=alien.EventManager,SceneRoom=function(t){function e(){var e=t.call(this)||this;return e._sceneAnimationDuration=500,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.skinName=scenes.SceneRoomSkin,this._self=MainLogic.instance.selfData},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._rollMsgHorizontal=this.rollMsg.horizontalCenter,this.navigator.push(PageChannels),this.onNavigate(null);var e=EventManager.instance;e.registerOnObject(this,alien.Dispatcher,EventNames.MY_USER_INFO_UPDATE,this.onMyUserInfoUpdate,this),e.registerOnObject(this,this.grpBottom,egret.TouchEvent.TOUCH_TAP,this.onGrpBottomTap,this),e.registerOnObject(this,this.gold,egret.TouchEvent.TOUCH_TAP,this._onClickGold,this),e.registerOnObject(this,this.diamond,egret.TouchEvent.TOUCH_TAP,this._onClickDiamond,this),e.registerOnObject(this,this.grpRedcoin,egret.TouchEvent.TOUCH_TAP,this._onClickExchange,this),e.registerOnObject(this,this.navigator,alien.Navigator.NAVIGATE,this.onNavigate,this),e.registerOnObject(this,alien.Dispatcher,EventNames.SHOW_ANNOUNCE,this.showAnnounce,this),e.registerOnObject(this,alien.Dispatcher,EventNames.USER_FRREWARD_GET_SUCC,this._onFRechargeRewGetSucc,this),e.registerOnObject(this,alien.Dispatcher,EventNames.USER_DTREWARD_GET_SUCC,this._onDayTaskRewGetSucc,this),e.registerOnObject(this,alien.Dispatcher,EventNames.HORN_TALK_RECORDS_CHANGE,this._onHornRecChange,this),e.registerOnObject(this,alien.Dispatcher,EventNames.BAG_INFO_REFRESH,this._onBagRefresh,this),e.registerOnObject(this,alien.Dispatcher,EventNames.BUY_REVIVE_SUCC,this._onBuyReviveSucc,this),e.registerOnObject(this,MailService.instance,EventNames.MAIL_UNREAD_UPDATE,this._onMailUnreadUpdate,this),e.registerOnObject(this,alien.Dispatcher,EventNames.USER_RED_COUNT_CHANGE,this._onUserRedCountChange,this),e.registerOnObject(this,alien.Dispatcher,EventNames.FRECHARGE_HASUPDATE,this._onFRechargeUpdate,this),server.addEventListener(EventNames.USER_GET_ACTInfo_REP,this._onRecvGetActInfoRep,this),server.addEventListener(EventNames.USER_GET_REWARD_REP,this._onRecvGetActRewRep,this),server.addEventListener(EventNames.JOIN_PGAME_REP,this.onJoinRep,this),server.addEventListener(EventNames.USER_DiamondGame_REP,this._onNewPlayerDiamonRewInfoRep,this),alien.Dispatcher.addEventListener(EventNames.ACT_RED_CHANGE,this._initActRed,this),ExchangeService.instance.announce&&this.showAnnounce(null)},e.prototype._setIsHome=function(t){this._isHome=t},e.prototype._onFRechargeUpdate=function(){var t=MainLogic.instance.selfData;t.isNotBuyFRecharge()||(this.mFRechageBg_img.visible=!1,t.isGetTodayFRechargeRew()||t.isFRechargeRewGetOver()||PanelFRGetRew.getInstance().show())},e.prototype._onClickKefu=function(){var t=GameConfig.wxService,e=PanelAlert3.instance;e.show(":"+t,0,function(e){"confirm"==e?GameConfig.copyText(this.parent,t,"("+t+")"):"cancel"==e&&PanelActAndNotice.getInstance().showRedExchange()},!0),e.btnCancel.labelIcon="room_redErr",e.btnConfirm.labelIcon="common_copyWX"},e.prototype._onClickRecharge=function(){PanelExchange2.instance.show()},e.prototype._enableEvent=function(t){var e="addEventListener";t||(e="removeEventListener"),this[e](egret.Event.REMOVED_FROM_STAGE,this._onRemovedToStage,this),this[e](egret.Event.ADDED_TO_STAGE,this._onAddToStage,this),this.mFRechageBg_img.addClickListener(this._onClickFRecharge,this),this.signBtn.addClickListener(this._onClickSign,this),this.keFuBtn.addClickListener(this._onClickKefu,this),this.settingBtn.addClickListener(this._onClickSetting,this),this.taskGroup.addClickListener(this._onClickTask,this),this.rechargeGroup.addClickListener(this._onClickRecharge,this),this.inviteGroup.addClickListener(this._onClickInvite,this),this.redBtn.addClickListener(this._onClickGetRed,this),this.backGroup.addClickListener(this._onClickBack,this),this.actGroup.addClickListener(this._onClickAct,this),this.emailGroup.addClickListener(this._onClickEmail,this),this.redExchangeImg.addClickListener(this._onClickExchange,this),this.publicWXGroup.addClickListener(this._onClickWatchWX,this),this.grpShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onGrpShareTap,this)},e.prototype._onGrpShareTap=function(t){if(_nativeBridge.isNative){var e=WxHelper;e.shareDownApp(null)}else _nativeBridge.isWXMP||_nativeBridge.isAli()||WxHelper.shareForPhone()},e.prototype._showEmailDefaultUnreadNum=function(t){var e=!1;t>0&&(e=!0),this.newEmailNumLabel.text=""+t,this.newEmailNumLabel.visible=e,this.newEmailBgImg.visible=e},e.prototype._onMailUnreadUpdate=function(t){var e=t.data;e&&e.count>=0&&this._showEmailDefaultUnreadNum(e.count)},e.prototype._onClickAct=function(){PanelActAndNotice.getInstance().showThanksgiving()},e.prototype._onClickEmail=function(){PanelMail.getInstance().show()},e.prototype._onClickExchange=function(){PanelExchange2.instance.show(2)},e.prototype._onClickGold=function(){PanelExchange2.instance.show()},e.prototype._onClickDiamond=function(){PanelExchange2.instance.show(1)},e.prototype._playLight=function(t,e){t.mask=e;var n=e.x,i=e.y,o=t.x+t.width+10,a=null;(a=function(){egret.Tween.get(e).to({x:o,y:i},1e3).wait(500).to({x:n,y:i},500).call(function(){a()})})()},e.prototype._onClickWatchWX=function(){this._saveHasClickWatchWX(),this._clearTipWX(),PanelFollowCourse.instance.show()},e.prototype._onAddToStage=function(){},e.prototype._onRemovedToStage=function(){this._enableEvent(!1)},e.prototype.showAnnounce=function(t){this.rollMsg.show(!1)},e.prototype._onClickInvite=function(){InviteService.instance.clearInvitePlayersList(),InviteService.instance.getInvitePlayersList(),PanelInviteList.instance.show(InviteService.instance.source,this.onCloseInvite.bind(this))},e.prototype.onCloseInvite=function(){},e.prototype._showBackGroup=function(t){this.backGroup.visible=t},e.prototype._showGrpShare=function(t){t&&!_nativeBridge.isNative&&(_nativeBridge.isWXMP||_nativeBridge.isAli())&&(t=!1),this.grpShare.visible=t},e.prototype.onNavigate=function(t){WxHelper.doWebH5ShareCfg(),!t||t.data.page instanceof PageChannels?(this.imgRoomTitle.source=ResNames.room_word_25,this._showBackGroup(!1),this._setIsHome(!0),alien.Native.instance.isNative&&"Android"==egret.Capabilities.os&&this._showBackGroup(!0),this._showWatchWX(!0),this._showGrpShare(!0),this._resetRollMsgHorizontal()):(this._setIsHome(!1),this._showWatchWX(!1),this._showBackGroup(!0),this._onChangeCenterHornPos(),t.data.page instanceof PageNormalChannel?(this.imgRoomTitle.source=ResNames.room_word_28,this._showGrpShare(!0)):(this.imgRoomTitle.source=ResNames.room_word_23,this._showGrpShare(!1)))},e.prototype.onGrpBottomTap=function(t){switch(t.target.name){case"home_page":break;case"add_favorite":break;case"avatar":PanelProfile.instance.show(function(){MainLogic.instance.refreshSelfInfo()})}},e.prototype.showBank=function(){},e.prototype._onClickBack=function(){this._isHome?PanelAlert.instance.show("",0,function(t){"confirm"==t&&alien.Native.instance.closeApp()}):this.navigator.pop()},e.prototype.doBack=function(){this._onClickBack()},e.prototype.onPanelBindPhoneResult=function(t){},e.prototype.checkRedNormalDiamondNum=function(){var t=GameConfig.getRoomConfigById(1e3),e=BagService.instance.getItemCountById(3);return t.minScore>e?void MainLogic.instance.noDiamondGetNewDiamondRewOrBuyRevive(t.minScore):void alien.SceneManager.show(SceneNames.PLAY,{action:"quick_join",roomID:1e3},alien.sceneEffect.Fade)},e.prototype.onCheckReconnectRep=function(t){var e=t.data,n=Math.floor(e.roomid/1e3),i=e.roomid>0&&(e.roomid<1e3||n==GameConfig.gameId);if(e.roomid>999&&e.roomid<1e4&&2==e.gametype)SceneManager.show(SceneNames.PLAY,{personalgame:!0,action:"reconnect",roomID:e.roomid},alien.sceneEffect.Fade);else if(i)alien.SceneManager.show(SceneNames.PLAY,{action:"reconnect",roomID:e.roomid},alien.sceneEffect.Fade);else{var o=this.navigator.currentPage;if(o.isClickRedRoom&&o.isClickRedRoom())this.checkRedNormalDiamondNum();else{var a=this.navigator.currentPage.selectedRoom;if(2==a.roomType)server.getMatchSignUpInfo(a.matchId);else if(1==a.roomType)if(this._self.gold>a.maxScore){var r=GameConfig.getSuitableRoomConfig(this._self.gold);Alert3.show(""+a.maxScore+"\n"+r.name+"",this.joinSpecialRoom.bind(this,r.roomID),"common_btn_enter",!0)}else this._self.gold>=a.minScore?alien.SceneManager.show(SceneNames.PLAY,{action:"quick_join",roomID:a.roomID},alien.sceneEffect.Fade):PanelRechargeTips.instance.show()}}},e.prototype.joinSpecialRoom=function(t){t&&GameConfig.getRoomConfigById(t)&&alien.SceneManager.show(SceneNames.PLAY,{action:"quick_join",roomID:t},alien.sceneEffect.Fade)},e.prototype._onShowNewReward=function(){PanelFreshManReward.instance.show()},e.prototype.onMyUserInfoUpdate=function(t){void 0===t&&(t=null);var e=t&&t.data?t.data.userInfoData:this._self;if(e.uid){var n=BagService.instance.getItemCountById(3);if(this.diamond.updateGold(n),this.gold.updateGold(e.gold),this.lbRedCoin.text=""+(null==this._self.redcoin?"0.00":Utils.exchangeRatio(this._self.redcoin/100,!0)),this._showEmailDefaultUnreadNum(0),this._showDayTaskDefaultByOverNum(e.getDayTaskOverCount()),this._initTaskRedImg(),this._initActRed(),this._initRedNum(),e.imageid&&(this.avatar.imageId=e.imageid),e.nickname){var i=e.nickname.substr(0,10);this.labNickName.text=i+"("+e.fakeuid+")",this.checkShareRoom()}}},e.prototype._showActRed=function(t){},e.prototype._initActRed=function(){this._self.shouldShowActRed()?this._showActRed(!0):this._showActRed(!1)},e.prototype._initTaskRedImg=function(){this._self.shouldShowTaskRed()&&this._showTaskRedImg(!0)},e.prototype.checkShareRoom=function(){var t=alien.Native.instance,e=t.getUrlArg(),n=e.share_room;console.log("checkShareRoom==>",n);var i=Number(n);i&&server.JoinPGameReq(i)},e.prototype.checkNickname=function(){0==MainLogic.instance.checkNicknameCount&&(this._self.nickname.match(/^\w{15}/)&&PanelModifyNickname.instance.show(),MainLogic.instance.checkNicknameCount++)},e.prototype._onClickGetRed=function(){var t=Number(this.redNumLabel.text);if(!t||0>=t)return void Alert.show("5",1,function(t){"confirm"==t&&alien.Dispatcher.dispatch(EventNames.TO_NORMAL_MATCH)});var e=this._self.getOneNorRoomRedFromSmall();e&&e.roomid&&ExchangeService.instance.doChou(e.roomid)},e.prototype._showFRecharge=function(){this._bInLobby&&PanelActAndNotice.getInstance().showFRecharge()},e.prototype._onSignEffectLoadOver=function(t){if(this._bInLobby&&"signAndEmail"==t.groupName){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onSignEffectLoadOver,this),PanelSign.getInstance().show();var e=this._self;e.freshrewardgot&&1==e.freshrewardgot&&this._onShowNewReward()}},e.prototype._showSignRew=function(){return RES.isGroupLoaded("signAndEmail")?void PanelSign.getInstance().show():(RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onSignEffectLoadOver,this),void RES.loadGroup("signAndEmail"))},e.prototype._onMailEffectLoadOver=function(t){this._bInLobby&&"signAndEmail"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onMailEffectLoadOver,this),PanelMail.getInstance().show())},e.prototype._showEmail=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onMailEffectLoadOver,this),RES.loadGroup("signAndEmail")},e.prototype._getThanksPopTimeStamp=function(){var t=alien.localStorage.getItem("PopThanksTime");return Number(t)},e.prototype._recordThanksPopTimeStamp=function(){var t=(new Date).getTime();alien.localStorage.setItem("PopThanksTime",""+t)},e.prototype._isShouldPopThanks=function(){var t=this._getThanksPopTimeStamp();if(t){var e=(new Date).getDate(),n=new Date(t).getDate();if(n+1>e)return!1}return!0},e.prototype._initThanks=function(){Utils.isInTimeSection("2017-11-23 00:00:00","2017-11-26 00:00:00",(new Date).getTime())&&this._isShouldPopThanks()&&(this._recordThanksPopTimeStamp(),PanelActAndNotice.getInstance().showThanksgiving())},e.prototype.onSignInRep=function(t){server.removeEventListener(EventNames.USER_DAY_SIGN_IN_REP,this.onSignInRep,this),this._initFRecharge(),this._initThanks();var e=this._self;if(1!=t.data.today?(e.setTodaySigned(!1),e.isNotBuyFRecharge()||null==e.frechargerewardday||e.isGetTodayFRechargeRew()||e.isFRechargeRewGetOver()||PanelFRGetRew.getInstance().show(),this._bShowSign=!0,this._showSignRew()):(this._bShowSign=!1,e.setTodaySigned(!0),e.isNotBuyFRecharge()?MainLogic.instance.alms():e.isGetTodayFRechargeRew()?MainLogic.instance.alms():e.isHadGetFRechargeRew()&&!e.isFRechargeRewGetOver()?PanelFRGetRew.getInstance().show():MainLogic.instance.alms()),e.freshrewardgot&&1==e.freshrewardgot){if(this._bShowSign)return;this._onShowNewReward()}},e.prototype.onHappyBeanConsumeRep=function(t){alien.Dispatcher.dispatch(EventNames.HIDE_WAITING),0==t.data.result&&Alert.show(lang.exchange_succ1)},e.prototype.onHappyBeanExchangeRep=function(t){alien.Dispatcher.dispatch(EventNames.HIDE_WAITING),0==t.data.result&&Alert.show(lang.exchange_succ2)},e.prototype.beforeShow=function(t,e){this.grpShare.visible=!0,this.inviteGroup.visible=!0,_nativeBridge.isNative||(_nativeBridge.isWXMP||_nativeBridge.isAli())&&(this.grpShare.visible=!1,this.inviteGroup.visible=!1),this.newActBgImg.visible=!1,this._setIsHome(!0),this._bInLobby=!0,this._bShowSign=!1,this.rollMsg.visible=!0,this.redNumLabel.visible=!1,this.redCountBgImg.visible=!1,this.rollMsg.enableSendHorn(!0),this.rollMsg.setInLobby(!0),this._enableEvent(!0),this._resetRollMsgHorizontal(),this._initRedNum(),this._initTipWX(),webService.getHornRec(this._onHttpRecvHornRec.bind(this)),webService.loadLog(2,0),alien.EventManager.instance.enableOnObject(this),this.onMyUserInfoUpdate(),this.navigator.active(),server.addEventListener(EventNames.USER_DAY_SIGN_IN_REP,this.onSignInRep,this),server.getSignInInfo(),server.reqDownAppRewInfo();var n=this._sceneAnimationDuration;egret.Tween.get(this.grpTop).to({top:-this.grpTop.height}).wait(n).to({top:0},n,egret.Ease.cubicOut),egret.Tween.get(this.grpBottom).to({bottom:-this.grpBottom.height}).wait(n).to({bottom:0},n,egret.Ease.cubicOut),alien.SoundManager.instance.playMusic(ResNames.bgm),t&&t.hasOwnProperty("jump2match")&&"PageMatchChannelSkin"!=this.navigator.currentPage.skinName.name&&this.navigator.push(PageMatchChannel)},e.prototype.beforeHide=function(){this._bInLobby=!1,EventManager.instance.disableOnObject(this),this.navigator.deactive();var t=this._sceneAnimationDuration;egret.Tween.get(this.grpTop).to({top:-this.grpTop.height},t,egret.Ease.cubicIn),egret.Tween.get(this.grpBottom).to({bottom:0},t,egret.Ease.cubicIn)},e.prototype._onClickTask=function(){var t=this._self;t.shouldShowTaskRed()&&(server.reqNewPlayerClickTask(),t.setNotShowTaskRed(),this._showTaskRedImg(!1)),PanelDayTask.getInstance().show()},e.prototype._onClickNotice=function(){PanelActAndNotice.getInstance().showNotice()},e.prototype._showDayTaskDefaultByOverNum=function(t){var e=!1;this.mOverTask_label.text=""+t,this.mOverTask_label.visible=e,this._showTaskRedImg(e)},e.prototype._onClickFRecharge=function(){this._showFRecharge()},e.prototype._showTaskRedImg=function(t){this.mOverTaskBg_img.visible=t},e.prototype._onClickSetting=function(){PanelSetting.instance.show()},e.prototype._onClickSign=function(){this._showSignRew()},e.prototype._playFRechargeAni=function(){},e.prototype._initFRecharge=function(){var t=this.navigator.currentPage;if(t instanceof PageChannels){var e=this._self,n=e.isNotBuyFRecharge(),i=e.isHadGetFRechargeRew();if(n){this.mFRechageBg_img.visible=!0;var o=this._isShouldPopBuyFRecharge();o&&(this._showFRecharge(),this._recordBuyFRechargePopTimeStamp())}else this.mFRechageBg_img.visible=!1,i||null==e.frechargerewardday||e.isFRechargeRewGetOver()||PanelFRGetRew.getInstance().show()}},e.prototype._getBuyFRechargePopTimeStamp=function(){var t=alien.localStorage.getItem("PopFRTime");return Number(t)},e.prototype._recordBuyFRechargePopTimeStamp=function(){var t=(new Date).getTime();alien.localStorage.setItem("PopFRTime",""+t)},e.prototype._isShouldPopBuyFRecharge=function(){var t=this._getBuyFRechargePopTimeStamp();if(t){var e=(new Date).getDate(),n=new Date(t).getDate();if(n+1>e)return!1}return!0},e.prototype._onFRechargeRewGetSucc=function(){this.mFRechageBg_img.visible=!1},e.prototype._onDayTaskRewGetSucc=function(){var t=this._self.getDayTaskOverCount();this._showDayTaskDefaultByOverNum(t)},e.prototype._onHornRecChange=function(t){this.rollMsg.show()},e.prototype._onHttpRecvHornRec=function(t){if(t&&t.total_items>0&&t.items){t.items.reverse();var e=this._self;e.cleanLocalHornRecByHttp();for(var n=0;n<t.total_items;++n)e.addHornTalkRecByHttp(t.items[n])}},e.prototype._onRecvGetActInfoRep=function(t){var e=t.data;e&&(1==e.optype?e.params?1==e.params[0]?_nativeBridge.isNative?this._showGetRewDownAppBtn():_nativeBridge.isAli()||_nativeBridge.isWXMP||"iOS"!=egret.Capabilities.os?this._showDownAppBtn():this._showGetRewDownAppBtn():2==e.params[0]?this._hideDownAppGroup():e.params[1]&&1==e.params[1]?(this._onClickDownApp(),alien.Native.instance.isNative||this._showDownAppBtn()):alien.Native.instance.isNative?this._hideDownAppGroup():this._showDownAppBtn():alien.Native.instance.isNative?this._hideDownAppGroup():this._showDownAppBtn():2==e.optype)},e.prototype._showGetRewDownAppBtn=function(){this.downAppGroup.visible=!1,this._onClickGetDownAppRew()},e.prototype._showDownAppBtn=function(){this.downAppGroup.visible=!0,this.downAppGroup.addClickListener(this._onClickDownApp,this),this._playLightOnTarget(),this._self.setNotLoginApp(!0),alien.Dispatcher.dispatch(EventNames.LOGINAPP_HASUPDATE)},e.prototype._hideDownAppGroup=function(){this.downAppGroup.visible=!1,this._self.setNotLoginApp(!1)},e.prototype._onClickDownApp=function(){PanelActAndNotice.getInstance().showAPPAct()},e.prototype._onClickGetDownAppRew=function(){server.reqGetDownAppRew()},e.prototype._onRecvGetActRewRep=function(t){var e=t.data,n=null,i="center";0==e.result||null==e.result?(1==e.optype?(i="left",n=":\n1.x32\n2.x10000\n3.x7\n4.x50\n5.APP50%",this._hideDownAppGroup()):2==e.optype||3==e.optype,BagService.instance.refreshBagInfo()):1==e.result?n="":2==e.result?n="":3==e.result&&(n=""),n&&PanelAlert.instance.show(n,0,null,i)},e.prototype._showWatchWX=function(t){this.publicWXGroup.visible=t},e.prototype._onChangeCenterHornPos=function(){this.rollMsg.horizontalCenter=0},e.prototype._resetRollMsgHorizontal=function(){this.rollMsg.horizontalCenter=this._rollMsgHorizontal},e.prototype._playLightOnTarget=function(){var t=null;egret.Tween.removeTweens(this.downLight_img),(t=function(e,n,i,o,a,r){n.scaleX=i,n.scaleY=i,egret.Tween.get(n).to({scaleX:a,scaleY:a},800).wait(500).to({scaleX:i,scaleY:o},500).call(function(){t(e,n,i,o,a,r)})})(this,this.downLight_img,0,0,1.7,1.7)},e.prototype._onBagRefresh=function(){var t=BagService.instance.getItemCountById(3);
this.diamond.updateGold(t)},e.prototype.onJoinRep=function(t){var e=t.data;0==e.result&&(alien.SceneManager.show(SceneNames.PLAY,{roomID:e.roomid,personalgame:!0},alien.sceneEffect.Fade),JoinTable.instance.close())},e.prototype._onBuyReviveSucc=function(){this.checkRedNormalDiamondNum()},e.prototype._onNewPlayerDiamonRewInfoRep=function(t){var e=t.data;if(3==e.optype&&null==e.result){this._self.setHasGetNewDiamond();var n=":"+e.params+"";Alert.show(n,0,function(){server.checkReconnect()})}},e.prototype.doReconnectToLobby=function(){MainLogic.instance.refreshSelfInfo();var t=this.navigator.currentPage;if(t.isClickRedRoom&&t.isClickRedRoom())this.checkRedNormalDiamondNum();else{var e=this.navigator.currentPage.selectedRoom;if(!e)return;if(2==e.roomType)server.getMatchSignUpInfo(e.matchId);else if(1==e.roomType)if(this._self.gold>e.maxScore){var n=GameConfig.getSuitableRoomConfig(this._self.gold);Alert3.show(""+e.maxScore+"\n"+n.name+"",this.joinSpecialRoom.bind(this,n.roomID),"common_btn_enter",!0)}else this._self.gold>=e.minScore?alien.SceneManager.show(SceneNames.PLAY,{action:"quick_join",roomID:e.roomID},alien.sceneEffect.Fade):PanelRechargeTips.instance.show()}},e.prototype._initRedNum=function(){var t=this._self.getNorRoomRedNum();t>0?(t>99?(this.redCountBgImg.visible=!1,this.redNumLabel.textColor=16711680):(this.redNumLabel.textColor=16777215,this.redCountBgImg.visible=!0),this.redNumLabel.text=""+t,this.redNumLabel.visible=!0):(this.redNumLabel.text="0",this.redNumLabel.visible=!1,this.redCountBgImg.visible=!1)},e.prototype._onUserRedCountChange=function(t){this._initRedNum()},e.prototype._hasClickWatchWX=function(){var t=alien.localStorage.getItem("hasWatchWx");return t?!0:!1},e.prototype._saveHasClickWatchWX=function(){alien.localStorage.setItem("hasWatchWx","1")},e.prototype._clearTipWX=function(){this.tipWxImg.visible=!1,egret.Tween.removeTweens(this.tipWxImg)},e.prototype._initTipWX=function(){this._clearTipWX(),this._hasClickWatchWX()||this._runTipWXAni()},e.prototype._runTipWXAni=function(){var t=this.tipWxImg.y;egret.Tween.get(this.tipWxImg).set({visible:!0,loop:!0}).to({y:t+10},400).to({y:t},400).call(this._runTipWXAni,this)},e}(alien.SceneBase);__reflect(SceneRoom.prototype,"SceneRoom");