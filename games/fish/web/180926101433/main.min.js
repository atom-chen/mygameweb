function md5(n){var r,d,e,t,o,a,i,H,F,G=Array(),I=7,g=12,u=17,f=22,s=5,c=9,U=14,C=20,h=4,v=11,T=16,m=23,x=6,S=10,w=15,A=21;for(n=uTF8Encode(n),G=convertToWordArray(n),a=1732584193,i=4023233417,H=2562383102,F=271733878,r=0;r<G.length;r+=16)d=a,e=i,t=H,o=F,a=FF(a,i,H,F,G[r+0],I,3614090360),F=FF(F,a,i,H,G[r+1],g,3905402710),H=FF(H,F,a,i,G[r+2],u,606105819),i=FF(i,H,F,a,G[r+3],f,3250441966),a=FF(a,i,H,F,G[r+4],I,4118548399),F=FF(F,a,i,H,G[r+5],g,1200080426),H=FF(H,F,a,i,G[r+6],u,2821735955),i=FF(i,H,F,a,G[r+7],f,4249261313),a=FF(a,i,H,F,G[r+8],I,1770035416),F=FF(F,a,i,H,G[r+9],g,2336552879),H=FF(H,F,a,i,G[r+10],u,4294925233),i=FF(i,H,F,a,G[r+11],f,2304563134),a=FF(a,i,H,F,G[r+12],I,1804603682),F=FF(F,a,i,H,G[r+13],g,4254626195),H=FF(H,F,a,i,G[r+14],u,2792965006),i=FF(i,H,F,a,G[r+15],f,1236535329),a=GG(a,i,H,F,G[r+1],s,4129170786),F=GG(F,a,i,H,G[r+6],c,3225465664),H=GG(H,F,a,i,G[r+11],U,643717713),i=GG(i,H,F,a,G[r+0],C,3921069994),a=GG(a,i,H,F,G[r+5],s,3593408605),F=GG(F,a,i,H,G[r+10],c,38016083),H=GG(H,F,a,i,G[r+15],U,3634488961),i=GG(i,H,F,a,G[r+4],C,3889429448),a=GG(a,i,H,F,G[r+9],s,568446438),F=GG(F,a,i,H,G[r+14],c,3275163606),H=GG(H,F,a,i,G[r+3],U,4107603335),i=GG(i,H,F,a,G[r+8],C,1163531501),a=GG(a,i,H,F,G[r+13],s,2850285829),F=GG(F,a,i,H,G[r+2],c,4243563512),H=GG(H,F,a,i,G[r+7],U,1735328473),i=GG(i,H,F,a,G[r+12],C,2368359562),a=HH(a,i,H,F,G[r+5],h,4294588738),F=HH(F,a,i,H,G[r+8],v,2272392833),H=HH(H,F,a,i,G[r+11],T,1839030562),i=HH(i,H,F,a,G[r+14],m,4259657740),a=HH(a,i,H,F,G[r+1],h,2763975236),F=HH(F,a,i,H,G[r+4],v,1272893353),H=HH(H,F,a,i,G[r+7],T,4139469664),i=HH(i,H,F,a,G[r+10],m,3200236656),a=HH(a,i,H,F,G[r+13],h,681279174),F=HH(F,a,i,H,G[r+0],v,3936430074),H=HH(H,F,a,i,G[r+3],T,3572445317),i=HH(i,H,F,a,G[r+6],m,76029189),a=HH(a,i,H,F,G[r+9],h,3654602809),F=HH(F,a,i,H,G[r+12],v,3873151461),H=HH(H,F,a,i,G[r+15],T,530742520),i=HH(i,H,F,a,G[r+2],m,3299628645),a=II(a,i,H,F,G[r+0],x,4096336452),F=II(F,a,i,H,G[r+7],S,1126891415),H=II(H,F,a,i,G[r+14],w,2878612391),i=II(i,H,F,a,G[r+5],A,4237533241),a=II(a,i,H,F,G[r+12],x,1700485571),F=II(F,a,i,H,G[r+3],S,2399980690),H=II(H,F,a,i,G[r+10],w,4293915773),i=II(i,H,F,a,G[r+1],A,2240044497),a=II(a,i,H,F,G[r+8],x,1873313359),F=II(F,a,i,H,G[r+15],S,4264355552),H=II(H,F,a,i,G[r+6],w,2734768916),i=II(i,H,F,a,G[r+13],A,1309151649),a=II(a,i,H,F,G[r+4],x,4149444226),F=II(F,a,i,H,G[r+11],S,3174756917),H=II(H,F,a,i,G[r+2],w,718787259),i=II(i,H,F,a,G[r+9],A,3951481745),a=addUnsigned(a,d),i=addUnsigned(i,e),H=addUnsigned(H,t),F=addUnsigned(F,o);var L=wordToHex(a)+wordToHex(i)+wordToHex(H)+wordToHex(F);return L.toLowerCase()}var rotateLeft=function(n,r){return n<<r|n>>>32-r},addUnsigned=function(n,r){var d,e,t,o,a;return t=2147483648&n,o=2147483648&r,d=1073741824&n,e=1073741824&r,a=(1073741823&n)+(1073741823&r),d&e?2147483648^a^t^o:d|e?1073741824&a?3221225472^a^t^o:1073741824^a^t^o:a^t^o},F=function(n,r,d){return n&r|~n&d},G=function(n,r,d){return n&d|r&~d},H=function(n,r,d){return n^r^d},I=function(n,r,d){return r^(n|~d)},FF=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(F(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},GG=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(G(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},HH=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(H(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},II=function(n,r,d,e,t,o,a){return n=addUnsigned(n,addUnsigned(addUnsigned(I(r,d,e),t),a)),addUnsigned(rotateLeft(n,o),r)},convertToWordArray=function(n){for(var r,d=n.length,e=d+8,t=(e-e%64)/64,o=16*(t+1),a=Array(o-1),i=0,H=0;d>H;)r=(H-H%4)/4,i=H%4*8,a[r]=a[r]|n.charCodeAt(H)<<i,H++;return r=(H-H%4)/4,i=H%4*8,a[r]=a[r]|128<<i,a[o-2]=d<<3,a[o-1]=d>>>29,a},wordToHex=function(n){var r,d,e="",t="";for(d=0;3>=d;d++)r=n>>>8*d&255,t="0"+r.toString(16),e+=t.substr(t.length-2,2);return e},uTF8Encode=function(n){n=n.replace(/\x0d\x0a/g,"\n");for(var r="",d=0;d<n.length;d++){var e=n.charCodeAt(d);128>e?r+=String.fromCharCode(e):e>127&&2048>e?(r+=String.fromCharCode(e>>6|192),r+=String.fromCharCode(63&e|128)):(r+=String.fromCharCode(e>>12|224),r+=String.fromCharCode(e>>6&63|128),r+=String.fromCharCode(63&e|128))}return r};!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define,1){var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t()}else define(t)}(function(){return function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=o[a]={exports:{}};e[a][0].call(h.exports,function(t){var o=e[a][1][t];return n(o?o:t)},h,h.exports,t,e,o,i)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,o){function i(){}var n=t("./Scalar");e.exports=i,i.lineInt=function(t,e,o){o=o||0;var i,r,a,s,c,h,l,p=[0,0];return i=t[1][1]-t[0][1],r=t[0][0]-t[1][0],a=i*t[0][0]+r*t[0][1],s=e[1][1]-e[0][1],c=e[0][0]-e[1][0],h=s*e[0][0]+c*e[0][1],l=i*c-s*r,n.eq(l,0,o)||(p[0]=(c*a-r*h)/l,p[1]=(i*h-s*a)/l),p},i.segmentsIntersect=function(t,e,o,i){var n=e[0]-t[0],r=e[1]-t[1],a=i[0]-o[0],s=i[1]-o[1];if(a*r-s*n==0)return!1;var c=(n*(o[1]-t[1])+r*(t[0]-o[0]))/(a*r-s*n),h=(a*(t[1]-o[1])+s*(o[0]-t[0]))/(s*n-a*r);return c>=0&&1>=c&&h>=0&&1>=h}},{"./Scalar":4}],2:[function(t,e,o){function i(){}e.exports=i,i.area=function(t,e,o){return(e[0]-t[0])*(o[1]-t[1])-(o[0]-t[0])*(e[1]-t[1])},i.left=function(t,e,o){return i.area(t,e,o)>0},i.leftOn=function(t,e,o){return i.area(t,e,o)>=0},i.right=function(t,e,o){return i.area(t,e,o)<0},i.rightOn=function(t,e,o){return i.area(t,e,o)<=0};var n=[],r=[];i.collinear=function(t,e,o,a){if(a){var s=n,c=r;s[0]=e[0]-t[0],s[1]=e[1]-t[1],c[0]=o[0]-e[0],c[1]=o[1]-e[1];var h=s[0]*c[0]+s[1]*c[1],l=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=Math.sqrt(c[0]*c[0]+c[1]*c[1]),u=Math.acos(h/(l*p));return a>u}return 0==i.area(t,e,o)},i.sqdist=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return o*o+i*i}},{}],3:[function(t,e,o){function i(){this.vertices=[]}function n(t,e,o,i,n){n=n||0;var r=e[1]-t[1],a=t[0]-e[0],c=r*t[0]+a*t[1],h=i[1]-o[1],l=o[0]-i[0],p=h*o[0]+l*o[1],u=r*l-h*a;return s.eq(u,0,n)?[0,0]:[(l*c-a*p)/u,(r*p-h*c)/u]}var r=t("./Line"),a=t("./Point"),s=t("./Scalar");e.exports=i,i.prototype.at=function(t){var e=this.vertices,o=e.length;return e[0>t?t%o+o:t%o]},i.prototype.first=function(){return this.vertices[0]},i.prototype.last=function(){return this.vertices[this.vertices.length-1]},i.prototype.clear=function(){this.vertices.length=0},i.prototype.append=function(t,e,o){if("undefined"==typeof e)throw new Error("From is not given!");if("undefined"==typeof o)throw new Error("To is not given!");if(e>o-1)throw new Error("lol1");if(o>t.vertices.length)throw new Error("lol2");if(0>e)throw new Error("lol3");for(var i=e;o>i;i++)this.vertices.push(t.vertices[i])},i.prototype.makeCCW=function(){for(var t=0,e=this.vertices,o=1;o<this.vertices.length;++o)(e[o][1]<e[t][1]||e[o][1]==e[t][1]&&e[o][0]>e[t][0])&&(t=o);a.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},i.prototype.reverse=function(){for(var t=[],e=0,o=this.vertices.length;e!==o;e++)t.push(this.vertices.pop());this.vertices=t},i.prototype.isReflex=function(t){return a.right(this.at(t-1),this.at(t),this.at(t+1))};var c=[],h=[];i.prototype.canSee=function(t,e){var o,i,n=c,s=h;if(a.leftOn(this.at(t+1),this.at(t),this.at(e))&&a.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;i=a.sqdist(this.at(t),this.at(e));for(var l=0;l!==this.vertices.length;++l)if((l+1)%this.vertices.length!==t&&l!==t&&a.leftOn(this.at(t),this.at(e),this.at(l+1))&&a.rightOn(this.at(t),this.at(e),this.at(l))&&(n[0]=this.at(t),n[1]=this.at(e),s[0]=this.at(l),s[1]=this.at(l+1),o=r.lineInt(n,s),a.sqdist(this.at(t),o)<i))return!1;return!0},i.prototype.copy=function(t,e,o){var n=o||new i;if(n.clear(),e>t)for(var r=t;e>=r;r++)n.vertices.push(this.vertices[r]);else{for(var r=0;e>=r;r++)n.vertices.push(this.vertices[r]);for(var r=t;r<this.vertices.length;r++)n.vertices.push(this.vertices[r])}return n},i.prototype.getCutEdges=function(){for(var t=[],e=[],o=[],n=new i,r=Number.MAX_VALUE,a=0;a<this.vertices.length;++a)if(this.isReflex(a))for(var s=0;s<this.vertices.length;++s)if(this.canSee(a,s)){e=this.copy(a,s,n).getCutEdges(),o=this.copy(s,a,n).getCutEdges();for(var c=0;c<o.length;c++)e.push(o[c]);e.length<r&&(t=e,r=e.length,t.push([this.at(a),this.at(s)]))}return t},i.prototype.decomp=function(){var t=this.getCutEdges();return t.length>0?this.slice(t):[this]},i.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],o=0;o<t.length;o++)for(var i=t[o],n=0;n<e.length;n++){var r=e[n],a=r.slice(i);if(a){e.splice(n,1),e.push(a[0],a[1]);break}}return e}var i=t,o=this.vertices.indexOf(i[0]),n=this.vertices.indexOf(i[1]);return-1!=o&&-1!=n?[this.copy(o,n),this.copy(n,o)]:!1},i.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var o=0;e-1>o;o++)if(r.segmentsIntersect(t[e],t[e+1],t[o],t[o+1]))return!1;for(var e=1;e<t.length-2;e++)if(r.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},i.prototype.quickDecomp=function(t,e,o,r,s,c){s=s||100,c=c||0,r=r||25,t="undefined"!=typeof t?t:[],e=e||[],o=o||[];var h=[0,0],l=[0,0],p=[0,0],u=0,d=0,f=0,v=0,y=0,m=0,g=0,A=new i,b=new i,E=this,B=this.vertices;if(B.length<3)return t;if(c++,c>s)return console.warn("quickDecomp: max level ("+s+") reached."),t;for(var q=0;q<this.vertices.length;++q)if(E.isReflex(q)){e.push(E.vertices[q]),u=d=Number.MAX_VALUE;for(var P=0;P<this.vertices.length;++P)a.left(E.at(q-1),E.at(q),E.at(P))&&a.rightOn(E.at(q-1),E.at(q),E.at(P-1))&&(p=n(E.at(q-1),E.at(q),E.at(P),E.at(P-1)),a.right(E.at(q+1),E.at(q),p)&&(f=a.sqdist(E.vertices[q],p),d>f&&(d=f,l=p,m=P))),a.left(E.at(q+1),E.at(q),E.at(P+1))&&a.rightOn(E.at(q+1),E.at(q),E.at(P))&&(p=n(E.at(q+1),E.at(q),E.at(P),E.at(P+1)),a.left(E.at(q-1),E.at(q),p)&&(f=a.sqdist(E.vertices[q],p),u>f&&(u=f,h=p,y=P)));if(m==(y+1)%this.vertices.length)p[0]=(l[0]+h[0])/2,p[1]=(l[1]+h[1])/2,o.push(p),y>q?(A.append(E,q,y+1),A.vertices.push(p),b.vertices.push(p),0!=m&&b.append(E,m,E.vertices.length),b.append(E,0,q+1)):(0!=q&&A.append(E,q,E.vertices.length),A.append(E,0,y+1),A.vertices.push(p),b.vertices.push(p),b.append(E,m,q+1));else{if(m>y&&(y+=this.vertices.length),v=Number.MAX_VALUE,m>y)return t;for(var P=m;y>=P;++P)a.leftOn(E.at(q-1),E.at(q),E.at(P))&&a.rightOn(E.at(q+1),E.at(q),E.at(P))&&(f=a.sqdist(E.at(q),E.at(P)),v>f&&(v=f,g=P%this.vertices.length));g>q?(A.append(E,q,g+1),0!=g&&b.append(E,g,B.length),b.append(E,0,q+1)):(0!=q&&A.append(E,q,B.length),A.append(E,0,g+1),b.append(E,g,q+1))}return A.vertices.length<b.vertices.length?(A.quickDecomp(t,e,o,r,s,c),b.quickDecomp(t,e,o,r,s,c)):(b.quickDecomp(t,e,o,r,s,c),A.quickDecomp(t,e,o,r,s,c)),t}return t.push(this),t},i.prototype.removeCollinearPoints=function(t){for(var e=0,o=this.vertices.length-1;this.vertices.length>3&&o>=0;--o)a.collinear(this.at(o-1),this.at(o),this.at(o+1),t)&&(this.vertices.splice(o%this.vertices.length,1),o--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,o){function i(){}e.exports=i,i.eq=function(t,e,o){return o=o||0,Math.abs(t-e)<o}},{}],5:[function(t,e,o){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,o){e.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(t,e,o){function i(t){this.lowerBound=n.create(),t&&t.lowerBound&&n.copy(this.lowerBound,t.lowerBound),this.upperBound=n.create(),t&&t.upperBound&&n.copy(this.upperBound,t.upperBound)}var n=t("../math/vec2");t("../utils/Utils"),e.exports=i;var r=n.create();i.prototype.setFromPoints=function(t,e,o,i){var a=this.lowerBound,s=this.upperBound;"number"!=typeof o&&(o=0),0!==o?n.rotate(a,t[0],o):n.copy(a,t[0]),n.copy(s,a);for(var c=Math.cos(o),h=Math.sin(o),l=1;l<t.length;l++){var p=t[l];if(0!==o){var u=p[0],d=p[1];r[0]=c*u-h*d,r[1]=h*u+c*d,p=r}for(var f=0;2>f;f++)p[f]>s[f]&&(s[f]=p[f]),p[f]<a[f]&&(a[f]=p[f])}e&&(n.add(this.lowerBound,this.lowerBound,e),n.add(this.upperBound,this.upperBound,e)),i&&(this.lowerBound[0]-=i,this.lowerBound[1]-=i,this.upperBound[0]+=i,this.upperBound[1]+=i)},i.prototype.copy=function(t){n.copy(this.lowerBound,t.lowerBound),n.copy(this.upperBound,t.upperBound)},i.prototype.extend=function(t){for(var e=2;e--;){var o=t.lowerBound[e];this.lowerBound[e]>o&&(this.lowerBound[e]=o);var i=t.upperBound[e];this.upperBound[e]<i&&(this.upperBound[e]=i)}},i.prototype.overlaps=function(t){var e=this.lowerBound,o=this.upperBound,i=t.lowerBound,n=t.upperBound;return(i[0]<=o[0]&&o[0]<=n[0]||e[0]<=n[0]&&n[0]<=o[0])&&(i[1]<=o[1]&&o[1]<=n[1]||e[1]<=n[1]&&n[1]<=o[1])},i.prototype.containsPoint=function(t){var e=this.lowerBound,o=this.upperBound;return e[0]<=t[0]&&t[0]<=o[0]&&e[1]<=t[1]&&t[1]<=o[1]},i.prototype.overlapsRay=function(t){var e=1/t.direction[0],o=1/t.direction[1],i=(this.lowerBound[0]-t.from[0])*e,n=(this.upperBound[0]-t.from[0])*e,r=(this.lowerBound[1]-t.from[1])*o,a=(this.upperBound[1]-t.from[1])*o,s=Math.max(Math.max(Math.min(i,n),Math.min(r,a))),c=Math.min(Math.min(Math.max(i,n),Math.max(r,a)));return 0>c?-1:s>c?-1:s}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,o){function i(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=i.AABB}var n=t("../math/vec2"),r=t("../objects/Body");e.exports=i,i.AABB=1,i.BOUNDING_CIRCLE=2,i.prototype.setWorld=function(t){this.world=t},i.prototype.getCollisionPairs=function(t){};var a=n.create();i.boundingRadiusCheck=function(t,e){n.sub(a,t.position,e.position);var o=n.squaredLength(a),i=t.boundingRadius+e.boundingRadius;return i*i>=o},i.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},i.prototype.boundingVolumeCheck=function(t,e){var o;switch(this.boundingVolumeType){case i.BOUNDING_CIRCLE:o=i.boundingRadiusCheck(t,e);break;case i.AABB:o=i.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return o},i.canCollide=function(t,e){var o=r.KINEMATIC,i=r.STATIC;return t.type===i&&e.type===i?!1:t.type===o&&e.type===i||t.type===i&&e.type===o?!1:t.type===o&&e.type===o?!1:t.sleepState===r.SLEEPING&&e.sleepState===r.SLEEPING?!1:t.sleepState===r.SLEEPING&&e.type===i||e.sleepState===r.SLEEPING&&t.type===i?!1:!0},i.NAIVE=1,i.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,o){function i(){n.call(this,n.NAIVE)}var n=(t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle"),t("../collision/Broadphase"));t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.getCollisionPairs=function(t){var e=t.bodies,o=this.result;o.length=0;for(var i=0,r=e.length;i!==r;i++)for(var a=e[i],s=0;i>s;s++){var c=e[s];n.canCollide(a,c)&&this.boundingVolumeCheck(a,c)&&o.push(a,c)}return o},i.prototype.aabbQuery=function(t,e,o){o=o||[];for(var i=t.bodies,n=0;n<i.length;n++){var r=i[n];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(e)&&o.push(r)}return o}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,o){function i(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new l({size:32}),this.frictionEquationPool=new p({size:64}),this.restitution=0,this.stiffness=d.DEFAULT_STIFFNESS,this.relaxation=d.DEFAULT_RELAXATION,this.frictionStiffness=d.DEFAULT_STIFFNESS,this.frictionRelaxation=d.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new u,this.contactSkinSize=.01}function n(t,e){a.set(t.vertices[0],.5*-e.length,-e.radius),a.set(t.vertices[1],.5*e.length,-e.radius),a.set(t.vertices[2],.5*e.length,e.radius),a.set(t.vertices[3],.5*-e.length,e.radius)}function r(t,e,o,i){for(var n=j,r=z,h=Y,l=K,p=t,u=e.vertices,d=null,f=0;f!==u.length+1;f++){var v=u[f%u.length],y=u[(f+1)%u.length];a.rotate(n,v,i),a.rotate(r,y,i),c(n,n,o),c(r,r,o),s(h,n,p),s(l,r,p);var m=a.crossLength(h,l);if(null===d&&(d=m),0>=m*d)return!1;d=m}return!0}var a=t("../math/vec2"),s=a.sub,c=a.add,h=a.dot,l=(t("../utils/Utils"),t("../utils/ContactEquationPool")),p=t("../utils/FrictionEquationPool"),u=t("../utils/TupleDictionary"),d=t("../equations/Equation"),f=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),v=t("../shapes/Convex"),y=t("../shapes/Shape"),m=(t("../objects/Body"),t("../shapes/Box"));e.exports=i;var g=a.fromValues(0,1),A=a.fromValues(0,0),b=a.fromValues(0,0),E=a.fromValues(0,0),B=a.fromValues(0,0),q=a.fromValues(0,0),P=a.fromValues(0,0),w=a.fromValues(0,0),S=a.fromValues(0,0),C=a.fromValues(0,0),L=a.fromValues(0,0),x=a.fromValues(0,0),F=a.fromValues(0,0),M=a.fromValues(0,0),I=a.fromValues(0,0),R=a.fromValues(0,0),V=a.fromValues(0,0),T=a.fromValues(0,0),N=a.fromValues(0,0),G=[],O=a.create(),U=a.create();i.prototype.bodiesOverlap=function(t,e){for(var o=O,i=U,n=0,r=t.shapes.length;n!==r;n++){var a=t.shapes[n];t.toWorldFrame(o,a.position);for(var s=0,c=e.shapes.length;s!==c;s++){var h=e.shapes[s];if(e.toWorldFrame(i,h.position),this[a.type|h.type](t,a,o,a.angle+t.angle,e,h,i,h.angle+e.angle,!0))return!0}}return!1},i.prototype.collidedLastStep=function(t,e){var o=0|t.id,i=0|e.id;return!!this.collidingBodiesLastStep.get(o,i)},i.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var o=t[e],i=o.bodyA.id,n=o.bodyB.id;this.collidingBodiesLastStep.set(i,n,!0)}for(var r=this.contactEquations,a=this.frictionEquations,s=0;s<r.length;s++)this.contactEquationPool.release(r[s]);for(var s=0;s<a.length;s++)this.frictionEquationPool.release(a[s]);this.contactEquations.length=this.frictionEquations.length=0},i.prototype.createContactEquation=function(t,e,o,i){var n=this.contactEquationPool.get();return n.bodyA=t,n.bodyB=e,n.shapeA=o,n.shapeB=i,n.restitution=this.restitution,n.firstImpact=!this.collidedLastStep(t,e),n.stiffness=this.stiffness,n.relaxation=this.relaxation,n.needsUpdate=!0,n.enabled=this.enabledEquations,n.offset=this.contactSkinSize,n},i.prototype.createFrictionEquation=function(t,e,o,i){var n=this.frictionEquationPool.get();return n.bodyA=t,n.bodyB=e,n.shapeA=o,n.shapeB=i,n.setSlipForce(this.slipForce),n.frictionCoefficient=this.frictionCoefficient,n.relativeVelocity=this.surfaceVelocity,n.enabled=this.enabledEquations,n.needsUpdate=!0,n.stiffness=this.frictionStiffness,n.relaxation=this.frictionRelaxation,n.contactEquations.length=0,n},i.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return a.copy(e.contactPointA,t.contactPointA),a.copy(e.contactPointB,t.contactPointB),a.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},i.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],o=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),i=e.bodyA;e.bodyB,a.set(o.contactPointA,0,0),a.set(o.contactPointB,0,0),a.set(o.t,0,0);for(var n=0;n!==t;n++)e=this.contactEquations[this.contactEquations.length-1-n],e.bodyA===i?(a.add(o.t,o.t,e.normalA),a.add(o.contactPointA,o.contactPointA,e.contactPointA),a.add(o.contactPointB,o.contactPointB,e.contactPointB)):(a.sub(o.t,o.t,e.normalA),a.add(o.contactPointA,o.contactPointA,e.contactPointB),a.add(o.contactPointB,o.contactPointB,e.contactPointA)),o.contactEquations.push(e);var r=1/t;return a.scale(o.contactPointA,o.contactPointA,r),a.scale(o.contactPointB,o.contactPointB,r),a.normalize(o.t,o.t),a.rotate90cw(o.t,o.t),o},i.prototype[y.LINE|y.CONVEX]=i.prototype.convexLine=function(t,e,o,i,n,r,a,s,c){return c?!1:0},i.prototype[y.LINE|y.BOX]=i.prototype.lineBox=function(t,e,o,i,n,r,a,s,c){return c?!1:0};var k=new m({width:1,height:1}),_=a.create();i.prototype[y.CAPSULE|y.CONVEX]=i.prototype[y.CAPSULE|y.BOX]=i.prototype.convexCapsule=function(t,e,o,i,r,s,c,h,l){var p=_;a.set(p,s.length/2,0),a.rotate(p,p,h),a.add(p,p,c);var u=this.circleConvex(r,s,p,h,t,e,o,i,l,s.radius);a.set(p,-s.length/2,0),a.rotate(p,p,h),a.add(p,p,c);var d=this.circleConvex(r,s,p,h,t,e,o,i,l,s.radius);if(l&&(u||d))return!0;var f=k;n(f,s);var v=this.convexConvex(t,e,o,i,r,f,c,h,l);return v+u+d},i.prototype[y.CAPSULE|y.LINE]=i.prototype.lineCapsule=function(t,e,o,i,n,r,a,s,c){return c?!1:0};var D=a.create(),W=a.create(),X=new m({width:1,height:1});i.prototype[y.CAPSULE|y.CAPSULE]=i.prototype.capsuleCapsule=function(t,e,o,i,r,s,c,h,l){for(var p,u=D,d=W,f=0,v=0;2>v;v++){a.set(u,(0===v?-1:1)*e.length/2,0),a.rotate(u,u,i),a.add(u,u,o);for(var y=0;2>y;y++){a.set(d,(0===y?-1:1)*s.length/2,0),a.rotate(d,d,h),a.add(d,d,c),this.enableFrictionReduction&&(p=this.enableFriction,this.enableFriction=!1);var m=this.circleCircle(t,e,u,i,r,s,d,h,l,e.radius,s.radius);if(this.enableFrictionReduction&&(this.enableFriction=p),l&&m)return!0;f+=m}}this.enableFrictionReduction&&(p=this.enableFriction,this.enableFriction=!1);var g=X;n(g,e);var A=this.convexCapsule(t,g,o,i,r,s,c,h,l);if(this.enableFrictionReduction&&(this.enableFriction=p),l&&A)return!0;if(f+=A,this.enableFrictionReduction){var p=this.enableFriction;this.enableFriction=!1}n(g,s);var b=this.convexCapsule(r,g,c,h,t,e,o,i,l);return this.enableFrictionReduction&&(this.enableFriction=p),l&&b?!0:(f+=b,this.enableFrictionReduction&&f&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(f)),f)},i.prototype[y.LINE|y.LINE]=i.prototype.lineLine=function(t,e,o,i,n,r,a,s,c){return c?!1:0},i.prototype[y.PLANE|y.LINE]=i.prototype.planeLine=function(t,e,o,i,n,r,l,p,u){var d=A,f=b,v=E,y=B,m=q,L=P,x=w,F=S,M=C,I=G,R=0;a.set(d,-r.length/2,0),a.set(f,r.length/2,0),a.rotate(v,d,p),a.rotate(y,f,p),c(v,v,l),c(y,y,l),a.copy(d,v),a.copy(f,y),s(m,f,d),a.normalize(L,m),a.rotate90cw(M,L),a.rotate(F,g,i),I[0]=d,I[1]=f;for(var V=0;V<I.length;V++){var T=I[V];s(x,T,o);var N=h(x,F);if(0>N){if(u)return!0;var O=this.createContactEquation(t,n,e,r);R++,a.copy(O.normalA,F),a.normalize(O.normalA,O.normalA),a.scale(x,F,N),s(O.contactPointA,T,x),s(O.contactPointA,O.contactPointA,t.position),s(O.contactPointB,T,l),c(O.contactPointB,O.contactPointB,l),s(O.contactPointB,O.contactPointB,n.position),this.contactEquations.push(O),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(O))}}return u?!1:(this.enableFrictionReduction||R&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(R)),R)},i.prototype[y.PARTICLE|y.CAPSULE]=i.prototype.particleCapsule=function(t,e,o,i,n,r,a,s,c){return this.circleLine(t,e,o,i,n,r,a,s,c,r.radius,0)},i.prototype[y.CIRCLE|y.LINE]=i.prototype.circleLine=function(t,e,o,i,n,r,l,p,u,d,f){var d=d||0,f="undefined"!=typeof f?f:e.radius,v=A,y=b,m=E,g=B,R=q,V=P,T=w,N=S,O=C,U=L,k=x,_=F,D=M,W=I,X=G;a.set(N,-r.length/2,0),a.set(O,r.length/2,0),a.rotate(U,N,p),a.rotate(k,O,p),c(U,U,l),c(k,k,l),a.copy(N,U),a.copy(O,k),s(V,O,N),a.normalize(T,V),a.rotate90cw(R,T),s(_,o,N);var j=h(_,R);s(g,N,l),s(D,o,l);var z=f+d;if(Math.abs(j)<z){a.scale(v,R,j),s(m,o,v),a.scale(y,R,h(R,D)),a.normalize(y,y),a.scale(y,y,d),c(m,m,y);var Y=h(T,m),K=h(T,N),H=h(T,O);if(Y>K&&H>Y){if(u)return!0;var Z=this.createContactEquation(t,n,e,r);return a.scale(Z.normalA,v,-1),a.normalize(Z.normalA,Z.normalA),a.scale(Z.contactPointA,Z.normalA,f),c(Z.contactPointA,Z.contactPointA,o),s(Z.contactPointA,Z.contactPointA,t.position),s(Z.contactPointB,m,l),c(Z.contactPointB,Z.contactPointB,l),s(Z.contactPointB,Z.contactPointB,n.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}X[0]=N,X[1]=O;for(var J=0;J<X.length;J++){var Q=X[J];if(s(_,Q,o),a.squaredLength(_)<Math.pow(z,2)){if(u)return!0;var Z=this.createContactEquation(t,n,e,r);return a.copy(Z.normalA,_),a.normalize(Z.normalA,Z.normalA),a.scale(Z.contactPointA,Z.normalA,f),c(Z.contactPointA,Z.contactPointA,o),s(Z.contactPointA,Z.contactPointA,t.position),s(Z.contactPointB,Q,l),a.scale(W,Z.normalA,-d),c(Z.contactPointB,Z.contactPointB,W),c(Z.contactPointB,Z.contactPointB,l),s(Z.contactPointB,Z.contactPointB,n.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}return 0},i.prototype[y.CIRCLE|y.CAPSULE]=i.prototype.circleCapsule=function(t,e,o,i,n,r,a,s,c){return this.circleLine(t,e,o,i,n,r,a,s,c,r.radius)},i.prototype[y.CIRCLE|y.CONVEX]=i.prototype[y.CIRCLE|y.BOX]=i.prototype.circleConvex=function(t,e,o,i,n,h,l,p,u,d){for(var d="number"==typeof d?d:e.radius,f=A,v=b,y=E,m=B,g=q,P=L,w=x,S=M,C=I,F=R,T=V,N=!1,G=Number.MAX_VALUE,O=h.vertices,U=0;U!==O.length+1;U++){var k=O[U%O.length],_=O[(U+1)%O.length];if(a.rotate(f,k,p),a.rotate(v,_,p),c(f,f,l),c(v,v,l),s(y,v,f),a.normalize(m,y),a.rotate90cw(g,m),a.scale(C,g,-e.radius),c(C,C,o),r(C,h,l,p)){a.sub(F,f,C);var D=Math.abs(a.dot(F,g));G>D&&(a.copy(T,C),G=D,a.scale(S,g,D),a.add(S,S,C),N=!0)}}if(N){if(u)return!0;var W=this.createContactEquation(t,n,e,h);return a.sub(W.normalA,T,o),a.normalize(W.normalA,W.normalA),a.scale(W.contactPointA,W.normalA,d),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,S,l),c(W.contactPointB,W.contactPointB,l),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}if(d>0)for(var U=0;U<O.length;U++){var X=O[U];if(a.rotate(w,X,p),c(w,w,l),s(P,w,o),a.squaredLength(P)<Math.pow(d,2)){if(u)return!0;var W=this.createContactEquation(t,n,e,h);return a.copy(W.normalA,P),a.normalize(W.normalA,W.normalA),a.scale(W.contactPointA,W.normalA,d),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,w,l),c(W.contactPointB,W.contactPointB,l),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}}return 0};var j=a.create(),z=a.create(),Y=a.create(),K=a.create();i.prototype[y.PARTICLE|y.CONVEX]=i.prototype[y.PARTICLE|y.BOX]=i.prototype.particleConvex=function(t,e,o,i,n,l,p,u,d){var f=A,v=b,y=E,m=B,g=q,S=P,C=w,x=L,F=M,I=T,R=N,V=Number.MAX_VALUE,G=!1,O=l.vertices;if(!r(o,l,p,u))return 0;if(d)return!0;for(var U=0;U!==O.length+1;U++){var k=O[U%O.length],_=O[(U+1)%O.length];a.rotate(f,k,u),a.rotate(v,_,u),c(f,f,p),c(v,v,p),s(y,v,f),a.normalize(m,y),a.rotate90cw(g,m),s(x,o,f),h(x,g),s(S,f,p),s(C,o,p),a.sub(I,f,o);var D=Math.abs(a.dot(I,g));V>D&&(V=D,a.scale(F,g,D),a.add(F,F,o),a.copy(R,g),G=!0)}if(G){var W=this.createContactEquation(t,n,e,l);return a.scale(W.normalA,R,-1),a.normalize(W.normalA,W.normalA),a.set(W.contactPointA,0,0),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,F,p),c(W.contactPointB,W.contactPointB,p),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}return 0},i.prototype[y.CIRCLE]=i.prototype.circleCircle=function(t,e,o,i,n,r,h,l,p,u,d){var f=A,u=u||e.radius,d=d||r.radius;s(f,o,h);var v=u+d;if(a.squaredLength(f)>Math.pow(v,2))return 0;if(p)return!0;var y=this.createContactEquation(t,n,e,r);return s(y.normalA,h,o),a.normalize(y.normalA,y.normalA),a.scale(y.contactPointA,y.normalA,u),a.scale(y.contactPointB,y.normalA,-d),c(y.contactPointA,y.contactPointA,o),s(y.contactPointA,y.contactPointA,t.position),c(y.contactPointB,y.contactPointB,h),s(y.contactPointB,y.contactPointB,n.position),this.contactEquations.push(y),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(y)),1},i.prototype[y.PLANE|y.CONVEX]=i.prototype[y.PLANE|y.BOX]=i.prototype.planeConvex=function(t,e,o,i,n,r,l,p,u){var d=A,f=b,v=E,y=0;a.rotate(f,g,i);for(var m=0;m!==r.vertices.length;m++){var B=r.vertices[m];if(a.rotate(d,B,p),c(d,d,l),s(v,d,o),h(v,f)<=0){if(u)return!0;y++;var q=this.createContactEquation(t,n,e,r);s(v,d,o),a.copy(q.normalA,f);var P=h(v,q.normalA);a.scale(v,q.normalA,P),s(q.contactPointB,d,n.position),s(q.contactPointA,d,v),s(q.contactPointA,q.contactPointA,t.position),this.contactEquations.push(q),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(q))}}return this.enableFrictionReduction&&this.enableFriction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},i.prototype[y.PARTICLE|y.PLANE]=i.prototype.particlePlane=function(t,e,o,i,n,r,c,l,p){var u=A,d=b;l=l||0,s(u,o,c),a.rotate(d,g,l);var f=h(u,d);if(f>0)return 0;if(p)return!0;var v=this.createContactEquation(n,t,r,e);return a.copy(v.normalA,d),a.scale(u,v.normalA,f),s(v.contactPointA,o,u),s(v.contactPointA,v.contactPointA,n.position),s(v.contactPointB,o,t.position),this.contactEquations.push(v),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(v)),1},i.prototype[y.CIRCLE|y.PARTICLE]=i.prototype.circleParticle=function(t,e,o,i,n,r,h,l,p){var u=A;if(s(u,h,o),a.squaredLength(u)>Math.pow(e.radius,2))return 0;if(p)return!0;var d=this.createContactEquation(t,n,e,r);return a.copy(d.normalA,u),a.normalize(d.normalA,d.normalA),a.scale(d.contactPointA,d.normalA,e.radius),c(d.contactPointA,d.contactPointA,o),s(d.contactPointA,d.contactPointA,t.position),s(d.contactPointB,h,n.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1};var H=new f({radius:1}),Z=a.create(),J=a.create();a.create(),i.prototype[y.PLANE|y.CAPSULE]=i.prototype.planeCapsule=function(t,e,o,i,n,r,s,h,l){var p=Z,u=J,d=H;a.set(p,-r.length/2,0),a.rotate(p,p,h),c(p,p,s),a.set(u,r.length/2,0),a.rotate(u,u,h),c(u,u,s),d.radius=r.radius;var f;this.enableFrictionReduction&&(f=this.enableFriction,this.enableFriction=!1);var v=this.circlePlane(n,d,p,0,t,e,o,i,l),y=this.circlePlane(n,d,u,0,t,e,o,i,l);if(this.enableFrictionReduction&&(this.enableFriction=f),l)return v||y;var m=v+y;return this.enableFrictionReduction&&m&&this.frictionEquations.push(this.createFrictionFromAverage(m)),m},i.prototype[y.CIRCLE|y.PLANE]=i.prototype.circlePlane=function(t,e,o,i,n,r,l,p,u){var d=t,f=e,v=o,y=n,m=l,B=p;B=B||0;var q=A,P=b,w=E;s(q,v,m),a.rotate(P,g,B);var S=h(P,q);if(S>f.radius)return 0;if(u)return!0;var C=this.createContactEquation(y,d,r,e);return a.copy(C.normalA,P),a.scale(C.contactPointB,C.normalA,-f.radius),c(C.contactPointB,C.contactPointB,v),s(C.contactPointB,C.contactPointB,d.position),a.scale(w,C.normalA,S),s(C.contactPointA,q,w),c(C.contactPointA,C.contactPointA,m),s(C.contactPointA,C.contactPointA,y.position),this.contactEquations.push(C),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(C)),1},i.prototype[y.CONVEX]=i.prototype[y.CONVEX|y.BOX]=i.prototype[y.BOX]=i.prototype.convexConvex=function(t,e,o,n,r,l,p,u,d,f){var v=A,y=b,m=E,g=B,P=q,L=w,x=S,F=C,M=0,f="number"==typeof f?f:0,I=i.findSeparatingAxis(e,o,n,l,p,u,v);if(!I)return 0;s(x,p,o),h(v,x)>0&&a.scale(v,v,-1);var R=i.getClosestEdge(e,n,v,!0),V=i.getClosestEdge(l,u,v);if(-1===R||-1===V)return 0;for(var T=0;2>T;T++){var N=R,G=V,O=e,U=l,k=o,_=p,D=n,W=u,X=t,j=r;if(0===T){var z;z=N,N=G,G=z,z=O,O=U,U=z,z=k,k=_,_=z,z=D,D=W,W=z,z=X,X=j,j=z}for(var Y=G;G+2>Y;Y++){var K=U.vertices[(Y+U.vertices.length)%U.vertices.length];a.rotate(y,K,W),c(y,y,_);for(var H=0,Z=N-1;N+2>Z;Z++){var J=O.vertices[(Z+O.vertices.length)%O.vertices.length],Q=O.vertices[(Z+1+O.vertices.length)%O.vertices.length];a.rotate(m,J,D),a.rotate(g,Q,D),c(m,m,k),c(g,g,k),s(P,g,m),a.rotate90cw(F,P),a.normalize(F,F),s(x,y,m);var $=h(F,x);(Z===N&&f>=$||Z!==N&&0>=$)&&H++}if(H>=3){if(d)return!0;var te=this.createContactEquation(X,j,O,U);M++;var J=O.vertices[N%O.vertices.length],Q=O.vertices[(N+1)%O.vertices.length];a.rotate(m,J,D),a.rotate(g,Q,D),c(m,m,k),c(g,g,k),s(P,g,m),a.rotate90cw(te.normalA,P),a.normalize(te.normalA,te.normalA),s(x,y,m);var $=h(te.normalA,x);a.scale(L,te.normalA,$),s(te.contactPointA,y,k),s(te.contactPointA,te.contactPointA,L),c(te.contactPointA,te.contactPointA,k),s(te.contactPointA,te.contactPointA,X.position),s(te.contactPointB,y,_),c(te.contactPointB,te.contactPointB,_),s(te.contactPointB,te.contactPointB,j.position),this.contactEquations.push(te),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(te))}}}return this.enableFrictionReduction&&this.enableFriction&&M&&this.frictionEquations.push(this.createFrictionFromAverage(M)),M};var Q=a.fromValues(0,0);i.projectConvexOntoAxis=function(t,e,o,i,n){var r,s,c=null,l=null,p=Q;a.rotate(p,i,-o);for(var u=0;u<t.vertices.length;u++)r=t.vertices[u],s=h(r,p),(null===c||s>c)&&(c=s),(null===l||l>s)&&(l=s);if(l>c){var d=l;l=c,c=d}var f=h(e,i);a.set(n,l+f,c+f)};var $=a.fromValues(0,0),te=a.fromValues(0,0),ee=a.fromValues(0,0),oe=a.fromValues(0,0),ie=a.fromValues(0,0),ne=a.fromValues(0,0);i.findSeparatingAxis=function(t,e,o,n,r,c,h){var l=null,p=!1,u=!1,d=$,f=te,v=ee,y=oe,g=ie,A=ne;if(t instanceof m&&n instanceof m)for(var b=0;2!==b;b++){var E=t,B=o;1===b&&(E=n,B=c);for(var q=0;2!==q;q++){0===q?a.set(y,0,1):1===q&&a.set(y,1,0),0!==B&&a.rotate(y,y,B),i.projectConvexOntoAxis(t,e,o,y,g),i.projectConvexOntoAxis(n,r,c,y,A);var P=g,w=A,S=!1;g[0]>A[0]&&(w=g,P=A,S=!0);var C=w[0]-P[1];p=0>=C,(null===l||C>l)&&(a.copy(h,y),l=C,u=p)}}else for(var b=0;2!==b;b++){var E=t,B=o;1===b&&(E=n,B=c);for(var q=0;q!==E.vertices.length;q++){a.rotate(f,E.vertices[q],B),a.rotate(v,E.vertices[(q+1)%E.vertices.length],B),s(d,v,f),a.rotate90cw(y,d),a.normalize(y,y),i.projectConvexOntoAxis(t,e,o,y,g),i.projectConvexOntoAxis(n,r,c,y,A);var P=g,w=A,S=!1;g[0]>A[0]&&(w=g,P=A,S=!0);var C=w[0]-P[1];p=0>=C,(null===l||C>l)&&(a.copy(h,y),l=C,u=p)}}return u};var re=a.fromValues(0,0),ae=a.fromValues(0,0),se=a.fromValues(0,0);i.getClosestEdge=function(t,e,o,i){var n=re,r=ae,c=se;a.rotate(n,o,-e),i&&a.scale(n,n,-1);for(var l=-1,p=t.vertices.length,u=-1,d=0;d!==p;d++){s(r,t.vertices[(d+1)%p],t.vertices[d%p]),a.rotate90cw(c,r),a.normalize(c,c);var f=h(c,n);(-1===l||f>u)&&(l=d%p,u=f)}return l};var ce=a.create(),he=a.create(),le=a.create(),pe=a.create(),ue=a.create(),de=a.create(),fe=a.create();i.prototype[y.CIRCLE|y.HEIGHTFIELD]=i.prototype.circleHeightfield=function(t,e,o,i,n,r,h,l,p,u){var d=r.heights,u=u||e.radius,f=r.elementWidth,v=he,y=ce,m=ue,g=fe,A=de,b=le,E=pe,B=Math.floor((o[0]-u-h[0])/f),q=Math.ceil((o[0]+u-h[0])/f);0>B&&(B=0),q>=d.length&&(q=d.length-1);for(var P=d[B],w=d[q],S=B;q>S;S++)d[S]<w&&(w=d[S]),d[S]>P&&(P=d[S]);if(o[1]-u>P)return p?!1:0;for(var C=!1,S=B;q>S;S++){a.set(b,S*f,d[S]),a.set(E,(S+1)*f,d[S+1]),a.add(b,b,h),a.add(E,E,h),a.sub(A,E,b),a.rotate(A,A,Math.PI/2),a.normalize(A,A),a.scale(y,A,-u),a.add(y,y,o),a.sub(v,y,b);var L=a.dot(v,A);if(y[0]>=b[0]&&y[0]<E[0]&&0>=L){if(p)return!0;C=!0,a.scale(v,A,-L),a.add(m,y,v),a.copy(g,A);var x=this.createContactEquation(n,t,r,e);a.copy(x.normalA,g),a.scale(x.contactPointB,x.normalA,-u),c(x.contactPointB,x.contactPointB,o),s(x.contactPointB,x.contactPointB,t.position),a.copy(x.contactPointA,m),a.sub(x.contactPointA,x.contactPointA,n.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}}if(C=!1,u>0)for(var S=B;q>=S;S++)if(a.set(b,S*f,d[S]),a.add(b,b,h),a.sub(v,o,b),a.squaredLength(v)<Math.pow(u,2)){if(p)return!0;
C=!0;var x=this.createContactEquation(n,t,r,e);a.copy(x.normalA,v),a.normalize(x.normalA,x.normalA),a.scale(x.contactPointB,x.normalA,-u),c(x.contactPointB,x.contactPointB,o),s(x.contactPointB,x.contactPointB,t.position),s(x.contactPointA,b,h),c(x.contactPointA,x.contactPointA,h),s(x.contactPointA,x.contactPointA,n.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}return C?1:0};var ve=a.create(),ye=a.create(),me=a.create(),ge=new v({vertices:[a.create(),a.create(),a.create(),a.create()]});i.prototype[y.BOX|y.HEIGHTFIELD]=i.prototype[y.CONVEX|y.HEIGHTFIELD]=i.prototype.convexHeightfield=function(t,e,o,i,n,r,s,c,h){var l=r.heights,p=r.elementWidth,u=ve,d=ye,f=me,v=ge,y=Math.floor((t.aabb.lowerBound[0]-s[0])/p),m=Math.ceil((t.aabb.upperBound[0]-s[0])/p);0>y&&(y=0),m>=l.length&&(m=l.length-1);for(var g=l[y],A=l[m],b=y;m>b;b++)l[b]<A&&(A=l[b]),l[b]>g&&(g=l[b]);if(t.aabb.lowerBound[1]>g)return h?!1:0;for(var E=0,b=y;m>b;b++){a.set(u,b*p,l[b]),a.set(d,(b+1)*p,l[b+1]),a.add(u,u,s),a.add(d,d,s);var B=100;a.set(f,.5*(d[0]+u[0]),.5*(d[1]+u[1]-B)),a.sub(v.vertices[0],d,f),a.sub(v.vertices[1],u,f),a.copy(v.vertices[2],v.vertices[1]),a.copy(v.vertices[3],v.vertices[0]),v.vertices[2][1]-=B,v.vertices[3][1]-=B,E+=this.convexConvex(t,e,o,i,n,v,f,0,h)}return E}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,o){function i(t){t=t||{},this.from=t.from?r.fromValues(t.from[0],t.from[1]):r.create(),this.to=t.to?r.fromValues(t.to[0],t.to[1]):r.create(),this.checkCollisionResponse=void 0!==t.checkCollisionResponse?t.checkCollisionResponse:!0,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:i.ANY,this.callback=t.callback||function(t){},this.direction=r.create(),this.length=1,this.update()}function n(t,e,o){r.sub(s,o,t);var i=r.dot(s,e);return r.scale(c,e,i),r.add(c,c,t),r.squaredDistance(o,c)}e.exports=i;var r=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB"),i.prototype.constructor=i,i.CLOSEST=1,i.ANY=2,i.ALL=4,i.prototype.update=function(){var t=this.direction;r.sub(t,this.to,this.from),this.length=r.length(t),r.normalize(t,t)},i.prototype.intersectBodies=function(t,e){for(var o=0,i=e.length;!t.shouldStop(this)&&i>o;o++){var n=e[o],r=n.getAABB();(r.overlapsRay(this)>=0||r.containsPoint(this.from))&&this.intersectBody(t,n)}};var a=r.create();i.prototype.intersectBody=function(t,e){var o=this.checkCollisionResponse;if(!o||e.collisionResponse)for(var i=a,n=0,s=e.shapes.length;s>n;n++){var c=e.shapes[n];if((!o||c.collisionResponse)&&0!==(this.collisionGroup&c.collisionMask)&&0!==(c.collisionGroup&this.collisionMask)){r.rotate(i,c.position,e.angle),r.add(i,i,e.position);var h=c.angle+e.angle;if(this.intersectShape(t,c,h,i,e),t.shouldStop(this))break}}},i.prototype.intersectShape=function(t,e,o,i,r){var a=this.from,s=n(a,this.direction,i);s>e.boundingRadius*e.boundingRadius||(this._currentBody=r,this._currentShape=e,e.raycast(t,this,i,o),this._currentBody=this._currentShape=null)},i.prototype.getAABB=function(t){var e=this.to,o=this.from;r.set(t.lowerBound,Math.min(e[0],o[0]),Math.min(e[1],o[1])),r.set(t.upperBound,Math.max(e[0],o[0]),Math.max(e[1],o[1]))},r.create(),i.prototype.reportIntersection=function(t,e,o,n){var a=(this.from,this.to,this._currentShape),s=this._currentBody;if(!(this.skipBackfaces&&r.dot(o,this.direction)>0))switch(this.mode){case i.ALL:t.set(o,a,s,e,n),this.callback(t);break;case i.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(o,a,s,e,n);break;case i.ANY:t.set(o,a,s,e,n)}};var s=r.create(),c=r.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,o){function i(){this.normal=n.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var n=t("../math/vec2"),r=t("../collision/Ray");e.exports=i,i.prototype.reset=function(){n.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},i.prototype.getHitDistance=function(t){return n.distance(t.from,t.to)*this.fraction},i.prototype.hasHit=function(){return-1!==this.fraction},i.prototype.getHitPoint=function(t,e){n.lerp(t,e.from,e.to,this.fraction)},i.prototype.stop=function(){this.isStopped=!0},i.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===r.ANY},i.prototype.set=function(t,e,o,i,r){n.copy(this.normal,t),this.shape=e,this.body=o,this.fraction=i,this.faceIndex=r}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,o){function i(){r.call(this,r.SAP),this.axisList=[],this.axisIndex=0;var t=this;this._addBodyHandler=function(e){t.axisList.push(e.body)},this._removeBodyHandler=function(e){var o=t.axisList.indexOf(e.body);-1!==o&&t.axisList.splice(o,1)}}var n=t("../utils/Utils"),r=t("../collision/Broadphase");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setWorld=function(t){this.axisList.length=0,n.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},i.sortAxisList=function(t,e){e=0|e;for(var o=1,i=t.length;i>o;o++){for(var n=t[o],r=o-1;r>=0&&!(t[r].aabb.lowerBound[e]<=n.aabb.lowerBound[e]);r--)t[r+1]=t[r];t[r+1]=n}return t},i.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;i.sortAxisList(t,e)},i.prototype.getCollisionPairs=function(t){var e=this.axisList,o=this.result,i=this.axisIndex;o.length=0;for(var n=e.length;n--;){var a=e[n];a.aabbNeedsUpdate&&a.updateAABB()}this.sortList();for(var s=0,c=0|e.length;s!==c;s++)for(var h=e[s],l=s+1;c>l;l++){var p=e[l],u=p.aabb.lowerBound[i]<=h.aabb.upperBound[i];if(!u)break;r.canCollide(h,p)&&this.boundingVolumeCheck(h,p)&&o.push(h,p)}return o},i.prototype.aabbQuery=function(t,e,o){o=o||[],this.sortList();var i=this.axisIndex,n="x";1===i&&(n="y"),2===i&&(n="z");for(var r=this.axisList,a=(e.lowerBound[n],e.upperBound[n],0);a<r.length;a++){var s=r[a];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&o.push(s)}return o}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,o){function i(t,e,o,i){this.type=o,i=n.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}e.exports=i;var n=t("../utils/Utils");i.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},i.DISTANCE=1,i.GEAR=2,i.LOCK=3,i.PRISMATIC=4,i.REVOLUTE=5,i.prototype.setStiffness=function(t){for(var e=this.equations,o=0;o!==e.length;o++){var i=e[o];i.stiffness=t,i.needsUpdate=!0}},i.prototype.setRelaxation=function(t){for(var e=this.equations,o=0;o!==e.length;o++){var i=e[o];i.relaxation=t,i.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,o){function i(t,e,o){o=s.defaults(o,{localAnchorA:[0,0],localAnchorB:[0,0]}),n.call(this,t,e,n.DISTANCE,o),this.localAnchorA=a.fromValues(o.localAnchorA[0],o.localAnchorA[1]),this.localAnchorB=a.fromValues(o.localAnchorB[0],o.localAnchorB[1]);var i=this.localAnchorA,c=this.localAnchorB;if(this.distance=0,"number"==typeof o.distance)this.distance=o.distance;else{var h=a.create(),l=a.create(),p=a.create();a.rotate(h,i,t.angle),a.rotate(l,c,e.angle),a.add(p,e.position,l),a.sub(p,p,h),a.sub(p,p,t.position),this.distance=a.length(p)}var u;u="undefined"==typeof o.maxForce?Number.MAX_VALUE:o.maxForce;var d=new r(t,e,-u,u);this.equations=[d],this.maxForce=u;var p=a.create(),f=a.create(),v=a.create(),y=this;d.computeGq=function(){var t=this.bodyA,e=this.bodyB,o=t.position,n=e.position;return a.rotate(f,i,t.angle),a.rotate(v,c,e.angle),a.add(p,n,v),a.sub(p,p,f),a.sub(p,p,o),a.length(p)-y.distance},this.setMaxForce(u),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var n=t("./Constraint"),r=t("../equations/Equation"),a=t("../math/vec2"),s=t("../utils/Utils");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var c=a.create(),h=a.create(),l=a.create();i.prototype.update=function(){var t=this.equations[0],e=this.bodyA,o=this.bodyB,i=(this.distance,e.position),n=o.position,r=this.equations[0],s=t.G;a.rotate(h,this.localAnchorA,e.angle),a.rotate(l,this.localAnchorB,o.angle),a.add(c,n,l),a.sub(c,c,h),a.sub(c,c,i),this.position=a.length(c);var p=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(r.maxForce=0,r.minForce=-this.maxForce,this.distance=this.upperLimit,p=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(r.maxForce=this.maxForce,r.minForce=0,this.distance=this.lowerLimit,p=!0),(this.lowerLimitEnabled||this.upperLimitEnabled)&&!p)return void(r.enabled=!1);r.enabled=!0,a.normalize(c,c);var u=a.crossLength(h,c),d=a.crossLength(l,c);s[0]=-c[0],s[1]=-c[1],s[2]=-u,s[3]=c[0],s[4]=c[1],s[5]=d},i.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},i.prototype.getMaxForce=function(){var t=this.equations[0];return t.maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.GEAR,o),this.ratio=void 0!==o.ratio?o.ratio:1,this.angle=void 0!==o.angle?o.angle:e.angle-this.ratio*t.angle,o.angle=this.angle,o.ratio=this.ratio,this.equations=[new r(t,e,o)],void 0!==o.maxTorque&&this.setMaxTorque(o.maxTorque)}var n=t("./Constraint"),r=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},i.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},i.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.LOCK,o);var i="undefined"==typeof o.maxForce?Number.MAX_VALUE:o.maxForce,s=(o.localAngleB||0,new a(t,e,-i,i)),c=new a(t,e,-i,i),h=new a(t,e,-i,i),l=r.create(),p=r.create(),u=this;s.computeGq=function(){return r.rotate(l,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,l),p[0]},c.computeGq=function(){return r.rotate(l,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,l),p[1]};var d=r.create(),f=r.create();h.computeGq=function(){return r.rotate(d,u.localOffsetB,e.angle-u.localAngleB),r.scale(d,d,-1),r.sub(p,t.position,e.position),r.add(p,p,d),r.rotate(f,d,-Math.PI/2),r.normalize(f,f),r.dot(p,f)},this.localOffsetB=r.create(),o.localOffsetB?r.copy(this.localOffsetB,o.localOffsetB):(r.sub(this.localOffsetB,e.position,t.position),r.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof o.localAngleB?this.localAngleB=o.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(s,c,h),this.setMaxForce(i)}var n=t("./Constraint"),r=t("../math/vec2"),a=t("../equations/Equation");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.setMaxForce=function(t){for(var e=this.equations,o=0;o<this.equations.length;o++)e[o].maxForce=t,e[o].minForce=-t},i.prototype.getMaxForce=function(){return this.equations[0].maxForce};var s=r.create(),c=r.create(),h=r.create(),l=r.fromValues(1,0),p=r.fromValues(0,1);i.prototype.update=function(){var t=this.equations[0],e=this.equations[1],o=this.equations[2],i=this.bodyA,n=this.bodyB;r.rotate(s,this.localOffsetB,i.angle),r.rotate(c,this.localOffsetB,n.angle-this.localAngleB),r.scale(c,c,-1),r.rotate(h,c,Math.PI/2),r.normalize(h,h),t.G[0]=-1,t.G[1]=0,t.G[2]=-r.crossLength(s,l),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-r.crossLength(s,p),e.G[4]=1,o.G[0]=-h[0],o.G[1]=-h[1],o.G[3]=h[0],o.G[4]=h[1],o.G[5]=r.crossLength(c,h)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.PRISMATIC,o);var i=s.fromValues(0,0),h=s.fromValues(1,0),l=s.fromValues(0,0);o.localAnchorA&&s.copy(i,o.localAnchorA),o.localAxisA&&s.copy(h,o.localAxisA),o.localAnchorB&&s.copy(l,o.localAnchorB),this.localAnchorA=i,this.localAnchorB=l,this.localAxisA=h;var p=this.maxForce="undefined"!=typeof o.maxForce?o.maxForce:Number.MAX_VALUE,u=new a(t,e,-p,p),d=new s.create,f=new s.create,v=new s.create,y=new s.create;if(u.computeGq=function(){return s.dot(v,y)},u.updateJacobian=function(){var o=this.G,n=t.position,r=e.position;s.rotate(d,i,t.angle),s.rotate(f,l,e.angle),s.add(v,r,f),s.sub(v,v,n),s.sub(v,v,d),s.rotate(y,h,t.angle+Math.PI/2),o[0]=-y[0],o[1]=-y[1],o[2]=-s.crossLength(d,y)+s.crossLength(y,v),o[3]=y[0],o[4]=y[1],o[5]=s.crossLength(f,y)},this.equations.push(u),!o.disableRotationalLock){var m=new c(t,e,-p,p);this.equations.push(m)}this.position=0,this.velocity=0,this.lowerLimitEnabled="undefined"!=typeof o.lowerLimit?!0:!1,this.upperLimitEnabled="undefined"!=typeof o.upperLimit?!0:!1,this.lowerLimit="undefined"!=typeof o.lowerLimit?o.lowerLimit:0,this.upperLimit="undefined"!=typeof o.upperLimit?o.upperLimit:1,this.upperLimitEquation=new r(t,e),this.lowerLimitEquation=new r(t,e),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=p,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.motorSpeed=0;var g=this,A=this.motorEquation;A.computeGW,A.computeGq=function(){return 0},A.computeGW=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.velocity,n=o.velocity,r=e.angularVelocity,a=o.angularVelocity;return this.gmult(t,i,r,n,a)+g.motorSpeed}}var n=t("./Constraint"),r=t("../equations/ContactEquation"),a=t("../equations/Equation"),s=t("../math/vec2"),c=t("../equations/RotationalLockEquation");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var h=s.create(),l=s.create(),p=s.create(),u=s.create(),d=s.create(),f=s.create();i.prototype.update=function(){var t=this.equations,e=t[0],o=this.upperLimit,i=this.lowerLimit,n=this.upperLimitEquation,r=this.lowerLimitEquation,a=this.bodyA,c=this.bodyB,v=this.localAxisA,y=this.localAnchorA,m=this.localAnchorB;e.updateJacobian(),s.rotate(h,v,a.angle),s.rotate(u,y,a.angle),s.add(l,u,a.position),s.rotate(d,m,c.angle),s.add(p,d,c.position);var g=this.position=s.dot(p,h)-s.dot(l,h);if(this.motorEnabled){var A=this.motorEquation.G;A[0]=h[0],A[1]=h[1],A[2]=s.crossLength(h,d),A[3]=-h[0],A[4]=-h[1],A[5]=-s.crossLength(h,u)}if(this.upperLimitEnabled&&g>o)s.scale(n.normalA,h,-1),s.sub(n.contactPointA,l,a.position),s.sub(n.contactPointB,p,c.position),s.scale(f,h,o),s.add(n.contactPointA,n.contactPointA,f),-1===t.indexOf(n)&&t.push(n);else{var b=t.indexOf(n);-1!==b&&t.splice(b,1)}if(this.lowerLimitEnabled&&i>g)s.scale(r.normalA,h,1),s.sub(r.contactPointA,l,a.position),s.sub(r.contactPointB,p,c.position),s.scale(f,h,i),s.sub(r.contactPointB,r.contactPointB,f),-1===t.indexOf(r)&&t.push(r);else{var b=t.indexOf(r);-1!==b&&t.splice(b,1)}},i.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},i.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},i.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.REVOLUTE,o);var i=this.maxForce="undefined"!=typeof o.maxForce?o.maxForce:Number.MAX_VALUE;this.pivotA=c.create(),this.pivotB=c.create(),o.worldPivot?(c.sub(this.pivotA,o.worldPivot,t.position),c.sub(this.pivotB,o.worldPivot,e.position),c.rotate(this.pivotA,this.pivotA,-t.angle),c.rotate(this.pivotB,this.pivotB,-e.angle)):(c.copy(this.pivotA,o.localPivotA),c.copy(this.pivotB,o.localPivotB));var f=this.equations=[new r(t,e,-i,i),new r(t,e,-i,i)],v=f[0],y=f[1],m=this;v.computeGq=function(){return c.rotate(h,m.pivotA,t.angle),c.rotate(l,m.pivotB,e.angle),c.add(d,e.position,l),c.sub(d,d,t.position),c.sub(d,d,h),c.dot(d,p)},y.computeGq=function(){return c.rotate(h,m.pivotA,t.angle),c.rotate(l,m.pivotB,e.angle),c.add(d,e.position,l),c.sub(d,d,t.position),c.sub(d,d,h),c.dot(d,u)},y.minForce=v.minForce=-i,y.maxForce=v.maxForce=i,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new s(t,e),this.lowerLimitEquation=new s(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var n=t("./Constraint"),r=t("../equations/Equation"),a=t("../equations/RotationalVelocityEquation"),s=t("../equations/RotationalLockEquation"),c=t("../math/vec2");e.exports=i;var h=c.create(),l=c.create(),p=c.fromValues(1,0),u=c.fromValues(0,1),d=c.create();i.prototype=new n,i.prototype.constructor=i,i.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},i.prototype.update=function(){var t=this.bodyA,e=this.bodyB,o=this.pivotA,i=this.pivotB,n=this.equations,r=(n[0],n[1],n[0]),a=n[1],s=this.upperLimit,d=this.lowerLimit,f=this.upperLimitEquation,v=this.lowerLimitEquation,y=this.angle=e.angle-t.angle;if(this.upperLimitEnabled&&y>s)f.angle=s,-1===n.indexOf(f)&&n.push(f);else{var m=n.indexOf(f);-1!==m&&n.splice(m,1)}if(this.lowerLimitEnabled&&d>y)v.angle=d,-1===n.indexOf(v)&&n.push(v);else{var m=n.indexOf(v);-1!==m&&n.splice(m,1)}c.rotate(h,o,t.angle),c.rotate(l,i,e.angle),r.G[0]=-1,r.G[1]=0,r.G[2]=-c.crossLength(h,p),r.G[3]=1,r.G[4]=0,r.G[5]=c.crossLength(l,p),a.G[0]=0,a.G[1]=-1,a.G[2]=-c.crossLength(h,u),a.G[3]=0,a.G[4]=1,a.G[5]=c.crossLength(l,u)},i.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},i.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},i.prototype.motorIsEnabled=function(){return!!this.motorEnabled},i.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations[e].relativeVelocity=t}},i.prototype.getMotorSpeed=function(){return this.motorEnabled?this.motorEquation.relativeVelocity:!1}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=o.angle||0,this.ratio="number"==typeof o.ratio?o.ratio:1,this.setRatio(this.ratio)}var n=t("./Equation");t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},i.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},i.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,o){function i(t,e){n.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=r.create(),this.penetrationVec=r.create(),this.contactPointB=r.create(),this.normalA=r.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var n=t("./Equation"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeB=function(t,e,o){var i=this.bodyA,n=this.bodyB,a=this.contactPointA,s=this.contactPointB,c=i.position,h=n.position,l=this.penetrationVec,p=this.normalA,u=this.G,d=r.crossLength(a,p),f=r.crossLength(s,p);u[0]=-p[0],u[1]=-p[1],u[2]=-d,u[3]=p[0],u[4]=p[1],u[5]=f,r.add(l,h,s),r.sub(l,l,c),r.sub(l,l,a);var v,y;this.firstImpact&&0!==this.restitution?(y=0,v=1/e*(1+this.restitution)*this.computeGW()):(y=r.dot(p,l)+this.offset,v=this.computeGW());var m=this.computeGiMf(),g=-y*t-v*e-o*m;return g}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,o){function i(t,e,o,n){this.minForce="undefined"==typeof o?-Number.MAX_VALUE:o,this.maxForce="undefined"==typeof n?Number.MAX_VALUE:n,this.bodyA=t,this.bodyB=e,this.stiffness=i.DEFAULT_STIFFNESS,this.relaxation=i.DEFAULT_RELAXATION,this.G=new r.ARRAY_TYPE(6);for(var a=0;6>a;a++)this.G[a]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}e.exports=i;var n=t("../math/vec2"),r=t("../utils/Utils");t("../objects/Body"),i.prototype.constructor=i,i.DEFAULT_STIFFNESS=1e6,i.DEFAULT_RELAXATION=4,i.prototype.update=function(){var t=this.stiffness,e=this.relaxation,o=this.timeStep;this.a=4/(o*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(o*o*t*(1+4*e)),this.needsUpdate=!1},i.prototype.gmult=function(t,e,o,i,n){return t[0]*e[0]+t[1]*e[1]+t[2]*o+t[3]*i[0]+t[4]*i[1]+t[5]*n},i.prototype.computeB=function(t,e,o){var i=this.computeGW(),n=this.computeGq(),r=this.computeGiMf();return-n*t-i*e-r*o};var a=n.create(),s=n.create();i.prototype.computeGq=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=(e.position,o.position,e.angle),n=o.angle;return this.gmult(t,a,i,s,n)+this.offset},i.prototype.computeGW=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.velocity,n=o.velocity,r=e.angularVelocity,a=o.angularVelocity;return this.gmult(t,i,r,n,a)+this.relativeVelocity},i.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.vlambda,n=o.vlambda,r=e.wlambda,a=o.wlambda;return this.gmult(t,i,r,n,a)};var c=n.create(),h=n.create();i.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,o=t.force,i=t.angularForce,r=e.force,a=e.angularForce,s=t.invMassSolve,l=e.invMassSolve,p=t.invInertiaSolve,u=e.invInertiaSolve,d=this.G;return n.scale(c,o,s),n.multiply(c,t.massMultiplier,c),n.scale(h,r,l),n.multiply(h,e.massMultiplier,h),this.gmult(d,c,i*p,h,a*u)},i.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,o=t.invMassSolve,i=e.invMassSolve,n=t.invInertiaSolve,r=e.invInertiaSolve,a=this.G;return a[0]*a[0]*o*t.massMultiplier[0]+a[1]*a[1]*o*t.massMultiplier[1]+a[2]*a[2]*n+a[3]*a[3]*i*e.massMultiplier[0]+a[4]*a[4]*i*e.massMultiplier[1]+a[5]*a[5]*r};var l=n.create(),p=n.create(),u=n.create();n.create(),n.create(),n.create(),i.prototype.addToWlambda=function(t){var e=this.bodyA,o=this.bodyB,i=l,r=p,a=u,s=e.invMassSolve,c=o.invMassSolve,h=e.invInertiaSolve,d=o.invInertiaSolve,f=this.G;r[0]=f[0],r[1]=f[1],a[0]=f[3],a[1]=f[4],n.scale(i,r,s*t),n.multiply(i,i,e.massMultiplier),n.add(e.vlambda,e.vlambda,i),e.wlambda+=h*f[2]*t,n.scale(i,a,c*t),n.multiply(i,i,o.massMultiplier),n.add(o.vlambda,o.vlambda,i),o.wlambda+=d*f[5]*t},i.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,o){function i(t,e,o){r.call(this,t,e,-o,o),this.contactPointA=n.create(),this.contactPointB=n.create(),this.t=n.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var n=t("../math/vec2"),r=t("./Equation");t("../utils/Utils"),e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},i.prototype.getSlipForce=function(){return this.maxForce},i.prototype.computeB=function(t,e,o){var i=(this.bodyA,this.bodyB,this.contactPointA),r=this.contactPointB,a=this.t,s=this.G;s[0]=-a[0],s[1]=-a[1],s[2]=-n.crossLength(i,a),s[3]=a[0],s[4]=a[1],s[5]=n.crossLength(r,a);var c=this.computeGW(),h=this.computeGiMf(),l=-c*e-o*h;return l}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=o.angle||0;var i=this.G;i[2]=1,i[5]=-1}var n=t("./Equation"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var a=r.create(),s=r.create(),c=r.fromValues(1,0),h=r.fromValues(0,1);i.prototype.computeGq=function(){return r.rotate(a,c,this.bodyA.angle+this.angle),r.rotate(s,h,this.bodyB.angle),r.dot(a,s)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,o){function i(t,e){n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var n=t("./Equation");t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeB=function(t,e,o){var i=this.G;i[2]=-1,i[5]=this.ratio;var n=this.computeGiMf(),r=this.computeGW(),a=-r*e-o*n;return a}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,o){var i=function(){};e.exports=i,i.prototype={constructor:i,on:function(t,e,o){e.context=o||this,void 0===this._listeners&&(this._listeners={});var i=this._listeners;return void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var o=this._listeners;if(e){if(void 0!==o[t]&&-1!==o[t].indexOf(e))return!0}else if(void 0!==o[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var o=this._listeners,i=o[t].indexOf(e);return-1!==i&&o[t].splice(i,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners,o=e[t.type];if(void 0!==o){t.target=this;for(var i=0,n=o.length;n>i;i++){var r=o[i];r.call(r.context,t)}}return this}}},{}],27:[function(t,e,o){function i(t,e,o){if(o=o||{},!(t instanceof n&&e instanceof n))throw new Error("First two arguments must be Material instances.");this.id=i.idCounter++,this.materialA=t,this.materialB=e,this.friction="undefined"!=typeof o.friction?Number(o.friction):.3,this.restitution="undefined"!=typeof o.restitution?Number(o.restitution):0,this.stiffness="undefined"!=typeof o.stiffness?Number(o.stiffness):r.DEFAULT_STIFFNESS,this.relaxation="undefined"!=typeof o.relaxation?Number(o.relaxation):r.DEFAULT_RELAXATION,this.frictionStiffness="undefined"!=typeof o.frictionStiffness?Number(o.frictionStiffness):r.DEFAULT_STIFFNESS,this.frictionRelaxation="undefined"!=typeof o.frictionRelaxation?Number(o.frictionRelaxation):r.DEFAULT_RELAXATION,this.surfaceVelocity="undefined"!=typeof o.surfaceVelocity?Number(o.surfaceVelocity):0,this.contactSkinSize=.005}var n=t("./Material"),r=t("../equations/Equation");e.exports=i,i.idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,o){function i(t){this.id=t||i.idCounter++}e.exports=i,i.idCounter=0},{}],29:[function(t,e,o){var i={};i.GetArea=function(t){if(t.length<6)return 0;for(var e=t.length-2,o=0,i=0;e>i;i+=2)o+=(t[i+2]-t[i])*(t[i+1]+t[i+3]);return o+=(t[0]-t[e])*(t[e+1]+t[1]),.5*-o},i.Triangulate=function(t){var e=t.length>>1;if(3>e)return[];for(var o=[],n=[],r=0;e>r;r++)n.push(r);for(var r=0,a=e;a>3;){var s=n[(r+0)%a],c=n[(r+1)%a],h=n[(r+2)%a],l=t[2*s],p=t[2*s+1],u=t[2*c],d=t[2*c+1],f=t[2*h],v=t[2*h+1],y=!1;if(i._convex(l,p,u,d,f,v)){y=!0;for(var m=0;a>m;m++){var g=n[m];if(g!=s&&g!=c&&g!=h&&i._PointInTriangle(t[2*g],t[2*g+1],l,p,u,d,f,v)){y=!1;break}}}if(y)o.push(s,c,h),n.splice((r+1)%a,1),a--,r=0;else if(r++>3*a)break}return o.push(n[0],n[1],n[2]),o},i._PointInTriangle=function(t,e,o,i,n,r,a,s){var c=a-o,h=s-i,l=n-o,p=r-i,u=t-o,d=e-i,f=c*c+h*h,v=c*l+h*p,y=c*u+h*d,m=l*l+p*p,g=l*u+p*d,A=1/(f*m-v*v),b=(m*y-v*g)*A,E=(f*g-v*y)*A;return b>=0&&E>=0&&1>b+E},i._convex=function(t,e,o,i,n,r){return(e-i)*(n-o)+(o-t)*(r-i)>=0},e.exports=i},{}],30:[function(t,e,o){var i=e.exports={},n=t("../utils/Utils");i.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},i.crossVZ=function(t,e,o){return i.rotate(t,e,-Math.PI/2),i.scale(t,t,o),t},i.crossZV=function(t,e,o){return i.rotate(t,o,Math.PI/2),i.scale(t,t,e),t},i.rotate=function(t,e,o){if(0!==o){var i=Math.cos(o),n=Math.sin(o),r=e[0],a=e[1];t[0]=i*r-n*a,t[1]=n*r+i*a}else t[0]=e[0],t[1]=e[1]},i.rotate90cw=function(t,e){var o=e[0],i=e[1];t[0]=i,t[1]=-o},i.toLocalFrame=function(t,e,o,n){i.copy(t,e),i.sub(t,t,o),i.rotate(t,t,-n)},i.toGlobalFrame=function(t,e,o,n){i.copy(t,e),i.rotate(t,t,n),i.add(t,t,o)},i.vectorToLocalFrame=function(t,e,o){i.rotate(t,e,-o)},i.vectorToGlobalFrame=function(t,e,o){i.rotate(t,e,o)},i.centroid=function(t,e,o,n){return i.add(t,e,o),i.add(t,t,n),i.scale(t,t,1/3),t},i.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var o=new n.ARRAY_TYPE(2);return o[0]=t,o[1]=e,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,o){return t[0]=e,t[1]=o,t},i.add=function(t,e,o){return t[0]=e[0]+o[0],t[1]=e[1]+o[1],t},i.subtract=function(t,e,o){return t[0]=e[0]-o[0],t[1]=e[1]-o[1],t},i.sub=i.subtract,i.multiply=function(t,e,o){return t[0]=e[0]*o[0],t[1]=e[1]*o[1],t},i.mul=i.multiply,i.divide=function(t,e,o){return t[0]=e[0]/o[0],t[1]=e[1]/o[1],t},i.div=i.divide,i.scale=function(t,e,o){return t[0]=e[0]*o,t[1]=e[1]*o,t},i.distance=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(o*o+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return o*o+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],o=t[1];return Math.sqrt(e*e+o*o)},i.len=i.length,i.squaredLength=function(t){var e=t[0],o=t[1];return e*e+o*o},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.normalize=function(t,e){var o=e[0],i=e[1],n=o*o+i*i;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},i.lerp=function(t,e,o,i){var n=e[0],r=e[1];return t[0]=n+i*(o[0]-n),t[1]=r+i*(o[1]-r),t},i.reflect=function(t,e,o){var i=e[0]*o[0]+e[1]*o[1];t[0]=e[0]-2*o[0]*i,t[1]=e[1]-2*o[1]*i},i.getLineSegmentsIntersection=function(t,e,o,n,r){var a=i.getLineSegmentsIntersectionFraction(e,o,n,r);return 0>a?!1:(t[0]=e[0]+a*(o[0]-e[0]),t[1]=e[1]+a*(o[1]-e[1]),!0)},i.getLineSegmentsIntersectionFraction=function(t,e,o,i){var n,r,a=e[0]-t[0],s=e[1]-t[1],c=i[0]-o[0],h=i[1]-o[1];return n=(-s*(t[0]-o[0])+a*(t[1]-o[1]))/(-c*s+a*h),r=(c*(t[1]-o[1])-h*(t[0]-o[0]))/(-c*s+a*h),n>=0&&1>=n&&r>=0&&1>=r?r:-1}},{"../utils/Utils":57}],31:[function(t,e,o){function i(t){t=t||{},l.call(this),this.id=t.id||++i._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=n.create(),this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.interpolatedPosition=n.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=n.fromValues(0,0),this.previousAngle=0,this.velocity=n.fromValues(0,0),t.velocity&&n.copy(this.velocity,t.velocity),this.vlambda=n.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=n.create(),t.force&&n.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=i.STATIC,"undefined"!=typeof t.type?this.type=t.type:t.mass?this.type=i.DYNAMIC:this.type=i.STATIC,this.boundingRadius=0,this.aabb=new h,this.aabbNeedsUpdate=!0,this.allowSleep=void 0!==t.allowSleep?t.allowSleep:!0,this.wantsToSleep=!1,this.sleepState=i.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0!==t.collisionResponse?t.collisionResponse:!0,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()
}var n=t("../math/vec2"),r=t("poly-decomp"),a=t("../shapes/Convex"),s=t("../collision/RaycastResult"),c=t("../collision/Ray"),h=t("../collision/AABB"),l=t("../events/EventEmitter");e.exports=i,i.prototype=new l,i.prototype.constructor=i,i._idCounter=0,i.prototype.updateSolveMassProperties=function(){this.sleepState===i.SLEEPING||this.type===i.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},i.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},i.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},i.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var p=new h,u=n.create();i.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,o=u,i=this.angle,r=0;r!==e;r++){var a=t[r],s=a.angle+i;n.rotate(o,a.position,i),n.add(o,o,this.position),a.computeAABB(p,o,s),0===r?this.aabb.copy(p):this.aabb.extend(p)}this.aabbNeedsUpdate=!1},i.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,o=0,i=0;i!==e;i++){var r=t[i],a=n.length(r.position),s=r.boundingRadius;a+s>o&&(o=a+s)}this.boundingRadius=o},i.prototype.addShape=function(t,e,o){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?n.copy(t.position,e):n.set(t.position,0,0),t.angle=o||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},i.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e?(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,t.body=null,!0):!1},i.prototype.updateMassProperties=function(){if(this.type===i.STATIC||this.type===i.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,o=this.mass/e,r=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var a=0;e>a;a++){var s=t[a],c=n.squaredLength(s.position),h=s.computeMomentOfInertia(o);r+=h+o*c}this.inertia=r,this.invInertia=r>0?1/r:0}this.invMass=1/this.mass,n.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}},n.create(),i.prototype.applyForce=function(t,e){if(n.add(this.force,this.force,t),e){var o=n.crossLength(e,t);this.angularForce+=o}};var d=n.create(),f=n.create(),v=n.create();i.prototype.applyForceLocal=function(t,e){e=e||v;var o=d,i=f;this.vectorToWorldFrame(o,t),this.vectorToWorldFrame(i,e),this.applyForce(o,i)};var y=n.create();i.prototype.applyImpulse=function(t,e){if(this.type===i.DYNAMIC){var o=y;if(n.scale(o,t,this.invMass),n.multiply(o,this.massMultiplier,o),n.add(this.velocity,o,this.velocity),e){var r=n.crossLength(e,t);r*=this.invInertia,this.angularVelocity+=r}}};var m=n.create(),g=n.create(),A=n.create();i.prototype.applyImpulseLocal=function(t,e){e=e||A;var o=m,i=g;this.vectorToWorldFrame(o,t),this.vectorToWorldFrame(i,e),this.applyImpulse(o,i)},i.prototype.toLocalFrame=function(t,e){n.toLocalFrame(t,e,this.position,this.angle)},i.prototype.toWorldFrame=function(t,e){n.toGlobalFrame(t,e,this.position,this.angle)},i.prototype.vectorToLocalFrame=function(t,e){n.vectorToLocalFrame(t,e,this.angle)},i.prototype.vectorToWorldFrame=function(t,e){n.vectorToGlobalFrame(t,e,this.angle)},i.prototype.fromPolygon=function(t,e){e=e||{};for(var o=this.shapes.length;o>=0;--o)this.removeShape(this.shapes[o]);var i=new r.Polygon;if(i.vertices=t,i.makeCCW(),"number"==typeof e.removeCollinearPoints&&i.removeCollinearPoints(e.removeCollinearPoints),"undefined"==typeof e.skipSimpleCheck&&!i.isSimple())return!1;this.concavePath=i.vertices.slice(0);for(var o=0;o<this.concavePath.length;o++){var s=[0,0];n.copy(s,this.concavePath[o]),this.concavePath[o]=s}var c;c=e.optimalDecomp?i.decomp():i.quickDecomp();for(var h=n.create(),o=0;o!==c.length;o++){for(var l=new a({vertices:c[o].vertices}),p=0;p!==l.vertices.length;p++){var s=l.vertices[p];n.sub(s,s,l.centerOfMass)}n.scale(h,l.centerOfMass,1),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),this.addShape(l,h)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var b=(n.fromValues(0,0),n.fromValues(0,0)),E=n.fromValues(0,0),B=n.fromValues(0,0);i.prototype.adjustCenterOfMass=function(){var t=b,e=E,o=B,i=0;n.set(e,0,0);for(var r=0;r!==this.shapes.length;r++){var a=this.shapes[r];n.scale(t,a.position,a.area),n.add(e,e,t),i+=a.area}n.scale(o,e,1/i);for(var r=0;r!==this.shapes.length;r++){var a=this.shapes[r];n.sub(a.position,a.position,o)}n.add(this.position,this.position,o);for(var r=0;this.concavePath&&r<this.concavePath.length;r++)n.sub(this.concavePath[r],this.concavePath[r],o);this.updateMassProperties(),this.updateBoundingRadius()},i.prototype.setZeroForce=function(){n.set(this.force,0,0),this.angularForce=0},i.prototype.resetConstraintVelocity=function(){var t=this,e=t.vlambda;n.set(e,0,0),t.wlambda=0},i.prototype.addConstraintVelocity=function(){var t=this,e=t.velocity;n.add(e,e,t.vlambda),t.angularVelocity+=t.wlambda},i.prototype.applyDamping=function(t){if(this.type===i.DYNAMIC){var e=this.velocity;n.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}},i.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=i.AWAKE,this.idleTime=0,t!==i.AWAKE&&this.emit(i.wakeUpEvent)},i.prototype.sleep=function(){this.sleepState=i.SLEEPING,this.angularVelocity=0,this.angularForce=0,n.set(this.velocity,0,0),n.set(this.force,0,0),this.emit(i.sleepEvent)},i.prototype.sleepTick=function(t,e,o){if(this.allowSleep&&this.type!==i.SLEEPING){this.wantsToSleep=!1;var r=(this.sleepState,n.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)),a=Math.pow(this.sleepSpeedLimit,2);r>=a?(this.idleTime=0,this.sleepState=i.AWAKE):(this.idleTime+=o,this.sleepState=i.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep())}},i.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var q=n.create(),P=n.create();i.prototype.integrate=function(t){var e=this.invMass,o=this.force,i=this.position,r=this.velocity;n.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),n.scale(q,o,t*e),n.multiply(q,this.massMultiplier,q),n.add(r,q,r),this.integrateToTimeOfImpact(t)||(n.scale(P,r,t),n.add(i,i,P),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var w=new s,S=new c({mode:c.ALL}),C=n.create(),L=n.create(),x=n.create(),F=n.create();i.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||n.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;n.normalize(C,this.velocity),n.scale(L,this.velocity,t),n.add(L,L,this.position),n.sub(x,L,this.position);var e,o=this.angularVelocity*t,i=n.length(x),r=1,a=this;if(w.reset(),S.callback=function(t){t.body!==a&&(e=t.body,t.getHitPoint(L,S),n.sub(x,L,a.position),r=n.length(x)/i,t.stop())},n.copy(S.from,this.position),n.copy(S.to,L),S.update(),this.world.raycast(w,S),!e)return!1;var s=this.angle;n.copy(F,this.position);for(var c=0,h=0,l=0,p=r;p>=h&&c<this.ccdIterations;){c++,l=(p-h)/2,n.scale(P,x,r),n.add(this.position,F,P),this.angle=s+o*r,this.updateAABB();var u=this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e);u?h=l:p=l}return r=l,n.copy(this.position,F),this.angle=s,n.scale(P,x,r),n.add(this.position,this.position,P),this.fixedRotation||(this.angle+=o*r),!0},i.prototype.getVelocityAtPoint=function(t,e){return n.crossVZ(t,e,this.angularVelocity),n.subtract(t,this.velocity,t),t},i.sleepyEvent={type:"sleepy"},i.sleepEvent={type:"sleep"},i.wakeUpEvent={type:"wakeup"},i.DYNAMIC=1,i.STATIC=2,i.KINEMATIC=4,i.AWAKE=0,i.SLEEPY=1,i.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,o){function i(t,e,o){o=o||{},r.call(this,t,e,o),this.localAnchorA=n.fromValues(0,0),this.localAnchorB=n.fromValues(0,0),o.localAnchorA&&n.copy(this.localAnchorA,o.localAnchorA),o.localAnchorB&&n.copy(this.localAnchorB,o.localAnchorB),o.worldAnchorA&&this.setWorldAnchorA(o.worldAnchorA),o.worldAnchorB&&this.setWorldAnchorB(o.worldAnchorB);var i=n.create(),a=n.create();this.getWorldAnchorA(i),this.getWorldAnchorB(a);var s=n.distance(i,a);this.restLength="number"==typeof o.restLength?o.restLength:s}var n=t("../math/vec2"),r=t("./Spring");t("../utils/Utils"),e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},i.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},i.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},i.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var a=n.create(),s=n.create(),c=n.create(),h=n.create(),l=n.create(),p=n.create(),u=n.create(),d=n.create(),f=n.create();i.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,o=this.restLength,i=this.bodyA,r=this.bodyB,v=a,y=s,m=c,g=h,A=f,b=l,E=p,B=u,q=d;this.getWorldAnchorA(b),this.getWorldAnchorB(E),n.sub(B,b,i.position),n.sub(q,E,r.position),n.sub(v,E,b);var P=n.len(v);n.normalize(y,v),n.sub(m,r.velocity,i.velocity),n.crossZV(A,r.angularVelocity,q),n.add(m,m,A),n.crossZV(A,i.angularVelocity,B),n.sub(m,m,A),n.scale(g,y,-t*(P-o)-e*n.dot(m,y)),n.sub(i.force,i.force,g),n.add(r.force,r.force,g);var w=n.crossLength(B,g),S=n.crossLength(q,g);i.angularForce-=w,r.angularForce+=S}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,o),this.restAngle="number"==typeof o.restAngle?o.restAngle:e.angle-t.angle}var n=(t("../math/vec2"),t("./Spring"));e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,o=this.restAngle,i=this.bodyA,n=this.bodyB,r=n.angle-i.angle,a=n.angularVelocity-i.angularVelocity,s=-t*(r-o)-e*a*0;i.angularForce-=s,n.angularForce+=s}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,o){function i(t,e,o){o=n.defaults(o,{stiffness:100,damping:1}),this.stiffness=o.stiffness,this.damping=o.damping,this.bodyA=t,this.bodyB=e}var n=(t("../math/vec2"),t("../utils/Utils"));e.exports=i,i.prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,o){function i(t,e){e=e||{},this.chassisBody=t,this.wheels=[],this.groundBody=new c({mass:0}),this.world=null;var o=this;this.preStepCallback=function(){o.update()}}function n(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new s(t.chassisBody,t.groundBody),this.sideEquation=new s(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=r.fromValues(0,1),e.localForwardVector&&r.copy(this.localForwardVector,e.localForwardVector),this.localPosition=r.fromValues(0,0),e.localPosition&&r.copy(this.localPosition,e.localPosition),a.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var r=t("../math/vec2"),a=(t("../utils/Utils"),t("../constraints/Constraint")),s=t("../equations/FrictionEquation"),c=t("../objects/Body");e.exports=i,i.prototype.addToWorld=function(t){this.world=t,t.addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var o=this.wheels[e];t.addConstraint(o)}},i.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var o=this.wheels[e];t.removeConstraint(o)}this.world=null},i.prototype.addWheel=function(t){var e=new n(this,t);return this.wheels.push(e),e},i.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},n.prototype=new a,n.prototype.setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},n.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var h=r.create(),l=r.create();n.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(l,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(h,l),r.dot(h,l)};var p=r.create();n.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),r.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),r.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),r.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),r.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),r.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),r.normalize(p,this.forwardEquation.t),r.scale(p,p,this.engineForce),this.vehicle.chassisBody.applyForce(p,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,o){var i=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(i,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),t=t||{};var e=this.width=t.width||1,o=this.height=t.height||1,i=[n.fromValues(-e/2,-o/2),n.fromValues(e/2,-o/2),n.fromValues(e/2,o/2),n.fromValues(-e/2,o/2)],s=[n.fromValues(1,0),n.fromValues(0,1)];t.vertices=i,t.axes=s,t.type=r.BOX,a.call(this,t)}var n=t("../math/vec2"),r=t("./Shape"),a=t("./Convex");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.width,o=this.height;return t*(o*o+e*e)/12},i.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2},n.create(),n.create(),n.create(),n.create(),i.prototype.computeAABB=function(t,e,o){t.setFromPoints(this.vertices,e,o,0)},i.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),t=t||{},this.length=t.length||1,this.radius=t.radius||1,t.type=n.CAPSULE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.radius,o=this.length+e,i=2*e;return t*(i*i+o*o)/12},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},i.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var a=r.create();i.prototype.computeAABB=function(t,e,o){var i=this.radius;r.set(a,this.length/2,0),0!==o&&r.rotate(a,a,o),r.set(t.upperBound,Math.max(a[0]+i,-a[0]+i),Math.max(a[1]+i,-a[1]+i)),r.set(t.lowerBound,Math.min(a[0]-i,-a[0]-i),Math.min(a[1]-i,-a[1]-i)),r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e)};var s=r.create(),c=r.create(),h=r.create(),l=r.create(),p=r.fromValues(0,1);i.prototype.raycast=function(t,e,o,i){for(var n=e.from,a=e.to,u=(e.direction,s),d=c,f=h,v=l,y=this.length/2,m=0;2>m;m++){var g=this.radius*(2*m-1);r.set(f,-y,g),r.set(v,y,g),r.toGlobalFrame(f,f,o,i),r.toGlobalFrame(v,v,o,i);var A=r.getLineSegmentsIntersectionFraction(n,a,f,v);if(A>=0&&(r.rotate(d,p,i),r.scale(d,d,2*m-1),e.reportIntersection(t,A,d,-1),t.shouldStop(e)))return}for(var b=Math.pow(this.radius,2)+Math.pow(y,2),m=0;2>m;m++){r.set(f,y*(2*m-1),0),r.toGlobalFrame(f,f,o,i);var E=Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2),B=2*((a[0]-n[0])*(n[0]-f[0])+(a[1]-n[1])*(n[1]-f[1])),q=Math.pow(n[0]-f[0],2)+Math.pow(n[1]-f[1],2)-Math.pow(this.radius,2),A=Math.pow(B,2)-4*E*q;if(!(0>A))if(0===A){if(r.lerp(u,n,a,A),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,A,d,-1),t.shouldStop(e)))return}else{var P=Math.sqrt(A),w=1/(2*E),S=(-B-P)*w,C=(-B+P)*w;if(S>=0&&1>=S&&(r.lerp(u,n,a,S),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,S,d,-1),t.shouldStop(e))))return;if(C>=0&&1>=C&&(r.lerp(u,n,a,C),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,C,d,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),t=t||{},this.radius=t.radius||1,t.type=n.CIRCLE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},i.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},i.prototype.computeAABB=function(t,e,o){var i=this.radius;r.set(t.upperBound,i,i),r.set(t.lowerBound,-i,-i),e&&(r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e))};var a=r.create(),s=r.create();i.prototype.raycast=function(t,e,o,i){var n=e.from,c=e.to,h=this.radius,l=Math.pow(c[0]-n[0],2)+Math.pow(c[1]-n[1],2),p=2*((c[0]-n[0])*(n[0]-o[0])+(c[1]-n[1])*(n[1]-o[1])),u=Math.pow(n[0]-o[0],2)+Math.pow(n[1]-o[1],2)-Math.pow(h,2),d=Math.pow(p,2)-4*l*u,f=a,v=s;if(!(0>d))if(0===d)r.lerp(f,n,c,d),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,d,v,-1);else{var y=Math.sqrt(d),m=1/(2*l),g=(-p-y)*m,A=(-p+y)*m;if(g>=0&&1>=g&&(r.lerp(f,n,c,g),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,g,v,-1),t.shouldStop(e)))return;A>=0&&1>=A&&(r.lerp(f,n,c,A),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,A,v,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,o){function i(t){Array.isArray(arguments[0])&&(t={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),t=t||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],o=0;o<e.length;o++){var i=r.create();r.copy(i,e[o]),this.vertices.push(i)}if(this.axes=[],t.axes)for(var o=0;o<t.axes.length;o++){var a=r.create();r.copy(a,t.axes[o]),this.axes.push(a)}else for(var o=0;o<this.vertices.length;o++){var s=this.vertices[o],c=this.vertices[(o+1)%this.vertices.length],h=r.create();r.sub(h,c,s),r.rotate90cw(h,h),r.normalize(h,h),this.axes.push(h)}if(this.centerOfMass=r.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=n.CONVEX,n.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var n=t("./Shape"),r=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp"),e.exports=i,i.prototype=new n,i.prototype.constructor=i;var s=r.create(),c=r.create();i.prototype.projectOntoLocalAxis=function(t,e){for(var o,i,n=null,a=null,t=s,c=0;c<this.vertices.length;c++)o=this.vertices[c],i=r.dot(o,t),(null===n||i>n)&&(n=i),(null===a||a>i)&&(a=i);if(a>n){var h=a;a=n,n=h}r.set(e,a,n)},i.prototype.projectOntoWorldAxis=function(t,e,o,i){var n=c;this.projectOntoLocalAxis(t,i),0!==o?r.rotate(n,t,o):n=t;var a=r.dot(e,n);r.set(i,i[0]+a,i[1]+a)},i.prototype.updateTriangles=function(){this.triangles.length=0;for(var t=[],e=0;e<this.vertices.length;e++){var o=this.vertices[e];t.push(o[0],o[1])}for(var i=a.Triangulate(t),e=0;e<i.length;e+=3){var n=i[e],r=i[e+1],s=i[e+2];this.triangles.push([n,r,s])}};var h=r.create(),l=r.create(),p=r.create(),u=r.create(),d=r.create();r.create(),r.create(),r.create(),r.create(),i.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,o=this.centerOfMass,n=h,a=p,s=u,c=d,f=l;r.set(o,0,0);for(var v=0,y=0;y!==t.length;y++){var m=t[y],a=e[m[0]],s=e[m[1]],c=e[m[2]];r.centroid(n,a,s,c);var g=i.triangleArea(a,s,c);v+=g,r.scale(f,n,g),r.add(o,o,f)}r.scale(o,o,1/v)},i.prototype.computeMomentOfInertia=function(t){for(var e=0,o=0,i=this.vertices.length,n=i-1,a=0;i>a;n=a,a++){var s=this.vertices[n],c=this.vertices[a],h=Math.abs(r.crossLength(s,c)),l=r.dot(c,c)+r.dot(c,s)+r.dot(s,s);e+=h*l,o+=h}return t/6*(e/o)},i.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,o=0;o!==t.length;o++){var i=r.squaredLength(t[o]);i>e&&(e=i)}this.boundingRadius=Math.sqrt(e)},i.triangleArea=function(t,e,o){return.5*((e[0]-t[0])*(o[1]-t[1])-(o[0]-t[0])*(e[1]-t[1]))},i.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,o=0;o!==t.length;o++){var n=t[o],r=e[n[0]],a=e[n[1]],s=e[n[2]],c=i.triangleArea(r,a,s);this.area+=c}},i.prototype.computeAABB=function(t,e,o){t.setFromPoints(this.vertices,e,o,0)};var f=r.create(),v=r.create(),y=r.create();i.prototype.raycast=function(t,e,o,i){var n=f,a=v,s=y,c=this.vertices;r.toLocalFrame(n,e.from,o,i),r.toLocalFrame(a,e.to,o,i);for(var h=c.length,l=0;h>l&&!t.shouldStop(e);l++){var p=c[l],u=c[(l+1)%h],d=r.getLineSegmentsIntersectionFraction(n,a,p,u);d>=0&&(r.sub(s,u,p),r.rotate(s,s,-Math.PI/2+i),r.normalize(s,s),e.reportIntersection(t,d,s,l))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,o){function i(t){if(Array.isArray(arguments[0])){if(t={heights:arguments[0]},"object"==typeof arguments[1])for(var e in arguments[1])t[e]=arguments[1][e];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,(void 0===t.maxValue||void 0===t.minValue)&&this.updateMaxMinValues(),t.type=n.HEIGHTFIELD,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");t("../utils/Utils"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],o=t[0],i=0;i!==t.length;i++){var n=t[i];n>e&&(e=n),o>n&&(o=n)}this.maxValue=e,this.minValue=o},i.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},i.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},i.prototype.updateArea=function(){for(var t=this.heights,e=0,o=0;o<t.length-1;o++)e+=(t[o]+t[o+1])/2*this.elementWidth;this.area=e};var a=[r.create(),r.create(),r.create(),r.create()];i.prototype.computeAABB=function(t,e,o){r.set(a[0],0,this.maxValue),r.set(a[1],this.elementWidth*this.heights.length,this.maxValue),r.set(a[2],this.elementWidth*this.heights.length,this.minValue),r.set(a[3],0,this.minValue),t.setFromPoints(a,e,o)},i.prototype.getLineSegment=function(t,e,o){var i=this.heights,n=this.elementWidth;r.set(t,o*n,i[o]),r.set(e,(o+1)*n,i[o+1])},i.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},i.prototype.getClampedSegmentIndex=function(t){var e=this.getSegmentIndex(t);return e=Math.min(this.heights.length,Math.max(e,0))};var s=(r.create(),r.create()),c=r.create(),h=r.create(),l=r.create(),p=r.create();r.fromValues(0,1),i.prototype.raycast=function(t,e,o,i){var n=e.from,a=e.to,u=(e.direction,s),d=c,f=h,v=l,y=p;r.toLocalFrame(v,n,o,i),r.toLocalFrame(y,a,o,i);var m=this.getClampedSegmentIndex(v),g=this.getClampedSegmentIndex(y);if(m>g){var A=m;m=g,g=A}for(var b=0;b<this.heights.length-1;b++){this.getLineSegment(d,f,b);var E=r.getLineSegmentsIntersectionFraction(v,y,d,f);if(E>=0&&(r.sub(u,f,d),r.rotate(u,u,i+Math.PI/2),r.normalize(u,u),e.reportIntersection(t,E,u,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&(t={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),t=t||{},this.length=t.length||1,t.type=n.LINE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var a=[r.create(),r.create()];i.prototype.computeAABB=function(t,e,o){var i=this.length/2;r.set(a[0],-i,0),r.set(a[1],i,0),t.setFromPoints(a,e,o,0)};var s=(r.create(),r.create()),c=r.create(),h=r.create(),l=r.fromValues(0,1);i.prototype.raycast=function(t,e,o,i){var n=e.from,a=e.to,p=c,u=h,d=this.length/2;r.set(p,-d,0),r.set(u,d,0),r.toGlobalFrame(p,p,o,i),r.toGlobalFrame(u,u,o,i);var f=r.getLineSegmentsIntersectionFraction(p,u,n,a);if(f>=0){var v=s;r.rotate(v,l,i),e.reportIntersection(t,f,v,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,o){function i(t){t=t||{},t.type=n.PARTICLE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return 0},i.prototype.updateBoundingRadius=function(){this.boundingRadius=0},i.prototype.computeAABB=function(t,e,o){r.copy(t.lowerBound,e),r.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,o){function i(t){t=t||{},t.type=n.PLANE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");t("../utils/Utils"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return 0},i.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},i.prototype.computeAABB=function(t,e,o){var i=o%(2*Math.PI),n=r.set,a=Number.MAX_VALUE,s=t.lowerBound,c=t.upperBound;0===i?(n(s,-a,-a),n(c,a,0)):i===Math.PI/2?(n(s,0,-a),n(c,a,a)):i===Math.PI?(n(s,-a,0),n(c,a,a)):i===3*Math.PI/2?(n(s,-a,-a),n(c,0,a)):(n(s,-a,-a),n(c,a,a)),r.add(s,s,e),r.add(c,c,e)},i.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var a=r.create(),s=(r.create(),r.create(),r.create()),c=r.create();i.prototype.raycast=function(t,e,o,i){var n=e.from,h=e.to,l=e.direction,p=a,u=s,d=c;r.set(u,0,1),r.rotate(u,u,i),r.sub(d,n,o);var f=r.dot(d,u);r.sub(d,h,o);var v=r.dot(d,u);if(!(f*v>0||r.squaredDistance(n,h)<f*f)){var y=r.dot(u,l);r.sub(p,n,o);var m=-r.dot(u,p)/y/e.length;e.reportIntersection(t,m,u,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,o){function i(t){t=t||{},this.body=null,this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=i.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0!==t.collisionResponse?t.collisionResponse:!0,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor?t.sensor:!1,this.type&&this.updateBoundingRadius(),this.updateArea()}e.exports=i;var n=t("../math/vec2");i.idCounter=0,i.CIRCLE=1,i.PARTICLE=2,i.PLANE=4,i.CONVEX=8,i.LINE=16,i.BOX=32,Object.defineProperty(i,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),i.BOX}}),i.CAPSULE=64,i.HEIGHTFIELD=128,i.prototype.computeMomentOfInertia=function(t){},i.prototype.updateBoundingRadius=function(){},i.prototype.updateArea=function(){},i.prototype.computeAABB=function(t,e,o){},i.prototype.raycast=function(t,e,o,i){}},{"../math/vec2":30}],46:[function(t,e,o){function i(t){a.call(this,t,a.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new s.ARRAY_TYPE(this.arrayStep),this.Bs=new s.ARRAY_TYPE(this.arrayStep),this.invCs=new s.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}function n(t){for(var e=t.length;e--;)t[e]=0}var r=t("../math/vec2"),a=t("./Solver"),s=t("../utils/Utils"),c=t("../equations/FrictionEquation");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.solve=function(t,e){this.sortEquations();var o=0,a=this.iterations,h=this.frictionIterations,l=this.equations,p=l.length,u=Math.pow(this.tolerance*p,2),d=e.bodies,f=e.bodies.length,v=(r.add,r.set,this.useZeroRHS),y=this.lambda;if(this.usedIterations=0,p)for(var m=0;m!==f;m++){var g=d[m];g.updateSolveMassProperties()}y.length<p&&(y=this.lambda=new s.ARRAY_TYPE(p+this.arrayStep),this.Bs=new s.ARRAY_TYPE(p+this.arrayStep),this.invCs=new s.ARRAY_TYPE(p+this.arrayStep)),n(y);
for(var A=this.invCs,b=this.Bs,y=this.lambda,m=0;m!==l.length;m++){var E=l[m];(E.timeStep!==t||E.needsUpdate)&&(E.timeStep=t,E.update()),b[m]=E.computeB(E.a,E.b,t),A[m]=E.computeInvC(E.epsilon)}var E,B,m,q;if(0!==p){for(m=0;m!==f;m++){var g=d[m];g.resetConstraintVelocity()}if(h){for(o=0;o!==h;o++){for(B=0,q=0;q!==p;q++){E=l[q];var P=i.iterateEquation(q,E,E.epsilon,b,A,y,v,t,o);B+=Math.abs(P)}if(this.usedIterations++,u>=B*B)break}for(i.updateMultipliers(l,y,1/t),q=0;q!==p;q++){var w=l[q];if(w instanceof c){for(var S=0,C=0;C!==w.contactEquations.length;C++)S+=w.contactEquations[C].multiplier;S*=w.frictionCoefficient/w.contactEquations.length,w.maxForce=S,w.minForce=-S}}}for(o=0;o!==a;o++){for(B=0,q=0;q!==p;q++){E=l[q];var P=i.iterateEquation(q,E,E.epsilon,b,A,y,v,t,o);B+=Math.abs(P)}if(this.usedIterations++,u>=B*B)break}for(m=0;m!==f;m++)d[m].addConstraintVelocity();i.updateMultipliers(l,y,1/t)}},i.updateMultipliers=function(t,e,o){for(var i=t.length;i--;)t[i].multiplier=e[i]*o},i.iterateEquation=function(t,e,o,i,n,r,a,s,c){var h=i[t],l=n[t],p=r[t],u=e.computeGWlambda(),d=e.maxForce,f=e.minForce;a&&(h=0);var v=l*(h-u-o*p),y=p+v;return f*s>y?v=f*s-p:y>d*s&&(v=d*s-p),r[t]+=v,e.addToWlambda(v),v}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,o){function i(t,e){t=t||{},n.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}var n=(t("../utils/Utils"),t("../events/EventEmitter"));e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var r={bodies:[]};i.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),r.bodies.length=0,e.getBodies(r.bodies),r.bodies.length&&this.solve(t,r))},i.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},i.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},i.prototype.addEquations=function(t){for(var e=0,o=t.length;e!==o;e++){var i=t[e];i.enabled&&this.equations.push(i)}},i.prototype.removeEquation=function(t){var e=this.equations.indexOf(t);-1!==e&&this.equations.splice(e,1)},i.prototype.removeAllEquations=function(){this.equations.length=0},i.GS=1,i.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../equations/ContactEquation"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../equations/FrictionEquation"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../world/IslandNode"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../world/Island"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,o){function i(){this.overlappingShapesLastState=new n,this.overlappingShapesCurrentState=new n,this.recordPool=new r({size:16}),this.tmpDict=new n,this.tmpArray1=[]}var n=t("./TupleDictionary"),r=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils"),e.exports=i,i.prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,o=t.keys.length;o--;){var i=t.keys[o],n=t.getByKey(i);e.getByKey(i),n&&this.recordPool.release(n)}t.reset(),t.copy(e),e.reset()},i.prototype.setOverlapping=function(t,e,o,i){var n=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);if(!n.get(e.id,i.id)){var r=this.recordPool.get();r.set(t,e,o,i),n.set(e.id,i.id,r)}},i.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},i.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},i.prototype.bodiesAreOverlapping=function(t,e){for(var o=this.overlappingShapesCurrentState,i=o.keys.length;i--;){var n=o.keys[i],r=o.data[n];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},i.prototype.getDiff=function(t,e,o){var o=o||[],i=t,n=e;o.length=0;for(var r=n.keys.length;r--;){var a=n.keys[r],s=n.data[a];if(!s)throw new Error("Key "+a+" had no data!");var c=i.data[a];c||o.push(s)}return o},i.prototype.isNewOverlap=function(t,e){var o=0|t.id,i=0|e.id,n=this.overlappingShapesLastState,r=this.overlappingShapesCurrentState;return!n.get(o,i)&&!!r.get(o,i)},i.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},i.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},i.prototype.getBodyDiff=function(t,e){e=e||[];for(var o=this.tmpDict,i=t.length;i--;){var n=t[i];o.set(0|n.bodyA.id,0|n.bodyB.id,n)}for(i=o.keys.length;i--;){var n=o.getByKey(o.keys[i]);n&&e.push(n.bodyA,n.bodyB)}return o.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,o){function i(t,e,o,i){this.shapeA=e,this.shapeB=i,this.bodyA=t,this.bodyB=o}e.exports=i,i.prototype.set=function(t,e,o,n){i.call(this,t,e,o,n)}},{}],54:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("./OverlapKeeperRecord"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,o){function i(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}e.exports=i,i.prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},i.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},i.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,o){function i(){this.data={},this.keys=[]}var n=t("./Utils");e.exports=i,i.prototype.getKey=function(t,e){return t=0|t,e=0|e,(0|t)===(0|e)?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},i.prototype.getByKey=function(t){return t=0|t,this.data[t]},i.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},i.prototype.set=function(t,e,o){if(!o)throw new Error("No data!");var i=this.getKey(t,e);return this.data[i]||this.keys.push(i),this.data[i]=o,i},i.prototype.reset=function(){for(var t=this.data,e=this.keys,o=e.length;o--;)delete t[e[o]];e.length=0},i.prototype.copy=function(t){this.reset(),n.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var o=t.keys[e];this.data[o]=t.data[o]}}},{"./Utils":57}],57:[function(t,e,o){function i(){}e.exports=i,i.appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var o=0,i=e.length;o!==i;++o)t.push(e[o])},i.splice=function(t,e,o){o=o||1;for(var i=e,n=t.length-o;n>i;i++)t[i]=t[i+o];t.length=n},"undefined"!=typeof P2_ARRAY_TYPE?i.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?i.ARRAY_TYPE=Float32Array:i.ARRAY_TYPE=Array,i.extend=function(t,e){for(var o in e)t[o]=e[o]},i.defaults=function(t,e){t=t||{};for(var o in e)o in t||(t[o]=e[o]);return t}},{}],58:[function(t,e,o){function i(){this.equations=[],this.bodies=[]}var n=t("../objects/Body");e.exports=i,i.prototype.reset=function(){this.equations.length=this.bodies.length=0};var r=[];i.prototype.getBodies=function(t){var e=t||[],o=this.equations;r.length=0;for(var i=0;i!==o.length;i++){var n=o[i];-1===r.indexOf(n.bodyA.id)&&(e.push(n.bodyA),r.push(n.bodyA.id)),-1===r.indexOf(n.bodyB.id)&&(e.push(n.bodyB),r.push(n.bodyB.id))}return e},i.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===n.DYNAMIC&&!e.wantsToSleep)return!1}return!0},i.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];e.sleep()}return!0}},{"../objects/Body":31}],59:[function(t,e,o){function i(t){this.nodePool=new n({size:16}),this.islandPool=new r({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}var n=(t("../math/vec2"),t("./Island"),t("./IslandNode"),t("./../utils/IslandNodePool")),r=t("./../utils/IslandPool"),a=t("../objects/Body");e.exports=i,i.getUnvisitedNode=function(t){for(var e=t.length,o=0;o!==e;o++){var i=t[o];if(!i.visited&&i.body.type===a.DYNAMIC)return i}return!1},i.prototype.visit=function(t,e,o){e.push(t.body);for(var i=t.equations.length,n=0;n!==i;n++){var r=t.equations[n];-1===o.indexOf(r)&&o.push(r)}},i.prototype.bfs=function(t,e,o){var n=this.queue;for(n.length=0,n.push(t),t.visited=!0,this.visit(t,e,o);n.length;)for(var r,s=n.pop();r=i.getUnvisitedNode(s.neighbors);)r.visited=!0,this.visit(r,e,o),r.body.type===a.DYNAMIC&&n.push(r)},i.prototype.split=function(t){for(var e=t.bodies,o=this.nodes,n=this.equations;o.length;)this.nodePool.release(o.pop());for(var r=0;r!==e.length;r++){var a=this.nodePool.get();a.body=e[r],o.push(a)}for(var s=0;s!==n.length;s++){var c=n[s],r=e.indexOf(c.bodyA),h=e.indexOf(c.bodyB),l=o[r],p=o[h];l.neighbors.push(p),p.neighbors.push(l),l.equations.push(c),p.equations.push(c)}for(var u=this.islands,r=0;r<u.length;r++)this.islandPool.release(u[r]);u.length=0;for(var d;d=i.getUnvisitedNode(o);){var f=this.islandPool.get();this.bfs(d,f.bodies,f.equations),u.push(f)}return u}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,o){function i(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}e.exports=i,i.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,o){function i(t){p.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new n,this.narrowphase=new m(this),this.islandManager=new b,this.gravity=r.fromValues(0,-9.78),t.gravity&&r.copy(this.gravity,t.gravity),this.frictionGravity=r.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new y,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new d,this.defaultContactMaterial=new f(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit="undefined"!=typeof t.islandSplit?!!t.islandSplit:!0,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=i.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new A}var n=t("../solver/GSSolver"),r=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),a=t("../shapes/Circle"),s=t("../shapes/Convex"),c=(t("../shapes/Line"),t("../shapes/Plane")),h=t("../shapes/Capsule"),l=t("../shapes/Particle"),p=t("../events/EventEmitter"),u=t("../objects/Body"),d=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),f=t("../material/ContactMaterial"),v=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),y=t("../collision/SAPBroadphase"),m=t("../collision/Narrowphase"),g=t("../utils/Utils"),A=t("../utils/OverlapKeeper"),b=t("./IslandManager");t("../objects/RotationalSpring"),e.exports=i,i.prototype=new Object(p.prototype),i.prototype.constructor=i,i.NO_SLEEPING=1,i.BODY_SLEEPING=2,i.ISLAND_SLEEPING=4,i.prototype.addConstraint=function(t){this.constraints.push(t)},i.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},i.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&g.splice(this.contactMaterials,e,1)},i.prototype.getContactMaterial=function(t,e){for(var o=this.contactMaterials,i=0,n=o.length;i!==n;i++){var r=o[i];if(r.materialA.id===t.id&&r.materialB.id===e.id||r.materialA.id===e.id&&r.materialB.id===t.id)return r}return!1},i.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&g.splice(this.constraints,e,1)};var E=(r.create(),r.create(),r.create(),r.create(),r.create(),r.create(),r.create()),B=r.fromValues(0,0),q=r.fromValues(0,0);r.fromValues(0,0),r.fromValues(0,0),i.prototype.step=function(t,e,o){if(o=o||10,e=e||0,0===e)this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var i=0;this.accumulator>=t&&o>i;)this.internalStep(t),this.time+=t,this.accumulator-=t,i++;for(var n=this.accumulator%t/t,a=0;a!==this.bodies.length;a++){var s=this.bodies[a];r.lerp(s.interpolatedPosition,s.previousPosition,s.position,n),s.interpolatedAngle=s.previousAngle+n*(s.angle-s.previousAngle)}}};var P=[];i.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,o=this.springs,n=this.bodies,a=this.gravity,s=this.solver,c=this.bodies.length,h=this.broadphase,l=this.narrowphase,p=this.constraints,d=E,f=(r.scale,r.add),v=(r.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var y=r.length(this.gravity);0===y&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=y)}if(this.applyGravity)for(var m=0;m!==c;m++){var A=n[m],b=A.force;A.type===u.DYNAMIC&&A.sleepState!==u.SLEEPING&&(r.scale(d,a,A.mass*A.gravityScale),f(b,b,d))}if(this.applySpringForces)for(var m=0;m!==e;m++){var B=o[m];B.applyForce()}if(this.applyDamping)for(var m=0;m!==c;m++){var A=n[m];A.type===u.DYNAMIC&&A.applyDamping(t)}for(var q=h.getCollisionPairs(this),w=this.disabledBodyCollisionPairs,m=w.length-2;m>=0;m-=2)for(var S=q.length-2;S>=0;S-=2)(w[m]===q[S]&&w[m+1]===q[S+1]||w[m+1]===q[S]&&w[m]===q[S+1])&&q.splice(S,2);var C=p.length;for(m=0;m!==C;m++){var L=p[m];if(!L.collideConnected)for(var S=q.length-2;S>=0;S-=2)(L.bodyA===q[S]&&L.bodyB===q[S+1]||L.bodyB===q[S]&&L.bodyA===q[S+1])&&q.splice(S,2)}this.postBroadphaseEvent.pairs=q,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);for(var m=0,x=q.length;m!==x;m+=2)for(var F=q[m],M=q[m+1],I=0,R=F.shapes.length;I!==R;I++)for(var V=F.shapes[I],T=V.position,N=V.angle,G=0,O=M.shapes.length;G!==O;G++){var U=M.shapes[G],k=U.position,_=U.angle,D=this.defaultContactMaterial;if(V.material&&U.material){var W=this.getContactMaterial(V.material,U.material);W&&(D=W)}this.runNarrowphase(l,F,V,T,N,M,U,k,_,D,this.frictionGravity)}for(var m=0;m!==c;m++){var X=n[m];X._wakeUpAfterNarrowphase&&(X.wakeUp(),X._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(P);for(var j=this.endContactEvent,G=P.length;G--;){var z=P[G];j.shapeA=z.shapeA,j.shapeB=z.shapeB,j.bodyA=z.bodyA,j.bodyB=z.bodyB,this.emit(j)}P.length=0}var Y=this.preSolveEvent;Y.contactEquations=l.contactEquations,Y.frictionEquations=l.frictionEquations,this.emit(Y),Y.contactEquations=Y.frictionEquations=null;var C=p.length;for(m=0;m!==C;m++)p[m].update();if(l.contactEquations.length||l.frictionEquations.length||C)if(this.islandSplit){for(v.equations.length=0,g.appendArray(v.equations,l.contactEquations),g.appendArray(v.equations,l.frictionEquations),m=0;m!==C;m++)g.appendArray(v.equations,p[m].equations);v.split(this);for(var m=0;m!==v.islands.length;m++){var K=v.islands[m];K.equations.length&&s.solveIsland(t,K)}}else{for(s.addEquations(l.contactEquations),s.addEquations(l.frictionEquations),m=0;m!==C;m++)s.addEquations(p[m].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(var m=0;m!==c;m++){var X=n[m];X.integrate(t)}for(var m=0;m!==c;m++)n[m].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var H=this.impactEvent,m=0;m!==l.contactEquations.length;m++){var Z=l.contactEquations[m];Z.firstImpact&&(H.bodyA=Z.bodyA,H.bodyB=Z.bodyB,H.shapeA=Z.shapeA,H.shapeB=Z.shapeB,H.contactEquation=Z,this.emit(H))}if(this.sleepMode===i.BODY_SLEEPING)for(m=0;m!==c;m++)n[m].sleepTick(this.time,!1,t);else if(this.sleepMode===i.ISLAND_SLEEPING&&this.islandSplit){for(m=0;m!==c;m++)n[m].sleepTick(this.time,!0,t);for(var m=0;m<this.islandManager.islands.length;m++){var K=this.islandManager.islands[m];K.wantsToSleep()&&K.sleep()}}this.stepping=!1;for(var J=this.bodiesToBeRemoved,m=0;m!==J.length;m++)this.removeBody(J[m]);J.length=0,this.emit(this.postStepEvent)},i.prototype.runNarrowphase=function(t,e,o,i,n,a,s,c,h,l,p){if(0!==(o.collisionGroup&s.collisionMask)&&0!==(s.collisionGroup&o.collisionMask)){r.rotate(B,i,e.angle),r.rotate(q,c,a.angle),r.add(B,B,e.position),r.add(q,q,a.position);var d=n+e.angle,f=h+a.angle;t.enableFriction=l.friction>0,t.frictionCoefficient=l.friction;var v;v=e.type===u.STATIC||e.type===u.KINEMATIC?a.mass:a.type===u.STATIC||a.type===u.KINEMATIC?e.mass:e.mass*a.mass/(e.mass+a.mass),t.slipForce=l.friction*p*v,t.restitution=l.restitution,t.surfaceVelocity=l.surfaceVelocity,t.frictionStiffness=l.frictionStiffness,t.frictionRelaxation=l.frictionRelaxation,t.stiffness=l.stiffness,t.relaxation=l.relaxation,t.contactSkinSize=l.contactSkinSize,t.enabledEquations=e.collisionResponse&&a.collisionResponse&&o.collisionResponse&&s.collisionResponse;var y=t[o.type|s.type],m=0;if(y){var g=o.sensor||s.sensor,A=t.frictionEquations.length;m=o.type<s.type?y.call(t,e,o,B,d,a,s,q,f,g):y.call(t,a,s,q,f,e,o,B,d,g);var b=t.frictionEquations.length-A;if(m){if(e.allowSleep&&e.type===u.DYNAMIC&&e.sleepState===u.SLEEPING&&a.sleepState===u.AWAKE&&a.type!==u.STATIC){var E=r.squaredLength(a.velocity)+Math.pow(a.angularVelocity,2),P=Math.pow(a.sleepSpeedLimit,2);E>=2*P&&(e._wakeUpAfterNarrowphase=!0)}if(a.allowSleep&&a.type===u.DYNAMIC&&a.sleepState===u.SLEEPING&&e.sleepState===u.AWAKE&&e.type!==u.STATIC){var w=r.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2),S=Math.pow(e.sleepSpeedLimit,2);w>=2*S&&(a._wakeUpAfterNarrowphase=!0)}if(this.overlapKeeper.setOverlapping(e,o,a,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(o,s)){var C=this.beginContactEvent;if(C.shapeA=o,C.shapeB=s,C.bodyA=e,C.bodyB=a,C.contactEquations.length=0,"number"==typeof m)for(var L=t.contactEquations.length-m;L<t.contactEquations.length;L++)C.contactEquations.push(t.contactEquations[L]);this.emit(C)}if("number"==typeof m&&b>1)for(var L=t.frictionEquations.length-b;L<t.frictionEquations.length;L++){var x=t.frictionEquations[L];x.setSlipForce(x.getSlipForce()/b)}}}}},i.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},i.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&g.splice(this.springs,e,1)},i.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t),t.world=this;var e=this.addBodyEvent;e.body=t,this.emit(e),e.body=null}},i.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(g.splice(this.bodies,e,1),this.removeBodyEvent.body=t,t.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},i.prototype.getBodyById=function(t){for(var e=this.bodies,o=0;o<e.length;o++){var i=e[o];if(i.id===t)return i}return!1},i.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},i.prototype.enableBodyCollision=function(t,e){for(var o=this.disabledBodyCollisionPairs,i=0;i<o.length;i+=2)if(o[i]===t&&o[i+1]===e||o[i+1]===t&&o[i]===e)return void o.splice(i,2)},i.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;e>=0;e--)this.removeConstraint(t[e]);for(var o=this.bodies,e=o.length-1;e>=0;e--)this.removeBody(o[e]);for(var n=this.springs,e=n.length-1;e>=0;e--)this.removeSpring(n[e]);for(var r=this.contactMaterials,e=r.length-1;e>=0;e--)this.removeContactMaterial(r[e]);i.apply(this)};var w=r.create(),S=(r.fromValues(0,0),r.fromValues(0,0));i.prototype.hitTest=function(t,e,o){o=o||0;var i=new u({position:t}),n=new l,p=t,d=0,f=w,v=S;i.addShape(n);for(var y=this.narrowphase,m=[],g=0,A=e.length;g!==A;g++)for(var b=e[g],E=0,B=b.shapes.length;E!==B;E++){var q=b.shapes[E];r.rotate(f,q.position,b.angle),r.add(f,f,b.position);var P=q.angle+b.angle;(q instanceof a&&y.circleParticle(b,q,f,P,i,n,p,d,!0)||q instanceof s&&y.particleConvex(i,n,p,d,b,q,f,P,!0)||q instanceof c&&y.particlePlane(i,n,p,d,b,q,f,P,!0)||q instanceof h&&y.particleCapsule(i,n,p,d,b,q,f,P,!0)||q instanceof l&&r.squaredLength(r.sub(v,f,t))<o*o)&&m.push(b)}return m},i.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,o=0;o!==e.length;o++)for(var i=e[o],n=0;n!==i.equations.length;n++){var r=i.equations[n];r.stiffness=t,r.needsUpdate=!0}for(var a=this.contactMaterials,o=0;o!==a.length;o++){var i=a[o];i.stiffness=i.frictionStiffness=t}var i=this.defaultContactMaterial;i.stiffness=i.frictionStiffness=t},i.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var o=this.constraints[e],i=0;i!==o.equations.length;i++){var n=o.equations[i];n.relaxation=t,n.needsUpdate=!0}for(var e=0;e!==this.contactMaterials.length;e++){var o=this.contactMaterials[e];o.relaxation=o.frictionRelaxation=t}var o=this.defaultContactMaterial;o.relaxation=o.frictionRelaxation=t};var C=new v,L=[];i.prototype.raycast=function(t,e){return e.getAABB(C),this.broadphase.aabbQuery(this,C,L),e.intersectBodies(t,L),L.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)});var tweenSetTimeOut=function(){return egret.setTimeout.call(this,arguments[0],this,arguments[1])},tweenClearTimeout=egret.clearTimeout,_gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var s=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},r=function(t,e,s){i.call(this,t,e,s),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=r.prototype.render},n=1e-10,a=i._internals,o=a.isSelector,h=a.isArray,_=r.prototype=i.to({},.1,{}),l=[];r.version="1.13.1",_.constructor=r,_.kill()._gc=!1,r.killTweensOf=r.killDelayedCallsTo=i.killTweensOf,r.getTweensOf=i.getTweensOf,r.lagSmoothing=i.lagSmoothing,r.ticker=i.ticker,r.render=i.render,_.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),i.prototype.invalidate.call(this)},_.updateTo=function(t,e){var s,r=this.ratio;e&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(s in t)this.vars[s]=t[s];if(this._initted)if(e)this._initted=!1;else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&i._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var n=this._time;this.render(0,!0,!1),this._initted=!1,this.render(n,!0,!1)}else if(this._time>0){this._initted=!1,this._init();for(var a,o=1/(1-r),h=this._firstPT;h;)a=h.s+h.c,h.c*=o,h.s=a-h.c,h=h._next}return this},_.render=function(t,e,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var s,r,o,h,_,u,c,m,p=this._dirty?this.totalDuration():this._totalDuration,f=this._time,d=this._totalTime,g=this._cycle,v=this._duration,y=this._rawPrevTime;if(t>=p?(this._totalTime=p,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=v,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(s=!0,r="onComplete"),0===v&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>y||y===n)&&y!==t&&(i=!0,y>n&&(r="onReverseComplete")),this._rawPrevTime=m=!e||t||y===t?t:n)):1e-7>t?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==d||0===v&&y>0&&y!==n)&&(r="onReverseComplete",s=this._reversed),0>t?(this._active=!1,0===v&&(this._initted||!this.vars.lazy||i)&&(y>=0&&(i=!0),this._rawPrevTime=m=!e||t||y===t?t:n)):this._initted||(i=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(h=v+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!==(1&this._cycle)&&(this._time=v-this._time),this._time>v?this._time=v:0>this._time&&(this._time=0)),this._easeType?(_=this._time/v,u=this._easeType,c=this._easePower,(1===u||3===u&&_>=.5)&&(_=1-_),3===u&&(_*=2),1===c?_*=_:2===c?_*=_*_:3===c?_*=_*_*_:4===c&&(_*=_*_*_*_),this.ratio=1===u?1-_:2===u?_:.5>this._time/v?_/2:1-_/2):this.ratio=this._ease.getRatio(this._time/v)),f===this._time&&!i&&g===this._cycle)return void(d!==this._totalTime&&this._onUpdate&&(e||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||l)));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=f,this._totalTime=d,this._rawPrevTime=y,this._cycle=g,a.lazyTweens.push(this),void(this._lazy=t);this._time&&!s?this.ratio=this._ease.getRatio(this._time/v):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==f&&t>=0&&(this._active=!0),0===d&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===v)&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||l))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,e,i),e||(this._totalTime!==d||s)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||l)),this._cycle!==g&&(e||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||l)),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this.vars[r].apply(this.vars[r+"Scope"]||this,this.vars[r+"Params"]||l),0===v&&this._rawPrevTime===n&&m!==n&&(this._rawPrevTime=0))},r.to=function(t,e,i){return new r(t,e,i)},r.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new r(t,e,i)},r.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new r(t,e,s)},r.staggerTo=r.allTo=function(t,e,n,a,_,u,c){a=a||0;var m,p,f,d,g=n.delay||0,v=[],y=function(){n.onComplete&&n.onComplete.apply(n.onCompleteScope||this,arguments),_.apply(c||this,u||l)};for(h(t)||("string"==typeof t&&(t=i.selector(t)||t),o(t)&&(t=s(t))),m=t.length,f=0;m>f;f++){p={};for(d in n)p[d]=n[d];p.delay=g,f===m-1&&_&&(p.onComplete=y),v[f]=new r(t[f],e,p),g+=a}return v},r.staggerFrom=r.allFrom=function(t,e,i,s,n,a,o){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,r.staggerTo(t,e,i,s,n,a,o)},r.staggerFromTo=r.allFromTo=function(t,e,i,s,n,a,o,h){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,r.staggerTo(t,e,s,n,a,o,h)},r.delayedCall=function(t,e,i,s,n){return new r(e,0,{delay:t,onComplete:e,onCompleteParams:i,onCompleteScope:s,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:s,immediateRender:!1,useFrames:n,overwrite:0})},r.set=function(t,e){return new r(t,0,e)},r.isTweening=function(t){return i.getTweensOf(t,!0).length>0};var u=function(t,e){for(var s=[],r=0,n=t._first;n;)n instanceof i?s[r++]=n:(e&&(s[r++]=n),s=s.concat(u(n,e)),r=s.length),n=n._next;return s},c=r.getAllTweens=function(e){return u(t._rootTimeline,e).concat(u(t._rootFramesTimeline,e))};r.killAll=function(t,i,s,r){null==i&&(i=!0),null==s&&(s=!0);var n,a,o,h=c(0!=r),_=h.length,l=i&&s&&r;for(o=0;_>o;o++)a=h[o],(l||a instanceof e||(n=a.target===a.vars.onComplete)&&s||i&&!n)&&(t?a.totalTime(a._reversed?0:a.totalDuration()):a._enabled(!1,!1))},r.killChildTweensOf=function(t,e){if(null!=t){var n,_,l,u,c,m=a.tweenLookup;if("string"==typeof t&&(t=i.selector(t)||t),o(t)&&(t=s(t)),h(t))for(u=t.length;--u>-1;)r.killChildTweensOf(t[u],e);else{n=[];for(l in m)for(_=m[l].target.parentNode;_;)_===t&&(n=n.concat(m[l].tweens)),_=_.parentNode;for(c=n.length,u=0;c>u;u++)e&&n[u].totalTime(n[u].totalDuration()),n[u]._enabled(!1,!1)}}};var m=function(t,i,s,r){i=i!==!1,s=s!==!1,r=r!==!1;for(var n,a,o=c(r),h=i&&s&&r,_=o.length;--_>-1;)a=o[_],(h||a instanceof e||(n=a.target===a.vars.onComplete)&&s||i&&!n)&&a.paused(t)};return r.pauseAll=function(t,e,i){m(!0,t,e,i)},r.resumeAll=function(t,e,i){m(!1,t,e,i)},r.globalTimeScale=function(e){var s=t._rootTimeline,r=i.ticker.time;return arguments.length?(e=e||n,s._startTime=r-(r-s._startTime)*s._timeScale/e,s=t._rootFramesTimeline,r=i.ticker.frame,s._startTime=r-(r-s._startTime)*s._timeScale/e,s._timeScale=t._rootTimeline._timeScale=e,e):s._timeScale},_.progress=function(t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},_.totalProgress=function(t){return arguments.length?this.totalTime(this.totalDuration()*t,!1):this._totalTime/this.totalDuration()},_.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!==(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},_.duration=function(e){return arguments.length?t.prototype.duration.call(this,e):this._duration},_.totalDuration=function(t){return arguments.length?-1===this._repeat?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},_.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},_.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},_.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},r},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var s=function(t){e.call(this,t),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,s,r=this.vars;for(s in r)i=r[s],o(i)&&-1!==i.join("").indexOf("{self}")&&(r[s]=this._swapSelfInParams(i));o(r.tweens)&&this.add(r.tweens,0,r.align,r.stagger)},r=1e-10,n=i._internals,a=n.isSelector,o=n.isArray,h=n.lazyTweens,_=n.lazyRender,l=[],u=_gsScope._gsDefine.globals,c=function(t){var e,i={};for(e in t)i[e]=t[e];return i},m=function(t,e,i,s){t._timeline.pause(t._startTime),e&&e.apply(s||t._timeline,i||l)},p=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},f=s.prototype=new e;return s.version="1.13.1",f.constructor=s,f.kill()._gc=!1,f.to=function(t,e,s,r){var n=s.repeat&&u.TweenMax||i;return e?this.add(new n(t,e,s),r):this.set(t,s,r)},f.from=function(t,e,s,r){return this.add((s.repeat&&u.TweenMax||i).from(t,e,s),r)},f.fromTo=function(t,e,s,r,n){var a=r.repeat&&u.TweenMax||i;return e?this.add(a.fromTo(t,e,s,r),n):this.set(t,r,n)},f.staggerTo=function(t,e,r,n,o,h,_,l){var u,m=new s({onComplete:h,onCompleteParams:_,onCompleteScope:l,smoothChildTiming:this.smoothChildTiming});for("string"==typeof t&&(t=i.selector(t)||t),a(t)&&(t=p(t)),n=n||0,u=0;t.length>u;u++)r.startAt&&(r.startAt=c(r.startAt)),m.to(t[u],e,c(r),u*n);return this.add(m,o)},f.staggerFrom=function(t,e,i,s,r,n,a,o){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(t,e,i,s,r,n,a,o)},f.staggerFromTo=function(t,e,i,s,r,n,a,o,h){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,this.staggerTo(t,e,s,r,n,a,o,h)},f.call=function(t,e,s,r){return this.add(i.delayedCall(0,t,e,s),r)},f.set=function(t,e,s){return s=this._parseTimeOrLabel(s,0,!0),null==e.immediateRender&&(e.immediateRender=s===this._time&&!this._paused),this.add(new i(t,0,e),s)},s.exportRoot=function(t,e){t=t||{},null==t.smoothChildTiming&&(t.smoothChildTiming=!0);var r,n,a=new s(t),o=a._timeline;for(null==e&&(e=!0),o._remove(a,!0),a._startTime=0,a._rawPrevTime=a._time=a._totalTime=o._time,r=o._first;r;)n=r._next,e&&r instanceof i&&r.target===r.vars.onComplete||a.add(r,r._startTime-r._delay),r=n;return o.add(a,0),a},f.add=function(r,n,a,h){var _,l,u,c,m,p;if("number"!=typeof n&&(n=this._parseTimeOrLabel(n,0,!0,r)),!(r instanceof t)){if(r instanceof Array||r&&r.push&&o(r)){for(a=a||"normal",h=h||0,_=n,l=r.length,u=0;l>u;u++)o(c=r[u])&&(c=new s({tweens:c})),this.add(c,_),"string"!=typeof c&&"function"!=typeof c&&("sequence"===a?_=c._startTime+c.totalDuration()/c._timeScale:"start"===a&&(c._startTime-=c.delay())),_+=h;return this._uncache(!0)}if("string"==typeof r)return this.addLabel(r,n);if("function"!=typeof r)throw"Cannot add "+r+" into the timeline; it is not a tween, timeline, function, or string.";r=i.delayedCall(0,r)}if(e.prototype.add.call(this,r,n),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(m=this,p=m.rawTime()>r._startTime;m._timeline;)p&&m._timeline.smoothChildTiming?m.totalTime(m._totalTime,!0):m._gc&&m._enabled(!0,!1),m=m._timeline;return this},f.remove=function(e){if(e instanceof t)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&o(e)){for(var i=e.length;--i>-1;)this.remove(e[i]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},f._remove=function(t,i){e.prototype._remove.call(this,t,i);var s=this._last;return s?this._time>s._startTime+s._totalDuration/s._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},f.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},f.insert=f.insertMultiple=function(t,e,i,s){return this.add(t,e||0,i,s)},f.appendMultiple=function(t,e,i,s){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),i,s)},f.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},f.addPause=function(t,e,i,s){return this.call(m,["{self}",e,i,s],this,t)},f.removeLabel=function(t){return delete this._labels[t],this},f.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},f._parseTimeOrLabel=function(e,i,s,r){var n;if(r instanceof t&&r.timeline===this)this.remove(r);else if(r&&(r instanceof Array||r.push&&o(r)))for(n=r.length;--n>-1;)r[n]instanceof t&&r[n].timeline===this&&this.remove(r[n]);if("string"==typeof i)return this._parseTimeOrLabel(i,s&&"number"==typeof e&&null==this._labels[i]?e-this.duration():0,s);if(i=i||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(n=e.indexOf("="),-1===n)return null==this._labels[e]?s?this._labels[e]=this.duration()+i:i:this._labels[e]+i;i=parseInt(e.charAt(n-1)+"1",10)*Number(e.substr(n+1)),e=n>1?this._parseTimeOrLabel(e.substr(0,n-1),0,s):this.duration()}return Number(e)+i},f.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),e!==!1)},f.stop=function(){return this.paused(!0)},f.gotoAndPlay=function(t,e){return this.play(t,e)},f.gotoAndStop=function(t,e){return this.pause(t,e)},f.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var s,n,a,o,u,c=this._dirty?this.totalDuration():this._totalDuration,m=this._time,p=this._startTime,f=this._timeScale,d=this._paused;if(t>=c?(this._totalTime=this._time=c,this._reversed||this._hasPausedChild()||(n=!0,o="onComplete",0===this._duration&&(0===t||0>this._rawPrevTime||this._rawPrevTime===r)&&this._rawPrevTime!==t&&this._first&&(u=!0,this._rawPrevTime>r&&(o="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=c+1e-4):1e-7>t?(this._totalTime=this._time=0,(0!==m||0===this._duration&&this._rawPrevTime!==r&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(o="onReverseComplete",n=this._reversed),0>t?(this._active=!1,this._rawPrevTime>=0&&this._first&&(u=!0),this._rawPrevTime=t):(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=0,this._initted||(u=!0))):this._totalTime=this._time=this._rawPrevTime=t,this._time!==m&&this._first||i||u){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==m&&t>0&&(this._active=!0),0===m&&this.vars.onStart&&0!==this._time&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||l)),this._time>=m)for(s=this._first;s&&(a=s._next,!this._paused||d);)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;else for(s=this._last;s&&(a=s._prev,!this._paused||d);)(s._active||m>=s._startTime&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;this._onUpdate&&(e||(h.length&&_(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||l))),o&&(this._gc||(p===this._startTime||f!==this._timeScale)&&(0===this._time||c>=this.totalDuration())&&(n&&(h.length&&_(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this.vars[o].apply(this.vars[o+"Scope"]||this,this.vars[o+"Params"]||l)))}},f._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof s&&t._hasPausedChild())return!0;t=t._next}return!1},f.getChildren=function(t,e,s,r){r=r||-9999999999;for(var n=[],a=this._first,o=0;a;)r>a._startTime||(a instanceof i?e!==!1&&(n[o++]=a):(s!==!1&&(n[o++]=a),t!==!1&&(n=n.concat(a.getChildren(!0,e,s)),o=n.length))),a=a._next;return n},f.getTweensOf=function(t,e){var s,r,n=this._gc,a=[],o=0;for(n&&this._enabled(!0,!0),s=i.getTweensOf(t),r=s.length;--r>-1;)(s[r].timeline===this||e&&this._contains(s[r]))&&(a[o++]=s[r]);return n&&this._enabled(!1,!0),a},f._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},f.shiftChildren=function(t,e,i){i=i||0;for(var s,r=this._first,n=this._labels;r;)r._startTime>=i&&(r._startTime+=t),r=r._next;if(e)for(s in n)n[s]>=i&&(n[s]+=t);return this._uncache(!0)},f._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),s=i.length,r=!1;--s>-1;)i[s]._kill(t,e)&&(r=!0);return r},f.clear=function(t){var e=this.getChildren(!1,!0,!0),i=e.length;for(this._time=this._totalTime=0;--i>-1;)e[i]._enabled(!1,!1);return t!==!1&&(this._labels={}),this._uncache(!0)},f.invalidate=function(){for(var t=this._first;t;)t.invalidate(),t=t._next;return this},f._enabled=function(t,i){if(t===this._gc)for(var s=this._first;s;)s._enabled(t,!0),s=s._next;return e.prototype._enabled.call(this,t,i)},f.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},f.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,i,s=0,r=this._last,n=999999999999;r;)e=r._prev,r._dirty&&r.totalDuration(),r._startTime>n&&this._sortChildren&&!r._paused?this.add(r,r._startTime-r._delay):n=r._startTime,0>r._startTime&&!r._paused&&(s-=r._startTime,this._timeline.smoothChildTiming&&(this._startTime+=r._startTime/this._timeScale),this.shiftChildren(-r._startTime,!1,-9999999999),n=0),i=r._startTime+r._totalDuration/r._timeScale,i>s&&(s=i),r=e;this._duration=this._totalDuration=s,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==t&&this.timeScale(this._totalDuration/t),this},f.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},f.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},s},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(t,e,i){var s=function(e){t.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},r=1e-10,n=[],a=e._internals,o=a.lazyTweens,h=a.lazyRender,_=new i(null,null,1,0),l=s.prototype=new t;return l.constructor=s,l.kill()._gc=!1,s.version="1.13.1",l.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},l.addCallback=function(t,i,s,r){return this.add(e.delayedCall(0,t,s,r),i)},l.removeCallback=function(t,e){if(t)if(null==e)this._kill(null,t);else for(var i=this.getTweensOf(t,!1),s=i.length,r=this._parseTimeOrLabel(e);--s>-1;)i[s]._startTime===r&&i[s]._enabled(!1,!1);return this},l.tweenTo=function(t,i){i=i||{};var s,r,a,o={ease:_,overwrite:i.delay?2:1,useFrames:this.usesFrames(),immediateRender:!1};for(r in i)o[r]=i[r];return o.time=this._parseTimeOrLabel(t),s=Math.abs(Number(o.time)-this._time)/this._timeScale||.001,a=new e(this,s,o),o.onStart=function(){a.target.paused(!0),a.vars.time!==a.target.time()&&s===a.duration()&&a.duration(Math.abs(a.vars.time-a.target.time())/a.target._timeScale),i.onStart&&i.onStart.apply(i.onStartScope||a,i.onStartParams||n)},a},l.tweenFromTo=function(t,e,i){i=i||{},t=this._parseTimeOrLabel(t),i.startAt={onComplete:this.seek,onCompleteParams:[t],onCompleteScope:this},i.immediateRender=i.immediateRender!==!1;var s=this.tweenTo(e,i);return s.duration(Math.abs(s.vars.time-t)/this._timeScale||.001)},l.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var s,a,_,l,u,c,m=this._dirty?this.totalDuration():this._totalDuration,p=this._duration,f=this._time,d=this._totalTime,g=this._startTime,v=this._timeScale,y=this._rawPrevTime,T=this._paused,w=this._cycle;if(t>=m?(this._locked||(this._totalTime=m,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(a=!0,l="onComplete",0===this._duration&&(0===t||0>y||y===r)&&y!==t&&this._first&&(u=!0,y>r&&(l="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,this._yoyo&&0!==(1&this._cycle)?this._time=t=0:(this._time=p,t=p+1e-4)):1e-7>t?(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==f||0===p&&y!==r&&(y>0||0>t&&y>=0)&&!this._locked)&&(l="onReverseComplete",a=this._reversed),0>t?(this._active=!1,y>=0&&this._first&&(u=!0),this._rawPrevTime=t):(this._rawPrevTime=p||!e||t||this._rawPrevTime===t?t:r,t=0,this._initted||(u=!0))):(0===p&&0>y&&(u=!0),this._time=this._rawPrevTime=t,this._locked||(this._totalTime=t,0!==this._repeat&&(c=p+this._repeatDelay,this._cycle=this._totalTime/c>>0,0!==this._cycle&&this._cycle===this._totalTime/c&&this._cycle--,this._time=this._totalTime-this._cycle*c,this._yoyo&&0!==(1&this._cycle)&&(this._time=p-this._time),this._time>p?(this._time=p,t=p+1e-4):0>this._time?this._time=t=0:t=this._time))),this._cycle!==w&&!this._locked){var b=this._yoyo&&0!==(1&w),P=b===(this._yoyo&&0!==(1&this._cycle)),S=this._totalTime,R=this._cycle,C=this._rawPrevTime,k=this._time;if(this._totalTime=w*p,w>this._cycle?b=!b:this._totalTime+=p,this._time=f,this._rawPrevTime=0===p?y-1e-4:y,this._cycle=w,this._locked=!0,f=b?0:p,this.render(f,e,0===p),e||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||n),P&&(f=b?p+1e-4:-1e-4,this.render(f,!0,!1)),this._locked=!1,this._paused&&!T)return;this._time=k,this._totalTime=S,this._cycle=R,this._rawPrevTime=C}if(!(this._time!==f&&this._first||i||u))return void(d!==this._totalTime&&this._onUpdate&&(e||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||n)));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==d&&t>0&&(this._active=!0),0===d&&this.vars.onStart&&0!==this._totalTime&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||n)),this._time>=f)for(s=this._first;s&&(_=s._next,!this._paused||T);)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=_;else for(s=this._last;s&&(_=s._prev,!this._paused||T);)(s._active||f>=s._startTime&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=_;this._onUpdate&&(e||(o.length&&h(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||n))),l&&(this._locked||this._gc||(g===this._startTime||v!==this._timeScale)&&(0===this._time||m>=this.totalDuration())&&(a&&(o.length&&h(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[l]&&this.vars[l].apply(this.vars[l+"Scope"]||this,this.vars[l+"Params"]||n)))},l.getActive=function(t,e,i){null==t&&(t=!0),null==e&&(e=!0),null==i&&(i=!1);var s,r,n=[],a=this.getChildren(t,e,i),o=0,h=a.length;for(s=0;h>s;s++)r=a[s],r.isActive()&&(n[o++]=r);return n},l.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,i=this.getLabelsArray(),s=i.length;for(e=0;s>e;e++)if(i[e].time>t)return i[e].name;return null},l.getLabelBefore=function(t){null==t&&(t=this._time);for(var e=this.getLabelsArray(),i=e.length;--i>-1;)if(t>e[i].time)return e[i].name;return null},l.getLabelsArray=function(){var t,e=[],i=0;for(t in this._labels)e[i++]={time:this._labels[t],name:t};return e.sort(function(t,e){return t.time-e.time}),e},l.progress=function(t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},l.totalProgress=function(t){return arguments.length?this.totalTime(this.totalDuration()*t,!1):this._totalTime/this.totalDuration()},l.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(t.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},l.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!==(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},l.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},l.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},l.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},l.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.getLabelBefore(this._time+1e-8)},s},!0),function(){var t=180/Math.PI,e=[],i=[],s=[],r={},n=function(t,e,i,s){this.a=t,this.b=e,this.c=i,this.d=s,this.da=s-t,this.ca=i-t,this.ba=e-t},a=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",o=function(t,e,i,s){var r={a:t},n={},a={},o={c:s},h=(t+e)/2,_=(e+i)/2,l=(i+s)/2,u=(h+_)/2,c=(_+l)/2,m=(c-u)/8;return r.b=h+(t-h)/4,n.b=u+m,r.c=n.a=(r.b+n.b)/2,n.c=a.a=(u+c)/2,a.b=c-m,o.b=l+(s-l)/4,a.c=o.a=(a.b+o.b)/2,[r,n,a,o]},h=function(t,r,n,a,h){var _,l,u,c,m,p,f,d,g,v,y,T,w,b=t.length-1,P=0,S=t[0].a;for(_=0;b>_;_++)m=t[P],l=m.a,u=m.d,c=t[P+1].d,h?(y=e[_],T=i[_],w=.25*(T+y)*r/(a?.5:s[_]||.5),p=u-(u-l)*(a?.5*r:0!==y?w/y:0),f=u+(c-u)*(a?.5*r:0!==T?w/T:0),d=u-(p+((f-p)*(3*y/(y+T)+.5)/4||0))):(p=u-.5*(u-l)*r,f=u+.5*(c-u)*r,d=u-(p+f)/2),p+=d,f+=d,m.c=g=p,m.b=0!==_?S:S=m.a+.6*(m.c-m.a),m.da=u-l,m.ca=g-l,m.ba=S-l,n?(v=o(l,S,g,u),t.splice(P,1,v[0],v[1],v[2],v[3]),P+=4):P++,S=f;m=t[P],m.b=S,m.c=S+.4*(m.d-S),m.da=m.d-m.a,m.ca=m.c-m.a,m.ba=S-m.a,n&&(v=o(m.a,S,m.c,m.d),t.splice(P,1,v[0],v[1],v[2],v[3]))},_=function(t,s,r,a){var o,h,_,l,u,c,m=[];if(a)for(t=[a].concat(t),h=t.length;--h>-1;)"string"==typeof(c=t[h][s])&&"="===c.charAt(1)&&(t[h][s]=a[s]+Number(c.charAt(0)+c.substr(2)));if(o=t.length-2,0>o)return m[0]=new n(t[0][s],0,0,t[-1>o?0:1][s]),m;for(h=0;o>h;h++)_=t[h][s],l=t[h+1][s],m[h]=new n(_,0,0,l),r&&(u=t[h+2][s],e[h]=(e[h]||0)+(l-_)*(l-_),i[h]=(i[h]||0)+(u-l)*(u-l));return m[h]=new n(t[h][s],0,0,t[h+1][s]),m},l=function(t,n,o,l,u,c){var m,p,f,d,g,v,y,T,w={},b=[],P=c||t[0];u="string"==typeof u?","+u+",":a,null==n&&(n=1);for(p in t[0])b.push(p);if(t.length>1){for(T=t[t.length-1],y=!0,m=b.length;--m>-1;)if(p=b[m],Math.abs(P[p]-T[p])>.05){y=!1;break}y&&(t=t.concat(),c&&t.unshift(c),t.push(t[1]),c=t[t.length-3])}for(e.length=i.length=s.length=0,m=b.length;--m>-1;)p=b[m],r[p]=-1!==u.indexOf(","+p+","),w[p]=_(t,p,r[p],c);for(m=e.length;--m>-1;)e[m]=Math.sqrt(e[m]),i[m]=Math.sqrt(i[m]);if(!l){for(m=b.length;--m>-1;)if(r[p])for(f=w[b[m]],v=f.length-1,d=0;v>d;d++)g=f[d+1].da/i[d]+f[d].da/e[d],s[d]=(s[d]||0)+g*g;for(m=s.length;--m>-1;)s[m]=Math.sqrt(s[m])}for(m=b.length,d=o?4:1;--m>-1;)p=b[m],f=w[p],h(f,n,o,l,r[p]),y&&(f.splice(0,d),f.splice(f.length-d,d));return w},u=function(t,e,i){e=e||"soft";var s,r,a,o,h,_,l,u,c,m,p,f={},d="cubic"===e?3:2,g="soft"===e,v=[];if(g&&i&&(t=[i].concat(t)),null==t||d+1>t.length)throw"invalid Bezier data";for(c in t[0])v.push(c);for(_=v.length;--_>-1;){for(c=v[_],f[c]=h=[],m=0,u=t.length,l=0;u>l;l++)s=null==i?t[l][c]:"string"==typeof(p=t[l][c])&&"="===p.charAt(1)?i[c]+Number(p.charAt(0)+p.substr(2)):Number(p),g&&l>1&&u-1>l&&(h[m++]=(s+h[m-2])/2),h[m++]=s;for(u=m-d+1,m=0,l=0;u>l;l+=d)s=h[l],r=h[l+1],a=h[l+2],o=2===d?0:h[l+3],h[m++]=p=3===d?new n(s,r,a,o):new n(s,(2*r+s)/3,(2*r+a)/3,a);h.length=m}return f},c=function(t,e,i){for(var s,r,n,a,o,h,_,l,u,c,m,p=1/i,f=t.length;--f>-1;)for(c=t[f],n=c.a,a=c.d-n,o=c.c-n,h=c.b-n,s=r=0,l=1;i>=l;l++)_=p*l,u=1-_,s=r-(r=(_*_*a+3*u*(_*o+u*h))*_),m=f*i+l-1,e[m]=(e[m]||0)+s*s},m=function(t,e){e=e>>0||6;var i,s,r,n,a=[],o=[],h=0,_=0,l=e-1,u=[],m=[];for(i in t)c(t[i],a,e);for(r=a.length,s=0;r>s;s++)h+=Math.sqrt(a[s]),n=s%e,m[n]=h,n===l&&(_+=h,n=s/e>>0,u[n]=m,o[n]=_,h=0,m=[]);return{length:_,lengths:o,segments:u}},p=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.3",API:2,global:!0,init:function(t,e,i){this._target=t,e instanceof Array&&(e={values:e}),this._func={},this._round={},this._props=[],this._timeRes=null==e.timeResolution?6:parseInt(e.timeResolution,10);var s,r,n,a,o,h=e.values||[],_={},c=h[0],p=e.autoRotate||i.vars.orientToBezier;this._autoRotate=p?p instanceof Array?p:[["x","y","rotation",p===!0?0:Number(p)||0]]:null;for(s in c)this._props.push(s);for(n=this._props.length;--n>-1;)s=this._props[n],this._overwriteProps.push(s),r=this._func[s]="function"==typeof t[s],_[s]=r?t[s.indexOf("set")||"function"!=typeof t["get"+s.substr(3)]?s:"get"+s.substr(3)]():parseFloat(t[s]),o||_[s]!==h[0][s]&&(o=_);if(this._beziers="cubic"!==e.type&&"quadratic"!==e.type&&"soft"!==e.type?l(h,isNaN(e.curviness)?1:e.curviness,!1,"thruBasic"===e.type,e.correlate,o):u(h,e.type,_),this._segCount=this._beziers[s].length,this._timeRes){var f=m(this._beziers,this._timeRes);this._length=f.length,this._lengths=f.lengths,this._segments=f.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(p=this._autoRotate)for(this._initialRotations=[],p[0]instanceof Array||(this._autoRotate=p=[p]),n=p.length;--n>-1;){for(a=0;3>a;a++)s=p[n][a],this._func[s]="function"==typeof t[s]?t[s.indexOf("set")||"function"!=typeof t["get"+s.substr(3)]?s:"get"+s.substr(3)]:!1;s=p[n][2],this._initialRotations[n]=this._func[s]?this._func[s].call(this._target):this._target[s]}return this._startRatio=i.vars.runBackwards?1:0,!0},set:function(e){var i,s,r,n,a,o,h,_,l,u,c=this._segCount,m=this._func,p=this._target,f=e!==this._startRatio;if(this._timeRes){if(l=this._lengths,u=this._curSeg,e*=this._length,r=this._li,e>this._l2&&c-1>r){for(_=c-1;_>r&&e>=(this._l2=l[++r]););this._l1=l[r-1],this._li=r,this._curSeg=u=this._segments[r],this._s2=u[this._s1=this._si=0]}else if(this._l1>e&&r>0){for(;r>0&&(this._l1=l[--r])>=e;);0===r&&this._l1>e?this._l1=0:r++,this._l2=l[r],this._li=r,this._curSeg=u=this._segments[r],this._s1=u[(this._si=u.length-1)-1]||0,this._s2=u[this._si]}if(i=r,e-=this._l1,r=this._si,e>this._s2&&u.length-1>r){for(_=u.length-1;_>r&&e>=(this._s2=u[++r]););this._s1=u[r-1],this._si=r}else if(this._s1>e&&r>0){for(;r>0&&(this._s1=u[--r])>=e;);0===r&&this._s1>e?this._s1=0:r++,this._s2=u[r],this._si=r}o=(r+(e-this._s1)/(this._s2-this._s1))*this._prec}else i=0>e?0:e>=1?c-1:c*e>>0,o=(e-i*(1/c))*c;for(s=1-o,r=this._props.length;--r>-1;)n=this._props[r],a=this._beziers[n][i],h=(o*o*a.da+3*s*(o*a.ca+s*a.ba))*o+a.a,this._round[n]&&(h=Math.round(h)),m[n]?p[n](h):p[n]=h;
if(this._autoRotate){var d,g,v,y,T,w,b,P=this._autoRotate;for(r=P.length;--r>-1;)n=P[r][2],w=P[r][3]||0,b=P[r][4]===!0?1:t,a=this._beziers[P[r][0]],d=this._beziers[P[r][1]],a&&d&&(a=a[i],d=d[i],g=a.a+(a.b-a.a)*o,y=a.b+(a.c-a.b)*o,g+=(y-g)*o,y+=(a.c+(a.d-a.c)*o-y)*o,v=d.a+(d.b-d.a)*o,T=d.b+(d.c-d.b)*o,v+=(T-v)*o,T+=(d.c+(d.d-d.c)*o-T)*o,h=f?Math.atan2(T-v,y-g)*b+w:this._initialRotations[r],m[n]?p[n](h):p[n]=h)}}}),f=p.prototype;p.bezierThrough=l,p.cubicToQuadratic=o,p._autoCSS=!0,p.quadraticToCubic=function(t,e,i){return new n(t,(2*e+t)/3,(2*e+i)/3,i)},p._cssRegister=function(){var t=_gsScope._gsDefine.globals.CSSPlugin;if(t){var e=t._internals,i=e._parseToProxy,s=e._setPluginRatio,r=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(t,e,n,a,o,h){e instanceof Array&&(e={values:e}),h=new p;var _,l,u,c=e.values,m=c.length-1,f=[],d={};if(0>m)return o;for(_=0;m>=_;_++)u=i(t,c[_],a,o,h,m!==_),f[_]=u.end;for(l in e)d[l]=e[l];return d.values=f,o=new r(t,"bezier",0,0,u.pt,2),o.data=u,o.plugin=h,o.setRatio=s,0===d.autoRotate&&(d.autoRotate=!0),!d.autoRotate||d.autoRotate instanceof Array||(_=d.autoRotate===!0?0:Number(d.autoRotate),d.autoRotate=null!=u.end.left?[["left","top","rotation",_,!1]]:null!=u.end.x?[["x","y","rotation",_,!1]]:!1),d.autoRotate&&(a._transform||a._enableTransforms(!1),u.autoRotate=a._target._gsTransform),h._onInitTween(u.proxy,d,a._tween),o}})}},f._roundProps=function(t,e){for(var i=this._overwriteProps,s=i.length;--s>-1;)(t[i[s]]||t.bezier||t.bezierThrough)&&(this._round[i[s]]=e)},f._kill=function(t){var e,i,s=this._props;for(e in this._beziers)if(e in t)for(delete this._beziers[e],delete this._func[e],i=s.length;--i>-1;)s[i]===e&&s.splice(i,1);return this._super._kill.call(this,t)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){},!0),function(){var t=_gsScope._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(t,e,i){return this._tween=i,!0}}),e=t.prototype;e._onInitAllProps=function(){for(var t,e,i,s=this._tween,r=s.vars.roundProps instanceof Array?s.vars.roundProps:s.vars.roundProps.split(","),n=r.length,a={},o=s._propLookup.roundProps;--n>-1;)a[r[n]]=1;for(n=r.length;--n>-1;)for(t=r[n],e=s._firstPT;e;)i=e._next,e.pg?e.t._roundProps(a,!0):e.n===t&&(this._add(e.t,t,e.s,e.c),i&&(i._prev=e._prev),e._prev?e._prev._next=i:s._firstPT===e&&(s._firstPT=i),e._next=e._prev=null,s._propLookup[t]=o),e=i;return!1},e._add=function(t,e,i,s){this._addTween(t,e,i,i+s,e,!0),this._overwriteProps.push(e)}}(),_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.3.3",init:function(t,e){var i,s,r;if("function"!=typeof t.setAttribute)return!1;this._target=t,this._proxy={},this._start={},this._end={};for(i in e)this._start[i]=this._proxy[i]=s=t.getAttribute(i),r=this._addTween(this._proxy,i,parseFloat(s),e[i],i),this._end[i]=r?r.s+r.c:e[i],this._overwriteProps.push(i);return!0},set:function(t){this._super.setRatio.call(this,t);for(var e,i=this._overwriteProps,s=i.length,r=1===t?this._end:t?this._proxy:this._start;--s>-1;)e=i[s],this._target.setAttribute(e,r[e]+"")}}),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(t,e){"object"!=typeof e&&(e={rotation:e}),this.finals={};var i,s,r,n,a,o,h=e.useRadians===!0?2*Math.PI:360,_=1e-6;for(i in e)"useRadians"!==i&&(o=(e[i]+"").split("_"),s=o[0],r=parseFloat("function"!=typeof t[i]?t[i]:t[i.indexOf("set")||"function"!=typeof t["get"+i.substr(3)]?i:"get"+i.substr(3)]()),n=this.finals[i]="string"==typeof s&&"="===s.charAt(1)?r+parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)):Number(s)||0,a=n-r,o.length&&(s=o.join("_"),-1!==s.indexOf("short")&&(a%=h,a!==a%(h/2)&&(a=0>a?a+h:a-h)),-1!==s.indexOf("_cw")&&0>a?a=(a+9999999999*h)%h-(0|a/h)*h:-1!==s.indexOf("ccw")&&a>0&&(a=(a-9999999999*h)%h-(0|a/h)*h)),(a>_||-_>a)&&(this._addTween(t,i,r,r+a,i),this._overwriteProps.push(i)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,s,r=_gsScope.GreenSockGlobals||_gsScope,n=r.com.greensock,a=2*Math.PI,o=Math.PI/2,h=n._class,_=function(e,i){var s=h("easing."+e,function(){},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,s},l=t.register||function(){},u=function(t,e,i,s){var r=h("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new s},!0);return l(r,t),r},c=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},m=function(e,i){var s=h("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,r.config=function(t){return new s(t)},s},p=u("Back",m("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),m("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),m("BackInOut",function(t){return 1>(t*=2)?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),f=h("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),d=f.prototype=new t;return d.constructor=f,d.getRatio=function(t){var e=t+(.5-t)*this._p;return this._p1>t?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},f.ease=new f(.7,.7),d.config=f.config=function(t,e,i){return new f(t,e,i)},e=h("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),d=e.prototype=new t,d.constructor=e,d.getRatio=function(t){return 0>t?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},d.config=e.config=function(t){return new e(t)},i=h("easing.RoughEase",function(e){e=e||{};for(var i,s,r,n,a,o,h=e.taper||"none",_=[],l=0,u=0|(e.points||20),m=u,p=e.randomize!==!1,f=e.clamp===!0,d=e.template instanceof t?e.template:null,g="number"==typeof e.strength?.4*e.strength:.4;--m>-1;)i=p?Math.random():1/u*m,s=d?d.getRatio(i):i,"none"===h?r=g:"out"===h?(n=1-i,r=n*n*g):"in"===h?r=i*i*g:.5>i?(n=2*i,r=.5*n*n*g):(n=2*(1-i),r=.5*n*n*g),p?s+=Math.random()*r-.5*r:m%2?s+=.5*r:s-=.5*r,f&&(s>1?s=1:0>s&&(s=0)),_[l++]={x:i,y:s};for(_.sort(function(t,e){return t.x-e.x}),o=new c(1,1,null),m=u;--m>-1;)a=_[m],o=new c(a.x,a.y,o);this._prev=new c(0,0,0!==o.t?o:o.next)},!0),d=i.prototype=new t,d.constructor=i,d.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},d.config=function(t){return new i(t)},i.ease=new i,u("Bounce",_("BounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),_("BounceIn",function(t){return 1/2.75>(t=1-t)?1-7.5625*t*t:2/2.75>t?1-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),_("BounceInOut",function(t){var e=.5>t;return t=e?1-2*t:2*t-1,t=1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),u("Circ",_("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),_("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),_("CircInOut",function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),s=function(e,i,s){var r=h("easing."+e,function(t,e){this._p1=t||1,this._p2=e||s,this._p3=this._p2/a*(Math.asin(1/this._p1)||0)},!0),n=r.prototype=new t;return n.constructor=r,n.getRatio=i,n.config=function(t,e){return new r(t,e)},r},u("Elastic",s("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*a/this._p2)+1},.3),s("ElasticIn",function(t){return-(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*a/this._p2))},.3),s("ElasticInOut",function(t){return 1>(t*=2)?-.5*this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*a/this._p2):.5*this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*a/this._p2)+1},.45)),u("Expo",_("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),_("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),_("ExpoInOut",function(t){return 1>(t*=2)?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),u("Sine",_("SineOut",function(t){return Math.sin(t*o)}),_("SineIn",function(t){return-Math.cos(t*o)+1}),_("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),h("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),l(r.SlowMo,"SlowMo","ease,"),l(i,"RoughEase","ease,"),l(e,"SteppedEase","ease,"),p},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t,e){"use strict";var i=t.GreenSockGlobals=t.GreenSockGlobals||t;if(!i.TweenLite){var s,r,n,a,o,h=function(t){var e,s=t.split("."),r=i;for(e=0;s.length>e;e++)r[s[e]]=r=r[s[e]]||{};return r},_=h("com.greensock"),l=1e-10,u=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},c=function(){},m=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),p={},f=function(s,r,n,a){this.sc=p[s]?p[s].sc:[],p[s]=this,this.gsClass=null,this.func=n;var o=[];this.check=function(_){for(var l,u,c,m,d=r.length,g=d;--d>-1;)(l=p[r[d]]||new f(r[d],[])).gsClass?(o[d]=l.gsClass,g--):_&&l.sc.push(this);if(0===g&&n)for(u=("com.greensock."+s).split("."),c=u.pop(),m=h(u.join("."))[c]=this.gsClass=n.apply(n,o),a&&(i[c]=m,"function"==typeof define&&define.amd?define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+s.split(".").pop(),[],function(){return m}):s===e&&"undefined"!=typeof module&&module.exports&&(module.exports=m)),d=0;this.sc.length>d;d++)this.sc[d].check()},this.check(!0)},d=t._gsDefine=function(t,e,i,s){return new f(t,e,i,s)},g=_._class=function(t,e,i){return e=e||function(){},d(t,[],function(){return e},i),e};d.globals=i;var v=[0,0,1,1],y=[],T=g("easing.Ease",function(t,e,i,s){this._func=t,this._type=i||0,this._power=s||0,this._params=e?v.concat(e):v},!0),w=T.map={},b=T.register=function(t,e,i,s){for(var r,n,a,o,h=e.split(","),l=h.length,u=(i||"easeIn,easeOut,easeInOut").split(",");--l>-1;)for(n=h[l],r=s?g("easing."+n,null,!0):_.easing[n]||{},a=u.length;--a>-1;)o=u[a],w[n+"."+o]=w[o+n]=r[o]=t.getRatio?t:t[o]||new t};for(n=T.prototype,n._calcEnd=!1,n.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,s=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?s*=s:2===i?s*=s*s:3===i?s*=s*s*s:4===i&&(s*=s*s*s*s),1===e?1-s:2===e?s:.5>t?s/2:1-s/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],r=s.length;--r>-1;)n=s[r]+",Power"+r,b(new T(null,null,1,r),n,"easeOut",!0),b(new T(null,null,2,r),n,"easeIn"+(0===r?",easeNone":"")),b(new T(null,null,3,r),n,"easeInOut");w.linear=_.easing.Linear.easeIn,w.swing=_.easing.Quad.easeInOut;var P=g("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});n=P.prototype,n.addEventListener=function(t,e,i,s,r){r=r||0;var n,h,_=this._listeners[t],l=0;for(null==_&&(this._listeners[t]=_=[]),h=_.length;--h>-1;)n=_[h],n.c===e&&n.s===i?_.splice(h,1):0===l&&r>n.pr&&(l=h+1);_.splice(l,0,{c:e,s:i,up:s,pr:r}),this!==a||o||a.wake()},n.removeEventListener=function(t,e){var i,s=this._listeners[t];if(s)for(i=s.length;--i>-1;)if(s[i].c===e)return void s.splice(i,1)},n.dispatchEvent=function(t){var e,i,s,r=this._listeners[t];if(r)for(e=r.length,i=this._eventTarget;--e>-1;)s=r[e],s.up?s.c.call(s.s||i,{type:t,target:i}):s.c.call(s.s||i)};var S=t.requestAnimationFrame,R=t.cancelAnimationFrame,C=Date.now||function(){return(new Date).getTime()},k=C();for(s=["ms","moz","webkit","o"],r=s.length;--r>-1&&!S;)S=t[s[r]+"RequestAnimationFrame"],R=t[s[r]+"CancelAnimationFrame"]||t[s[r]+"CancelRequestAnimationFrame"];g("Ticker",function(t,e){var i,s,r,n,h,_=this,u=C(),m=e!==!1&&S,p=500,f=33,d=function(t){var e,a,o=C()-k;o>p&&(u+=o-f),k+=o,_.time=(k-u)/1e3,e=_.time-h,(!i||e>0||t===!0)&&(_.frame++,h+=e+(e>=n?.004:n-e),a=!0),t!==!0&&(r=s(d)),a&&_.dispatchEvent("tick")};P.call(_),_.time=_.frame=0,_.tick=function(){d(!0)},_.lagSmoothing=function(t,e){p=t||1/l,f=Math.min(e,p,0)},_.sleep=function(){null!=r&&(m&&R?R(r):tweenClearTimeout(r),s=c,r=null,_===a&&(o=!1))},_.wake=function(){null!==r?_.sleep():_.frame>10&&(k=C()-p+5),s=0===i?c:m&&S?S:function(t){return tweenSetTimeOut(t,0|1e3*(h-_.time)+1)},_===a&&(o=!0),d(2)},_.fps=function(t){return arguments.length?(i=t,n=1/(i||60),h=this.time+n,void _.wake()):i},_.useRAF=function(t){return arguments.length?(_.sleep(),m=t,void _.fps(i)):m},_.fps(t),tweenSetTimeOut(function(){m&&(!r||5>_.frame)&&_.useRAF(!1)},1500)}),n=_.Ticker.prototype=new _.events.EventDispatcher,n.constructor=_.Ticker;var A=g("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,G){o||a.wake();var i=this.vars.useFrames?j:G;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});a=A.ticker=new _.Ticker,n=A.prototype,n._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1;var D=function(){o&&C()-k>2e3&&a.wake(),tweenSetTimeOut(D,2e3)};D(),n.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},n.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},n.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},n.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},n.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},n.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},n.render=function(){},n.invalidate=function(){return this},n.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&i+this.totalDuration()/this._timeScale>t},n._enabled=function(t,e){return o||a.wake(),this._gc=!t,this._active=this.isActive(),e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(){return this._enabled(!1,!1)},n.kill=function(t,e){return this._kill(t,e),this},n._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},n._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},n.eventCallback=function(t,e,i,s){if("on"===(t||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[t];null==e?delete r[t]:(r[t]=e,r[t+"Params"]=m(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[t+"Scope"]=s),"onUpdate"===t&&(this._onUpdate=e)}return this},n.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},n.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},n.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},n.totalTime=function(t,e,i){if(o||a.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var s=this._totalDuration,r=this._timeline;if(t>s&&!i&&(t=s),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?s-t:t)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,e,!1),E.length&&Q())}return this},n.progress=n.totalProgress=function(t,e){return arguments.length?this.totalTime(this.duration()*t,e):this._time/this.duration()},n.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},n.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||l,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},n.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(t){if(!arguments.length)return this._paused;if(t!=this._paused&&this._timeline){o||t||a.wake();var e=this._timeline,i=e.rawTime(),s=i-this._pauseTime;!t&&e.smoothChildTiming&&(this._startTime+=s,this._uncache(!1)),this._pauseTime=t?i:null,this._paused=t,this._active=this.isActive(),!t&&0!==s&&this._initted&&this.duration()&&this.render(e.smoothChildTiming?this._totalTime:(i-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!t&&this._enabled(!0,!1),this};var x=g("core.SimpleTimeline",function(t){A.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});n=x.prototype=new A,n.constructor=x,n.kill()._gc=!1,n._first=n._last=null,n._sortChildren=!1,n.add=n.insert=function(t,e){var i,s;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),i=this._last,this._sortChildren)for(s=t._startTime;i&&i._startTime>s;)i=i._prev;return i?(t._next=i._next,i._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=i,this._timeline&&this._uncache(!0),this},n._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,this._timeline&&this._uncache(!0)),this},n.render=function(t,e,i){var s,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;r;)s=r._next,(r._active||t>=r._startTime&&!r._paused)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(t-r._startTime)*r._timeScale,e,i):r.render((t-r._startTime)*r._timeScale,e,i)),r=s},n.rawTime=function(){return o||a.wake(),this._totalTime};var O=g("TweenLite",function(e,i,s){if(A.call(this,i,s),this.render=O.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:O.selector(e)||e;var r,n,a,o=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),h=this.vars.overwrite;if(this._overwrite=h=null==h?q[O.defaultOverwrite]:"number"==typeof h?h>>0:q[h],(o||e instanceof Array||e.push&&m(e))&&"number"!=typeof e[0])for(this._targets=a=u(e),this._propLookup=[],this._siblings=[],r=0;a.length>r;r++)n=a[r],n?"string"!=typeof n?n.length&&n!==t&&n[0]&&(n[0]===t||n[0].nodeType&&n[0].style&&!n.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(u(n))):(this._siblings[r]=$(n,this,!1),1===h&&this._siblings[r].length>1&&K(n,this,null,1,this._siblings[r])):(n=a[r--]=O.selector(n),"string"==typeof n&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=$(e,this,!1),1===h&&this._siblings.length>1&&K(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-l,this.render(-this._delay))},!0),I=function(e){return e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},z=function(t,e){var i,s={};for(i in t)B[i]||i in e&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!U[i]||U[i]&&U[i]._autoCSS)||(s[i]=t[i],delete t[i]);t.css=s};n=O.prototype=new A,n.constructor=O,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,O.version="1.13.1",O.defaultEase=n._ease=new T(null,null,1,1),O.defaultOverwrite="auto",O.ticker=a,O.autoSleep=!0,O.lagSmoothing=function(t,e){a.lagSmoothing(t,e)},O.selector=t.$||t.jQuery||function(e){var i=t.$||t.jQuery;return i?(O.selector=i,i(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var E=[],M={},L=O._internals={isArray:m,isSelector:I,lazyTweens:E},U=O._plugins={},N=L.tweenLookup={},F=0,B=L.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1},q={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},j=A._rootFramesTimeline=new x,G=A._rootTimeline=new x,Q=L.lazyRender=function(){var t=E.length;for(M={};--t>-1;)s=E[t],s&&s._lazy!==!1&&(s.render(s._lazy,!1,!0),s._lazy=!1);E.length=0};G._startTime=a.time,j._startTime=a.frame,G._active=j._active=!0,tweenSetTimeOut(Q,1),A._updateRoot=O.render=function(){var t,e,i;if(E.length&&Q(),G.render((a.time-G._startTime)*G._timeScale,!1,!1),j.render((a.frame-j._startTime)*j._timeScale,!1,!1),E.length&&Q(),!(a.frame%120)){for(i in N){for(e=N[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete N[i]}if(i=G._first,(!i||i._paused)&&O.autoSleep&&!j._first&&1===a._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||a.sleep()}}},a.addEventListener("tick",A._updateRoot);var $=function(t,e,i){var s,r,n=t._gsTweenID;if(N[n||(t._gsTweenID=n="t"+F++)]||(N[n]={target:t,tweens:[]}),e&&(s=N[n].tweens,s[r=s.length]=e,i))for(;--r>-1;)s[r]===e&&s.splice(r,1);return N[n].tweens},K=function(t,e,i,s,r){var n,a,o,h;if(1===s||s>=4){for(h=r.length,n=0;h>n;n++)if((o=r[n])!==e)o._gc||o._enabled(!1,!1)&&(a=!0);else if(5===s)break;return a}var _,u=e._startTime+l,c=[],m=0,p=0===e._duration;for(n=r.length;--n>-1;)(o=r[n])===e||o._gc||o._paused||(o._timeline!==e._timeline?(_=_||H(e,0,p),0===H(o,_,p)&&(c[m++]=o)):u>=o._startTime&&o._startTime+o.totalDuration()/o._timeScale>u&&((p||!o._initted)&&2e-10>=u-o._startTime||(c[m++]=o)));for(n=m;--n>-1;)o=c[n],2===s&&o._kill(i,t)&&(a=!0),(2!==s||!o._firstPT&&o._initted)&&o._enabled(!1,!1)&&(a=!0);return a},H=function(t,e,i){for(var s=t._timeline,r=s._timeScale,n=t._startTime;s._timeline;){if(n+=s._startTime,r*=s._timeScale,s._paused)return-100;s=s._timeline}return n/=r,n>e?n-e:i&&n===e||!t._initted&&2*l>n-e?l:(n+=t.totalDuration()/t._timeScale/r)>e+l?0:n-e-l};n._init=function(){var t,e,i,s,r,n=this.vars,a=this._overwrittenProps,o=this._duration,h=!!n.immediateRender,_=n.ease;if(n.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),r={};for(s in n.startAt)r[s]=n.startAt[s];if(r.overwrite=!1,r.immediateRender=!0,r.lazy=h&&n.lazy!==!1,r.startAt=r.delay=null,this._startAt=O.to(this.target,0,r),h)if(this._time>0)this._startAt=null;else if(0!==o)return}else if(n.runBackwards&&0!==o)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{i={};for(s in n)B[s]&&"autoCSS"!==s||(i[s]=n[s]);if(i.overwrite=0,i.data="isFromStart",i.lazy=h&&n.lazy!==!1,i.immediateRender=h,this._startAt=O.to(this.target,0,i),h){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1)}if(this._ease=_=_?_ instanceof T?_:"function"==typeof _?new T(_,n.easeParams):w[_]||O.defaultEase:O.defaultEase,n.easeParams instanceof Array&&_.config&&(this._ease=_.config.apply(_,n.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],a?a[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,a);if(e&&O._onPluginEvent("_onInitAllProps",this),a&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),n.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=n.onUpdate,this._initted=!0},n._initProps=function(e,i,s,r){var n,a,o,h,_,l;if(null==e)return!1;M[e._gsTweenID]&&Q(),this.vars.css||e.style&&e!==t&&e.nodeType&&U.css&&this.vars.autoCSS!==!1&&z(this.vars,e);for(n in this.vars){if(l=this.vars[n],B[n])l&&(l instanceof Array||l.push&&m(l))&&-1!==l.join("").indexOf("{self}")&&(this.vars[n]=l=this._swapSelfInParams(l,this));else if(U[n]&&(h=new U[n])._onInitTween(e,this.vars[n],this)){for(this._firstPT=_={_next:this._firstPT,t:h,p:"setRatio",s:0,c:1,f:!0,n:n,pg:!0,pr:h._priority},a=h._overwriteProps.length;--a>-1;)i[h._overwriteProps[a]]=this._firstPT;(h._priority||h._onInitAllProps)&&(o=!0),(h._onDisable||h._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=i[n]=_={_next:this._firstPT,t:e,p:n,f:"function"==typeof e[n],n:n,pg:!1,pr:0},_.s=_.f?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),_.c="string"==typeof l&&"="===l.charAt(1)?parseInt(l.charAt(0)+"1",10)*Number(l.substr(2)):Number(l)-_.s||0;_&&_._next&&(_._next._prev=_)}return r&&this._kill(r,e)?this._initProps(e,i,s,r):this._overwrite>1&&this._firstPT&&s.length>1&&K(e,this,i,this._overwrite,s)?(this._kill(i,e),this._initProps(e,i,s,r)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(M[e._gsTweenID]=!0),o)},n.render=function(t,e,i){var s,r,n,a,o=this._time,h=this._duration,_=this._rawPrevTime;if(t>=h)this._totalTime=this._time=h,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(s=!0,r="onComplete"),0===h&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>_||_===l)&&_!==t&&(i=!0,_>l&&(r="onReverseComplete")),this._rawPrevTime=a=!e||t||_===t?t:l);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==o||0===h&&_>0&&_!==l)&&(r="onReverseComplete",s=this._reversed),0>t?(this._active=!1,0===h&&(this._initted||!this.vars.lazy||i)&&(_>=0&&(i=!0),this._rawPrevTime=a=!e||t||_===t?t:l)):this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var u=t/h,c=this._easeType,m=this._easePower;(1===c||3===c&&u>=.5)&&(u=1-u),3===c&&(u*=2),1===m?u*=u:2===m?u*=u*u:3===m?u*=u*u*u:4===m&&(u*=u*u*u*u),this.ratio=1===c?1-u:2===c?u:.5>t/h?u/2:1-u/2}else this.ratio=this._ease.getRatio(t/h);if(this._time!==o||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=o,this._rawPrevTime=_,E.push(this),void(this._lazy=t);this._time&&!s?this.ratio=this._ease.getRatio(this._time/h):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==o&&t>=0&&(this._active=!0),0===o&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._time||0===h)&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||y))),n=this._firstPT;n;)n.f?n.t[n.p](n.c*this.ratio+n.s):n.t[n.p]=n.c*this.ratio+n.s,n=n._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,e,i),e||(this._time!==o||s)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||y)),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this.vars[r].apply(this.vars[r+"Scope"]||this,this.vars[r+"Params"]||y),0===h&&this._rawPrevTime===l&&a!==l&&(this._rawPrevTime=0))}},n._kill=function(t,e){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:O.selector(e)||e;var i,s,r,n,a,o,h,_;if((m(e)||I(e))&&"number"!=typeof e[0])for(i=e.length;--i>-1;)this._kill(t,e[i])&&(o=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(e===this._targets[i]){a=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],s=this._overwrittenProps[i]=t?this._overwrittenProps[i]||{}:"all";break}}else{if(e!==this.target)return!1;a=this._propLookup,s=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(a){h=t||a,_=t!==s&&"all"!==s&&t!==a&&("object"!=typeof t||!t._tempKill);for(r in h)(n=a[r])&&(n.pg&&n.t._kill(h)&&(o=!0),n.pg&&0!==n.t._overwriteProps.length||(n._prev?n._prev._next=n._next:n===this._firstPT&&(this._firstPT=n._next),n._next&&(n._next._prev=n._prev),n._next=n._prev=null),delete a[r]),_&&(s[r]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return o},n.invalidate=function(){return this._notifyPluginsOfEnabled&&O._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=this._lazy=!1,this._propLookup=this._targets?{}:[],this},n._enabled=function(t,e){if(o||a.wake(),t&&this._gc){var i,s=this._targets;if(s)for(i=s.length;--i>-1;)this._siblings[i]=$(s[i],this,!0);else this._siblings=$(this.target,this,!0)}return A.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?O._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},O.to=function(t,e,i){return new O(t,e,i)},O.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new O(t,e,i)},O.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new O(t,e,s)},O.delayedCall=function(t,e,i,s,r){return new O(e,0,{delay:t,onComplete:e,onCompleteParams:i,onCompleteScope:s,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:s,immediateRender:!1,useFrames:r,overwrite:0})},O.set=function(t,e){return new O(t,0,e)},O.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:O.selector(t)||t;var i,s,r,n;if((m(t)||I(t))&&"number"!=typeof t[0]){for(i=t.length,s=[];--i>-1;)s=s.concat(O.getTweensOf(t[i],e));for(i=s.length;--i>-1;)for(n=s[i],r=i;--r>-1;)n===s[r]&&s.splice(i,1)}else for(s=$(t).concat(),i=s.length;--i>-1;)(s[i]._gc||e&&!s[i].isActive())&&s.splice(i,1);return s},O.killTweensOf=O.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var s=O.getTweensOf(t,e),r=s.length;--r>-1;)s[r]._kill(i,t)};var J=g("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=J.prototype},!0);if(n=J.prototype,J.version="1.10.1",J.API=2,n._firstPT=null,n._addTween=function(t,e,i,s,r,n){var a,o;return null!=s&&(a="number"==typeof s||"="!==s.charAt(1)?Number(s)-i:parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)))?(this._firstPT=o={_next:this._firstPT,t:t,p:e,s:i,c:a,f:"function"==typeof t[e],n:r||e,r:n},o._next&&(o._next._prev=o),o):void 0},n.setRatio=function(t){for(var e,i=this._firstPT,s=1e-6;i;)e=i.c*t+i.s,i.r?e=Math.round(e):s>e&&e>-s&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},n._kill=function(t){var e,i=this._overwriteProps,s=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);
for(;s;)null!=t[s.n]&&(s._next&&(s._next._prev=s._prev),s._prev?(s._prev._next=s._next,s._prev=null):this._firstPT===s&&(this._firstPT=s._next)),s=s._next;return!1},n._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},O._onPluginEvent=function(t,e){var i,s,r,n,a,o=e._firstPT;if("_onInitAllProps"===t){for(;o;){for(a=o._next,s=r;s&&s.pr>o.pr;)s=s._next;(o._prev=s?s._prev:n)?o._prev._next=o:r=o,(o._next=s)?s._prev=o:n=o,o=a}o=e._firstPT=r}for(;o;)o.pg&&"function"==typeof o.t[t]&&o.t[t]()&&(i=!0),o=o._next;return i},J.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===J.API&&(U[(new t[e])._propName]=t[e]);return!0},d.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,s=t.priority||0,r=t.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=g("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){J.call(this,i,s),this._overwriteProps=r||[]},t.global===!0),o=a.prototype=new J(i);o.constructor=a,a.API=t.API;for(e in n)"function"==typeof t[e]&&(o[n[e]]=t[e]);return a.version=t.version,J.activate([a]),a},s=t._gsQueue){for(r=0;s.length>r;r++)s[r]();for(n in p)p[n].func||t.console.log("GSAP encountered missing dependency: com.greensock."+n)}o=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax");var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),FishUtils;!function(e){var t=function(){function e(){}return e}();__reflect(t.prototype,"langFishuagePack");var i=function(){function e(){this.loading="loading",this.config_url="config_url",this.config_url_1="config_url_1",this.first_alert_title="first_alert_title",this.first_alert_buttons="first_alert_buttons",this.service_provision_url="service_provision_url",this.service_provision="service_provision",this.health_game_advise="health_game_advise",this.loginError="loginError",this.login_waiting="login_waiting",this.disconnect_kick_out="disconnect_kick_out",this.disconnect_server="disconnect_server",this.auto_reconnect="auto_reconnect",this.waiting_for_getting_information="waiting_for_getting_information",this.backAlert="backAlert",this.roomLimit1="roomLimit1",this.roomLimit2="roomLimit2",this.roomAmount="roomAmount",this.quick_join_error="quick_join_error",this.upload_avatar="upload_avatar",this.no_more_desk="no_more_desk",this.noMoreGold="noMoreGold",this.noMoreGold2="noMoreGold2",this.noMoreGold3="noMoreGold3",this.browNoGold="browNoGold",this.reportSucc="reportSucc",this.repeatReport="repeatReport",this.gameResult="gameResult",this.sex="sex",this.sexVoice="sexVoice",this.people="people",this.second="second",this.gold="gold",this.score="score",this.year="year",this.month="month",this.day="day",this.sky="sky",this.format_y_m_d="format_y_m_d",this.format_m_d="format_m_d",this.currency="currency",this.play_turn="play_turn",this.no_ranking="no_ranking",this.confirm="confirm",this.reconnect="reconnect",this.history="history",this.chatList="chatList",this.free_pay="free_pay",this.match_sign_up_result="match_sign_up_result",this.match_jikai_limit="match_jikai_limit",this.match_jikai_reward="match_jikai_reward",this.match_title_reward_intro="match_title_reward_intro",this.match_title_match_intro="match_title_match_intro",this.match_play_info="match_play_info",this.match_result_match_name="match_result_match_name",this.match_waiting_other_desk_1="match_waiting_other_desk_1",this.match_waiting_other_desk_2="match_waiting_other_desk_2",this.match_get_in="match_get_in",this.match_result_praise="match_result_praise",this.match_cancel_alert="match_cancel_alert",this.match_turn_name="match_turn_name",this.match_top_info_1="match_top_info_1",this.match_top_info_2="match_top_info_2",this.match_top_info_3="match_top_info_3",this.match_top_notify="match_top_notify",this.match_notice_alert="match_notice_alert",this.modify_profile_success="modify_profile_success",this.modify_profile_failed="modify_profile_failed",this.modify_profile_err="modify_profile_err",this.set_password_error="set_password_error",this.bank_operate="bank_operate",this.bank_operate_error="bank_operate_error",this.bind_phone_notice="bind_phone_notice",this.download_client_notice="download_client_notice",this.alms_success="alms_success",this.alms_success_continue="alms_success_continue",this.alms_success_exit="alms_success_exit",this.version_content="version_content",this.version_content_notice="version_content_notice",this.recharge_scale="recharge_scale",this.recharge_addition="recharge_addition",this.recharge_waiting="recharge_waiting",this.recharge_failed="recharge_failed",this.recharge_cancel="recharge_cancel",this.recharge_success_simple="recharge_success_simple",this.recharge_success="recharge_success",this.get_code_error="get_code_error",this.bind_phone_error="bind_phone_error",this.bind_third_part="bind_third_part",this.exchange_redcoin="exchange_redcoin",this.exchange_roomid="exchange_roomid",this.kickback_str="kickback_str",this.dayTaskOne="dayTaskOne",this.dayTaskTwo="dayTaskTwo",this.recordCardHour="recordCardHour",this.recordCardDay="recordCardDay",this.redCoin="redCoin",this.taskNotExist="taskNotExist",this.taskNotOver="taskNotOver",this.taskHasGetRew="taskHasGetRew"}return e}();__reflect(i.prototype,"langFishuageIds");var n=function(){function e(){}return e.injectProp=function(e,t,i,n,o){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=!0),void 0===o&&(o=!0),!t)return!1;var r=!0;for(var s in t){var a=t[s];n&&"function"==typeof a||o&&null==a||(i?i(e,s,a):e[s]=a)}return r},e.obj2query=function(e){if(!e)return"";var t=[];for(var i in e)t.push(i+"="+e[i]);return t.join("&")},e.getUrlParams=function(){var e={},t=window.location.href,i=t.indexOf("?");if(0>i)return e;for(var n=t.substr(i+1).split("&"),o=0;o<n.length;o++){var r=n[o].split("=");e[r[0]]=r[1]}return e},e}();e.Utils=n,__reflect(n.prototype,"FishUtils.Utils");var o=function(t){function n(n){var o=t.call(this)||this;return o.splitCache={},o.id=new i,e.Utils.injectProp(o,n),o}return __extends(n,t),n.prototype.split=function(e,t){var i=this.splitCache[e];return i||(i=this.splitCache[e]=langFish[e].split(",")),i[t]},n.prototype.format=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return e.StringUtils.formatApply(this[t],i)},n}(t);e.langFishuage=o,__reflect(o.prototype,"FishUtils.langFishuage");var r=function(){function e(){}return e.distancePoint=function(e,t){return this.distance(e.x,e.y,t.x,t.y)},e.distance=function(e,t,i,n){return Math.sqrt((e-i)*(e-i)+(t-n)*(t-n))},e.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},e.makeRandomInt=function(e,t){return void 0===t&&(t=0),Math.floor(Math.random()*(e-t))+t},e.makeRandomFloat=function(e,t){return void 0===t&&(t=0),Math.random()*(e-t)+t},e.makeRandomByRange=function(e,t){return e+(Math.random()*t*2-t)},e.makeRandomIntArr=function(e,t,i){void 0===i&&(i=0);for(var n=[],o=0;e>o;o++)n.push(this.makeRandomInt(t));return n},e.makeOrderIntArray=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=1);for(var n=[],o=t;e>=o;o+=i)n.push(o);return n},e.mixArray=function(e){for(var t=0,i=Math.round(e.length/2);i>t;t++){var n=this.makeRandomInt(e.length),o=this.makeRandomInt(e.length),r=e[n];e[n]=e[o],e[o]=r}return e},e.mixArray2=function(e){for(var t,i,n=e[0].length,o=e.length,r=0,s=Math.round(n*o/2);s>r;r++){t=[this.makeRandomInt(n),this.makeRandomInt(o)],i=[this.makeRandomInt(n),this.makeRandomInt(o)];var a=e[t[0]][t[1]];e[t[0]][t[1]]=e[i[0]][i[1]],e[i[0]][i[1]]=a}return e},e.getRandomFromArray=function(e){return e[this.makeRandomInt(e.length)]},e.fixRange=function(e,t,i){return t>e?e=t:e>i&&(e=i),e},e.roundFix=function(e,t,i){return void 0===i&&(i=0),i>e?e+=t-i:e>=t&&(e-=t-i),e},e.radiusToAngle=function(e){return 180*e/Math.PI},e.angleToRadius=function(e){return e*Math.PI/180},e.turnRight=function(e){for(var t=[],i=0,n=e.length;n>i;i++)t.push([]);for(var o=0,r=e.length;r>o;o++)for(var s=0,a=e[o].length;a>s;s++)t[o][s]=e[a-s-1][o];return t},e.turnLeft=function(e){for(var t=[],i=0,n=e.length;n>i;i++)t.push([]);for(var o=0,r=e.length;r>o;o++)for(var s=0,a=e[o].length;a>s;s++)t[o][s]=e[s][a-o-1];return t},e.calDir=function(e,t,i,n){if(e==i&&t==n)return-1;var o,r=Math.atan2(n-t,i-e);return o=Math.abs(r)<Math.PI/4?0:Math.abs(r)>Math.PI/4*3?2:r>0?1:3},e.sign=function(e){return 0==e?0:e>0?1:-1},e.split=function(e,t){for(var i=[],n=0;t>n;n++)i[n]=0;for(var n=0;e>n;n++)i[this.makeRandomInt(t)]++;return i},e.bezierPoints=function(e,t){function i(e,t,i){return{x:(t.x-e.x)*i+e.x,y:(t.y-e.y)*i+e.y}}for(var n,o=[],r=0,s=1/(t-1),a=0;t>a;a++){for(var h=e.concat(),c=h.length-1;c>0;c--){n=[];for(var l=0,u=h.length;u-1>l;l++)n.push(i(h[l],h[l+1],r));h=n}o.push(h[0]),r+=s}return o},e}();e.MathUtils=r,__reflect(r.prototype,"FishUtils.MathUtils");var s=function(){function e(){}return e.makeRandomString=function(e){for(var t="",i=this.chars.length,n=0;e>n;n++)t+=this.chars.charAt(r.makeRandomInt(i));return t},e.makeRandomIntString=function(e){for(var t="",i=0;e>i;i++)t+=r.makeRandomInt(10);return t},e.stringCut=function(e,t,i){void 0===i&&(i="...");var n=e;return e.length>t&&(n=e.substr(0,t)+i),n},e.supplement=function(e,t){var i=t-e.toString().length-1;return 0>i?e.toString():this.zeros[i]+e},e.format=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.formatApply(e,t)},e.formatApply=function(e,t){for(var i=e,n=0,o=t.length;o>n;n++)i=i.replace("{"+n+"}",t[n]);return i},e.getStrFromObj=function(e,t){void 0===t&&(t="&");var i="";for(var n in e)""!=i&&(i+=t),i+=n+"="+e[n];return i},e.getColor=function(e,t,i){return void 0===i&&(i=0),0==i?"<font color='#"+t.toString(16)+"'>"+e+"</font>":"<font size="+i+" color='#"+t.toString(16)+"'>"+e+"</font>"},e.chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e.zeros=["0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000"],e}();e.StringUtils=s,__reflect(s.prototype,"FishUtils.StringUtils");var a=function(){function e(){}return e.timeFormat=function(e,t,i,n){var o=this;void 0===t&&(t="{1}:{0}"),void 0===i&&(i=!0),void 0===n&&(n=!1);var r=e%60,a=Math.floor(e/60)%60,h=Math.floor(e/3600)%24,c=Math.floor(e/3600/24);if(i&&(r=s.supplement(r,2),a=s.supplement(a,2),h=s.supplement(h,2),c=s.supplement(c,2)),n){var l="";return[c,h,a,r].forEach(function(e,t){e>0&&(l+=e+langFish[o.timelangFish[t]])}),l}return s.format(t,r,a,h,c)},e.timeFormatForEx=function(e){var t=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),o=s.supplement(e.getHours(),2),r=s.supplement(e.getMinutes(),2);return t+"年"+i+"月"+n+"日 "+o+":"+r},e.parseFromString=function(e){return new Date(e.replace("T"," ").replace(/-/g,"/"))},e.parseFromStringScope=function(e){var t=this;return e.map(function(e){return t.parseFromString(e)})},e.dateTimeToString=function(e){return this.dateToString(e,langFish.format_y_m_d)+" "+this.dateToTimeString(e,"{2}:{1}")},e.tsToDate=function(e){var t=new Date;return t.setTime(1e3*e),t},e.parseTime=function(e){var t=e.split(":");return 3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2])},e.tsToDateString=function(e,t){return void 0===t&&(t="{0}/{1}/{2}"),this.dateToString(this.tsToDate(e))},e.dateToString=function(e,t){return void 0===t&&(t="{0}/{1}/{2}"),s.format(t,e.getFullYear(),s.supplement(e.getMonth()+1,2),s.supplement(e.getDate(),2))},e.dateToTimeString=function(e,t){return void 0===t&&(t="{2}:{1}:{0}"),s.format(t,s.supplement(e.getSeconds(),2),s.supplement(e.getMinutes(),2),s.supplement(e.getHours(),2))},e.dateToTs=function(e){return Math.floor(e.valueOf()/1e3)},e.dateCut=function(e){var t=e.getHours(),i=e.getMinutes(),n=e.getSeconds();return this.tsToDate(this.dateToTs(e)-3600*t-60*i-n)},e.tsToMonthDayString=function(e){var t=this.tsToDate(e);return s.format("{0}"+langFish.month+"{1}"+langFish.day,s.supplement(t.getMonth()+1,2),s.supplement(t.getDate(),2))},e.scopeToDateString=function(e,t){return this.dateToString(e[0],t)+"-"+this.dateToString(e[1],t)},e.scopeToTimeString=function(e,t){var i=this.dateToTimeString(e[0],t),n=this.dateToTimeString(e[1],t);return i+"-"+n},e.scopeToDateTimeString=function(e,t,i,n){void 0===n&&(n=!1);var o=e[0],r=e[1];return n&&o.getDate()==r.getDate()?this.dateToString(o,t)+" "+this.dateToTimeString(o,i)+"-"+this.dateToTimeString(r,i):this.dateTimeToString(o)+" - "+this.dateTimeToString(r)},e.remainDays=function(e,t,i){return void 0===i&&(i=!1),0},e.compareScope=function(e,t){var i=this.dateToTs(e[0]),n=this.dateToTs(e[1]);return i>t?t-i:t>=i&&n>=t?0:t-n},e.getWeekIndex=function(e){var t=this.tsToDate(e),i=this.getFirstWeekBegDay(t.getFullYear());i>t&&(i=this.getFirstWeekBegDay(t.getFullYear()-1));var n=Math.floor((t.valueOf()-i.valueOf())/864e5);return Math.floor(n/7)+1},e.getFirstWeekBegDay=function(e){var t=new Date(e,0,1),i=t.getDay();if(1==i)return t;i=0==i?7:i;var n=t.setDate(t.getDate()+(8-i));return new Date(n)},e.timelangFish=["sky","hour","minutes","second"],e}();e.TimeUtils=a,__reflect(a.prototype,"FishUtils.TimeUtils");var h=function(e){function t(){var t=e.call(this)||this;return t._urlParams={},t._dicCall={},egret.ExternalInterface.addCallback("nativeCall",t.nativeCall.bind(t)),t._initDefaultWX(),t._urlParams=n.getUrlParams(),t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.getUrlArg=function(){return this._urlParams},Object.defineProperty(t.prototype,"isNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWXMP",{get:function(){return this._isWXMP},set:function(e){this._isWXMP=e},enumerable:!0,configurable:!0}),t.prototype.wxConfig=function(){var e=this;fishWebService.getWxConfig(function(t){e._wxApi.config(t)})},t.prototype.initWXFunc=function(){this.isNative||(window.top&&window.top.wxApi?this._wxApi=window.top.wxApi:alert("debug"))},t.prototype._initDefaultWX=function(){this._wxApi={initBridge:function(e){},config:function(e){},share:function(e,t){},recharge:function(e,t){},getLocation:function(e){}}},t.prototype.nativeCall=function(e){console.log("nativeCall:"+e);var t=JSON.parse(e),i=t.id,n=t.method;this.dispatchEventWith(n,!1,t);var o=this._dicCall[i];o&&(o(t.args),delete this._dicCall[i])},Object.defineProperty(t.prototype,"platform",{get:function(){var e;return e=this.isNative?egret.Capabilities.os:"web"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"platformId",{get:function(){return t.instance.isNative?"iOS"==egret.Capabilities.os?2:3:4},enumerable:!0,configurable:!0}),t.prototype.userLogin=function(e,t){this.call("putInfo",{uid:e})},t.prototype.call=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null),t=t||{};var n={id:s.makeRandomIntString(10),method:e,args:t};i&&(this._dicCall[n.id]=i),egret.ExternalInterface.call("egretCall",JSON.stringify(n))},t.prototype.recharge=function(e,t){return void 0===t&&(t=null),this.isNative?this.call("recharge",{id:e},t):alert("sorry, can not recharge."),4!=this.platformId},t.prototype.rechargeInWXMP=function(e,t){void 0===t&&(t=null),0==e.code?this._wxApi.recharge(e.data,function(e){console.log("rechargeInWXMP=============>",e.code),t&&t(e.code)}):7005==e.code||alert("支付失败,错误码:"+e.code)},t.prototype.share=function(e,t,i){void 0===i&&(i=null),this.isNative?this.call("share",{type:e,params:t},i):this._wxApi.share(t,i)},t.prototype.setShareParam=function(){var e=FishUserData.instance,t=e.getItem("sk");t||(t="");var i={};i.imgUrl=u.RESOURCE_URL+"shareicon.jpg",i.title1=langFish.thirdPartWxMp.title2,i.link1=u.WX_LOGIN_URL+"?state=3&share_sk="+t,i.title2=langFish.thirdPartWxMp.title2,i.desc2=langFish.thirdPartWxMp.desc2,i.link2=u.WX_LOGIN_URL+"?state=3&share_sk="+t,this.share("",i,function(e){})},t}(egret.EventDispatcher);e.Native=h,__reflect(h.prototype,"FishUtils.Native");var c=function(){function e(){}return e.init=function(){e.instance=new egret.EventDispatcher},e.dispatch=function(t,i){void 0===i&&(i=null),i?e.instance.dispatchEventWith(t,!1,i):e.instance.dispatchEvent(new egret.Event(t))},e.addEventListener=function(t,i,n){e.instance.addEventListener(t,i,n)},e.removeEventListener=function(t,i,n){e.instance.removeEventListener(t,i,n)},e}();e.Dispatcher=c,__reflect(c.prototype,"FishUtils.Dispatcher");var l=function(){function t(){}return t.callNet=function(t,i,n,o,r,s,a,h){void 0===i&&(i=null),void 0===n&&(n=egret.HttpMethod.GET),void 0===o&&(o=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===h&&(h=null);var c=a?a():t,l=new egret.HttpRequest;l.responseType=egret.HttpResponseType.TEXT,l.addEventListener(egret.Event.COMPLETE,function(e){r&&r(l.response)},this),l.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){s&&s(l.response)},this),l.open(c,n);for(var u in o)l.setRequestHeader(u,o[u]);var p=null;h?p=h():(l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p=e.Utils.obj2query(i)),p?l.send(p):l.send()},t.GET=function(t,i,n,o,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=null),this.callNet(t,i,egret.HttpMethod.GET,r,n,o,function(){if(i){var n=e.Utils.obj2query(i);t+=(t.indexOf("?")<0?"?":"")+n}return t},function(){return null})},t.POST=function(e,t,i,n,o){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.callNet(e,t,egret.HttpMethod.POST,o,i,n)},t.POSTDirectory=function(e,t,i,n,o){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.callNet(e,t,egret.HttpMethod.POST,o,i,n,null,function(){return t})},t}();e.Ajax=l,__reflect(l.prototype,"FishUtils.Ajax");var u=function(){function t(){}return t.init=function(){var e=RES.getRes("langFish");return null==e?void console.log("load langFish.json error."):void(langFish=new o(e))},t.init_SERVER_URL_TAIL=function(){if(t.SERVER_URL){var e=t.SERVER_URL,i=e.split("."),n=i[0],o=n.substr(n.length-1);t.SERVER_URL_TAIL=o,console.log("SERVER_URL_TAIL===>",t.SERVER_URL_TAIL)}},t.loadConfigs=function(t){var i=this;e.Ajax.GET(langFish.config_url+"config.php",{id:this.gameId},function(e){var n=JSON.parse(e);i.roomList=n.game.rooms,i.roomList.sort(function(e,t){return e.roomID-t.roomID}),t(n)})},t.getRoomConfig=function(e){var t=this.getRoomConfigById(e);return t||(t=this.getRoomConfigByMatchId(e)),t},t.getRoomConfigById=function(e){var t;return this.roomList.forEach(function(i){return i.roomID==e?(t=i,!0):void 0}),t},t.getRoomConfigByMatchId=function(e){for(var t=0;t<this.roomList.length;++t)if(this.roomList[t].matchId==e)return this.roomList[t]},t.getUrl=function(e){console.log(langFish.config_url),l.GET(langFish.config_url+"geturl.php",{},function(i){var n=JSON.parse(i);t.WEB_SERVICE_URL=n.WEB_SERVICE_URL,t.WX_LOGIN_URL=n.WX_LOGIN_URL,t.RESOURCE_URL=n.RESOURCE_URL,t.RECHARGE_URL=n.RECHARGE_URL,t.REGISTER_URL=n.REGISTER_URL,t.PASSWORD_URL=n.PASSWORD_URL,t.HOME_PAGE_URL=n.HOME_PAGE_URL,t.DOWNLOAD_PAGE_URL=n.DOWNLOAD_PAGE_URL,t.LOBBY_PAGE_URL=n.LOBBY_PAGE_URL,t.urlData=n,t.SERVER_URL=FISH_SERVER_TEST,t.init_SERVER_URL_TAIL(),e()},function(){console.log("geturl.php error.")})},t.gameId=1,t.SERVER_URL="ws://192.168.0.91:9001/ws",t.WX_LOGIN_URL="http://www.htgames.cn/zhanghaichuan",t.WEB_SERVICE_URL="http://kungu.ngrok.club/",t.REPORT_URL="http://120.27.162.46:8866/_.gif",t.RESOURCE_URL="http://192.168.0.81/laoqifeng/platform/",t.RECHARGE_URL="http://pay.exunsoul.com:8998/index/pay?account=",t.REGISTER_URL="http://reg.gamebode.com/regist.html",t.PASSWORD_URL="http://reg.gamebode.com/motify.html",t.HOME_PAGE_URL="http://reg.gamebode.com/index.html",t.DOWNLOAD_PAGE_URL="http://reg.gamebode.com/index.html",t.LOBBY_PAGE_URL="http://reg.gamebode.com/game_list_1.html",t.EXCHANGE_URL="http://192.168.0.86:8998/coin/index",t}();e.GameConfig=u,__reflect(u.prototype,"FishUtils.GameConfig");var p=function(){function e(){}return e.channel_id=1,e}();e.Environment=p,__reflect(p.prototype,"FishUtils.Environment");var d=function(){function t(){this.uuid=s.makeRandomString(32)}return t.prototype.login=function(e,t,i){this.callApi("index","login",function(e){i(e.data)},{username:e,password:t})},t.prototype.fastLogin=function(e){this.callApi("index","guest",function(t){e(t.data)},{device:this.uuid})},t.prototype.callApi=function(e,t,i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o="post"),n||(n={}),n.pf=h.instance.platformId;var r=u.WEB_SERVICE_URL+e+"/"+t,s="post"==o?l.POST:l.GET;s.call(l,r,n,function(e){if(i){var t=JSON.parse(e);t.code>0,i(t)}})},t.prototype.getCode=function(e,t){this.callApi("user","getYunCode",function(e){t(e.code)},{phone:e,action:1},"get")},t.prototype.bindPhone=function(e,t,i){this.callApi("user","bindMobile",function(e){i(e)},{uid:fishServer.selfData.uid,phone:e,code:t},"post")},t.prototype.loginByWxFromWeb=function(e,t){this.callApi("index","login",function(e){t(e)},{type:1,"package":"cn.htgames.buyu.web",code:e},"post")},t.prototype.loginByWxFromWechat=function(e,t,i){this.callApi("index","login",function(e){i(e)},{type:1,"package":"cn.htgames.buyu.wechat",code:e,sk:t},"post")},t.prototype.bindByWx=function(e,t){this.callApi("user","bindByUid",function(e){t(e)},{type:1,"package":"cn.htgames.buyu.web",wxcode:e,uid:fishServer.selfData.uid},"post")},t.prototype.rechagre=function(t,i){void 0===i&&(i=null),e.Native.instance.isWXMP&&this.callApi("shop","wechatpayOrder",function(e){h.instance.rechargeInWXMP(e,i)},{product_id:t,os:1,uid:fishServer.selfData.uid,type:u.SERVER_URL_TAIL},"post")},t.prototype.buyCardsRecorder=function(t){e.Native.instance.isWXMP&&this.callApi("shop","wechatpayOrder",function(e){h.instance.rechargeInWXMP(e)},{product_id:t,os:1,uid:fishServer.selfData.uid,type:u.SERVER_URL_TAIL},"post")},t.prototype.getWxConfig=function(e){this.callApi("wechat","jsConfig",function(t){0==t.code?e(t.data):alert(""+t.code)},{url:encodeURIComponent(window.top.location.href)},"post")},t}();e.WebService=d,__reflect(d.prototype,"FishUtils.WebService");var _=function(){function e(){}return e.init=function(e){this.ID=e},e.getName=function(e,t){return void 0===t&&(t=null),(t||!this.ID||""==this.ID?t:this.ID)+"_"+e},e.getItem=function(e,t){return void 0===t&&(t=null),egret.localStorage.getItem(this.getName(e,t))},e.setItem=function(e,t,i){return void 0===i&&(i=null),egret.localStorage.setItem(this.getName(e,i),t)},e.getItemObj=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var n;try{n=JSON.parse(this.getItem(e,i))}catch(o){}return n||(n=t),n},e.setItemObj=function(e,t,i){return void 0===i&&(i=null),this.setItem(e,JSON.stringify(t),i)},e.ID="",e}();e.localStorage=_,__reflect(_.prototype,"FishUtils.localStorage");var f=function(){function e(){this.name="save"}return e.prototype.loadData=function(){this.save=_.getItemObj(this.name,{},this.prefix)},e.prototype.clearData=function(e){if(void 0===e&&(e=null),e)for(var t in this.save)e.indexOf(t)<0&&delete this.save[t];else this.save={};this.saveData()},e.prototype.saveData=function(){_.setItemObj(this.name,this.save,this.prefix)},e.prototype.getItem=function(e,t){void 0===t&&(t=null);var i=this.save[e];return null===i&&(i=t),i},e.prototype.setItem=function(e,t,i){void 0===i&&(i=!1);var n=this.save[e];return this.save[e]=t,i&&this.saveData(),n},e.prototype.changeItem=function(e,t,i){void 0===i&&(i=!1);var n=this.save[e];return this.save[e]=n+t,i&&this.saveData(),n},e}();e.DataStorage=f,__reflect(f.prototype,"FishUtils.DataStorage");var g=function(){function e(){this._groups={}}return Object.defineProperty(e,"instance",{get:function(){return void 0==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t,i,o,r,s){void 0===s&&(s=0);var a=new v;n.injectProp(a,{target:t,eventName:i,callback:o,thisObj:r,priority:s},null,!1);var h=this._groups[e];h||(h=this._groups[e]={enable:!1,items:[]}),h.items.push(a)},e.prototype.registerOnObject=function(e,t,i,n,o,r){void 0===r&&(r=0),this.register(e.__class__,t,i,n,o,r)},e.prototype.enable=function(e){var t=this._groups[e];t&&!t.enable&&(t.enable=!0,t.items.forEach(function(e){e.target.addEventListener(e.eventName,e.callback,e.thisObj,!1,e.priority)}))},e.prototype.enableOnObject=function(e){this.enable(e.__class__)},e.prototype.disable=function(e){var t=this._groups[e];t&&t.enable&&(t.enable=!1,t.items.forEach(function(e){e.target.removeEventListener(e.eventName,e.callback,e.thisObj)}))},e.prototype.disableOnObject=function(e){this.disable(e.__class__)},e.prototype.dump=function(e){void 0===e&&(e=null);for(var t in this._groups){var i=this._groups[t];console.log(t+"["+i.items.length+"]: "+(i.enable?"● enable":"○ disable")),console.log(i.items.map(function(e){return e.eventName}).join(","))}},e}();e.EventManager=g,__reflect(g.prototype,"FishUtils.EventManager");var v=function(){function e(){}return e}();e.RegisterItem=v,__reflect(v.prototype,"FishUtils.RegisterItem");var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y=function(){function e(){}return e.encode=function(e){if(!e)return"";var t,i,n,o,r,s,a,h="",c=0;for(e=this._utf8_encode(e);c<e.length;)t=e.charCodeAt(c++),i=e.charCodeAt(c++),n=e.charCodeAt(c++),o=t>>2,r=(3&t)<<4|i>>4,s=(15&i)<<2|n>>6,a=63&n,isNaN(i)?s=a=64:isNaN(n)&&(a=64),h=h+m.charAt(o)+m.charAt(r)+m.charAt(s)+m.charAt(a);return h},e.decode=function(e){if(!e)return"";var t,i,n,o,r,s,a,h="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)o=m.indexOf(e.charAt(c++)),r=m.indexOf(e.charAt(c++)),s=m.indexOf(e.charAt(c++)),a=m.indexOf(e.charAt(c++)),t=o<<2|r>>4,i=(15&r)<<4|s>>2,n=(3&s)<<6|a,h+=String.fromCharCode(t),64!=s&&(h+=String.fromCharCode(i)),64!=a&&(h+=String.fromCharCode(n));return h=this._utf8_decode(h)},e._utf8_encode=function(e){return window.unescape(encodeURIComponent(e))},e._utf8_decode=function(e){return decodeURIComponent(window.escape(e))},e}();e.Base64=y,__reflect(y.prototype,"FishUtils.Base64")}(FishUtils||(FishUtils={})),FishUtils.Dispatcher.init();var langFish,fishWebService=new FishUtils.WebService,ProtoBuf=dcodeIO.ProtoBuf,ByteArray=egret.ByteArray,Endian=egret.Endian,FishUserData=function(e){function t(){var t=e.call(this)||this;return t.name="user",t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(e){this.prefix=e},t}(FishUtils.DataStorage);__reflect(FishUserData.prototype,"FishUserData");var FishSocket=function(e){function t(){var t=e.call(this)||this;return t._sid=0,t.frozen=!1,t._clientId=1,t._session=0,t.showLogs=!1,t._ddzDispatcher=null,t.logList=[/.*?/],t._callId=1e3,t._callbackMap=[],t.cacheList=[],t._heartCount=0,t._lastHeart=0,t._showLogToScreen=!1,t}return __extends(t,e),t.prototype.ready=function(){this._protoBuilderMap={user:ProtoBuf.loadProto(RES.getRes("fish_user_proto")),game:ProtoBuf.loadProto(RES.getRes("fish_game_proto"))},this._protoIDs=FishProtoIDs.getMap(),FISH_MODE_INDEPENDENT&&(this._heartTimer=new egret.Timer(2e3),this._heartTimer.addEventListener(egret.TimerEvent.TIMER,this.onHeartTimer,this),this._serverTimer=new egret.Timer(1e3),this._serverTimer.addEventListener(egret.TimerEvent.TIMER,this.onServerTimer,this),FishUtils.Native.instance.addEventListener("HEART_BEAT",this.onHeartBeat,this))},t.prototype.prepareSocket=function(){var e=this._socket;return e=this._socket=new egret.WebSocket,e.type=egret.WebSocket.TYPE_BINARY,e.id=++this._sid,e},t.prototype.onHeartBeat=function(e){console.log("on HEART_BEAT"),this.sendHeartPackage()},Object.defineProperty(t.prototype,"connected",{get:function(){return this._socket&&this._socket.connected},enumerable:!0,configurable:!0}),t.prototype.tryConnect=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null),egret.setTimeout(this.connect,this,200)},t.prototype.connect=function(){FISH_MODE_INDEPENDENT&&(this.prepareSocket(),this._socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),FISH_MODE_WXMP?this._socket.connectByUrl(FishUtils.GameConfig.SERVER_URL):this._socket.connectByUrl(FISH_SERVER_TEST))},t.prototype.close=function(e){void 0===e&&(e=!0),FISH_MODE_INDEPENDENT&&this.connected&&(this.showLogs&&console.log("socket["+this._socket.id+"] closing Server"),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this._socket.readBytes(new ByteArray),this._socket.close(),this._heartTimeout&&(egret.clearTimeout(this._heartTimeout),this._heartTimeout=null),e&&this.afterClose())},t.prototype.onConnect=function(e){var t=e.target;console.log("connected",t.id,this._sid),this._connected=!0,t.removeEventListener(egret.Event.CONNECT,this.onConnect,this),FISH_MODE_INDEPENDENT&&(t.addEventListener(egret.Event.CLOSE,this.onClose,this),t.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),t.id==this._sid&&(this._kickOut=!1,this.dispatchEventWith(FishEvent.CONNECT_SERVER)))},t.prototype.onError=function(e){var t=e.target;this.showLogs&&console.log("socket["+t.id+"] Server error"),t.id==this._sid&&this.dispatchEventWith(FishEvent.SERVER_ERROR)},t.prototype.onClose=function(e){var t=e.target;console.log("Disconnect"),t.removeEventListener(egret.Event.CLOSE,this.onClose,this),t.id==this._sid&&(this.dispatchEventWith(FishEvent.SERVER_CLOSE),this.afterClose())},t.prototype.afterClose=function(){this._connected&&(this._connected=!1,this._heartTimer.stop(),this._serverTimer.stop())},t.prototype.send=function(e,t,i){void 0===i&&(i=null);var n=e.substring(0,e.indexOf(".")),o=this._protoBuilderMap[n].build(e),r=new o(t),s=new egret.ByteArray(r.encodeAB());if(this.showLogs&&this.inShowList(e),this._showLogToScreen,!FISH_MODE_INDEPENDENT)return void this.ddzDispatchEvent(0,this._protoIDs[e],s);var a=new egret.ByteArray;a.writeUnsignedShort(s.length+2),a.writeUnsignedShort(this._protoIDs[e]),a.writeBytes(s),this._socket.writeBytes(a),this._socket.flush()},t.prototype.addCallback=function(e){var t=this._callId++;if(e){var i=this.tsServer;this._callbackMap[t]={id:t,cb:e,time:i},console.log("addCallback:",t,i)}return t},t.prototype.onSocketData=function(e){var t=e.target;if(t.id==this._sid){var i=new egret.ByteArray;if(this._socket.readBytes(i),!FISH_MODE_INDEPENDENT){var n=new egret.ByteArray;this._socket.readBytes(n);var o=n.readUnsignedShort(),r=n.readUnsignedShort();return void this._parseBytes(r,o,n)}var s=i.readUnsignedShort(),a=i.readUnsignedShort();switch(10>a&&2!=a&&(this.showLogs&&console.log("get:[%d] %d",s,a),this._showLogToScreen),a){case 0:this.onHeartTimer(),this._heartTimer.start(),this.dispatchEventWith(FishEvent.USER_LOGIN_RESPONSE,!1,{code:0});break;case 1:this.showLogs&&console.log("login failed.");var h=parseInt(i.readUTFBytes(i.bytesAvailable));this.dispatchEventWith(FishEvent.USER_LOGIN_RESPONSE,!1,{code:1,errorId:h});break;case 2:this._heartTimeout&&(egret.clearTimeout(this._heartTimeout),this._heartTimeout=null),this._lastHeart=this.tsLocal;var c=i.readInt();this.tsServerOffset=this.tsLocal-c,this._serverTimer.running||(this._serverTimer.start(),this.checkDate(!1));break;default:var l=this._protoIDs[a];if(!l){console.log("没有ID为"+a+"的协议!");break}var u=l.indexOf("."),p=l.substring(0,u),d=l.substring(u+1),_=new egret.ByteArray;i.readBytes(_);var f=this._protoBuilderMap[p].build(l),g=f.decode(_.buffer),v=!0;"game"==p&&"SetSession"!=d&&(v=this._session==g.session);!this.frozen&&v?"#d0c400":"#BBBBBB";if(this.showLogs&&!this.frozen&&this.inShowList(l),this._showLogToScreen,!this.frozen&&v)if(this.needCache){if(!(this.exception&&this.exception.indexOf(l)>-1))return void this.cacheList.push([l,g]);this.beforeDispatchMessage(l,g),this.dispatchEventWith(l,!1,g)}else this.beforeDispatchMessage(l,g),this.dispatchEventWith(l,!1,g)}}},t.prototype.startCache=function(e,t){void 0===e&&(e=null),void 0===t&&(t=-1),console.log("开始缓存"),e?this.exception=e.concat():this.exception=[],this.needCache=!0,this.cacheTime=t,this.timer||(this.timer=new egret.Timer(1e3)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.start()},t.prototype.stopCache=function(){for(console.log("缓存结束"),this.needCache=!1,this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this));this.cacheList.length>0;){var e=this.cacheList.shift();if(this.beforeDispatchMessage(e[0],e[1]),this.dispatchEventWith(e[0],!1,e[1]),this.needCache)break}},t.prototype.onTimer=function(e){if(-1!=this.cacheTime)for(var t=0;t<this.cacheList.length;t++)"object"==typeof this.cacheList[t][1]&&(this.cacheList[t][1].hasOwnProperty("time")?(this.cacheList[t][1].time-=this.cacheTime,this.cacheList[t][1].time<0&&(this.cacheList[t][1].time=0)):this.cacheList[t][1].hasOwnProperty("timeout")&&(this.cacheList[t][1].timeout-=this.cacheTime,this.cacheList[t][1].timeout<0&&(this.cacheList[t][1].timeout=0)))
},t.prototype.checkCallback=function(e,t){if(e>0){var i=this._callbackMap[e];console.log("checkCallback:",e,!!i),i&&(this._callbackMap.splice(e,1),i.cb(t))}},t.prototype.inShowList=function(e){var t=!1;return this.logList.forEach(function(i){"string"==typeof i?i==e&&(t=!0):e.match(i)&&(t=!0)}),t},t.prototype.beforeDispatchMessage=function(e,t){switch(e){case FishEvent.GAME_SET_SESSION:this._session=t.session;break;case FishEvent.USER_CHECK_RECONNECT_REP:t.roomid>0&&(this._session=t.session);break;case FishEvent.GAME_USER_ONLINE:this._uid==t.uid&&(this.seatid=t.seatid);break;case FishEvent.USER_NOTIFY_KICK_OUT:this._kickOut=!0;var i={content:langFish.disconnect_kick_out[t.reason]};4==t.reason&&(i.button=langFish.confirm),FishUtils.Dispatcher.dispatch(FishEvent.SHOW_DISCONNECT,i);break;case FishEvent.GAME_GAME_END:break;case FishEvent.USER_OPERATE_REP:}},t.prototype.onServerTimer=function(e){void 0===e&&(e=null),this.checkDate()},t.prototype.checkDate=function(e){void 0===e&&(e=!0);var t=FishUtils.TimeUtils.tsToDate(this.tsServer),i=t.getDate();this._today!=i&&(this._today=i,e&&FishUtils.Dispatcher.dispatch(FishEvent.CLOCK_0))},Object.defineProperty(t.prototype,"tsLocal",{get:function(){return Math.floor((new Date).valueOf()/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tsServer",{get:function(){return this.tsLocal-this.tsServerOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverDate",{get:function(){return FishUtils.TimeUtils.tsToDate(this.tsServer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tsToday",{get:function(){var e=this.serverDate;return new Date(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()).valueOf()/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tsNow",{get:function(){return this.tsServer-this.tsToday},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),t.prototype.onHeartTimer=function(e){void 0===e&&(e=null),this.sendHeartPackage()},t.prototype.sendHeartPackage=function(){if(this.connected){var e=new egret.ByteArray;e.writeShort(2),e.writeShort(2),this._socket.writeBytes(e),this._socket.flush(),this._heartCount++,this._heartTimeout||(this._heartTimeout=egret.setTimeout(this.onHeartTimerEnd,this,5e3))}},t.prototype.onHeartTimerEnd=function(){console.log("心跳接收超时,主动关闭连接."),this.close(),FishUtils.Dispatcher.dispatch(FishEvent.SERVER_CLOSE)},t.prototype.checkEnterForegroundTimeOut=function(){return this._lastHeart>0&&this.tsLocal-this._lastHeart>5?(this.onHeartTimerEnd(),!0):!1},t.prototype.login=function(e,t){this._token=t;var i=1;this._uid=parseInt(e);var n=[this._uid,1,t,FishUtils.StringUtils.makeRandomString(32),FishUtils.Environment.channel_id,i].join(":"),o=new egret.ByteArray;o.writeUnsignedShort(0),o.writeUTFBytes(n),this._socket.writeBytes(o),this._socket.flush(),console.log("login:"+n)},t.prototype.checkReconnect=function(){this.send(FishEvent.USER_CHECK_RECONNECT_REQ,{})},t.prototype.reconnect=function(e){console.log("Server: reconnect"),this.send(FishEvent.USER_RECONNECT_TABLE_REQ,{result:e,index:0,session:this._session})},t.prototype.resetSession=function(){this._session=0},t.prototype.getRoomId=function(){return this.roomInfo&&this.roomInfo.roomID?this.roomInfo.roomID:null},t.prototype.getTableId=function(){return this.roomInfo&&this.roomInfo.tableId?this.roomInfo.tableId:null},t.prototype.ddzDispatchEvent=function(e,t,i){if(!FISH_MODE_INDEPENDENT&&this._ddzDispatcher)if(0==e){var n={type:e,protoID:t,byteArray:i};this._ddzDispatcher.dispatchEventWith("FishMain",!1,n)}else this._ddzDispatcher.dispatchEventWith("FishMain",!1,i)},t.prototype.onDDZSocketData=function(e){var t=e.data;t&&t.byteArray&&t.nameId&&this._parseBytes(t.nameId,t.len,t.byteArray)},t.prototype._parseBytes=function(e,t,i){if(this._protoIDs&&i)switch(10>e&&2!=e&&(this.showLogs&&(FishUtils.Native.instance.isNative?console.log("222get:["+t+"] "+e):console.log("222get:[%d] %d",t,e)),this._showLogToScreen&&FishUtils.Dispatcher.dispatch(FishEvent.LOG,"get: "+e)),e){case 0:this.onHeartTimer(),this._heartTimer.start(),this.dispatchEventWith(FishEvent.USER_LOGIN_RESPONSE,!1,{code:0});break;case 1:this.showLogs&&console.log("222login failed.");var n=parseInt(i.readUTFBytes(i.bytesAvailable));this.dispatchEventWith(FishEvent.USER_LOGIN_RESPONSE,!1,{code:1,errorId:n});break;case 2:if(!FISH_MODE_INDEPENDENT)return;this._heartTimeout&&(egret.clearTimeout(this._heartTimeout),this._heartTimeout=null),this._lastHeart=this.tsLocal;var o=i.readInt();this.tsServerOffset=this.tsLocal-o,this._serverTimer.running||(this._serverTimer.start(),this.checkDate(!1));break;default:var r=this._protoIDs[e];if(!r){console.log("222没有ID为"+e+"的协议!");break}var s=r.indexOf("."),a=r.substring(0,s),h=(r.substring(s+1),new egret.ByteArray);i.readBytes(h);var c=this._protoBuilderMap[a].build(r);if(!c)return;var l=c.decode(h.buffer);FISH_MODE_INDEPENDENT||console.log("222recv:",r,JSON.stringify(l),this.frozen);var u=!0;!this.frozen&&u?"#d0c400":"#BBBBBB";if(this.showLogs&&!this.frozen&&this.inShowList(r)&&FishUtils.Native.instance.isNative,this._showLogToScreen&&FishUtils.Dispatcher.dispatch(FishEvent.LOG,"get: "+r),!this.frozen&&u)if(this.needCache){if(!(this.exception&&this.exception.indexOf(r)>-1))return void this.cacheList.push([r,l]);this.beforeDispatchMessage(r,l),this.dispatchEventWith(r,!1,l)}else this.beforeDispatchMessage(r,l),this.dispatchEventWith(r,!1,l)}},t}(egret.EventDispatcher);__reflect(FishSocket.prototype,"FishSocket");var FishUserInfoData=function(){function e(){this._sysTalkMaxN=10,this._hornTalkRecMaxN=20,this.clean()}return e.prototype.hasRecorder=function(){return this.cardsRecorder&&this.cardsRecorder.length>=7&&this.cardsRecorder[6]>0?!0:!1},e.prototype.todayHasBuyRevive=function(){return 1==this.diamondrelive?!0:!1},e.prototype.setTodayHasBuyRevive=function(){this.diamondrelive=1},e.prototype.initData=function(t){var i=this;t.cardsRecorder&&t.cardsRecorder.length<1&&(t.cardsRecorder=null),FishUtils.Utils.injectProp(this,t,function(t,n,o){"nickname"==n?o&&("参赛玩家"!=o?t.nickname=FishUtils.Base64.decode(o):t.nickname=o):"sex"==n?e.updateSex(t,o):"gold"==n||"redcoingot"==n||"totalwincnt"==n||"totallosecnt"==n||"totaldrawcnt"==n||"diamondgiftgot"==n||"diamondrelive"==n?(t[n]=parseInt(o),"redcoingot"==n&&(t[n]=t[n]/100)):"frechargerewardday"==n?o>=1&&9>=o&&(t[n]=parseInt(o)):"wincnt"==n?o&&o.length&&(t[n]=o):"daytaskprogress"==n?o.length>=1&&(t[n]=o):"daytaskstatus"==n?o&&7==o.length&&(t[n]=o,i._calculateOverTaskNum(o)):"imageid"==n&&o&&0==o.indexOf("head")&&o.length<=10?t[n]="icon_head_default":t[n]=o}),0==this.sex&&e.updateSex(this,0),0!=this.recorderfirstrewardgot||t.recorderfirstrewardgot||(this.recorderfirstrewardgot=null)},e.updateSex=function(e,t){void 0===t&&(t=0),e.sex=t,e.sexStr=langFish.sex[e.sex],e.sexVoiceStr=langFish.sexVoice[e.sex]},e.prototype._calculateOverTaskNum=function(e){for(var t=0,i=0;i<e.length;++i)1==e[i]&&(t+=1);this._dayTaskOverNum=t},e.prototype.getWinRate=function(){var e=this.totalwincnt+this.totaldrawcnt+this.totallosecnt;return 0==e||0==this.totalwincnt?0:this.totalwincnt/e},e.prototype.getGold=function(){return this.gold},e.prototype.addGold=function(e){var t=this.gold+e;this.gold=t,0>t&&(this.gold=0)},e.prototype.getDayTaskPre=function(){return this.daytaskprogress},e.prototype.getDayTaskAllTStatus=function(){return this.daytaskstatus},e.prototype.getDayTaskOverCount=function(){return this._dayTaskOverNum},e.prototype.isHasBuyFRecharge=function(){return null!=this.frechargerewardday?!0:!1},e.prototype.isHadGetFRechargeRew=function(){return this.frechargerewardday&&this.frechargerewardday>=2&&this.frechargerewardday<=9?!0:!1},e.prototype.isGetTodayFRechargeRew=function(){return this.frechargerewardday&&8==this.frechargerewardday?!0:!1},e.prototype.isFRechargeRewGetOver=function(){return this.frechargerewardday&&this.frechargerewardday>=1&&this.frechargerewardday<=7?!1:!0},e.prototype.getFRechargeRewGetDay=function(){return this.frechargerewardday},e.prototype.setFRechargeTodayHasGet=function(){this.frechargerewardday=8},e.prototype.isTodayHasSign=function(){return this.todayHasSign},e.prototype.setTodaySigned=function(e){this.todayHasSign=e},e.prototype.isSignGoldAddByFRecharge=function(){return this.signrewardaddremain&&this.signrewardaddremain>0?!0:!1},e.prototype.isNotGetFRechargeSignAdd=function(){return 7==this.signrewardaddremain?!0:!1},e.prototype.signSuccSubSignAddRemin=function(){this.isHasBuyFRecharge()&&this.isHadGetFRechargeRew()&&this.signrewardaddremain&&(this.signrewardaddremain-=1,this.signrewardaddremain<0&&(this.signrewardaddremain=0))},e.prototype.setTaskHasGetRew=function(e){for(var t=0;t<this.daytaskstatus.length;++t)t+1==e&&(this.daytaskstatus[t]=2);this._calculateOverTaskNum(this.daytaskstatus)},e.prototype.addHornTalkRec=function(e){if(e&&e.nickname&&e.msg){var t=new Date(e.time),i=t.getHours(),n=t.getMinutes(),o=t.getSeconds();10>i&&(i="0"+i),10>n&&(n="0"+n),10>o&&(o="0"+o);var r=i+":"+n+":"+o,s={time:r,name:FishUtils.Base64.decode(e.nickname),msg:e.msg,isUser:!0};this._hornTalkRec.length>=this._hornTalkRecMaxN&&this._hornTalkRec.shift(),this._hornTalkRec.push(s),this._hornTalkShowList.push(s)}},e.prototype.addHornTalkRecByHttp=function(e){if(e&&e.nickname&&e.msg&&e.add_time){var t=e.add_time.substr(-8),i=e.nickname,n=e.msg,o={time:t,name:i,msg:n,isUser:!0};this._hornTalkRec.length>=this._hornTalkRecMaxN&&this._hornTalkRec.shift(),this._hornTalkRec.push(o)}},e.prototype.cleanLocalHornRecByHttp=function(){this._hornTalkRec=[]},e.prototype.setHornTalkRecMaxLen=function(e){this._hornTalkRecMaxN=e},e.prototype.getHornTalkRecList=function(){return this._hornTalkRec},e.prototype.getHornTalkShowLen=function(){return this._hornTalkShowList.length},e.prototype.getFrontHornTalkShow=function(){var e=null;return this._hornTalkShowList.length>0&&(e=this._hornTalkShowList[0],this._hornTalkShowList.shift()),e},e.prototype.addSysTalkRec=function(e){this._sysTalkRec[0]={msg:e,isUser:!1}},e.prototype.getSysTalkRecList=function(){return this._sysTalkRec},e.prototype.setNationalActInfo=function(e){this._nationalInfo=e},e.prototype.getNationalGetLoginRewDay=function(){return this._nationalInfo&&this._nationalInfo.getRewDay?this._nationalInfo.getRewDay:0},e.prototype.hasGetNationalTodayLoginRew=function(){return this._nationalInfo&&2==this._nationalInfo.todayGet?!0:!1},e.prototype.getNationalInviteNum=function(){return this._nationalInfo&&this._nationalInfo.inviteNum?this._nationalInfo.inviteNum:0},e.prototype.getNationalInviteRew=function(){return 0},e.prototype.hasGetNationalInviteRew=function(){return this._nationalInfo&&this._nationalInfo.getInviteRew&&2==this._nationalInfo.getInviteRew?!0:!1},e.prototype.hasGetNewDiamond=function(){return 1==this.diamondgiftgot?!0:!1},e.prototype.setHasGetNewDiamond=function(){this.diamondgiftgot=1},e.prototype.setNationalGetLoginRewDay=function(e){this._nationalInfo.getRewDay=e,this._nationalInfo.todayGet=2},e.prototype.clean=function(){this._nationalInfo={getRewDay:0,todayGet:0,inviteNum:0,getInviteRew:0},this._hornTalkShowList=[],this._hornTalkRec=[],this._sysTalkRec=[],this.uid=0,this.nickname=null,this.diamondgiftgot=0,this.money=0,this.gold=null,this.exp=0,this.vipexp=0,this.sex=0,this.sexStr=null,this.sexVoiceStr=null,this.imageid=null,this.havesecondpwd=0,this.isbinding=0,this.wincnt=[],this.drawcnt=0,this.fakeuid=0,this.bindphone=null,this.redcoin=0,this.seatid=0,this.freshmanredcoinsent=0,this.beans=null,this.rcminexcexpiretime=0,this.rcminexcchanceused=null,this.freshrewardgot=null,this.redcoingot=0,this.totalwincnt=0,this.totallosecnt=0,this.totaldrawcnt=0,this.recorderfirstrewardgot=0,this.cardsRecorder=null,this._dayTaskOverNum=0,this.daytaskprogress=[0,0],this.daytaskstatus=[0,0,0,0,0,0,0],this.frechargerewardday=null,this.todayHasSign=null,this.signrewardaddremain=null},e}();__reflect(FishUserInfoData.prototype,"FishUserInfoData");var FishPanelBase=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype._show=function(e){var t=this;e.touchEnabled=!0,t.x=e.width/2,t.y=e.height/2,e.addChild(t),egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},150,egret.Ease.backIn).to({scaleX:1,scaleY:1},150,egret.Ease.backOut)},t.prototype._hide=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var i=this;egret.Tween.get(i).to({scaleX:.8,scaleY:.8},80,egret.Ease.backIn).to({scaleX:.9,scaleY:.9},80,egret.Ease.backOut).call(function(e,t,i){var n=e,o=n.parent;o.removeChild(n),0==o.numChildren&&(o.touchEnabled=!1),t&&t(i)},i,[i,e,t])},t}(eui.Component);__reflect(FishPanelBase.prototype,"FishPanelBase");var FishObject=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.IsFish=function(){return!1},t.prototype.IsBullet=function(){return!1},t.prototype.Object=function(){return null},t.prototype.P2Body=function(){return null},t.prototype.ResetP2Body=function(){},t}(egret.DisplayObjectContainer);__reflect(FishObject.prototype,"FishObject");var FishPhysics=function(){function e(){this.factor=32,this.world=null,this.debugDraw=null,this.selfViewId=0}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e._instance.CreateWorld()),e._instance},e.prototype.CreateWorld=function(){var e=this,t=new p2.World;return t.sleepMode=p2.World.BODY_SLEEPING,t.gravity=[0,0],e.world=t,e.world.on("beginContact",function(t){var i=t.bodyA,n=t.bodyB,o=i.displays[0],r=n.displays[0];if(null!=o&&null!=r&&!(o.IsFish()&&r.IsFish()||o.IsBullet()&&r.IsBullet())){var s=null,a=null;o.IsFish()?(s=o,a=r):(s=r,a=o),s.explode||a.explode||(a.GetFromCannon()==e.selfViewId&&(s.Beat(),fishServer.catchFish(a.GetBulletID(),s.GetFishID())),a.Explode())}}),t},e.prototype.Wakeup=function(){var e=this;e.world.sleepMode=p2.World.NO_SLEEPING},e.prototype.Sleep=function(){var e=this;e.world.sleepMode=p2.World.BODY_SLEEPING},e.prototype.AddPhysicalBodyForFish=function(e){var t=this,i=new p2.Box({width:.9*e.width,height:.9*e.height}),n=new p2.Body({mass:1,position:[e.x,e.y],fixedRotation:!0,type:p2.Body.DYNAMIC,inertia:0,angularForce:0,force:0});return n.addShape(i),n.displays=[e],t.world.addBody(n),n},e.prototype.RemovePhysicalBodyForFish=function(e){var t=this;t.world.removeBody(e.P2Body()),e.ResetP2Body()},e.prototype.AddPhysicalBodyForBullet=function(e){var t=this,i=new p2.Box({width:1/t.factor,height:1/t.factor}),n=new p2.Body({mass:1,position:[e.x,e.y],fixedRotation:!0,type:p2.Body.DYNAMIC,inertia:0,angularForce:0,force:0});return n.addShape(i),n.displays=[e],t.world.addBody(n),n},e.prototype.RemovePhysicalBodyForBullet=function(e){var t=this;t.world.removeBody(e.P2Body()),e.ResetP2Body()},e.prototype.CreateDebugDraw=function(e){var t=this;t.debugDraw=new FishPhysicsDraw(t.world);var i=new egret.Sprite;e&&e.addChild(i),t.debugDraw.setSprite(i)},e.prototype.Update=function(){var e=this;e.world.step(.06),e.debugDraw&&e.debugDraw.drawDebug()},e._instance=null,e}();__reflect(FishPhysics.prototype,"FishPhysics");var FishPhysicsDraw=function(){function e(e){this.COLOR_D_SLEEP=10066329,this.COLOR_D_WAKE=15053490,this.COLOR_K=8355813,this.COLOR_S=8381823,this.world=e}return e.prototype.setSprite=function(e){this.sprite=e},e.prototype.drawDebug=function(){this.sprite.graphics.clear();for(var e=this.world.bodies.length,t=0;e>t;t++){var i=this.world.bodies[t];if(i.sleepState!=p2.Body.SLEEPING&&i.sleepState!=p2.Body.SLEEPY)for(var n=0;n<i.shapes.length;n++){var o=i.shapes[n];o instanceof p2.Convex?this.drawConvex(o,i):o instanceof p2.Circle?this.drawCircle(o,i):o instanceof p2.Line?this.drawLine(o,i):o instanceof p2.Particle?this.drawParticle(o,i):o instanceof p2.Plane?this.drawPlane(o,i):o instanceof p2.Capsule&&this.drawCapsule(o,i)}}},e.prototype.drawCircle=function(e,t){var i=this.getColor(t),n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,.5),n.drawCircle(t.position[0],t.position[1],e.radius);var o=new Array;t.toWorldFrame(o,[e.radius,0]),n.moveTo(t.position[0],t.position[1]),n.lineTo(o[0],o[1]),n.endFill()},e.prototype.drawCapsule=function(e,t){var i=this.getColor(t),n=e.length,o=e.radius,r=new Array,s=new Array,a=new Array,h=new Array,c=new Array,l=new Array;t.toWorldFrame(r,[-n/2,-o]),t.toWorldFrame(s,[n/2,-o]),t.toWorldFrame(a,[n/2,o]),t.toWorldFrame(h,[-n/2,o]),t.toWorldFrame(c,[n/2,0]),t.toWorldFrame(l,[-n/2,0]);var u=this.sprite.graphics;u.lineStyle(1,i),u.beginFill(i,.5),u.drawCircle(c[0],c[1],o),u.endFill(),u.lineStyle(1,i),u.beginFill(i,.5),u.drawCircle(l[0],l[1],o),u.endFill(),u.lineStyle(1,i),u.beginFill(i,.5),u.moveTo(r[0],r[1]),u.lineTo(s[0],s[1]),u.lineTo(a[0],a[1]),u.lineTo(h[0],h[1]),u.endFill()},e.prototype.drawLine=function(e,t){var i=this.getColor(t),n=e.length,o=new Array,r=new Array;t.toWorldFrame(o,[-n/2,0]),t.toWorldFrame(r,[n/2,0]);var s=this.sprite.graphics;s.lineStyle(1,i),s.moveTo(o[0],o[1]),s.lineTo(r[0],r[1]),s.endFill()},e.prototype.drawParticle=function(e,t){var i=this.getColor(t),n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,.5),n.drawCircle(t.position[0],t.position[1],1),n.endFill(),n.lineStyle(1,i),n.drawCircle(t.position[0],t.position[1],5),n.endFill()},e.prototype.drawConvex=function(e,t){var i=this.getColor(t),n=e.vertices.length,o=this.sprite.graphics;o.lineStyle(1,i),o.beginFill(i,.5);var r=new Array;t.toWorldFrame(r,e.vertices[0]),o.moveTo(t.position[0],t.position[1]),o.lineTo(r[0],r[1]);for(var s=1;n>=s;s++)t.toWorldFrame(r,e.vertices[s%n]),o.lineTo(r[0],r[1]);o.endFill()},e.prototype.drawPlane=function(e,t){var i=this.COLOR_D_SLEEP,n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,1);var o=new Array,r=new Array;t.toWorldFrame(o,[-1e3,0]),n.moveTo(o[0],o[1]),t.toWorldFrame(r,[1e3,0]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[1e3,-1e3]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[-1e3,-1e3]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[-1e3,-0]),n.lineTo(r[0],r[1]),n.endFill()},e.prototype.getColor=function(e){var t=this.COLOR_D_SLEEP;return e.type==p2.Body.KINEMATIC?t=this.COLOR_K:e.type==p2.Body.STATIC?t=this.COLOR_S:e.sleepState==p2.Body.AWAKE&&(t=this.COLOR_D_WAKE),t},e}();__reflect(FishPhysicsDraw.prototype,"FishPhysicsDraw");var FishCannon=function(e){function t(){var t=e.call(this)||this;t.viewID=0,t.mc=null,t.bulletId=1,t.fireAngle=0,t.mutilple=0,t.mutilples=[];var i=t;return i.touchEnabled=!1,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishCannonSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){var e=this;switch(e.currentState="wait",e.name){case"cannon1":e.SetViewID(1);break;case"cannon2":e.SetViewID(2);break;case"cannon3":e.SetViewID(3);break;case"cannon4":e.SetViewID(4)}e.fish_btn_cannon_up.addEventListener(egret.TouchEvent.TOUCH_TAP,e.btnTouchHandler,e),e.fish_btn_cannon_down.addEventListener(egret.TouchEvent.TOUCH_TAP,e.btnTouchHandler,e)},t.prototype.uiResizeHandler=function(){},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_cannon_up:var i=t.mutilples.length;if(0==i)return;var n=t.mutilples.indexOf(t.mutilple);-1==n||n==i-1?t.SetMultiple(t.mutilples[0]):t.SetMultiple(t.mutilples[n+1]);break;case t.fish_btn_cannon_down:var i=t.mutilples.length;if(0==i)return;var n=t.mutilples.indexOf(t.mutilple);0==n?t.SetMultiple(t.mutilples[i-1]):t.SetMultiple(t.mutilples[n-1])}egret.Tween.get(e.target).to({scaleX:1.2,scaleY:1.2},150,egret.Ease.backIn).to({scaleX:1,scaleY:1},150,egret.Ease.backOut)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this,i=RES.getRes("gun_json"),n=RES.getRes("gun_png"),o=new egret.MovieClipDataFactory(i,n),r=o.generateMovieClipData("pao");t.mc=new egret.MovieClip(r),t.mc.anchorOffsetX=t.mc.width/2,t.mc.anchorOffsetY=160,t.mc.frameRate=9,t.mc.touchEnabled=!1,t.mc.x=t.fish_cannon_container.width/2,t.mc.y=t.fish_cannon_container.height,t.fish_cannon_container.addChild(t.mc)},t.prototype.FireTo=function(e){var t=this,i=180*-Math.atan2(e.y-t.y,e.x-t.x)/Math.PI;return 10>i&&(i=10),i>170&&(i=170),t.FireToAngle(i)},t.prototype.FireToAngle=function(e){var t=this;t.fireAngle=e,t.mc.rotation=90-e,t.viewID>2&&(e=180-e),t.mc.gotoAndPlay("fire",1);var i=FishBulletManager.GetInstance().BuildBullet(0,t.bulletId++,t.viewID);return i.MoveToAngle(egret.Point.create(t.x,t.y),e),FishSoundManager.GetInstance().PlayShot(),i},t.prototype.GetFireAngle=function(){var e=this;return e.fireAngle},t.prototype.SetViewID=function(e){var t=this;t.viewID=e,e>2&&(t.fish_label_cannon_wait.rotation=180,t.fish_label_cannon_level_other.rotation=180),FishCannonManager.GetInstance().AddCannon(t)},t.prototype.GetViewID=function(){return this.viewID},t.prototype.ShowCannon=function(e,t){void 0===t&&(t=!1);var i=this;i.fish_img_self_flag.visible=!1,i.fish_img_self_flag2.visible=!1,e?t?(i.currentState="self",i.fish_img_self_flag.visible=!0,i.fish_img_self_flag2.visible=!0,egret.Tween.get(i.fish_img_self_flag,{loop:!0}).to({scaleX:1,scaleY:1},500).to({scaleX:.7,scaleY:.7},500),egret.setTimeout(function(e){var t=e;t.fish_img_self_flag.visible=!1,t.fish_img_self_flag2.visible=!1,egret.Tween.removeTweens(t.fish_img_self_flag)},i,5e3,i)):i.currentState="other":i.currentState="wait",i.mutilple>0&&i.SetMultiple(i.mutilple)},t.prototype.SetMultiples=function(e){var t=this;t.mutilples=e,t.mutilples.length>0&&(0==t.mutilple||t.mutilple<t.mutilples[0]||t.mutilple>t.mutilples[t.mutilples.length-1])&&t.SetMultiple(t.mutilples[0])},t.prototype.SetMultiple=function(e){var t=this;t.mutilple!=e&&-1!=t.mutilples.indexOf(e)&&(10>e?(t.fish_label_cannon_level_other.text="   "+e,t.fish_label_cannon_level_self.text="   "+e):100>e?(t.fish_label_cannon_level_other.text="  "+e,t.fish_label_cannon_level_self.text="  "+e):(t.fish_label_cannon_level_other.text=" "+e,t.fish_label_cannon_level_self.text=" "+e),t.mutilple=e)},t.prototype.GetMultiple=function(){var e=this;return e.mutilple},t.prototype.ShowBingo=function(e){var t=this;if(null!=FishScene.instance.GetFishGround()){var i=FishBingoManager.GetInstance().BuildBingo(e,t.viewID!=FishPhysics.GetInstance().selfViewId);i.x=t.x,i.y=t.y-180,FishScene.instance.GetFishGround().addChild(i),i.Fire()}},t}(eui.Component);__reflect(FishCannon.prototype,"FishCannon");var FishCannonManager=function(){function e(){this.cannons=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.AddCannon=function(e){var t=this;t.cannons.push(e)},e.prototype.RemoveCannon=function(e){var t=this,i=t.cannons.indexOf(e,0);-1!=i&&t.cannons.splice(i,1)},e.prototype.GetCannons=function(){var e=this;return e.cannons},e.prototype.GetCannon=function(e){for(var t=this,i=0,n=t.cannons.length;n>i;i++)if(t.cannons[i].GetViewID()==e)return t.cannons[i];return null},e._instance=null,e}();__reflect(FishCannonManager.prototype,"FishCannonManager");var FishProtoIDs=function(){function e(){}return e.getMap=function(){var e={};return e[2002]="game.SetSession",e["game.SetSession"]=2002,e[2003]="game.TableInfo",e["game.TableInfo"]=2003,e[2004]="game.EnterTable",e["game.EnterTable"]=2004,e[2006]="game.LeaveTable",e["game.LeaveTable"]=2006,e[2022]="game.ReconnectReq",e["game.ReconnectReq"]=2022,e[2023]="game.ReconnectRep",e["game.ReconnectRep"]=2023,e[2024]="game.GiveUpGameReq",e["game.GiveUpGameReq"]=2024,e[2025]="game.GiveUpGameRep",e["game.GiveUpGameRep"]=2025,e[2026]="game.UserOffline",e["game.UserOffline"]=2026,e[2027]="game.UserOnline",e["game.UserOnline"]=2027,e[2036]="game.UserInfoInGameReq",e["game.UserInfoInGameReq"]=2036,e[2037]="game.UserInfoInGameRep",e["game.UserInfoInGameRep"]=2037,e[1001]="user.UserInfoRequest",e["user.UserInfoRequest"]=1001,e[1002]="user.UserInfoResonpse",e["user.UserInfoResonpse"]=1002,e[1005]="user.CheckReconnectReq",e["user.CheckReconnectReq"]=1005,e[1006]="user.CheckReconnectRep",e["user.CheckReconnectRep"]=1006,e[1007]="user.ReconnectTableReq",e["user.ReconnectTableReq"]=1007,e[1008]="user.ReconnectTableRep",e["user.ReconnectTableRep"]=1008,e[1009]="user.QuickJoinRequest",e["user.QuickJoinRequest"]=1009,e[1010]="user.QuickJoinResonpse",e["user.QuickJoinResonpse"]=1010,e[1038]="user.DaySigninOptReq",e["user.DaySigninOptReq"]=1038,e[1039]="user.DaySigninOptRep",e["user.DaySigninOptRep"]=1039,e[1042]="user.NotifyKickout",e["user.NotifyKickout"]=1042,e[1046]="user.BagInfoReq",e["user.BagInfoReq"]=1046,e[1047]="user.BagInfoRep",e["user.BagInfoRep"]=1047,e[1050]="user.AlmsReq",e["user.AlmsReq"]=1050,e[1051]="user.AlmsRep",e["user.AlmsRep"]=1051,e[1090]="user.RedcoinExchangeGoodsReq",e["user.RedcoinExchangeGoodsReq"]=1090,e[1091]="user.RedcoinExchangeGoodsRep",e["user.RedcoinExchangeGoodsRep"]=1091,e[1092]="user.LotteryRedcoinReq",e["user.LotteryRedcoinReq"]=1092,e[1093]="user.LotteryRedcoinRep",e["user.LotteryRedcoinRep"]=1093,e[1107]="user.GetFreshManRewardReq",e["user.GetFreshManRewardReq"]=1107,e[1108]="user.GetFreshManRewardRep",e["user.GetFreshManRewardRep"]=1108,e[1114]="user.GetRewardReq",e["user.GetRewardReq"]=1114,e[1115]="user.GetRewardRep",e["user.GetRewardRep"]=1115,e[2050]="game.STCGameFishTrace",e["game.STCGameFishTrace"]=2050,e[2051]="game.CTSGameFishNum",e["game.CTSGameFishNum"]=2051,e[2052]="game.CTSGameFishFire",e["game.CTSGameFishFire"]=2052,e[2053]="game.STCGameFishFire",e["game.STCGameFishFire"]=2053,e[2054]="game.CTSGameFishCatch",e["game.CTSGameFishCatch"]=2054,e[2055]="game.STCGameFishOver",e["game.STCGameFishOver"]=2055,e[2056]="game.STCGameFishScreenFish",e["game.STCGameFishScreenFish"]=2056,e[2057]="game.STCGameFishSetAI",e["game.STCGameFishSetAI"]=2057,e[2058]="game.STCGameFishConfig",e["game.STCGameFishConfig"]=2058,e[2059]="game.STCGameFishRedCount",e["game.STCGameFishRedCount"]=2059,e[2060]="game.STCGameFishFireFail",e["game.STCGameFishFireFail"]=2060,e[2061]="game.CTSGameFishBindPhoneReward",e["game.CTSGameFishBindPhoneReward"]=2061,e[2062]="game.STCGameFishBindPhoneReward",e["game.STCGameFishBindPhoneReward"]=2062,e[2063]="game.CTSGameFishFreshenGold",e["game.CTSGameFishFreshenGold"]=2063,e[2064]="game.STCGameFishFreshenGold",e["game.STCGameFishFreshenGold"]=2064,e},e}();__reflect(FishProtoIDs.prototype,"FishProtoIDs");var FishEditorElement=function(e){function t(t){var i=e.call(this)||this;switch(i.type=t,i.touchChildren=!1,t){case 0:case 2:i.touchEnabled=!0;break;case 1:i.touchEnabled=!1}return i}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(FishEditorElement.prototype,"FishEditorElement");var FishEditorPoint=function(e){function t(t,i,n){void 0===n&&(n=10);var o=e.call(this,0)||this,r=o;r.label=new eui.Label(t+"(0,0)"),r.label.size=16,r.label.textColor=11110245,r.label.anchorOffsetX=r.label.width/2,r.label.anchorOffsetY=r.label.height/2,r.label.y=20,r.addChild(r.label);var s=new egret.Shape;return s.graphics.beginFill(16711680,1),s.graphics.drawCircle(0,0,n),s.graphics.endFill(),r.addChild(s),r.x=i.x,r.y=i.y,egret.setInterval(function(e,t,i){var n=e,o=n.GetGlobalPos();n.label.text=t+"("+o.x+","+o.y+")"},r,500,r,t,i),o}return __extends(t,e),t.prototype.GetPos=function(){var e=this,t=new egret.Point(e.x,e.y);return t},t.prototype.GetGlobalPos=function(){var e=this,t=e.localToGlobal(e.parent.x+e.x,e.parent.y+e.y);return t.x/=2,t.y/=2,t},t.prototype.GetGlobalPosForExport=function(){var e=this,t=e.GetGlobalPos();return t.x-=320,t.y-=180,t.x*=2,t.y*=2,t},t.prototype.SetByGlobalPos=function(e){var t=this;t.x=e.x-t.parent.x,t.y=e.y-t.parent.y},t}(FishEditorElement);__reflect(FishEditorPoint.prototype,"FishEditorPoint");var FishEditorLine=function(e){function t(t,i){var n=e.call(this,1)||this,o=new egret.Shape;return o.graphics.lineStyle(2,85),o.graphics.moveTo(t.x,t.y),o.graphics.lineTo(i.x,i.y),o.graphics.endFill(),n.addChild(o),n}return __extends(t,e),t}(FishEditorElement);__reflect(FishEditorLine.prototype,"FishEditorLine");var FishEditorBezier=function(e){function t(t,i,n,o,r){var s=e.call(this,1)||this,a=s;a.label=new eui.Label(t),a.label.size=16,a.label.anchorOffsetX=a.label.width/2,a.label.anchorOffsetY=a.label.height/2,a.label.x=i.x,a.label.y=i.y+20,a.addChild(a.label);var h=new egret.Shape;return h.graphics.lineStyle(5,65280),h.graphics.moveTo(i.x,i.y),h.graphics.cubicCurveTo(n.x,n.y,o.x,o.y,r.x,r.y),h.graphics.endFill(),s.addChild(h),s}return __extends(t,e),t}(FishEditorElement);__reflect(FishEditorBezier.prototype,"FishEditorBezier");var FishEditorSurface=function(e){function t(t,i,n){void 0===n&&(n=16777215);var o=e.call(this,2)||this,r=o,s=new egret.Shape;return s.graphics.beginFill(n,.1),s.graphics.drawRect(i.x,i.y,i.width,i.height),s.graphics.endFill(),r.addChild(s),r.label=new eui.Label(t),r.label.size=16,r.label.anchorOffsetX=r.label.width/2,r.label.anchorOffsetY=r.label.height/2,r.label.x=i.x+i.width/2,r.label.y=i.y+i.height-20,r.addChild(r.label),r.anchorOffsetX=0,r.anchorOffsetY=0,o}return __extends(t,e),t.prototype.SetSurfaceName=function(e){var t=this;t.label.text=e},t}(FishEditorElement);__reflect(FishEditorSurface.prototype,"FishEditorSurface");var FishPathEditor=function(e){function t(){var t=e.call(this)||this;t.fish_paths=[],t.fish_actor_show=null;var i=t;return i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.skinName=FishPathEditorSkin,FishActor.InitStaticResource(),t}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this,i=new egret.Shape;i.graphics.beginFill(8947848,.3),i.graphics.drawRect(0,0,t.stage.stageWidth,t.stage.stageHeight),i.graphics.endFill(),i.touchEnabled=!1,t.addChildAt(i,0);var n=new eui.HorizontalLayout;n.paddingLeft=10,n.gap=10,n.setTypicalSize(1280/21,1280/21),t.fish_editor_show_select_group.layout=n;for(var o=0;21>o;o++){var r=new FishShowItem;r.SetFishInfo(o),r.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showTouchHandler,t),t.fish_editor_show_select_group.addChild(r)}t.fish_editor_btn_insert.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_editor_btn_delete.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_editor_btn_export.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_editor_btn_import.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_editor_btn_xmirr.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_editor_btn_ymirr.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t)},t.prototype.uiCompHandler=function(){},t.prototype.showTouchHandler=function(e){var t=this,i=e.target;i.Select(!0),fishServer.seatid=1;var n=t.fish_paths.length;if(0!=n){t.fish_actor_show&&(FishManager.GetInstance().DestroyFish(t.fish_actor_show),t.fish_actor_show=null),t.fish_actor_show=FishManager.GetInstance().BuildFish(i.fishType,0),t.fish_actor_show.x=t.fish_paths[0].pstart.x,t.fish_actor_show.y=t.fish_paths[0].pstart.y;var o={};o.points=[],o.fish_trace_type=[],o.fish_trace_time=[];for(var r=0;n>r;r++)o.fish_trace_type.push(2),o.fish_trace_time.push(t.fish_paths[r].time),o.points.push(t.fish_paths[r].pstart.GetGlobalPos()),o.points.push(t.fish_paths[r].pp1.GetGlobalPos()),o.points.push(t.fish_paths[r].pp2.GetGlobalPos()),o.points.push(t.fish_paths[r].pend.GetGlobalPos());t.fish_ground.addChildAt(t.fish_actor_show,20),t.fish_actor_show.MoveToTrace(o)}},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_editor_btn_insert:var i=t.fish_paths.length,n=new FishPathItem(10,"路径"+(i+1),egret.Point.create(100,300),egret.Point.create(200,100),egret.Point.create(400,100),egret.Point.create(500,300));t.fish_paths.push(n),t.fish_ground.addChild(n);for(var o=0;o<t.fish_paths.length;o++)t.fish_paths[o].SetPathName("路径"+(o+1));break;case t.fish_editor_btn_delete:if(null!=FishPathItem.lastSelected){var r=t.fish_paths.indexOf(FishPathItem.lastSelected,0);
-1!=r&&t.fish_paths.splice(r,1),t.fish_ground.removeChild(FishPathItem.lastSelected),FishPathItem.lastSelected=null}for(var o=0;o<t.fish_paths.length;o++)t.fish_paths[o].SetPathName("路径"+(o+1));break;case t.fish_editor_btn_export:var i=t.fish_paths.length,s={};s.points=[],s.fish_trace_type=[],s.fish_trace_time=[];for(var o=0;i>o;o++){s.fish_trace_type.push(2),s.fish_trace_time.push(t.fish_paths[o].time);var a=s.points.push(t.fish_paths[o].pstart.GetGlobalPosForExport());Object.defineProperty(s.points[a-1],"$hashCode",{enumerable:!1}),a=s.points.push(t.fish_paths[o].pp1.GetGlobalPosForExport()),Object.defineProperty(s.points[a-1],"$hashCode",{enumerable:!1}),a=s.points.push(t.fish_paths[o].pp2.GetGlobalPosForExport()),Object.defineProperty(s.points[a-1],"$hashCode",{enumerable:!1}),a=s.points.push(t.fish_paths[o].pend.GetGlobalPosForExport()),Object.defineProperty(s.points[a-1],"$hashCode",{enumerable:!1})}Object.defineProperty(s,"$hashCode",{enumerable:!1}),FishJsBridge.getInstance().tsCallJsFunc("savejsonfile",JSON.stringify(s));break;case t.fish_editor_btn_import:var h=document.getElementById("file-input"),c=function(e){var i=JSON.parse(e),n=i.fish_trace_type,o=i.points,r=i.fish_trace_time;if(n.length>0){t.fish_ground.removeChildren(),t.fish_paths=[];for(var s=0,a=0,h=n.length;h>a;a++){var c,l,u,p;1==n[a]?(c=t.HandlePoint(o[s++]),l=c,p=t.HandlePoint(o[s++]),u=p):2==n[a]&&(c=t.HandlePoint(o[s++]),l=t.HandlePoint(o[s++]),u=t.HandlePoint(o[s++]),p=t.HandlePoint(o[s++]));var d=new FishPathItem(r[a],"",c,l,u,p);t.fish_paths.push(d),t.fish_ground.addChild(d)}}for(var a=0;a<t.fish_paths.length;a++)t.fish_paths[a].SetPathName("路径"+(a+1))},l=function(e){FishJsBridge.getInstance().tsCallJsFunc("getselectfilecontent","",c)};h.addEventListener("change",l,!1),h.click();break;case t.fish_editor_btn_xmirr:t.MirrorPath(!0,!1);break;case t.fish_editor_btn_ymirr:t.MirrorPath(!1,!0)}},t.prototype.HandlePoint=function(e){return e.x/=2,e.x+=320,e.y/=2,e.y+=160,e},t.prototype.MirrorPath=function(e,t){var i=this;FishPathItem.lastSelected&&(FishPathItem.lastSelected.Select(!1),FishPathItem.lastSelected=null);for(var n=i.stage.stageWidth,o=i.stage.stageHeight,r=[],s=0,a=i.fish_paths.length;a>s;s++){var h=i.fish_paths[s],c=h.width,l=h.height;e&&(h.x=n-h.x-c,h.pstart.x=h.x+c-h.pstart.x,h.pstart.y=h.y+h.pstart.y,h.pp1.x=h.x+c-h.pp1.x,h.pp1.y=h.y+h.pp1.y,h.pp2.x=h.x+c-h.pp2.x,h.pp2.y=h.y+h.pp2.y,h.pend.x=h.x+c-h.pend.x,h.pend.y=h.y+h.pend.y),t&&(h.y=o-h.y-l,h.pstart.y=h.y+l-h.pstart.y,h.pstart.x=h.x+h.pstart.x,h.pp1.y=h.y+l-h.pp1.y,h.pp1.x=h.x+h.pp1.x,h.pp2.y=h.y+l-h.pp2.y,h.pp2.x=h.x+h.pp2.x,h.pend.y=h.y+l-h.pend.y,h.pend.x=h.x+h.pend.x);var u=new FishPathItem(h.time,h.pathName,h.pstart.GetPos(),h.pp1.GetPos(),h.pp2.GetPos(),h.pend.GetPos());r.push(u),i.fish_ground.removeChild(h)}i.fish_paths.splice(0,i.fish_paths.length),i.fish_paths=r;for(var s=0,a=i.fish_paths.length;a>s;s++){var h=i.fish_paths[s];i.fish_ground.addChild(h),h.Update()}},t._instance=null,t}(eui.Component);__reflect(FishPathEditor.prototype,"FishPathEditor");var FishPathItem=function(e){function t(t,i,n,o,r,s,a,h){void 0===a&&(a=null),void 0===h&&(h=null);var c=e.call(this)||this;c.time=1e4,c.selected=!1,c.movingSurface=!1,c.movingPoint=!1,c.movingObject=null,c.moveLocalX=0,c.moveLocalY=0,c.offsetLeft=0,c.offsetTop=0,c.prev=null,c.next=null;var l=c;l.x=0,l.y=0,l.anchorOffsetX=0,l.anchorOffsetY=0,l.prev=a,l.next=h,l.time=t,l.pathName=i,l.pstart=new FishEditorPoint("起点",n),l.pstart.addEventListener(egret.TouchEvent.TOUCH_BEGIN,l.touchBegin,l),l.pstart.addEventListener(egret.TouchEvent.TOUCH_MOVE,l.touchMove,l),l.pstart.addEventListener(egret.TouchEvent.TOUCH_END,l.touchEnd,l),l.addChildAt(l.pstart,3),l.pp1=new FishEditorPoint("控制点1",o),l.pp1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,l.touchBegin,l),l.pp1.addEventListener(egret.TouchEvent.TOUCH_MOVE,l.touchMove,l),l.pp1.addEventListener(egret.TouchEvent.TOUCH_END,l.touchEnd,l),l.addChildAt(l.pp1,3),l.pp2=new FishEditorPoint("控制点2",r),l.pp2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,l.touchBegin,l),l.pp2.addEventListener(egret.TouchEvent.TOUCH_MOVE,l.touchMove,l),l.pp2.addEventListener(egret.TouchEvent.TOUCH_END,l.touchEnd,l),l.addChildAt(l.pp2,3),l.pend=new FishEditorPoint("终点",s),l.pend.addEventListener(egret.TouchEvent.TOUCH_BEGIN,l.touchBegin,l),l.pend.addEventListener(egret.TouchEvent.TOUCH_MOVE,l.touchMove,l),l.pend.addEventListener(egret.TouchEvent.TOUCH_END,l.touchEnd,l),l.addChildAt(l.pend,3),l.Redraw();var u='\n            <e:Skin class="skins.TextInputSkin" minHeight="40" minWidth="300" states="normal,disabled,normalWithPrompt,disabledWithPrompt" xmlns:e="http://ns.egret.com/eui">\n                <e:Rect height="100%" width="100%" fillColor="0xffffff" bottom="3"/>\n                <e:EditableText id="textDisplay" verticalCenter="0" left="0" right="0"\n                                textColor="0x000000" textColor.disabled="0xff0000" width="100%" height="24" size="16" />\n            </e:Skin>\n        ';return l.timeInput=new eui.TextInput,l.timeInput.skinName=u,l.addChild(l.timeInput),l.timeInput.width=50,l.timeInput.height=20,l.timeInput.text=""+t,l.timeInput.anchorOffsetX=0,l.timeInput.anchorOffsetY=l.timeInput.height/2,l.timeLabel=new eui.Label("秒"),l.timeLabel.size=16,l.timeLabel.anchorOffsetX=0,l.timeLabel.anchorOffsetY=l.timeLabel.height/2,l.addChild(l.timeLabel),c}return __extends(t,e),t.prototype.touchBegin=function(e){var i=this,n=e.target;i.moveLocalX=e.localX,i.moveLocalY=e.localY,2==n.type?(i.movingPoint=!1,i.movingSurface=!0):0==n.type&&(i.movingPoint=!0,i.movingSurface=!1),i.movingObject=n,i.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,i.touchMove,i),null!=t.lastSelected&&(t.lastSelected.Select(!1),t.lastSelected.parent.setChildIndex(t.lastSelected,10)),t.lastSelected=i,i.parent.setChildIndex(i,11),i.Select(!0),i.time=+i.timeInput.text},t.prototype.touchMove=function(e){var t=this,i=t.movingObject;t.movingSurface&&2==i.type?(t.x=e.stageX-t.moveLocalX,t.y=e.stageY-t.moveLocalY):t.movingPoint&&0==i.type&&(i.x=e.stageX-t.x,i.y=e.stageY-t.y,t.Redraw())},t.prototype.touchEnd=function(e){var t=this,i=t.movingObject;t.moveLocalX=0,t.moveLocalY=0,t.movingSurface=!1,t.movingPoint=!1,t.movingObject=null,t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),i&&0==i.type&&t.Redraw(),i&&2==i.type},t.prototype.Redraw=function(){var e=this,t=new egret.Point(e.pstart.x,e.pstart.y),i=new egret.Point(e.pp1.x,e.pp1.y),n=new egret.Point(e.pp2.x,e.pp2.y),o=new egret.Point(e.pend.x,e.pend.y),r=Math.min(t.x,i.x,n.x,o.x),s=Math.max(t.x,i.x,n.x,o.x),a=Math.min(t.y,i.y,n.y,o.y),h=Math.max(t.y,i.y,n.y,o.y);e.width=s-r,e.height=h-a,e.offsetLeft=r,e.offsetTop=a,e.s&&e.removeChild(e.s),e.s=new FishEditorSurface(e.pathName,new egret.Rectangle(r,a,e.width,e.height),e.selected?16711680:16777215),e.addChildAt(e.s,0),e.s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBegin,e),e.s.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMove,e),e.s.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEnd,e),e.s.addEventListener(egret.TouchEvent.TOUCH_CANCEL,e.touchEnd,e),e.s.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.touchEnd,e),e.l1&&e.removeChild(e.l1),e.l1=new FishEditorLine(t,i),e.addChildAt(e.l1,1),e.l2&&e.removeChild(e.l2),e.l2=new FishEditorLine(o,n),e.addChildAt(e.l2,1),e.b&&e.removeChild(e.b),e.b=new FishEditorBezier("",t,i,n,o),e.addChildAt(e.b,1),e.timeInput&&(e.timeInput.x=r+e.width/2+50,e.timeInput.y=a+e.height-18),e.timeLabel&&(e.timeLabel.x=e.timeInput.x+e.timeInput.width+5,e.timeLabel.y=a+e.height-20)},t.prototype.Update=function(){var e=this;e.Redraw()},t.prototype.Select=function(e){var t=this;t.selected=e,t.Redraw(),t.time=+t.timeInput.text},t.prototype.LockStart=function(e){},t.prototype.SetPathName=function(e){var t=this;t.pathName=e,t.Redraw()},t.lastSelected=null,t}(egret.DisplayObjectContainer);__reflect(FishPathItem.prototype,"FishPathItem");var FishShowItem=function(e){function t(){var t=e.call(this)||this;t.fishType=0,t.fish=null;var i=t;return i.touchEnabled=!0,i.touchChildren=!1,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishShowItemSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){var e=this;e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},t.prototype.uiResizeHandler=function(){},t.prototype.SetFishInfo=function(e){var t=this;t.fishType=e;var i=FishManager.GetInstance().BuildFish(e,0);i.x=t.width/2,i.y=t.height/2,i.height>50&&(i.scaleX=50/i.height,i.scaleY=50/i.height),i.rotation=45,i.MoveOnly(),t.addChild(i),t.fish=i},t.prototype.ClearFishInfo=function(){var e=this;e.fish&&(e.fish.parent&&e.fish.parent.removeChild(e.fish),FishManager.GetInstance().DestroyFish(e.fish))},t.prototype.Select=function(e){var i=this;e?(null!=t.selectedItem&&t.selectedItem.Select(!1),t.selectedItem=i,i.currentState="big"):i.currentState="small"},t.selectedItem=null,t}(eui.Component);__reflect(FishShowItem.prototype,"FishShowItem");var FishSignItem=function(e){function t(){var t=e.call(this)||this,i=t;return i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishSignItemSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){},t.prototype.uiResizeHandler=function(){},t.prototype.SetItemInfo=function(e,t){var i=this;i.fish_sign_item_title.text=e,i.fish_sign_item_amount.text=t},t}(eui.Component);__reflect(FishSignItem.prototype,"FishSignItem");var FishActivity=function(e){function t(){var t=e.call(this)||this;t.fish_signin_data=null,t.fish_timeoutid_captcha=0,t.fish_timer_captcha=120;var i=t;return i.skinName=FishActivitySkin,i.addEventListener(eui.UIEvent.ADDED_TO_STAGE,i.addToStage,i),i.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,i.removeFromStage,i),t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.addToStage=function(e){var t=this;t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t);var i=FishUtils.EventManager.instance;i.registerOnObject(t,fishServer,FishEvent.USER_DAY_SIGNIN_OPT_REP,t.onUserDaySigninOpt,t),i.enableOnObject(t)},t.prototype.removeFromStage=function(e){var t=this;t.removeEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeFromStage,t);var i=FishUtils.EventManager.instance;i.disableOnObject(t)},t.prototype.onUserDaySigninOpt=function(e){var t=e.data,i=this;2==t.optype&&0==t.result&&(i.fish_sign_btn_get.currentState="disabled",i.fish_sign_item_1.currentState=t.total_day>0?"signed":"unsigned",i.fish_sign_item_2.currentState=t.total_day>1?"signed":"unsigned",i.fish_sign_item_3.currentState=t.total_day>2?"signed":"unsigned",i.fish_sign_item_4.currentState=t.total_day>3?"signed":"unsigned",i.fish_sign_item_5.currentState=t.total_day>4?"signed":"unsigned",i.fish_sign_item_6.currentState=t.total_day>5?"signed":"unsigned",i.fish_sign_item_7.currentState=t.total_day>6?"signed":"unsigned")},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.fish_activity_type_btn_bind.fish_shoptype_label.text="绑定手机",t.fish_activity_type_btn_sign.fish_shoptype_label.text="每日签到",t.fish_activity_input_phone.SetPlaceHolder("请输入手机号"),t.fish_activity_input_captcha.SetPlaceHolder("请输入验证码"),t.fish_activity_input_phone.inputType=egret.TextFieldInputType.TEL,t.fish_activity_input_captcha.inputType=egret.TextFieldInputType.TEL,t.fish_btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_activity_type_btn_bind.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_activity_type_btn_sign.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_activity_btn_captcha.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_activity_btn_bind.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_sign_btn_get.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t);var i=FishUserData.instance;t.fish_activity_type_btn_bind.visible=!i.getItem("isbind",!1)},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_close:break;case t.fish_activity_type_btn_bind:case t.fish_activity_type_btn_sign:return void t.selectType(e.target);case t.fish_sign_btn_get:return void("disabled"!=t.fish_sign_btn_get.currentState&&fishServer.sendDaySigninOptReq(2));case t.fish_activity_btn_captcha:if("disabled"!=t.fish_activity_btn_captcha.currentState){if(""==t.fish_activity_input_phone.text||11!=t.fish_activity_input_phone.text.length)return void FishAlert.instance.show(t.fish_parent,"手机号格式不正确",1);fishWebService.getCode(t.fish_activity_input_phone.text,function(e){0==e?(t.fish_activity_btn_captcha.currentState="disabled",t.fish_timer_captcha=119,t.fish_timeoutid_captcha=egret.setInterval(function(e){var t=e;return t.fish_timer_captcha<1?(egret.clearInterval(t.fish_timeoutid_captcha),t.fish_timeoutid_captcha=0,t.fish_activity_btn_captcha.currentState="up",void(t.fish_activity_btn_captcha.fish_btn_captcha_title.text="重新获取")):void(t.fish_activity_btn_captcha.fish_btn_captcha_title.text=""+t.fish_timer_captcha--)},t,1e3,t)):FishAlert.instance.show(t.fish_parent,"获取验证码失败，可能操作太频繁！",1)})}return;case t.fish_activity_btn_bind:return""==t.fish_activity_input_phone.text||11!=t.fish_activity_input_phone.text.length||""==t.fish_activity_input_captcha.text?void FishAlert.instance.show(t.fish_parent,"手机号或验证码格式不正确！",1):void fishWebService.bindPhone(t.fish_activity_input_phone.text,t.fish_activity_input_captcha.text,function(e){if(0==e.code){var i=FishUserData.instance;i.setItem("isbind",!0),FishAlert.instance.show(t.fish_parent,"绑定成功！",1),fishServer.getBindPhoneReward()}else{var n="未知错误",o=e.code;switch(o){case 2016:n="该手机已经绑定过";break;case 2004:n="找不到该用户";break;case 2017:n="绑定失败";break;case 2024:n="验证码错误"}FishAlert.instance.show(t.fish_parent,"绑定失败！错误："+n,1)}})}t.hide()},t.prototype.selectType=function(e){var t=this;t.fish_activity_type_btn_selected&&(t.fish_activity_type_btn_selected.currentState="up"),e.currentState="downAndSelected",t.fish_activity_type_btn_selected=e,t.fish_activity_panel_bind.visible=e==t.fish_activity_type_btn_bind,t.fish_activity_panel_sign.visible=e==t.fish_activity_type_btn_sign},t.prototype.show=function(t,i){var n=this;e.prototype._show.call(this,t),n.fish_parent=t,n.fish_signin_data=i,n.selectType(n.fish_activity_type_btn_sign),n.fish_sign_item_1.SetItemInfo("第一天","1000"),n.fish_sign_item_2.SetItemInfo("第二天","1200"),n.fish_sign_item_3.SetItemInfo("第三天","1400"),n.fish_sign_item_4.SetItemInfo("第四天","1600"),n.fish_sign_item_5.SetItemInfo("第五天","1800"),n.fish_sign_item_6.SetItemInfo("第六天","2000"),n.fish_sign_item_7.SetItemInfo("第七天","2700"),n.fish_sign_item_1.currentState=n.fish_signin_data.total_day>0?"signed":"unsigned",n.fish_sign_item_2.currentState=n.fish_signin_data.total_day>1?"signed":"unsigned",n.fish_sign_item_3.currentState=n.fish_signin_data.total_day>2?"signed":"unsigned",n.fish_sign_item_4.currentState=n.fish_signin_data.total_day>3?"signed":"unsigned",n.fish_sign_item_5.currentState=n.fish_signin_data.total_day>4?"signed":"unsigned",n.fish_sign_item_6.currentState=n.fish_signin_data.total_day>5?"signed":"unsigned",n.fish_sign_item_7.currentState=n.fish_signin_data.total_day>6?"signed":"unsigned",n.fish_sign_btn_get.currentState=1==n.fish_signin_data.today?"disabled":"normal",n.fish_activity_input_phone.text="",n.fish_activity_input_captcha.text=""},t.prototype.hide=function(){var t=this;e.prototype._hide.call(this,function(e){},t)},t}(FishPanelBase);__reflect(FishActivity.prototype,"FishActivity");var FishBezier=function(){function e(e,t,i,n,o){var r=this;r.ReuseBezier(e,t,i,n,o)}return e.prototype.ReuseBezier=function(e,t,i,n,o){var r=this;r.time=e,r.start=t,r.p1=i,r.p2=n,r.end=o},e}();__reflect(FishBezier.prototype,"FishBezier");var FishBezierManager=function(){function e(){}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){FishObjectPool.registerPool("bezier_pool_key",function(e,t,i,n,o){return new FishBezier(e,t,i,n,o)},function(e,t,i,n,o,r){e.ReuseBezier(t,i,n,o,r)})},e.prototype.BuildBezier=function(e,t,i,n,o){return FishObjectPool.getObject("bezier_pool_key",e,t,i,n,o)},e.prototype.DestroyBezier=function(e){FishObjectPool.recycleObject("bezier_pool_key",e)},e._instance=null,e}();__reflect(FishBezierManager.prototype,"FishBezierManager");var FishActor=function(e){function t(i,n){var o=e.call(this)||this;o.mc=null,o.shadow=null,o.tween=null,o.explode=!1,o.timeoutId=0,o.enableShadow=!0,o.catchedByCanonViewId=0,o.goldNumber=0,o.redPacket=0,o.p2Body=null,o.trace=[],o.passTime=0;var r=o;if(r.touchChildren=!1,r.touchEnabled=!1,null==t.colorFlilter){var s=[1,0,0,0,0,0,.5,0,0,0,0,0,.5,0,0,0,0,0,1,0];t.colorFlilter=new egret.ColorMatrixFilter(s),s=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t.grayFlilter=new egret.ColorMatrixFilter(s)}r.fishType=i;for(var a=0,h=FishTypes.typeConfigs.length;h>a;a++)FishTypes.typeConfigs[a].typeid==r.fishType&&(r.fishMultiple=FishTypes.typeConfigs[a].multiple);return r.mc=r.makeMCByType(i),r.addChild(r.mc),r.mc.addEventListener(egret.Event.COMPLETE,function(e){var t=FishCannonManager.GetInstance().GetCannon(r.catchedByCanonViewId);if(t){if(r.goldNumber>0){var i=1;r.catchedByCanonViewId!=FishPhysics.GetInstance().selfViewId&&(i=0);var n=FishCoinManager.GetInstance().BuildCoin(i,r.fishType);n.Move(500,egret.Point.create(r.x-(200*Math.random()-100),r.y-(200*Math.random()-100)),egret.Point.create(t.x,t.y),r.goldNumber,r.fishMultiple>=30),r.parent&&r.parent.addChild(n)}if(0!=r.redPacket){var o=new FishRedpacket;o.x=r.x,o.y=r.y,r.parent&&(r.parent.addChild(o),o.Fly(egret.Point.create(r.x,r.y),egret.Point.create(t.x,t.y)))}}egret.setTimeout(function(e){var t=e;t.parent&&(t.enableShadow&&t.parent.removeChild(t.shadow),t.parent.removeChild(t)),FishManager.GetInstance().DestroyFish(t)},r,300,r)},r),r.enableShadow&&(r.shadow=r.makeMCByType(i,!0),r.shadow.anchorOffsetX=r.shadow.$getWidth()/2,r.shadow.anchorOffsetY=r.shadow.$getHeight()/2,r.shadow.frameRate=9),r.p2Body=FishPhysics.GetInstance().AddPhysicalBodyForFish(r),r.ReuseFish(n),o}return __extends(t,e),t.prototype.IsFish=function(){return!0},t.prototype.IsBullet=function(){return!1},t.prototype.Object=function(){return this},t.prototype.P2Body=function(){return this.p2Body},t.prototype.ResetP2Body=function(){this.p2Body=null},t.prototype.ReuseFish=function(e){var t=this;t.fishId=e,t.trace=[],t.passTime=0,t.explode=!0,t.catchedByCanonViewId=0,t.goldNumber=0,t.redPacket=0,t.filters=[],t.scaleX=1,t.scaleY=1,t.enableShadow=!0,t.shadow&&(t.shadow.x=-200,t.shadow.y=-200)},t.prototype.Destroy=function(){},t.InitStaticResource=function(){if(null==t.mcDataFactory0_7){var e=RES.getRes("fish0_7_json"),i=RES.getRes("fish0_7_png");t.mcDataFactory0_7=new egret.MovieClipDataFactory(e,i)}if(null==t.mcDataFactory8_11){var e=RES.getRes("fish8_11_json"),i=RES.getRes("fish8_11_png");t.mcDataFactory8_11=new egret.MovieClipDataFactory(e,i)}if(null==t.mcDataFactory12_14){var e=RES.getRes("fish12_14_json"),i=RES.getRes("fish12_14_png");t.mcDataFactory12_14=new egret.MovieClipDataFactory(e,i)}if(null==t.mcDataFactory17_21){var e=RES.getRes("fish17_21_json"),i=RES.getRes("fish17_21_png");t.mcDataFactory17_21=new egret.MovieClipDataFactory(e,i)}if(null==t.mcDataFactory15){var e=RES.getRes("fish15_json"),i=RES.getRes("fish15_png");t.mcDataFactory15=new egret.MovieClipDataFactory(e,i)}if(null==t.mcDataFactory16){var e=RES.getRes("fish16_json"),i=RES.getRes("fish16_png");t.mcDataFactory16=new egret.MovieClipDataFactory(e,i)}},t.prototype.makeMCByType=function(e,i){void 0===i&&(i=!1);var n=null;7>=e?n=t.mcDataFactory0_7:11>=e?n=t.mcDataFactory8_11:14>=e?n=t.mcDataFactory12_14:e>=17?n=t.mcDataFactory17_21:15==e?n=t.mcDataFactory15:16==e&&(n=t.mcDataFactory16);var o="";o=10>e?"fish_0"+e:"fish_"+e,i&&(o+="_shadow");var r=n.generateMovieClipData(o),s=new egret.MovieClip(r);return s.anchorOffsetX=s.$getWidth()/2,s.anchorOffsetY=s.$getHeight()/2,s.frameRate=9,s.touchEnabled=!1,s},t.prototype.Move=function(e,t,i,n,o){var r=this;r.p2Body.wakeUp(),r.p2Body.position=[i.x,i.y],r.explode=!1,r.x=t.x,r.y=t.y,r.enableShadow&&r.parent&&(r.shadow.x=r.x,r.shadow.y=r.y,r.shadow.gotoAndPlay("move",-1),r.parent&&r.parent.addChildAt(r.shadow,0)),r.mc.gotoAndPlay("move",-1),r.trace.push(FishBezierManager.GetInstance().BuildBezier(e,t,i,n,o))},t.prototype.MoveToTrace=function(e,t){void 0===t&&(t=0);var i=this;i.trace=[];var n=e.fish_trace_type,o=e.points,r=e.fish_trace_time;i.passTime=t;var s=0;if(n.length>0){for(var a=0,h=0,c=n.length;c>h;h++){if(1==n[h]){var l=i.HandlePoint(o[a++]),u=i.HandlePoint(o[a++]);i.trace.push(FishBezierManager.GetInstance().BuildBezier(r[h],l,l,u,u))}else{if(2!=n[h])continue;var l=i.HandlePoint(o[a++]),p=i.HandlePoint(o[a++]),d=i.HandlePoint(o[a++]),u=i.HandlePoint(o[a++]);i.trace.push(FishBezierManager.GetInstance().BuildBezier(r[h],l,p,d,u))}s+=r[h]}return t>=s?(i.trace=[],i.passTime=0,void FishManager.GetInstance().DestroyFish(i)):(i.p2Body.wakeUp(),i.explode=!1,i.enableShadow&&i.parent&&(i.shadow.gotoAndPlay("move",-1),i.parent&&i.parent.addChildAt(i.shadow,0)),i.mc.gotoAndPlay("move",-1),void i.MoveToTraceImpl())}FishManager.GetInstance().DestroyFish(i)},t.prototype.MoveToTraceImpl=function(){var e=this;if(0==e.trace.length)return e.parent&&(e.enableShadow&&e.parent.removeChild(e.shadow),e.parent.removeChild(e)),void FishManager.GetInstance().DestroyFish(e);var t=e.trace.shift();if(e.passTime>=t.time)return e.passTime-=t.time,void e.MoveToTraceImpl();e.explode=!1,e.x=t.start.x,e.y=t.start.y,t.start.x>0&&t.start.x<e.stage.stageWidth&&t.start.y>0&&t.start.y<e.stage.stageHeight;var i=TweenMax.to(e,t.time,{bezier:{type:"cubic",values:[{x:t.start.x,y:t.start.y},{x:t.p1.x,y:t.p1.y},{x:t.p2.x,y:t.p2.y},{x:t.end.x,y:t.end.y}],autoRotate:90},ease:Linear.easeNone}).progress(e.passTime/t.time);i.eventCallback("onComplete",function(e,t){var i=e;i.passTime=0,FishBezierManager.GetInstance().DestroyBezier(t),i.trace.length>0?(TweenMax.killTweensOf(i),i.MoveToTraceImpl()):(i.explode=!0,i.parent&&(i.enableShadow&&i.parent.removeChild(i.shadow),i.parent.removeChild(i)),TweenMax.killTweensOf(i),FishManager.GetInstance().DestroyFish(i))},[e,t],e),i.eventCallback("onUpdate",function(e){var t=e;if(t.p2Body.position=[t.x,t.y],t.p2Body.angle=t.rotation*Math.PI/180,t.enableShadow){var i=180*-Math.atan2(t.y- -300,t.x- -300)/Math.PI+90;t.shadow.rotation=t.rotation,t.shadow.x=t.x+50*Math.cos((90-i)*Math.PI/180),t.shadow.y=t.y+50*Math.sin((90-i)*Math.PI/180)}},[e],e)},t.prototype.MoveOnly=function(){var e=this;e.explode=!1,e.enableShadow=!1,e.mc.gotoAndPlay("move",-1)},t.prototype.StopMove=function(){var e=this;e.explode=!0,e.p2Body.sleep(),TweenMax.killTweensOf(e),e.mc.stop(),e.trace=[],e.passTime=0,e.enableShadow&&(e.shadow.stop(),e.shadow.parent&&e.shadow.parent.removeChild(e.shadow))},t.prototype.Beat=function(){var e=this;e.filters=[t.colorFlilter],0!=e.timeoutId&&egret.clearTimeout(e.timeoutId),e.timeoutId=egret.setTimeout(function(e){var t=e;t.filters=[],t.timeoutId=0},e,500,e)},t.prototype.Explode=function(e,i,n){void 0===n&&(n=0);var o=this;o.p2Body.sleep(),o.explode=!0,egret.clearTimeout(o.timeoutId),o.timeoutId=0,o.filters=[t.grayFlilter],o.catchedByCanonViewId=e,o.goldNumber=i,o.redPacket=n,o.mc.gotoAndPlay("die",2),o.enableShadow&&o.shadow.gotoAndPlay("die",2),TweenMax.killTweensOf(o),FishSoundManager.GetInstance().PlayCatch(o.GetFishType())},t.prototype.GetFishType=function(){var e=this;return e.fishType},t.prototype.GetFishID=function(){var e=this;return e.fishId},t.prototype.HandlePoint=function(e){var t=this,i=e;return fishServer.seatid>2&&(i.x=t.stage.stageWidth-e.x,i.y=t.stage.stageHeight-e.y),i},t.colorFlilter=null,t.grayFlilter=null,t.glowFilter=null,t.mcDataFactory0_7=null,t.mcDataFactory8_11=null,t.mcDataFactory12_14=null,t.mcDataFactory15=null,t.mcDataFactory16=null,t.mcDataFactory17_21=null,t}(FishObject);__reflect(FishActor.prototype,"FishActor");var FishManager=function(){function e(){this.fishes=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){for(var e=this,t=0;FISH_TYPE_COUNT>=t;t++){FishObjectPool.registerPool("fish_pool_key_"+t,function(e,t){return new FishActor(e,t)},function(e,t,i){e.ReuseFish(i)});for(var i=0;10>i;i++)e.DestroyFish(e.BuildFish(t,0))}},e.prototype.BuildFish=function(e,t){var i=this,n=FishObjectPool.getObject("fish_pool_key_"+e,e,t);return i.AddFish(n),n},e.prototype.DestroyFish=function(e){var t=this;e&&(e.StopMove(),e.parent&&e.parent.removeChild(e),e.x=-200,e.y=-200,t.RemoveFish(e),FishObjectPool.recycleObject("fish_pool_key_"+e.GetFishType(),e))},e.prototype.AddFish=function(e){var t=this;t.fishes.push(e)},e.prototype.RemoveFish=function(e){var t=this,i=t.fishes.indexOf(e,0);-1!=i&&t.fishes.splice(i,1)},e.prototype.GetFishes=function(){var e=this;return e.fishes},e.prototype.GetFishByID=function(e){for(var t=this,i=0,n=t.fishes.length;n>i;i++){var o=t.fishes[i];if(o.GetFishID()==e)return o}return null},e.prototype.ClearAllFishes=function(){for(var e=this,t=0,i=e.fishes.length;i>t;t++){var n=e.fishes[t];n.StopMove(),n&&n.parent&&n.parent.removeChild(n)}e.fishes.splice(0,e.fishes.length)},e._instance=null,e}();__reflect(FishManager.prototype,"FishManager");var FishAlert=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishAlertSkin,t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.fish_alert_ok.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_alert_ok1.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_alert_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t)},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_alert_ok:case t.fish_alert_ok1:t.callback&&t.callback(!0);break;default:t.callback&&t.callback(!1)}t.hide()},t.prototype.show=function(t,i,n,o,r){void 0===n&&(n=0),void 0===o&&(o=null),void 0===r&&(r="center");var s=this;s.callback=o,s.fish_label_msg.text=i,s.fish_alert_ok.visible=0==n,s.fish_alert_cancel.visible=0==n,s.fish_alert_ok1.visible=1==n,e.prototype._show.call(this,t)},t.prototype.hide=function(){e.prototype._hide.call(this)},t}(FishPanelBase);__reflect(FishAlert.prototype,"FishAlert");var FishAssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(FishAssetAdapter.prototype,"FishAssetAdapter",["eui.IAssetAdapter"]);var FishMain=function(e){function t(i){var n=e.call(this)||this;n.isThemeLoadEnd=!1,n.isResourceLoadEnd=!1,n.loginData={uid:0,token:""},n.isThemeLoadEnd=!1,n.isResourceLoadEnd=!1;return t._instance=n,!FISH_MODE_INDEPENDENT&&i&&fishServer.initFromParams(i),n}return __extends(t,e),t.GetInstance=function(){return t._instance},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;this.stage.setContentSize(1280,720),FISH_MODE_INDEPENDENT&&(console.log=function(){});var i=new FishAssetAdapter;if(egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new FishThemeAdapter),FishJsBridge.getInstance(),FISH_MODE_MICROCLIENT){RES.setMaxLoadingThread(8);var n={};n.wxAppId="wx8b9e89cb045df35b",FishNativeBridge.getInstance().CallNative("initNativeGame",JSON.stringify(n));var o=new FishLogin(function(e,t){FishNativeBridge.getInstance().CallNative("loginByWechat","")},t);t.addChildAt(o,0)}else t.loadGame()},t.prototype.loadGame=function(){var e=this;e.loadingView=new FishLoading(function(e){var t=e;RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,t.onConfigComplete,t),RES.loadConfig("resource/fish.default.res.json","resource/")},e),e.stage.addChild(e.loadingView)},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/fish.default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("fish_preload",0)},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"fish_preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){var e=this;if(e.isThemeLoadEnd&&e.isResourceLoadEnd){if(FISH_MODE_EDITOR){FishJsBridge.getInstance().tsCallJsFunc("settitle",FISH_GAME_NAME+" "+FISH_MODE_EDITOR_TITLE);var t=new FishPathEditor;return e.addChildAt(t,0),void e.stage.removeChild(e.loadingView)}if(FISH_MODE_INDEPENDENT){FishJsBridge.getInstance().tsCallJsFunc("settitle",FISH_GAME_NAME+" "+FISH_VERSION),egret.ImageLoader.crossOrigin="anonymous",FishUtils.GameConfig.init(),FishUserData.instance.loadData(),FishUtils.localStorage.init("ddz");var i=FishUtils.EventManager.instance;i.registerOnObject(e,fishServer,FishEvent.USER_LOGIN_RESPONSE,e.onLoginResponse,e),i.registerOnObject(e,fishServer,FishEvent.CONNECT_SERVER,e.onConnectToServer,e),i.registerOnObject(e,fishServer,FishEvent.USER_CHECK_RECONNECT_REP,e.onCheckReconnectRep,e),i.enableOnObject(e),e.loadingView.setLoadingText("正在获取配置..."),FishUtils.GameConfig.getUrl(function(){if(fishServer.ready(),e.loadingView.setLoadingText("微信认证中."),FISH_MODE_WXMP){var t=FishUtils.localStorage.getItem("wx_login_code_wechat");if(t&&"null"!=t&&!FishUtils.Native.instance.isNative)if(FishUtils.Native.instance.isWXMP=!0,window.top.isWXReady())e.loadingView.setLoadingText("微信认证中.."),e.onWXReadyCallInit(),e.doWebWXLogin();else{var i=e;i.loadingView.setLoadingText("微信认证中...");var n=egret.getTimer(),o=egret.setInterval(function(e,t){(window.top.isWXReady()||egret.getTimer()-n>3e3)&&(egret.clearInterval(t),e.onWXReadyCallInit(),e.doWebWXLogin())},e,1e3,e,o)}else e.loadingView.setLoadingText("微信认证异常，请重试:"+t)}else fishWebService.fastLogin(e.onVerifyLoginResponse.bind(e))})}else{var i=FishUtils.EventManager.instance;i.registerOnObject(e,fishServer,FishEvent.USER_CHECK_RECONNECT_REP,e.onCheckReconnectRep,e),i.enableOnObject(e),egret.ImageLoader.crossOrigin="anonymous",FishUtils.GameConfig.init(),FishUserData.instance.loadData(),fishServer.ready(),fishServer.checkReconnect()}}},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"fish_preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(e){void 0===e&&(e=0);var t=this,i=FishUtils.EventManager.instance;
i.disableOnObject(this);var n=new FishScene(t.loginData,e);this.addChildAt(n,0),n.visible=!1,egret.setTimeout(function(e,t){t.visible=!0,FishJsBridge.getInstance().tsCallJsFunc("setstyle"),e.stage.removeChild(e.loadingView)},this,500,this,n)},t.prototype.onVerifyLoginResponse=function(e){var t=this;if(t.loadingView.setLoadingText("微信认证结果:"+e),e)if(e.hasOwnProperty("code")){var i=e.code;0==i?t.tryLogin(e.data):(console.log(langFish.loginError[i]+" "+JSON.stringify(e.data)),t.loadingView.setLoadingText("微信认证失败，请重试"))}else t.tryLogin(e);else t.loadingView.setLoadingText("微信认证失败，请重试..")},t.prototype.tryLogin=function(e){var t=this;this.loginData=e;var i=FishUserData.instance;i.setItem("uid",this.loginData.uid),i.setItem("sk",this.loginData.sk),i.setItem("username",this.loginData.username),i.setItem("type",this.loginData.type),i.setItem("token",FishUtils.Native.instance.isNative?this.loginData.token:this.loginData.token,!0),i.setItem("isbind",this.loginData.is_bind),i.setItem("server",this.loginData.server),FishUtils.GameConfig.SERVER_URL=this.loginData.server,FishUtils.GameConfig.init_SERVER_URL_TAIL(),t.loadingView.setLoadingText("连接游戏服务器.."),fishServer.tryConnect(this.loginData.uid)},t.prototype.doWebWXLogin=function(){var e=this,t=FishUtils.Native.instance,i=t.getUrlArg(),n=i.wx_code;if(n&&"null"!=n){e.loadingView.setLoadingText("微信认证中....");var o=FishUtils.localStorage.getItem("wx_login_code_wechat_sk");o||(o=""),fishWebService.loginByWxFromWechat(n,o,e.onVerifyLoginResponse.bind(e))}},t.prototype.onConnectToServer=function(e){var t=this;t.loadingView.setLoadingText("正在登录..."),fishServer.login(this.loginData.uid,this.loginData.token)},t.prototype.onLoginResponse=function(e){var t=this,i=e.data;JSON.stringify(i);switch(i.code){case 0:t.loadingView.setLoadingText("正在进入游戏..."),FishUtils.Native.instance.userLogin(fishServer.uid,t.loginData.token),fishServer.checkReconnect();break;default:t.loadingView.setLoadingText("登录失败，请重试"),fishServer.close()}},t.prototype.onCheckReconnectRep=function(e){var t=this,i=e.data;console.log("onCheckReconnectRep===========>",i),0==i.roomid?t.startCreateScene():t.startCreateScene(i.session)},t.prototype.onWXReadyCallInit=function(){var e=FishUtils.Native.instance;e.isNative||(e.initWXFunc(),e.wxConfig(),e.setShareParam())},t._instance=null,t}(eui.UILayer);__reflect(FishMain.prototype,"FishMain");var FishBullet=function(e){function t(t,i,n){var o=e.call(this)||this;o.explode=!0,o.lastTime=0,o.duration=0,o.fromCannon=0,o.lastDetectionIndex=0,o.p2Body=null,o.bulletId=0;var r=o;r.touchChildren=!1,r.touchEnabled=!1,r.bulletId=i,r.fromCannon=n;var s=new egret.Bitmap,a=RES.getRes("zidan");return r.width=a.textureWidth,r.height=a.textureHeight,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,s.texture=a,r.addChild(s),r.speed=egret.Point.create(0,0),r.p2Body=FishPhysics.GetInstance().AddPhysicalBodyForBullet(r),o}return __extends(t,e),t.prototype.IsFish=function(){return!1},t.prototype.IsBullet=function(){return!0},t.prototype.Object=function(){return this},t.prototype.P2Body=function(){return this.p2Body},t.prototype.ResetP2Body=function(){this.p2Body=null},t.prototype.ReuseBullet=function(e,t){var i=this;i.duration=0,i.lastTime=0,i.fromCannon=t,i.explode=!0,i.bulletId=e},t.prototype.CalculateRotation=function(e,t){var i=180*-Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90;return i},t.prototype.Move=function(e,t,i){void 0===i&&(i=1200);var n=this;n.startPoint=e,n.endPoint=t,n.x=e.x,n.y=e.y,n.lastTime=egret.getTimer();var o=n.CalculateRotation(e,t);n.rotation=o+90,n.speed.x=Math.cos((90-o)*Math.PI/180)*i/1e3,n.speed.y=Math.sin((90-o)*Math.PI/180)*i/1e3,egret.startTick(n.moveBullet,n)},t.prototype.MoveToAngle=function(e,t,i){void 0===i&&(i=1200);var n=this;n.p2Body.wakeUp(),n.p2Body.position=[e.x,e.y],n.startPoint=e,n.x=e.x,n.y=e.y,n.lastTime=egret.getTimer(),n.rotation=t+90,n.speed.x=Math.cos(t*Math.PI/180)*i/1e3,n.speed.y=Math.sin(t*Math.PI/180)*i/1e3,egret.startTick(n.moveBullet,n)},t.prototype.StopMove=function(){var e=this;e.explode=!0,e.p2Body.sleep(),egret.stopTick(e.moveBullet,e)},t.prototype.Explode=function(){var e=this;e.explode=!0,e.p2Body.sleep();var t=FishNetManager.GetInstance().BuildNet(1);t.Explode(egret.Point.create(e.x,e.y),e.parent),egret.stopTick(e.moveBullet,e),e.parent&&e.parent.removeChild(e),FishBulletManager.GetInstance().DestroyBullet(e)},t.prototype.moveBullet=function(e){var t=this;if(null==t.stage)return egret.stopTick(t.moveBullet,t),t.parent&&t.parent.removeChild(t),!0;var i=e,n=t.lastTime,o=i-n;0!=t.lastTime&&(t.duration+=o);var r=t.x,s=t.y;t.x+=t.speed.x*o,t.y+=t.speed.y*o;var a=!0,h=!1;return t.x>t.stage.stageWidth&&(t.speed.x*=-1,r=t.stage.stageWidth+(t.stage.stageWidth-r),t.x=t.stage.stageWidth-(t.x-t.stage.stageWidth),h=a=!0),t.x<0&&(t.speed.x*=-1,r*=-1,t.x*=-1,h=a=!0),t.y>t.stage.stageHeight&&(t.speed.y*=-1,s=t.stage.stageHeight+(t.stage.stageHeight-s),t.y=t.stage.stageHeight-(t.y-t.stage.stageHeight),h=a=!0),t.y<0&&(t.speed.y*=-1,s*=-1,t.y*=-1,h=a=!0),a&&(t.rotation=90-t.CalculateRotation(egret.Point.create(r,s),egret.Point.create(t.x,t.y))+90),t.p2Body.position=[t.x,t.y],t.duration>100&&(t.explode=!1),t.lastTime=i,!1},t.prototype.GetFromCannon=function(){return this.fromCannon},t.prototype.GetBulletID=function(){return this.bulletId},t}(FishObject);__reflect(FishBullet.prototype,"FishBullet");var FishBulletManager=function(){function e(){this.bullets=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){var e=this;FishObjectPool.registerPool("bullet_pool_key",function(e,t,i){return new FishBullet(e,t,i)},function(e,t,i,n){e.ReuseBullet(i,n)});for(var t=0;10>t;t++)e.DestroyBullet(e.BuildBullet(0,0,0))},e.prototype.BuildBullet=function(e,t,i){var n=this,o=FishObjectPool.getObject("bullet_pool_key",e,t,i);return n.bullets.push(o),o},e.prototype.DestroyBullet=function(e){var t=this;if(e){e.StopMove(),e.parent&&e.parent.removeChild(e);var i=t.bullets.indexOf(e,0);-1!=i&&t.bullets.splice(i,1),FishObjectPool.recycleObject("bullet_pool_key",e)}},e.prototype.ClearAllBullet=function(){for(var e=this,t=0,i=e.bullets.length;i>t;t++)e.DestroyBullet(e.bullets[t])},e._instance=null,e}();__reflect(FishBulletManager.prototype,"FishBulletManager");var FishBtnRedpacket=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishRedPacketButtonSkin,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.showRedGrp(!1)},t.prototype.showRedGrp=function(e){this.redGrp.visible=e},t.prototype.setNum=function(e){this.fish_redpacket.text=""+e},t.prototype.getNum=function(){return Number(this.fish_redpacket.text)},t.prototype.updateNum=function(e){var t=!0;0>=e&&(t=!1),this.setNum(e),this.showRedGrp(t)},t}(eui.Button);__reflect(FishBtnRedpacket.prototype,"FishBtnRedpacket");var FishBtnShopType=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishShopTypeButtonSkin,t}return __extends(t,e),t}(eui.Button);__reflect(FishBtnShopType.prototype,"FishBtnShopType");var FishBtnCaptcha=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishCaptchaButtonSkin,t}return __extends(t,e),t}(eui.Button);__reflect(FishBtnCaptcha.prototype,"FishBtnCaptcha");var FishJsBridge=function(){function e(){if(e.instance)throw new egret.error("FishJsBridge is a singleton class.");this.init()}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.init()),e.instance},e.prototype.init=function(){window.platformInstance=e.instance},e.prototype.jsCallTsFunc=function(e){switch(e){case"beforeunload":fishServer.close();break;case"getversion":return FISH_VERSION}return""},e.prototype.tsCallJsFunc=function(e,t,i){return void 0===t&&(t=""),void 0===i&&(i=null),FISH_MODE_INDEPENDENT?FISH_MODE_MICROCLIENT?"":callJSFunction(e,t,i):""},e.instance=null,e}();__reflect(FishJsBridge.prototype,"FishJsBridge");var FishCaustic=function(e){function t(){var i=e.call(this)||this;i.mcs=[];var n=i;if(n.touchChildren=!1,n.touchEnabled=!1,null==t.mcdatacaustic){var o=RES.getRes("caustic_json"),r=RES.getRes("caustic_png"),s=new egret.MovieClipDataFactory(o,r);t.mcdatacaustic=s.generateMovieClipData("caustic")}for(var a=0;15>a;a++){var h=new egret.MovieClip(t.mcdatacaustic);h.frameRate=5,n.mcs.push(h)}return i}return __extends(t,e),t.prototype.Move=function(){var e=this;e.width=e.stage.stageWidth,e.height=e.stage.stageHeight,e.x=0,e.y=0;for(var t=0,i=e.mcs.length;i>t;t++){var n=e.mcs[t];n.x=t%5*256,n.y=256*Math.floor(t/5),e.addChild(n);var o=200*n.totalFrames;n.alpha=0,egret.Tween.get(n,{loop:!0}).wait(2e3*Math.random()).call(function(e){e.gotoAndPlay("move")},e,[n]).to({alpha:1},o/2).to({alpha:0},o/2)}},t.mcdatacaustic=null,t}(egret.DisplayObjectContainer);__reflect(FishCaustic.prototype,"FishCaustic");var FishCoin=function(e){function t(i,n){var o=e.call(this)||this;o.mc=null,o.tween=null,o.mcs=[],o.cointype=0,o.bg=null;var r=o;if(r.touchChildren=!1,r.touchEnabled=!1,r.cointype=i,r.bg=new egret.Bitmap,r.bg.texture=RES.getRes("fish_gold_fx"),r.bg.anchorOffsetX=r.bg.width/2,r.bg.anchorOffsetY=r.bg.height/2,r.bg.visible=!1,r.addChild(r.bg),null==t.mcdatagold||null==t.mcdatasliver){var s=RES.getRes("fish_coin_json"),a=RES.getRes("fish_coin_png"),h=new egret.MovieClipDataFactory(s,a);t.mcdatagold=h.generateMovieClipData("gold"),t.mcdatasliver=h.generateMovieClipData("sliver")}for(var c=0;n>c;c++){var l=null;l=1==i?new egret.MovieClip(t.mcdatagold):new egret.MovieClip(t.mcdatasliver),r.mcs.push(l),r.addChild(l)}return r.width=r.mcs[0].width,r.height=r.mcs[0].height,r.anchorOffsetX=r.$getWidth()/2,r.anchorOffsetY=r.$getHeight()/2,o}return __extends(t,e),t.prototype.ReuseCoin=function(){},t.prototype.Move=function(e,t,i,n,o){void 0===o&&(o=!1);var r=this,s=r.mcs.length,a=40,h=2;s>=8&&(h=4),o&&(r.bg.x=t.x,r.bg.y=t.y,r.bg.scaleX=.5,r.bg.scaleY=.5,r.bg.alpha=1,r.bg.visible=!0,egret.Tween.get(r.bg,{loop:!1}).to({scaleX:1,scaleY:1,alpha:.2},600,egret.Ease.bounceIn).call(function(e){e.visible=!1},r,[r.bg]));var c=FishCoinNumberManager.GetInstance().BuildCoinNumber(n,0==r.cointype);c.x=t.x,c.y=t.y,c.scaleX=.5,c.scaleY=.5,r.addChild(c),egret.Tween.get(c).to({scaleX:1,scaleY:1},400,egret.Ease.bounceOut);for(var l=0;s>l;l++){r.mcs[l].alpha=.1,r.mcs[l].x=t.x,r.mcs[l].y=t.y,r.mcs[l].gotoAndPlay("fly",-1);var u=t.x+Math.random()*(2*a)-a,p=t.y+Math.random()*(2*a)-a;egret.Tween.get(r.mcs[l]).to({x:u,y:p,alpha:1},200,egret.Ease.cubicIn).to({y:p-60},200,egret.Ease.bounceOut).wait(20*l).call(function(e){e.gotoAndStop("fly")},r,[r.mcs[l]]).to({x:t.x-l%h*30,y:t.y-30*Math.floor(l/h)},200,egret.Ease.bounceIn).wait(20*s+50*Math.floor(l/h)).to({x:t.x}).to({x:i.x,y:i.y},300,egret.Ease.bounceInOut).call(function(e,t,i){if(t){var n=i;egret.Tween.removeTweens(n),FishCoinNumberManager.GetInstance().DestroyCoinNumber(n);var o=e;FishCoinManager.GetInstance().DestroyCoin(o)}},r,[r,l==s-1,c])}},t.prototype.StopMove=function(){for(var e=this,t=e.mcs.length,i=0;t>i;i++)egret.Tween.removeTweens(e.mcs[i])},t.prototype.GetCoinCount=function(){var e=this;return e.mcs.length},t.prototype.GetCoinType=function(){var e=this;return e.cointype},t.mcdatagold=null,t.mcdatasliver=null,t}(egret.DisplayObjectContainer);__reflect(FishCoin.prototype,"FishCoin");var FishCoinManager=function(){function e(){this.coins=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){for(var e=this,t=1;4>=t;t++){FishObjectPool.registerPool("coins_pool_key_gold_"+4*t,function(e,t){return new FishCoin(e,t)},function(e,t,i){e.ReuseCoin()});for(var i=0;10>i;i++)e.DestroyCoin(e.BuildCoin(1,4*t))}for(var t=1;4>=t;t++){FishObjectPool.registerPool("coins_pool_key_sliver_"+4*t,function(e,t){return new FishCoin(e,t)},function(e,t,i){e.ReuseCoin()});for(var i=0;10>i;i++)e.DestroyCoin(e.BuildCoin(0,4*t))}},e.prototype.BuildCoin=function(e,t){var i=this;t=4*Math.floor(t/4),t>16?t=16:4>t&&(t=4);var n=null;return n=1==e?FishObjectPool.getObject("coins_pool_key_gold_"+t,e,t):FishObjectPool.getObject("coins_pool_key_sliver_"+t,e,t),i.coins.push(n),n},e.prototype.DestroyCoin=function(e){var t=this;e.StopMove(),e&&e.parent&&e.parent.removeChild(e);var i=t.coins.indexOf(e,0);-1!=i&&t.coins.splice(i,1),1==e.GetCoinType()?FishObjectPool.recycleObject("coins_pool_key_gold_"+e.GetCoinCount(),e):FishObjectPool.recycleObject("coins_pool_key_sliver_"+e.GetCoinCount(),e)},e.prototype.ClearAllCoins=function(){for(var e=this,t=0,i=e.coins.length;i>t;t++)e.DestroyCoin(e.coins[t])},e._instance=null,e}();__reflect(FishCoinManager.prototype,"FishCoinManager");var FishCoinNumber=function(e){function t(i,n){void 0===n&&(n=!0);var o=e.call(this)||this;o.bitmapLabel=null;var r=o;return null==t.fontSelf&&(t.fontSelf=RES.getRes("fish_font_2_fnt")),null==t.fontOther&&(t.fontOther=RES.getRes("fish_font_3_fnt")),r.bitmapLabel=new eui.BitmapLabel(""),r.addChild(r.bitmapLabel),r.ReuseCoinNumber(i,n),o}return __extends(t,e),t.prototype.ReuseCoinNumber=function(e,i){var n=this;i?n.bitmapLabel.font=t.fontOther:n.bitmapLabel.font=t.fontSelf,n.bitmapLabel.text="+"+e,n.bitmapLabel.anchorOffsetX=n.width/2,n.bitmapLabel.anchorOffsetY=n.height/2},t.prototype.Destroy=function(){},t.fontSelf=null,t.fontOther=null,t}(egret.DisplayObjectContainer);__reflect(FishCoinNumber.prototype,"FishCoinNumber");var FishCoinNumberManager=function(){function e(){this.coinNumbers=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){FishObjectPool.registerPool("coinnumber_pool_key",function(e,t){return new FishCoinNumber(e,t)},function(e,t,i){e.ReuseCoinNumber(t,i)})},e.prototype.BuildCoinNumber=function(e,t){var i=this,n=FishObjectPool.getObject("coinnumber_pool_key",e,t);return i.coinNumbers.push(n),n},e.prototype.DestroyCoinNumber=function(e){var t=this;e.Destroy(),e&&e.parent&&e.parent.removeChild(e);var i=t.coinNumbers.indexOf(e,0);-1!=i&&t.coinNumbers.splice(i,1),FishObjectPool.recycleObject("coinnumber_pool_key",e)},e._instance=null,e}();__reflect(FishCoinNumberManager.prototype,"FishCoinNumberManager");var FishBingo=function(e){function t(t,i){void 0===i&&(i=!0);var n=e.call(this)||this;n.bitmapLabel=null,n.bg1=null,n.bg2=null,n.bg3=null;var o=n;return o.bg1=o.loadBitmapFromRes("fx_02"),o.bg1.anchorOffsetX=o.bg1.width/2,o.bg1.anchorOffsetY=o.bg1.height/2,o.addChild(o.bg1),o.bg2=o.loadBitmapFromRes("fx_03"),o.bg2.anchorOffsetX=o.bg2.width/2,o.bg2.anchorOffsetY=o.bg2.height/2,o.addChild(o.bg2),o.bg3=o.loadBitmapFromRes("fx_01"),o.bg3.anchorOffsetX=o.bg3.width/2,o.bg3.anchorOffsetY=o.bg3.height/2,o.addChild(o.bg3),null==FishCoinNumber.fontSelf&&(FishCoinNumber.fontSelf=RES.getRes("fish_font_2_fnt")),null==FishCoinNumber.fontOther&&(FishCoinNumber.fontOther=RES.getRes("fish_font_3_fnt")),o.bitmapLabel=new eui.BitmapLabel(""),o.bitmapLabel.width=o.bg3.width,o.bitmapLabel.height=30,o.bitmapLabel.anchorOffsetX=o.bitmapLabel.width/2,o.bitmapLabel.anchorOffsetY=o.bitmapLabel.height/2,o.addChild(o.bitmapLabel),o.ReuseFishBingo(t,i),n}return __extends(t,e),t.prototype.ReuseFishBingo=function(e,t){var i=this;t?i.bitmapLabel.font=FishCoinNumber.fontOther:i.bitmapLabel.font=FishCoinNumber.fontSelf,10>e?i.bitmapLabel.text="     +"+e:100>e?i.bitmapLabel.text="    +"+e:1e3>e?i.bitmapLabel.text="   +"+e:1e4>e?i.bitmapLabel.text="  +"+e:i.bitmapLabel.text="+"+e,i.scaleX=.8,i.scaleY=.8,i.bg1.rotation=0,i.bg2.rotation=0,i.bg3.rotation=0,i.bg1.alpha=1,i.bg2.alpha=1,i.bg3.alpha=1,i.bg2.scaleX=1,i.bg2.scaleY=1,i.bitmapLabel.rotation=0,i.bitmapLabel.alpha=1},t.prototype.Destroy=function(){},t.prototype.Fire=function(){var e=this,t=3e3;egret.Tween.get(e).to({scaleX:.7,scaleY:.7},t/20,egret.Ease.bounceOut).to({scaleX:1,scaleY:1},t/10,egret.Ease.bounceIn),egret.Tween.get(e.bg1,{loop:!0}).to({rotation:360,alpha:0},t),egret.Tween.get(e.bg2).to({scaleX:1.2,scaleY:1.2,alpha:.1},t/2),egret.Tween.get(e.bg3,{loop:!0}).to({rotation:360,alpha:0},t),egret.Tween.get(e.bitmapLabel).to({rotation:-30,alpha:.8},t/12).to({rotation:60,alpha:.6},t/6).to({rotation:-60,alpha:.4},t/6).to({rotation:60,alpha:.2},t/6).to({rotation:-60,alpha:0},t/6).call(function(e){var t=e;egret.Tween.removeTweens(t.bg1),egret.Tween.removeTweens(t.bg2),egret.Tween.removeTweens(t.bg3),egret.Tween.removeTweens(t.bitmapLabel),FishBingoManager.GetInstance().DestroyBingo(t)},e,[e])},t.prototype.loadBitmapFromRes=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.fontSelf=null,t.fontOther=null,t}(egret.DisplayObjectContainer);__reflect(FishBingo.prototype,"FishBingo");var FishBingoManager=function(){function e(){this.bingos=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){FishObjectPool.registerPool("bingo_pool_key",function(e,t){return new FishBingo(e,t)},function(e,t,i){e.ReuseFishBingo(t,i)})},e.prototype.BuildBingo=function(e,t){var i=this,n=FishObjectPool.getObject("bingo_pool_key",e,t);return i.bingos.push(n),n},e.prototype.DestroyBingo=function(e){var t=this;if(e){e.Destroy(),e&&e.parent&&e.parent.removeChild(e);var i=t.bingos.indexOf(e,0);-1!=i&&t.bingos.splice(i,1),FishObjectPool.recycleObject("bingo_pool_key",e)}},e._instance=null,e}();__reflect(FishBingoManager.prototype,"FishBingoManager");var FishRedpacket=function(e){function t(){var t=e.call(this)||this;t.packet=null;var i=t;return i.packet=i.loadBitmapFromRes("fish_jiangquan"),i.packet.anchorOffsetX=i.packet.width/2,i.packet.anchorOffsetY=i.packet.height/2,i.addChild(i.packet),t}return __extends(t,e),t.prototype.Fly=function(e,t){var i=this;i.x=e.x,i.y=e.y,i.scaleX=2,i.scaleY=2,egret.Tween.get(i,{loop:!0}).to({rotation:-30},200).to({rotation:0},200).to({rotation:30},200).to({rotation:0},200);var n=-160;t.y<50&&(n=160),egret.Tween.get(i).to({x:t.x,y:t.y+n,scaleX:1,scaleY:1},1e3,egret.Ease.cubicInOut).wait(1e3,!0).to({x:t.x,y:t.y,scaleX:.3,scaleY:.3},500,egret.Ease.cubicInOut).call(function(e){var t=e;t.parent&&t.parent.removeChild(t),egret.Tween.removeTweens(t)},i,[i])},t.prototype.loadBitmapFromRes=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t}(egret.DisplayObjectContainer);__reflect(FishRedpacket.prototype,"FishRedpacket");var FISH_MODE_EDITOR=!1,FISH_MODE_EDITOR_TITLE="路径编辑器",FISH_MODE_INDEPENDENT=!1,FISH_MODE_WXMP=!1,FISH_MODE_MICROCLIENT=!1,FISH_DESIGN_WIDTH=1280,FISH_DESIGN_HEIGHT=720,FISH_TYPE_COUNT=22,FISH_USER_COUNT=4,FISH_TAG_FISH=1,FISH_TAG_BULLET=2,FISH_SERVER_TEST="ws://192.168.1.97:9001/ws",FISH_ROOMID_TEST=3002,FISH_CONFIG_URL="http://192.168.0.81/laoqifeng/doudizhu/",FISH_GAME_NAME="触玩捕鱼",FISH_VERSION="v1.1.1(build.10)",FISH_VERSION_DESC="增加切换房间",FISH_USERID_TEST="1694534",FISH_TOKEN_TEST="vsAoleRSj8pQtA7X7AtjAPjpAPXsbSaN",FISH_UUID_TEST="785bd24210674ec64f3e26e8f800293f",FishEvent=function(){function e(){}return e.CLOCK_0="clock0",e.LOG="log",e.SHOW_DISCONNECT="showDisconnect",e.HIDE_DISCONNECT="hideDisconnect",e.CONNECT_SERVER="connectToServer",e.SERVER_CLOSE="serverClose",e.SERVER_ERROR="serverError",e.MY_USER_INFO_UPDATE="myUserInfoUpdate",e.GOLD_UPDATE="goldUpdate",e.USER_USER_INFO_REQUEST="user.UserInfoRequest",e.USER_USER_INFO_RESPONSE="user.UserInfoResonpse",e.USER_LOGIN_RESPONSE="user.loginResponse",e.USER_NOTIFY_KICK_OUT="user.NotifyKickout",e.USER_OPERATE_REP="user.OperateRep",e.USER_CHECK_RECONNECT_REQ="user.CheckReconnectReq",e.USER_CHECK_RECONNECT_REP="user.CheckReconnectRep",e.USER_RECONNECT_TABLE_REQ="user.ReconnectTableReq",e.USER_RECONNECT_TABLE_REP="user.ReconnectTableRep",e.USER_QUICK_JOIN_REQUEST="user.QuickJoinRequest",e.USER_QUICK_JOIN_RESPONSE="user.QuickJoinResonpse",e.GET_FRESHMAN_REWARD_REQ="user.GetFreshManRewardReq",e.GET_FRESHMAN_REWARD_REP="user.GetFreshManRewardRep",e.LOTTERY_REDCOIN_REQ="user.LotteryRedcoinReq",e.LOTTERY_REDCOIN_REP="user.LotteryRedcoinRep",e.USER_BAG_INFO_REQ="user.BagInfoReq",e.USER_BAG_INFO_REP="user.BagInfoRep",e.USER_ALMS_REQ="user.AlmsReq",e.USER_ALMS_REP="user.AlmsRep",e.USER_REDCOIN_EXCHANGE_GOODS_REQ="user.RedcoinExchangeGoodsReq",e.USER_REDCOIN_EXCHANGE_GOODS_REP="user.RedcoinExchangeGoodsRep",e.USER_DAY_SIGNIN_OPT_REQ="user.DaySigninOptReq",e.USER_DAY_SIGNIN_OPT_REP="user.DaySigninOptRep",e.GAME_ENTER_TABLE="game.EnterTable",e.GAME_LEAVE_TABLE="game.LeaveTable",e.GAME_TABLE_INFO="game.TableInfo",e.GAME_SET_SESSION="game.SetSession",e.GAME_USER_ONLINE="game.UserOnline",e.GAME_GAME_END="game.GameEnd",e.GAME_GIVE_UP_GAME_REQ="game.GiveUpGameReq",e.GAME_GIVE_UP_GAME_REP="game.GiveUpGameRep",e.GAME_USER_INFO_IN_GAME_REQ="game.UserInfoInGameReq",e.GAME_USER_INFO_IN_GAME_REP="game.UserInfoInGameRep",e.GAME_FISH_TRACE="game.STCGameFishTrace",e.GAME_FISH_FIRE_REQ="game.CTSGameFishFire",e.GAME_FISH_FIRE_REP="game.STCGameFishFire",e.GAME_FISH_FIRE_FAIL="game.STCGameFishFireFail",e.GAME_FISH_CATCH="game.CTSGameFishCatch",e.GAME_FISH_FISH_OVER="game.STCGameFishOver",e.GAME_FISH_SCENE="game.STCGameFishScreenFish",e.GAME_FISH_CONFIG="game.STCGameFishConfig",e.GAME_FISH_REDCOUNT="game.STCGameFishRedCount",e.GAME_FISH_BIND_PHONE_REWARD_REQ="game.CTSGameFishBindPhoneReward",e.GAME_FISH_BIND_PHONE_REWARD_REP="game.STCGameFishBindPhoneReward",e.GAME_FISH_FRESHEN_GOLD_REQ="game.CTSGameFishFreshenGold",e.GAME_FISH_FRESHEN_GOLD_REP="game.STCGameFishFreshenGold",e}();__reflect(FishEvent.prototype,"FishEvent");var FishInput=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishInputSkin,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.SetPlaceHolder=function(e){var t=this;t.promptDisplay.text=e},t}(eui.TextInput);__reflect(FishInput.prototype,"FishInput");var FishLoading=function(e){function t(t,i){var n=e.call(this)||this;n.callback=null,n.callbackParam=null;var o=n;return o.callback=t,o.callbackParam=i,o.createView(),n}return __extends(t,e),t.prototype.createView=function(){var e=this;RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,e.onConfigComplete,e),RES.loadConfig("resource/fish.loading.res.json","resource/")},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.onThemeLoadComplete=function(){var e=this;e.skinName=FishLoadingSkin,RES.loadGroup("loading",1)},t.prototype.onConfigComplete=function(e){var t=this;RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,t.onConfigComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t);var i=new eui.Theme("resource/fish.loading.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},t.prototype.onResourceLoadComplete=function(e){var t=this;"loading"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),t.fish_loading_bg.source="loading_png",t.callback&&t.callback(t.callbackParam))},t.prototype.setProgress=function(e,t){var i=this;if(i.fish_loading_progress){var n=e/t*100,o=n.toFixed(0);i.fish_loading_progress.text="正在加载("+o+"%)..."}},t.prototype.setLoadingText=function(e){var t=this;t.fish_loading_progress&&(t.fish_loading_progress.text=e)},t}(eui.Component);__reflect(FishLoading.prototype,"FishLoading");var FishLogin=function(e){function t(t,i){var n=e.call(this)||this;n.callback=null,n.callbackParam=null;var o=n;return o.callback=t,o.callbackParam=i,o.createView(),n}return __extends(t,e),t.prototype.createView=function(){var e=this;RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,e.onConfigComplete,e),RES.loadConfig("resource/fish.login.res.json","resource/")},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.onThemeLoadComplete=function(){var e=this;e.skinName=FishLoginSkin,RES.loadGroup("fish_login",1)},t.prototype.onConfigComplete=function(e){var t=this;RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,t.onConfigComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t);var i=new eui.Theme("resource/fish.login.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},t.prototype.onResourceLoadComplete=function(e){var t=this;"fish_login"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),t.fish_login_img_bg.source="fish_wd_login",t.fish_login_img_logo.source="fish_wd_name",t.fish_login_btn_wx.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),FishNativeBridge.getInstance().CallNative("showGameView",""))},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_login_btn_wx:t.callback&&t.callback(t.callbackParam,t)}},t}(eui.Component);__reflect(FishLogin.prototype,"FishLogin");var FishNet=function(e){function t(t){var i=e.call(this)||this;i.mc=null,i.netType=0,i.netBitmap=null;var n=i;if(n.touchChildren=!1,n.touchEnabled=!1,n.netType=t,0==t){var o=RES.getRes("net_json"),r=RES.getRes("net_png"),s=new egret.MovieClipDataFactory(o,r),a=s.generateMovieClipData("net");n.mc=new egret.MovieClip(a),n.mc.anchorOffsetX=n.mc.$getWidth()/2,n.mc.anchorOffsetY=n.mc.$getHeight()/2,n.mc.frameRate=9,n.mc.scaleX=1.5,n.mc.scaleY=1.5,n.mc.touchEnabled=!1,n.mc.addEventListener(egret.Event.COMPLETE,function(e){n.parent&&n.parent.removeChild(n),FishNetManager.GetInstance().DestroyNet(n)},n),n.mc.stop(),n.addChild(n.mc)}else if(1==t){n.netBitmap=new egret.Bitmap;var r=RES.getRes("wang");n.netBitmap.texture=r,n.netBitmap.anchorOffsetX=n.netBitmap.width/2,n.netBitmap.anchorOffsetY=n.netBitmap.height/2,n.addChild(n.netBitmap)}return i}return __extends(t,e),t.prototype.ReuseNet=function(){},t.prototype.Explode=function(e,t){var i=this;i.x=e.x,i.y=e.y,0==i.netType?i.mc.gotoAndPlay("explode",1):1==i.netType&&(i.netBitmap.scaleX=1,i.netBitmap.scaleY=1,i.netBitmap.alpha=1,egret.Tween.get(i.netBitmap).to({scaleX:1.1,scaleY:1.1},200,egret.Ease.backInOut).to({alpha:0},300).call(function(e){var t=e;egret.Tween.removeTweens(t.netBitmap),t.parent&&t.parent.removeChild(t),FishNetManager.GetInstance().DestroyNet(t)},i,[i])),t&&t.addChild(i)},t}(egret.DisplayObjectContainer);__reflect(FishNet.prototype,"FishNet");var FishNetManager=function(){function e(){this.nets=[]}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e,e.GetInstance().InitPool()),e._instance},e.prototype.InitPool=function(){var e=this;FishObjectPool.registerPool("net_pool_key",function(e){return new FishNet(e)},function(e,t){e.ReuseNet()});for(var t=0;10>t;t++)e.DestroyNet(e.BuildNet(1))},e.prototype.BuildNet=function(e){var t=this,i=FishObjectPool.getObject("net_pool_key",e);return t.nets.push(i),i},e.prototype.DestroyNet=function(e){var t=this;if(e){e.parent&&e.parent.removeChild(e);var i=t.nets.indexOf(e,0);-1!=i&&t.nets.splice(i,1),FishObjectPool.recycleObject("net_pool_key",e)}},e.prototype.ClearAllNets=function(){for(var e=this,t=0,i=e.nets.length;i>t;t++)e.DestroyNet(e.nets[t])},e._instance=null,e}();__reflect(FishNetManager.prototype,"FishNetManager");var FishObjectPool=function(){function e(){}return e.registerPool=function(e,t,i){void 0===i&&(i=null),this.createMethods[e]=t,this.initMethods[e]=i,this.pools[e]=[]},e.getObject=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=this.pools[e];if(!n)return console.warn(e+"没有注册在对象池中。"),null;var o;if(n.length>0)o=n.shift();else{var r=this.createMethods[e];o=r.apply(null,t)}var s=this.initMethods[e];return s&&(t.unshift(o),s.apply(null,t)),this.debug(),o},e.recycleObject=function(e,t){if(t){var i=this.pools[e];if(!i)return void console.warn(e+"没有注册在对象池中。");i.indexOf(t)<0&&i.length<=this.MAX&&i.push(t),this.debug()}},e.debug=function(){var e="";for(var t in this.pools){var i=this.pools[t];e+=t+":"+i.length+"\n"}},e.MAX=20,e.createMethods={},e.initMethods={},e.pools={},e}();__reflect(FishObjectPool.prototype,"FishObjectPool");var FishNativeBridge=function(){function e(){if(e.instance)throw new egret.error("FishJsBridge is a singleton class.");this.init()}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.init()),e.instance},e.prototype.init=function(){egret.ExternalInterface.addCallback("OnNativeCalled",this.OnNativeCalled)},e.prototype.CallNative=function(e,t){FISH_MODE_MICROCLIENT&&egret.ExternalInterface.call(e,t)},e.prototype.OnNativeCalled=function(e){if(FISH_MODE_MICROCLIENT){console.log("====================================>"+e),alert(e);var t=JSON.parse(e);switch(t.callback){case"initNativeGameCallback":break;case"loginByWechatCallback":console.log("====================================>loginByWechatCallback"),fishWebService.loginByWxFromWeb(t.code,this.onVerifyLoginResponse.bind(this))}}},e.prototype.onVerifyLoginResponse=function(e){console.log("====================================>"+e)},e.instance=null,e}();__reflect(FishNativeBridge.prototype,"FishNativeBridge");var FishRoom=function(e){function t(){var t=e.call(this)||this,i=t;return i.skinName=FishRoomSkin,t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype._initRoomLimits=function(){for(var e=langFish.roomCfg,t=null,i="",n=0;3>n;++n){t=e[n];var o=t.minScore,r=t.maxScore;i=""+o,o>1e4&&(o=""+o/1e4+"万",i=o),r>1e4?r>99999999?(o+="以上",r="",i=o):(r=""+r/1e4+"万",i=o+"-"+r):i=o+"-"+r,this["limitLabel"+(n+1)].text=i}},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.fish_btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_room1.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_room2.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_room3.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_close:break;case t.fish_btn_room1:t.callback&&t.callback(3002);break;case t.fish_btn_room2:t.callback&&t.callback(3003);break;case t.fish_btn_room3:t.callback&&t.callback(3004)}t.hide()},t.prototype.show=function(t,i,n){var o=this;o.fish_room_current_flag1.visible=3002==i,o.fish_room_current_flag2.visible=3003==i,o.fish_room_current_flag3.visible=3004==i,o.callback=n,o._initRoomLimits(),e.prototype._show.call(this,t)},t.prototype.hide=function(){var t=this;e.prototype._hide.call(this,function(e){},t)},t}(FishPanelBase);__reflect(FishRoom.prototype,"FishRoom");var FishScene=function(e){function t(i,n){void 0===n&&(n=0);var o=e.call(this)||this;o.lastFireTime=egret.getTimer(),o.checkLastFireIntervalId=0,o.redpacketTipTimeoutId=0,o.timeoutIdHideUI=0,o.timeoutIdFireCheck=0,o.redcoinStatus=!1,o.autoFireMode=!1,o.bulletSpaceTime=100,o.bulletMultiple=[],o.selfViewId=0,o.userDatas=[],o.loginData=null,o.signinData=null,o.reconnectSession=null,o.willToSuit=!1,t.instance=o;var r=o;r.loginData=i,r.reconnectSession=n,r.addEventListener(eui.UIEvent.ADDED_TO_STAGE,r.beforeShow,r),r.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,r.beforeHide,r),r.addEventListener(eui.UIEvent.COMPLETE,r.uiCompHandler,r),r.addEventListener(egret.Event.RESIZE,r.uiResizeHandler,r),r.skinName=FishMainSkin,FishActor.InitStaticResource();for(var s=0;FISH_USER_COUNT>=s;s++)r.userDatas.push(new FishUserInfoData);return FishTypes.instance,FishManager.GetInstance(),FishNetManager.GetInstance(),FishCoinManager.GetInstance(),FishBulletManager.GetInstance(),FishCoinNumberManager.GetInstance(),FishSoundManager.GetInstance().Load(),o}return __extends(t,e),t.prototype.GetFishGround=function(){var e=this;return e.fish_ground},t.prototype.tryReconnect=function(){var e=this;if(FISH_MODE_INDEPENDENT){var t=FishUserData.instance;t.setItem("uid",e.loginData.uid),t.setItem("sk",e.loginData.sk),t.setItem("username",e.loginData.username),t.setItem("type",e.loginData.type),t.setItem("token",FishUtils.Native.instance.isNative?e.loginData.token:e.loginData.token,!0),fishServer.tryConnect(e.loginData.uid)
}},t.prototype.onLoginResponse=function(e){var t=this,i=e.data;JSON.stringify(i);switch(i.code){case 0:FishUtils.Native.instance.userLogin(fishServer.uid,t.loginData.token),fishServer.checkReconnect();break;default:fishServer.close()}},t.prototype.onConnectToServer=function(e){var t=this;fishServer.login(t.loginData.uid,t.loginData.token)},t.prototype.beforeShow=function(e){this.fish_btn_activity.visible=!1;var t=this;t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.beforeShow,t),console.log("==================>>>>>>>> beforeShow"),t.oldScaleMode=t.stage.scaleMode,t.stage.scaleMode=egret.StageScaleMode.SHOW_ALL,t.oldFrameRate=t.stage.frameRate,t.stage.frameRate=60,FishPhysics.GetInstance().Wakeup(),t.oldContentWidth=t.stage.stageWidth,t.oldContentHeight=t.stage.stageHeight,t.stage.setContentSize(FISH_DESIGN_WIDTH,FISH_DESIGN_HEIGHT),FishUtils.EventManager.instance.enableOnObject(t),fishServer.userInfoRequest(fishServer.uid),fishServer.seatid=0,0==t.reconnectSession?t.willToSuit=!0:fishServer.reconnect(0)},t.prototype.beforeHide=function(e){var t=this;t.willToSuit=!1,t.removeEventListener(egret.Event.REMOVED_FROM_STAGE,t.beforeHide,t),console.log("==================>>>>>>>> beforeHide"),t.stage.scaleMode=t.oldScaleMode,t.stage.frameRate=t.oldFrameRate,FishPhysics.GetInstance().Sleep(),t.stage.setContentSize(t.oldContentWidth,t.oldContentHeight),t.resetScene(),FishUtils.EventManager.instance.disableOnObject(t)},t.prototype.shakeScene=function(){var e=this;if(e.fish_ground){var t=0,i=0;egret.Tween.get(e).to({x:t-8*Math.random(),y:i-8*Math.random()},60,egret.Ease.cubicInOut).to({x:t+8*Math.random(),y:i+8*Math.random()},120,egret.Ease.cubicInOut).to({x:t-8*Math.random(),y:i-8*Math.random()},120,egret.Ease.cubicInOut).to({x:t+8*Math.random(),y:i+8*Math.random()},120,egret.Ease.cubicInOut).to({x:t-8*Math.random(),y:i-8*Math.random()},120,egret.Ease.cubicInOut).to({x:t+8*Math.random(),y:i+8*Math.random()},120,egret.Ease.cubicInOut).to({x:0,y:0},60)}},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.fish_label_version.text=FISH_VERSION+" "+FISH_VERSION_DESC;var i=new FishCaustic;t.fish_caustic.addChild(i),i.Move(),t.fish_btn_exit.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_room.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_type.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_shop.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_sound_on.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_sound_off.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_auto.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_redpacket.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_btn_activity.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_ground.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBegin,t),t.fish_ground.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),t.fish_ground.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.touchEnd,t),t.fish_ground.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEnd,t),t.fish_ground.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.touchEnd,t),t.orgin_fish_btn_exit_left=t.fish_btn_exit.left,t.orgin_fish_btn_room_left=t.fish_btn_room.left,t.orgin_fish_btn_type_left=t.fish_btn_type.left,t.orgin_fish_btn_shop_left=t.fish_btn_shop.left,t.old_fish_btn_auto_x=t.fish_btn_auto.x,t.old_fish_btn_redpacket_x=t.fish_btn_redpacket.x,t.old_fish_btn_future1_x=t.fish_btn_future1.x,t.old_fish_btn_future2_x=t.fish_btn_future2.x;var n=FishUtils.EventManager.instance;n.registerOnObject(t,fishServer,FishEvent.USER_LOGIN_RESPONSE,t.onLoginResponse,t),n.registerOnObject(t,fishServer,FishEvent.CONNECT_SERVER,t.onConnectToServer,t),n.registerOnObject(t,fishServer,FishEvent.SERVER_CLOSE,t.onServerClose,t),n.registerOnObject(t,fishServer,FishEvent.SHOW_DISCONNECT,t.onServerClose,t),n.registerOnObject(t,fishServer,FishEvent.USER_CHECK_RECONNECT_REP,t.onCheckReconnectRep,t),n.registerOnObject(t,fishServer,FishEvent.USER_QUICK_JOIN_RESPONSE,t.onQuickJoinResponse,t),n.registerOnObject(t,fishServer,FishEvent.USER_USER_INFO_RESPONSE,t.onUserInfoResponse,t),n.registerOnObject(t,fishServer,FishEvent.USER_RECONNECT_TABLE_REP,t.onUserReconnectResponse,t),n.registerOnObject(t,fishServer,FishEvent.GAME_USER_ONLINE,t.onUserOnline,t),n.registerOnObject(t,fishServer,FishEvent.GAME_ENTER_TABLE,t.onEnterTable,t),n.registerOnObject(t,fishServer,FishEvent.GAME_LEAVE_TABLE,t.onLeaveTable,t),n.registerOnObject(t,fishServer,FishEvent.GAME_TABLE_INFO,t.onTableInfo,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_TRACE,t.onGameFishTrace,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_FIRE_REP,t.onGameFishFire,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_FISH_OVER,t.onGameFishOver,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_SCENE,t.onGameFishScene,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_CONFIG,t.onGameFishConfig,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_REDCOUNT,t.onGameFishRedcount,t),n.registerOnObject(t,fishServer,FishEvent.LOTTERY_REDCOIN_REP,t.onGameFishRedcoin,t),n.registerOnObject(t,fishServer,FishEvent.USER_BAG_INFO_REP,t.onUserBagInfo,t),n.registerOnObject(t,fishServer,FishEvent.USER_ALMS_REP,t.onUserAlms,t),n.registerOnObject(t,fishServer,FishEvent.GET_FRESHMAN_REWARD_REP,t.onUserGetFreshManReward,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_FIRE_FAIL,t.onGameFireFail,t),n.registerOnObject(t,fishServer,FishEvent.GAME_USER_INFO_IN_GAME_REP,t.onUserInfoInGame,t),n.registerOnObject(t,fishServer,FishEvent.USER_REDCOIN_EXCHANGE_GOODS_REP,t.onRedcoinExchangeGoods,t),n.registerOnObject(t,fishServer,FishEvent.USER_DAY_SIGNIN_OPT_REP,t.onDaySigninOpt,t),n.registerOnObject(t,fishServer,FishEvent.GAME_FISH_FRESHEN_GOLD_REP,t.onRefreshUserGold,t),n.enableOnObject(t),FISH_MODE_INDEPENDENT&&(FishUtils.Dispatcher.addEventListener(FishEvent.SERVER_CLOSE,t.onServerClose,t),FISH_MODE_WXMP&&(t.fish_btn_exit.visible=!1)),fishServer.sendDaySigninOptReq(1),t.addEventListener(egret.Event.ENTER_FRAME,function(){FishPhysics.GetInstance().Update()},t),t.touchPos=egret.Point.create(t.stage.stageWidth/2,t.stage.stageHeight/2)},t.prototype.uiCompHandler=function(){},t.prototype.uiResizeHandler=function(){},t.prototype.getRandomArbitrary=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.prototype.autoFireBullet=function(e){var t=this;return e-t.lastFireTime>t.bulletSpaceTime&&t.fireBullet(t.getMyViewID(),t.touchPos),!1},t.prototype.checkLastFire=function(){console.log("checkLastFire----------->");var e=this,t=e.bulletMultiple[0]||1,i=e.getMyViewID();if(e.userDatas[i].gold<t)return void e._tipNoGold();var n=egret.getTimer();if(0==e.timeoutIdFireCheck&&n-e.lastFireTime>6e4){var o=e,r=10;e.timeoutIdFireCheck=egret.setInterval(function(){o.showTimeoutTip(r--),0>r&&(o.closeCheckLastFire(),o.quitGame())},e,1e3)}return!1},t.prototype.closeCheckLastFire=function(){var e=this;0!=e.timeoutIdFireCheck&&(egret.clearInterval(e.timeoutIdFireCheck),e.timeoutIdFireCheck=0,e.showTimeoutTip(0)),e.lastFireTime=egret.getTimer()},t.prototype.showTimeoutTip=function(e){var t=this;t.fish_panel_timeout_tip.visible=e>0,t.fish_timeout_time.text=e>9?""+e:" "+e},t.prototype.fireBullet=function(e,t){var i=this,n=i.getCannon(e);if(null!=n){if(null==fishServer||0==fishServer.connected)return i.closeAutoFire(),void FishAlert.instance.show(i.fish_group_top,"断线了，是否重新连接？",0,i.onAlertResult.bind(i,2));if(e==i.getMyViewID()&&i.userDatas[e].gold<n.GetMultiple())return i.closeAutoFire(),void fishServer.alms();i.lastFireTime=egret.getTimer();var o=n.FireTo(t);i.fish_ground.addChild(o),e==i.getMyViewID()&&fishServer.fireFish(1,n.GetFireAngle(),n.GetMultiple(),o.GetBulletID())}},t.prototype.touchBegin=function(e){var t=this;return t.autoFireMode?void(t.touchPos=egret.Point.create(e.stageX,e.stageY)):void(egret.getTimer()-t.lastFireTime<t.bulletSpaceTime||(t.touchPos=egret.Point.create(e.stageX,e.stageY),t.fireBullet(t.getMyViewID(),t.touchPos),egret.startTick(t.autoFireBullet,t)))},t.prototype.touchMove=function(e){this.touchPos=egret.Point.create(e.stageX,e.stageY)},t.prototype.touchEnd=function(e){var t=this;t.autoFireMode||(t.touchPos=egret.Point.create(e.stageX,e.stageY),egret.stopTick(t.autoFireBullet,t))},t.prototype.clearCheckLastFireInterval=function(){var e=this;0!=e.checkLastFireIntervalId&&egret.clearInterval(e.checkLastFireIntervalId),e.checkLastFireIntervalId=0},t.prototype.quitGame=function(){var e=this;e.closeAutoFire(),e.closeCheckLastFire(),FishSoundManager.GetInstance().Mute(!0),e.clearCheckLastFireInterval(),FISH_MODE_INDEPENDENT?(fishServer.giveUpGame(),e.resetScene(),FISH_MODE_WXMP?FishAlert.instance.show(e.fish_group_top,"长时间无操作，被系统请出来休息了，是否重新加入游戏？",0,e.onAlertResult.bind(e,4)):FishJsBridge.getInstance().tsCallJsFunc("closewindow")):(fishServer.giveUpGame(),e.resetScene(),fishServer.ddzDispatchEvent(1,"",{type:1}))},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_exit:FishAlert.instance.show(t.fish_group_top,"打鱼收益好像不错，不再玩一会了吗？",0,t.onAlertResult.bind(t,0));break;case t.fish_btn_room:FishRoom.instance.show(t.fish_group_top,fishServer.roomId,t.onRoomSelect.bind(t));break;case t.fish_btn_type:FishTypes.instance.show(t.fish_group_top);break;case t.fish_btn_shop:FishShop.instance.show(t.fish_group_top);break;case t.fish_btn_sound_on:FishSoundManager.GetInstance().Mute(!0),t.fish_btn_sound_on.visible=!1,t.fish_btn_sound_off.visible=!0;break;case t.fish_btn_sound_off:FishSoundManager.GetInstance().Mute(!1),t.fish_btn_sound_on.visible=!0,t.fish_btn_sound_off.visible=!1;break;case t.fish_btn_auto:if(t.autoFireMode)t.closeAutoFire();else{var i=new egret.TouchEvent(egret.TouchEvent.TOUCH_BEGIN,!1,!1,t.touchPos.x,t.touchPos.y,0);t.touchBegin(i),t.fish_btn_auto.currentState="auto",t.autoFireMode=!0}break;case t.fish_btn_redpacket:t.redcoinStatus=!0,fishServer.lotteryRedcoin(fishServer.roomId);break;case t.fish_btn_activity:FishActivity.instance.show(t.fish_group_top,t.signinData)}},t.prototype.getSuitFishRoom=function(){for(var e=langFish.roomCfg,t=fishServer.selfData.gold,i=null,n=null,o=e.length,r=o-1;r>=0;--r)if(i=e[r],i.minScore<=t&&i.maxScore>=t){n=i;break}return console.log("getSuitFishRoom-------------->",n,t),n},t.prototype.onAlertResult=function(e,t){var i=this;0==e&&t?i.quitGame():1==e&&t?FishShop.instance.show(i.fish_group_top):2==e&&t?i.tryReconnect():3==e&&t?fishServer.alms():4==e&&t?egret.setTimeout(function(){i.resetScene(),fishServer.seatid=0;var e=i.getSuitFishRoom();return e?void fishServer.quickJoin(e.roomID):void i._tipNoGold()},i,1e3):5==e&&t?(i.fish_panel_tip_text.text="正在切换房间...",i.fish_panel_tip.visible=!0,fishServer.giveUpGame(),egret.setTimeout(function(){i.resetScene(),fishServer.seatid=0;var e=i.getSuitFishRoom();fishServer.quickJoin(e.roomID),i.fish_panel_tip.visible=!1},i,300)):6==e&&t&&(i.fish_panel_tip_text.text="正在切换房间...",i.fish_panel_tip.visible=!0,fishServer.giveUpGame(),egret.setTimeout(function(){i.resetScene(),fishServer.seatid=0;var e=i.getSuitFishRoom();return e?(fishServer.quickJoin(e.roomID),void(i.fish_panel_tip.visible=!1)):void i._tipNoGold()},i,1500))},t.prototype.onRoomSelect=function(e){var t=this;e!=fishServer.roomId&&(t.fish_panel_tip_text.text="正在切换房间...",t.fish_panel_tip.visible=!0,fishServer.giveUpGame(),egret.setTimeout(function(){t.resetScene(),fishServer.seatid=0,fishServer.quickJoin(e),t.fish_panel_tip.visible=!1},t,1500))},t.prototype.getUserDataByID=function(e){for(var t=this,i=1;FISH_USER_COUNT>=i;i++)if(t.userDatas[i].uid==e)return t.userDatas[i];return null},t.prototype.getMyViewID=function(){var e=this;if(0==fishServer.seatid)return 0;if(0!=e.selfViewId)return e.selfViewId;var t=Math.abs(fishServer.seatid-2)%3;return 0==t?t=2:0/0==t&&(t=0),e.selfViewId=t,t},t.prototype.switchSeatID2ViewID=function(e){var t=this;if(0==fishServer.seatid)return 0;var i=(t.getMyViewID()+(e-fishServer.seatid)+FISH_USER_COUNT)%FISH_USER_COUNT;return 0==i&&(i=4),i},t.prototype.getCannon=function(e){var t=this;switch(e){case 1:return t.fish_cannon_1;case 2:return t.fish_cannon_2;case 3:return t.fish_cannon_3;case 4:return t.fish_cannon_4;default:return null}},t.prototype.getUserInfo=function(e){var t=this;switch(e){case 1:return t.fish_userinfo_1;case 2:return t.fish_userinfo_2;case 3:return t.fish_userinfo_3;case 4:return t.fish_userinfo_4;default:return null}},t.prototype.getUserInfoByUid=function(e){for(var t,i=this,n=i.userDatas.length;n>t;t++)if(i.userDatas[t].uid==e){var o=i.switchSeatID2ViewID(i.userDatas[t].seatid);return i.getUserInfo(o)}return null},t.prototype.getViewByUid=function(e){for(var t=this,i=0,n=t.userDatas.length;n>i;i++)if(t.userDatas[i].uid==e)return t.switchSeatID2ViewID(t.userDatas[i].seatid);return 0},t.prototype.resetScene=function(){var e=this;FishSoundManager.GetInstance().Mute(!0),e.closeAutoFire(),egret.stopTick(e.checkLastFire,e),e.clearCheckLastFireInterval();for(var t=1;4>=t;t++)e.getCannon(t).SetMultiple(0),e.getCannon(t).ShowCannon(!1,!1),e.getUserInfo(t).SetUserInfo(0);FishManager.GetInstance().ClearAllFishes(),FishNetManager.GetInstance().ClearAllNets(),FishBulletManager.GetInstance().ClearAllBullet(),fishServer.seatid=0,e.selfViewId=0,e.redcoinStatus=!1},t.prototype.playerSeatDown=function(e){var t=this;e.uid==fishServer.uid&&(t.selfViewId=0,fishServer.seatid=e.seatid,fishServer.selfData.seatid=e.seatid,FishPhysics.GetInstance().selfViewId=t.getMyViewID(),fishServer.userInfoRequest(fishServer.uid),2==t.getMyViewID()?(t.fish_btn_auto.x=t.old_fish_btn_future2_x,t.fish_btn_future2.x=t.old_fish_btn_auto_x,t.fish_btn_redpacket.x=t.old_fish_btn_future1_x,t.fish_btn_future1.x=t.old_fish_btn_redpacket_x):(t.fish_btn_auto.x=t.old_fish_btn_auto_x,t.fish_btn_redpacket.x=t.old_fish_btn_redpacket_x,t.fish_btn_future1.x=t.old_fish_btn_future1_x,t.fish_btn_future2.x=t.old_fish_btn_future2_x),FishSoundManager.GetInstance().PlayBGM(0,!1),FishSoundManager.GetInstance().Mute(!1));var i=t.switchSeatID2ViewID(e.seatid);t.userDatas[i].initData(e),fishServer.getUserInfoInGame(e.uid);var n=t.getCannon(i);n&&(n.ShowCannon(!0,e.uid==fishServer.uid),t.bulletMultiple.length>0&&n.SetMultiple(t.bulletMultiple[0]))},t.prototype.playerStandUp=function(e){var t=this,i=t.getUserDataByID(e),n=t.switchSeatID2ViewID(i.seatid);i.initData({}),t.getUserInfo(n).SetUserInfo(0),t.getCannon(n).ShowCannon(!1)},t.prototype.closeAutoFire=function(){var e=this;egret.stopTick(e.autoFireBullet,e),e.fish_btn_auto.currentState="normal",e.autoFireMode=!1},t.prototype.onServerClose=function(e){var t=this;FishAlert.instance.show(t.fish_group_top,"断线了，是否重新连接？",0,t.onAlertResult.bind(t,2)),t.closeAutoFire()},t.prototype.onQuickJoinResponse=function(e){var t=e.data,i=this;switch(t.result){case 0:return console.log("join success."),i.closeAutoFire(),i.closeCheckLastFire(),i.clearCheckLastFireInterval(),i.checkLastFireIntervalId=egret.setInterval(i.checkLastFire,i,1e3),i.fish_panel_tip_text.text="已经进入捕鱼"+langFish.exchange_roomid[fishServer.roomId],i.fish_panel_tip.visible=!0,void egret.setTimeout(function(){i.fish_panel_tip.visible=!1},i,3e3);case 1:FishAlert.instance.show(i.fish_group_top,"加入房间失败！",1);break;case 2:var n=3,o=0,r=i.getSuitFishRoom(),s="金豆不足！";r?(n=6,o=1,s="金豆不足，点击确定进入"+langFish.exchange_roomid[r.roomID]+"！"):this.almsErrClose=!0,FishAlert.instance.show(i.fish_group_top,s,o,i.onAlertResult.bind(i,n));break;case 3:FishAlert.instance.show(i.fish_group_top,langFish.no_more_desk,1);break;case 4:FishAlert.instance.show(i.fish_group_top,"用户已经存在",1);break;case 7:var a=i.getSuitFishRoom(),h="拥有金豆超过房间上限，点击确定进入"+langFish.exchange_roomid[a.roomID];FishAlert.instance.show(i.fish_group_top,h,1,i.onAlertResult.bind(i,5))}fishServer.roomId=0},t.prototype.onTableInfo=function(e){for(var t=this,i=e.data,n=0,o=i.players.length;o>n;++n)i.players[n].uid!=fishServer.uid&&t.playerSeatDown(i.players[n])},t.prototype.onUserOnline=function(e){var t=this,i=e.data;t.playerSeatDown(i)},t.prototype.onEnterTable=function(e){var t=this,i=e.data;t.playerSeatDown(i)},t.prototype.onLeaveTable=function(e){var t=this,i=e.data;i.uid==fishServer.uid?4==i.reason&&t._tipNoGold():t.playerStandUp(i.uid)},t.prototype.onGameFishTrace=function(e){var t=e.data,i=this,n=FishManager.GetInstance().BuildFish(t.fishkind-1,t.fishid);i.fish_ground.addChildAt(n,1),n.MoveToTrace(t)},t.prototype.onGameFireFail=function(e){var t=e.data,i=this;if(1==t.code){var n=i.getSuitFishRoom();if(n&&n.roomID!=fishServer.roomId)return void FishAlert.instance.show(i.fish_group_top,"金豆不够了，发射子弹失败。点击确定进入其他场！",1,i.onAlertResult.bind(i,6));i._tipNoGold(!0)}},t.prototype.onGameFishFire=function(e){var t=e.data,i=this,n=i.switchSeatID2ViewID(t.seat_id),o=i.getCannon(n);if(null!=o){if(t.seat_id!=fishServer.seatid){var r=o.FireToAngle(t.angle);i.fish_ground.addChild(r),o.SetMultiple(t.bullet_multiple)}else{i.closeCheckLastFire();var s=o.GetMultiple();if(t.gold<s)for(var a=i.bulletMultiple.length-1;a>=0;a--)if(t.gold>=i.bulletMultiple[a]){o.SetMultiple(i.bulletMultiple[a]);break}}i.userDatas[n].gold=t.gold;var h=i.getUserInfo(n);h&&h.UpdateGold(t.gold)}},t.prototype.onGameFishOver=function(e){var t=e.data,i=this,n=FishManager.GetInstance().GetFishByID(t.fishid),o=i.switchSeatID2ViewID(t.seat_id);if(n){var r=n.GetFishType();n.Explode(o,t.fish_gold,t.red_packet),17==r&&i.shakeScene()}var s=i.getCannon(o);s&&1==t.effect&&s.ShowBingo(t.fish_gold),i.userDatas[o].gold=t.gold;var a=i.getUserInfo(o);a&&a.UpdateGold(t.gold)},t.prototype.onGameFishScene=function(e){var t=e.data,i=this,n=FishManager.GetInstance().BuildFish(t.fish_info.fishkind-1,t.fish_info.fishid);i.fish_ground.addChildAt(n,1),n.MoveToTrace(t.fish_info,t.passtime/1e3)},t.prototype.onGameFishConfig=function(e){var t=e.data,i=this,n=t.bullet_multiple,o=t.bullet_space_time;i.bulletSpaceTime=o,i.bulletMultiple=n,i.fish_cannon_1.SetMultiples(n),i.fish_cannon_2.SetMultiples(n),i.fish_cannon_3.SetMultiples(n),i.fish_cannon_4.SetMultiples(n)},t.prototype.onGameFishRedcount=function(e){var t=e.data,i=this;i.fish_btn_redpacket.updateNum(t.red_count)},t.prototype.onGameFishRedcoin=function(e){var t=e.data,i=this,n=t.result,o=t.coin;if(0==n){var r=600;egret.Tween.removeTweens(i.fish_label_redpacket_tip),i.fish_label_redpacket_tip.x=i.fish_btn_redpacket.x+34,i.fish_label_redpacket_tip.y=r,i.fish_label_redpacket_tip.text="+"+o/100+"奖杯",i.fish_label_redpacket_tip.visible=!0,i.fish_label_redpacket_tip.alpha=1,egret.Tween.get(i.fish_label_redpacket_tip).to({y:r-50,alpha:.1},1200).call(function(e){e.fish_label_redpacket_tip.visible=!1},i,[i]);var s=i.fish_btn_redpacket,a=+s.getNum();a>0&&a--,s.updateNum(a)}else{i.redcoinStatus=!1;var h="系统错误";switch(n){case 1:h="领取时发生错误，请稍后再试。";break;case 2:h="奖杯不足，请捕获更多的鱼获取奖杯。";break;case 3:h="领取时发生错误，请稍后再试。";break;case 4:h="操作过于频繁，请稍后再试。"}FishAlert.instance.show(i.fish_group_top,h,1)}},t.prototype.onUserBagInfo=function(e){var t=e.data,i=this,n=i.getUserInfo(i.getMyViewID());n&&t.items.forEach(function(e){3==e.id&&n.UpdateDiamond(e.count)})},t.prototype.onUserAlms=function(e){console.log("==================>>>>>>>> onUserAlms");var t=e.data,i=this,n=t.result;0==n?(this.almsErrClose=!1,FishAlert.instance.show(i.fish_group_top,"金豆不足，领取救济金2000成功！",1),fishServer.refreshUserGoldInGame()):this.almsErrClose&&i._tipNoGold(!0)},t.prototype.onUserGetFreshManReward=function(e){var t=e.data,i=this;0==t.result&&FishAlert.instance.show(i.fish_group_top,"欢迎您的到来，已自动帮您领取新手奖励"+t.gold+"金豆。",1),fishServer.seatid=0;var n=i.getSuitFishRoom();return n?void fishServer.quickJoin(n.roomID):void i._tipNoGold()},t.prototype.onUserInfoResponse=function(e){var t=this,i=e.data;if(i.uid==fishServer.uid){fishServer.selfData.initData(i);var n=t.getMyViewID();t.userDatas[n].gold=fishServer.selfData.gold,t.userDatas[n].redcoin=fishServer.selfData.redcoin;var o=t.getUserInfo(n);if(o&&(o.UpdateRedcoin(fishServer.selfData.redcoin/100),t.redcoinStatus||(o.UpdateGold(fishServer.selfData.gold),t.redcoinStatus=!1)),t.willToSuit&&0==fishServer.seatid)if(FISH_MODE_INDEPENDENT)fishServer.getFreshManReward();else{var r=t.getSuitFishRoom();if(!r)return void t._tipNoGold();fishServer.quickJoin(r.roomID)}t.willToSuit=!1}},t.prototype._justStopFire=function(){var e=this;egret.stopTick(e.checkLastFire,e),e.closeAutoFire(),e.closeCheckLastFire(),e.clearCheckLastFireInterval()},t.prototype._tipNoGold=function(e){void 0===e&&(e=!0);var t=this;t._justStopFire(),fishServer.giveUpGame(),e?FishAlert.instance.show(t.fish_group_top,"金豆不够了",1,t.onAlertResult.bind(t,0,1)):t.onAlertResult(0,!0)},t.prototype.onUserInfoInGame=function(e){var t=this,i=e.data,n=t.getViewByUid(i.uid);if(0!=n){t.userDatas[n].initData(i);var o=t.getUserInfo(n);o&&o.SetUserInfo(t.userDatas[n].uid,t.userDatas[n].nickname,t.userDatas[n].gold,0,t.userDatas[n].imageid,t.userDatas[n].redcoin/100)}},t.prototype.onCheckReconnectRep=function(e){var t=e.data,i=this;if(i.resetScene(),fishServer.seatid=0,0==i.reconnectSession&&0==t.roomid){var n=i.getSuitFishRoom();if(!n)return void i._tipNoGold();fishServer.quickJoin(n.roomID)}else fishServer.reconnectJoin(t.session)},t.prototype.onUserReconnectResponse=function(e){var t=e.data,i=this;if(i.reconnectSession=0,0==t.result)console.log("重连成功"),i.closeAutoFire(),i.closeCheckLastFire(),i.clearCheckLastFireInterval(),i.checkLastFireIntervalId=egret.setInterval(i.checkLastFire,i,1e3);else{fishServer.seatid=0;var n=i.getSuitFishRoom();if(!n)return void i._tipNoGold();fishServer.quickJoin(n.roomID)}},t.prototype.onRedcoinExchangeGoods=function(e){var t=e.data,i=this,n="";switch(t.result){case 0:n=-1!=[5,6,7,10,11,12].indexOf(fishServer.exchangeId)?"恭喜你，兑换成功！兑换后的话费，请到公众号领取。":"恭喜你，兑换成功！",fishServer.refreshUserGoldInGame();break;case 1:n="对不起，该商品不存在！";break;case 2:n="对不起，奖杯不足！";break;case 3:n="对不起，系统错误！";break;case 4:n="对不起，操作过于频繁！"}fishServer.exchangeId=0,FishAlert.instance.show(i.fish_group_top,n,1)},t.prototype.onDaySigninOpt=function(e){var t=e.data,i=this;if(1==t.optype)0!=t.result?FishAlert.instance.show(i.fish_group_top,"请求签到信息失败！",1):i.signinData=t;else if(2==t.optype)if(0!=t.result)FishAlert.instance.show(i.fish_group_top,"签到失败！",1);else{var n=t.reward.indexOf(":"),o=t.reward.indexOf("|"),r=t.reward.substring(n+1,o);FishAlert.instance.show(i.fish_group_top,"签到成功，获得"+r+"奖励！",1),i.signinData.today=1,i.signinData.total_day++,fishServer.refreshUserGoldInGame()}},t.prototype.onRefreshUserGold=function(e){var t=e.data,i=this;console.log(t),fishServer.selfData.gold=t.gold;var n=i.getUserInfo(i.getMyViewID());n&&n.UpdateGold(t.gold)},t.instance=null,t}(eui.Component);__reflect(FishScene.prototype,"FishScene");var FishServer=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfData=new FishUserInfoData,t.exchangeId=0,t.roomId=0,t}return __extends(t,e),t.prototype.beforeDispatchMessage=function(t,i){switch(t){case FishEvent.GAME_SET_SESSION:this._session>0&&this._session!=i.session&&this.giveUpGame(),this.resetSession()}e.prototype.beforeDispatchMessage.call(this,t,i)},t.prototype.initFromParams=function(e){this._uid=e.serverUid,this._ddzDispatcher=e.dispatcher,this.ddzDispatchEvent(6,null,{type:6,protoIDS:{"user.RedcoinExchangeGoodsRep":{just:!0},"user.LotteryRedcoinRep":{just:!0}}}),this._ddzDispatcher.addEventListener("RECV_SOCKET_DATA",fishServer.onDDZSocketData,fishServer)},t.prototype.send=function(t,i){!i.session&&t.indexOf("game")>=0&&(i.session=this._session),e.prototype.send.call(this,t,i)},t.prototype.reconnectJoin=function(e){this.send(FishEvent.USER_RECONNECT_TABLE_REQ,{session:e,result:0,index:0})},t.prototype.quickJoin=function(e){void 0===e&&(e=FISH_ROOMID_TEST),this.roomId=e,this.send(FishEvent.USER_QUICK_JOIN_REQUEST,{roomid:e,clientid:this._clientId})},t.prototype.getFreshManReward=function(){this.send(FishEvent.GET_FRESHMAN_REWARD_REQ,{})},t.prototype.userInfoRequest=function(e){this.send(FishEvent.USER_USER_INFO_REQUEST,{uid:e})},t.prototype.giveUpGame=function(){this.send(FishEvent.GAME_GIVE_UP_GAME_REQ,{status:0})},t.prototype.fireFish=function(e,t,i,n){this.send(FishEvent.GAME_FISH_FIRE_REQ,{bullet_kind:e,angle:t,bullet_multiple:i,bullet_id:n})},t.prototype.catchFish=function(e,t){this.send(FishEvent.GAME_FISH_CATCH,{bullet_id:e,fishid:t})},t.prototype.lotteryRedcoin=function(e){void 0===e&&(e=FISH_ROOMID_TEST),this.send(FishEvent.LOTTERY_REDCOIN_REQ,{roomid:e})},t.prototype.getBagInfo=function(){this.send(FishEvent.USER_BAG_INFO_REQ,{})},t.prototype.alms=function(){this.send(FishEvent.USER_ALMS_REQ,{})},t.prototype.getUserInfoInGame=function(e){this.send(FishEvent.GAME_USER_INFO_IN_GAME_REQ,{uid:e})},t.prototype.redcoinExchangeGoodsReq=function(e){this.exchangeId=e,this.send(FishEvent.USER_REDCOIN_EXCHANGE_GOODS_REQ,{index:e})},t.prototype.sendDaySigninOptReq=function(e){this.send(FishEvent.USER_DAY_SIGNIN_OPT_REQ,{optype:e})},t.prototype.getBindPhoneReward=function(){this.send(FishEvent.GAME_FISH_BIND_PHONE_REWARD_REQ,{})},t.prototype.refreshUserGoldInGame=function(){this.send(FishEvent.GAME_FISH_FRESHEN_GOLD_REQ,{})},t}(FishSocket);__reflect(FishServer.prototype,"FishServer");var fishServer=new FishServer,FishShopItem=function(e){function t(){var t=e.call(this)||this;t.exchange=!1,t.fish_shop_item_id="",t.fish_shop_item_ticket=!1;var i=t;return i.touchEnabled=!1,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishShopItemSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){var e=this;e.currentState="small",e.fish_shop_item_buy_big.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buyTouchHandler,e),e.fish_shop_item_buy_small.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buyTouchHandler,e),e.fish_shop_item_small_top.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buyTouchHandler,e),e.fish_shop_item_big_top.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buyTouchHandler,e)},t.prototype.uiResizeHandler=function(){},t.prototype.SetShopItemInfo=function(e,t,i,n,o,r,s,a,h){void 0===r&&(r=""),void 0===s&&(s=""),void 0===a&&(a=!1),void 0===h&&(h=!1);var c=this;if(c.fish_shop_item_id=e,c.fish_shop_item_ticket=h,c.exchange=a,t){c.currentState="big";for(var l=0,u=8-s.length;u>l;l++)s=" "+s;c.fish_shop_item_total_big.text=s,c.fish_shop_item_name_big.text=i,c.fish_shop_item_price_big.text=(h?"   ":"")+n,c.fish_shop_item_icon_big.source=r,c.fish_shop_item_ticket_big.visible=h}else c.currentState="small",c.fish_shop_item_name_small.text=i,c.fish_shop_item_price_small.text=(h?"   ":"")+n,c.fish_shop_item_icon_small.source=r,c.fish_shop_item_hot_flag.visible=a,c.fish_shop_item_hot_title.visible=a,c.fish_shop_item_ticket_small.visible=h;o>0?(c.fish_shop_item_giftlabel.visible=!0,c.fish_shop_item_gift.visible=!0,c.fish_shop_item_giftlabel.text="加送\n"+o+"%"):(c.fish_shop_item_giftlabel.visible=!1,c.fish_shop_item_gift.visible=!1)},t.prototype.buyTouchHandler=function(e){var t=this;FISH_MODE_INDEPENDENT?t.fish_shop_item_ticket?fishServer.redcoinExchangeGoodsReq(parseInt(t.fish_shop_item_id)):fishWebService.rechagre(t.fish_shop_item_id,function(e){0==e&&fishServer.refreshUserGoldInGame()}):t.exchange?fishServer.ddzDispatchEvent(7,"",{type:7,id:t.fish_shop_item_id}):fishServer.ddzDispatchEvent(5,"",{type:5,productID:t.fish_shop_item_id})},t}(eui.Component);__reflect(FishShopItem.prototype,"FishShopItem");var FishShop=function(e){function t(){var i=e.call(this)||this,n=i;return n.skinName=FishShopSkin,null==t.itemConfigs&&(t.itemConfigs=RES.getRes("shop_json")),i}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2;var i=new eui.TileLayout;i.horizontalGap=15,i.verticalGap=0,i.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,i.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,i.paddingTop=10,i.paddingRight=15,i.paddingLeft=15,i.paddingBottom=10,i.requestedColumnCount=1,t.fish_shop_group.layout=i;var i=new eui.TileLayout;i.horizontalGap=15,i.verticalGap=15,i.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,i.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,i.requestedColumnCount=2,t.fish_shop_group_big.layout=i;var i=new eui.TileLayout;i.horizontalGap=15,i.verticalGap=15,i.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,i.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,i.requestedColumnCount=4,t.fish_shop_group_small.layout=i,t.fish_shop_type_btn_gold.currentState="downAndSelected",t.fish_shop_type_btn_gold.fish_shoptype_label.text="金豆",t.fish_shop_type_btn_diamond.currentState="up",t.fish_shop_type_btn_diamond.fish_shoptype_label.text="钻石",t.fish_shop_type_btn_redpacket.currentState="up",t.fish_shop_type_btn_redpacket.fish_shoptype_label.text="话费",t.fish_shop_type_btn_jd.currentState="up",t.fish_shop_type_btn_jd.fish_shoptype_label.text="京东卡",t.fish_shop_type_btn_alipay.currentState="up",t.fish_shop_type_btn_alipay.fish_shoptype_label.text="支付宝零钱",t.fish_btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_shop_type_btn_gold.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_shop_type_btn_diamond.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_shop_type_btn_redpacket.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_shop_type_btn_jd.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.fish_shop_type_btn_alipay.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t)},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_close:break;case t.fish_shop_type_btn_gold:case t.fish_shop_type_btn_diamond:case t.fish_shop_type_btn_redpacket:case t.fish_shop_type_btn_jd:case t.fish_shop_type_btn_alipay:return void t.selectType(e.target)}t.hide()},t.prototype.selectType=function(e){var i=this;switch(i.fish_shop_type_btn_selected&&(i.fish_shop_type_btn_selected.currentState="up"),e.currentState="downAndSelected",i.fish_shop_type_btn_selected=e,i.fish_shop_group_big.removeChildren(),i.fish_shop_group_small.removeChildren(),e){case i.fish_shop_type_btn_gold:for(var n=0,o=t.itemConfigs.length;o>n;n++){var r=t.itemConfigs[n];if(0==r.itemtype){var s=new FishShopItem;1==r.type?i.fish_shop_group_big.addChild(s):i.fish_shop_group_small.addChild(s),s.SetShopItemInfo(r.itemid+"",1==r.type,r.name,r.price,r.gift,r.icon,r.total,r.exchange,r.ticket)}}break;case i.fish_shop_type_btn_diamond:for(var n=0,o=t.itemConfigs.length;o>n;n++){var r=t.itemConfigs[n];if(1==r.itemtype){var s=new FishShopItem;1==r.type?i.fish_shop_group_big.addChild(s):i.fish_shop_group_small.addChild(s),s.SetShopItemInfo(r.itemid+"",1==r.type,r.name,r.price,r.gift,r.icon,r.total,r.exchange,r.ticket)}}break;case i.fish_shop_type_btn_redpacket:for(var n=0,o=t.itemConfigs.length;o>n;n++){var r=t.itemConfigs[n];if(2==r.itemtype){var s=new FishShopItem;1==r.type?i.fish_shop_group_big.addChild(s):i.fish_shop_group_small.addChild(s),s.SetShopItemInfo(r.itemid+"",1==r.type,r.name,r.price,r.gift,r.icon,r.total,r.exchange,r.ticket)}}break;case i.fish_shop_type_btn_jd:for(var n=0,o=t.itemConfigs.length;o>n;n++){var r=t.itemConfigs[n];if(3==r.itemtype){var s=new FishShopItem;1==r.type?i.fish_shop_group_big.addChild(s):i.fish_shop_group_small.addChild(s),s.SetShopItemInfo(r.itemid+"",1==r.type,r.name,r.price,r.gift,r.icon,r.total,r.exchange,r.ticket)}}break;case i.fish_shop_type_btn_alipay:}},t.prototype.show=function(t){var i=this;e.prototype._show.call(this,t),i.selectType(i.fish_shop_type_btn_gold)},t.prototype.hide=function(){var t=this;e.prototype._hide.call(this,function(e){var t=e;t.fish_shop_group_big.removeChildren(),t.fish_shop_group_small.removeChildren()},t)},t.itemConfigs=null,t}(FishPanelBase);__reflect(FishShop.prototype,"FishShop");var FishSoundManager=function(){function e(){this.scenes=[],this.catches=[],this.bgmChannel=null,this.mute=!1
}return e.GetInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.Load=function(){for(var e=this,t=0;1>t;t++)e.scenes.push(RES.getRes("scene"+t+"_mp3"));for(var t=0;FISH_TYPE_COUNT>t;t++)e.catches.push(RES.getRes("catch"+t+"_mp3"));e.shejiang=RES.getRes("shejiang_mp3")},e.prototype.PlayShot=function(){var e=this;if(!e.mute&&e.shejiang){var t=e.shejiang.play(0,1);t.volume=.5}},e.prototype.PlayCatch=function(e){var t=this;if(!t.mute&&!(e>=FISH_TYPE_COUNT)&&t.catches[e]){var i=t.catches[e].play(0,1);i.volume=.5}},e.prototype.PlayBGM=function(e,t){void 0===t&&(t=!0);var i=this;if(!(i.mute&&t||e>0||0>e))if(t){if(i.bgmChannel)return;i.scenes[e]&&(i.bgmChannel=i.scenes[e].play(0,-1),i.bgmChannel.volume=.5)}else i.bgmChannel&&(i.bgmChannel.stop(),i.bgmChannel=null)},e.prototype.Mute=function(e){void 0===e&&(e=!0);var t=this;t.mute=e,e?t.PlayBGM(0,!1):t.PlayBGM(0,!0)},e._instance=null,e}();__reflect(FishSoundManager.prototype,"FishSoundManager");var FishThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(FishThemeAdapter.prototype,"FishThemeAdapter",["eui.IThemeAdapter"]);var FishTypeItem=function(e){function t(){var t=e.call(this)||this;t.fish=null;var i=t;return i.touchEnabled=!1,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishTypeItemSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){var e=this;e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},t.prototype.uiResizeHandler=function(){},t.prototype.SetFishInfo=function(e,t,i,n){void 0===n&&(n=0);var o=this;o.currentState=i>=40||n?"big":"small",o.fish_type_item_name.text=e,i>0?(o.fish_type_item_multi.text=""+i+"倍",o.fish_type_item_specific.text=""):(o.fish_type_item_multi.text="",o.fish_type_item_specific.text="获得奖杯"),o.fish=FishManager.GetInstance().BuildFish(t,0),o.fish.x=o.width/2,o.fish.y=o.height/2,o.fish.height>100&&(o.fish.scaleX=.5,o.fish.scaleY=.5),o.fish.rotation=45,o.fish.MoveOnly(),o.addChild(o.fish)},t.prototype.ClearFishInfo=function(){var e=this;e.fish&&(e.fish.parent&&e.fish.parent.removeChild(e.fish),FishManager.GetInstance().DestroyFish(e.fish))},t}(eui.Component);__reflect(FishTypeItem.prototype,"FishTypeItem");var FishTypes=function(e){function t(){var i=e.call(this)||this;i.items=[];var n=i;return n.skinName=FishTypesSkin,null==t.typeConfigs&&(t.typeConfigs=RES.getRes("fish_json"),t.typeConfigs=t.typeConfigs.sort(n.sortFunction)),i}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return void 0==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.sortFunction=function(e,t){return e.redpacket>0?1:t.redpacket>0?-1:e.multiple>t.multiple?1:-1},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this;t.fish_btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnTouchHandler,t),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2;var i=new eui.TileLayout;i.horizontalGap=15,i.verticalGap=15,i.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,i.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,i.paddingTop=10,i.paddingRight=15,i.paddingLeft=15,i.paddingBottom=10,i.requestedColumnCount=4,t.fish_group_types.layout=i},t.prototype.btnTouchHandler=function(e){var t=this;switch(e.target){case t.fish_btn_close:t.hide()}},t.prototype.show=function(i){for(var n=this,o=t.typeConfigs.length-1;o>=0;o--){var r=new FishTypeItem,s=t.typeConfigs[o];r.SetFishInfo(s.name,s.typeid,s.multiple,s.redpacket),n.items.push(r),n.fish_group_types.addChild(r)}e.prototype._show.call(this,i)},t.prototype.hide=function(){var t=this;e.prototype._hide.call(this,function(e){for(var t=e,i=0,n=t.items.length;n>i;i++)t.items[i].ClearFishInfo();t.items.splice(0,t.items.length),t.fish_group_types.removeChildren()},t)},t.typeConfigs=null,t}(FishPanelBase);__reflect(FishTypes.prototype,"FishTypes");var FishUserInfo=function(e){function t(){var t=e.call(this)||this,i=t;return i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.addEventListener(egret.Event.RESIZE,i.uiResizeHandler,i),i.skinName=FishUserInfoSkin,t}return __extends(t,e),t.prototype.uiCompHandler=function(){var e=this;e.currentState="wait"},t.prototype.uiResizeHandler=function(){},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.SetUserInfo=function(e,t,i,n,o,r){void 0===t&&(t=""),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=""),void 0===r&&(r=0);var s=this;0==e?s.currentState="wait":e==fishServer.uid?(s.currentState="normal",s.fish_label_nickname.text=t,s.fish_label_id.text="ID:"+e,s.fish_label_gold.text=i+"",s.fish_label_diamond.text=n+"",s.fish_label_redcoin.text=r+"",null==o||""==o?s.fish_img_avatar.source="fish_touxiang":s.fish_img_avatar.source=o):(s.currentState="other",s.fish_label_nickname.text=t,s.fish_label_id.text="ID:"+e,s.fish_label_gold.text=i+"",null==o||""==o?s.fish_img_avatar.source="fish_touxiang":s.fish_img_avatar.source=o)},t.prototype.UpdateGold=function(e){var t=this;t.fish_label_gold.text=e+""},t.prototype.UpdateDiamond=function(e){var t=this;"normal"==t.currentState&&(t.fish_label_diamond.text=e+"")},t.prototype.UpdateRedcoin=function(e,t){void 0===t&&(t=!1);var i=this;"normal"==i.currentState&&(t?i.fish_label_redcoin.text=(parseFloat(i.fish_label_redcoin.text)+e).toFixed(2)+"":i.fish_label_redcoin.text=e.toFixed(2)+"")},t}(eui.Component);__reflect(FishUserInfo.prototype,"FishUserInfo");